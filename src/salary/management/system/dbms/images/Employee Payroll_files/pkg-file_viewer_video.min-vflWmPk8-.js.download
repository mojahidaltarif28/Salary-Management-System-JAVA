define("modules/clean/react/previews/video/video_player",["require","exports","tslib","flash_detect","external/lodash","react","react-dom","classnames","videojs/video","jquery","modules/clean/ajax","modules/clean/perf_tools/web_timing_utils","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/previews/video/poster_image","modules/clean/react/previews/video/icon","modules/clean/react/previews/video/title","modules/clean/react/previews/video/utils","modules/clean/react/previews/video/settings_menu_component","modules/clean/react/comments2/video_annotations/constants","modules/clean/react/comments2/video_annotations/video_preview_event_emitter","modules/constants/file_viewer","modules/constants/static","modules/core/browser_detection","modules/core/i18n","modules/clean/react/previews/video/video_thumbnails","modules/clean/react/previews/video/audio_waveform/audio_waveform","modules/clean/react/previews/video/comments2_onboarding","modules/clean/react/previews/video/annotation_markers","modules/clean/react/previews/video/constants","modules/clean/react/previews/video/videojs_portal_component","dig-components/icons","dig-components/icons/src"],(function(e,t,a,n,i,r,o,s,l,u,d,c,p,m,f,h,v,y,g,b,_,S,T,w,E,I,C,P,k,L,M,O,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),i=a.__importStar(i),r=a.__importDefault(r),o=a.__importDefault(o),s=a.__importDefault(s),l=a.__importDefault(l),u=a.__importDefault(u),d=a.__importStar(d),S=a.__importStar(S),T=a.__importStar(T),w=a.__importStar(w),l.default.videojs.registerComponent("PosterImage",f.PosterImage);var N=(function(e){function t(t,a){var n=e.call(this,t,a)||this;return n.onClick=function(){n.player().pause();var e=n.frameTime*n.step;n.player().currentTime(n.player().currentTime()+e)},n.mount=function(){n.step<0?o.default.render(r.default.createElement("div",{className:"frame-stepper"},r.default.createElement(O.UIIcon,{src:x.SkipTrackBackLine})),n.el()):o.default.render(r.default.createElement("div",{className:"frame-stepper"},r.default.createElement(O.UIIcon,{src:x.SkipTrackForwardLine})),n.el())},t&&a?(n.frameTime=1/a.frameRate,n.step=a.step,n.on("click",n.onClick),n.on("dispose",(function(){o.default.unmountComponentAtNode(n.el())})),t.ready((function(){n.mount()})),n):n}return a.__extends(t,e),t})(l.default.videojs.getComponent("Button")),R=(function(e){function t(t,a){return a&&(a.step=-1),e.call(this,t,a)||this}return a.__extends(t,e),t})(N),A=(function(e){function t(t,a){return a&&(a.step=1),e.call(this,t,a)||this}return a.__extends(t,e),t})(N);function j(e,t){l.default.videojs.getComponent("FrameStepper")||(l.default.videojs.registerComponent("FrameStepper",N),l.default.videojs.registerComponent("BackStepper",R),l.default.videojs.registerComponent("ForwardStepper",A)),e.controlBar&&e.controlBar.el&&e.controlBar.el()&&!e.controlBar.getChild("BackStepper")&&(e.controlBar.addChild("BackStepper",{frameRate:t},6),e.controlBar.addChild("ForwardStepper",{frameRate:t},7))}function D(e){e.controlBar&&e.controlBar.el&&e.controlBar.el()&&(e.controlBar.removeChild("BackStepper"),e.controlBar.removeChild("ForwardStepper"))}var U=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.videoNodeRef=function(e){return t.videoNode=e},t.startSeekTime=0,t.oldPlaybackRate=1,t.playLatencyStart=0,t.playlistRetryCount={},t.rafLoopShouldRun=!1,t.state={paused:!1},t.isPlaylistPreloading=function(){var e=t.state.player?y.getTechFromPlayer(t.state.player):void 0;return!!e&&!!e.hls},t.onError=function(e){if(t.props.playerCallbacks.onError){var a=t.state.player&&t.state.player.error()||{code:0,message:e};t.props.playerCallbacks.onError(a)}t.disposeVideoJSPlayer(t.state.player),t.cancelUpdateTimeLoop(!1,!1)},t.setUserInactive=function(){t.state.player&&t.state.player.userActive(!1)},t.onVideoToggled=function(){t.state.player&&(t.state.player.paused()?t.state.player.play():t.state.player.pause())},t.onLoadedMetadata=function(){if(t.state.player&&t.props.playerCallbacks.onLoadedMetadata){var e=t.state.player.duration();t.props.playerCallbacks.onLoadedMetadata(e),t.setState({duration:e})}},t.onReady=function(){if(t.props.shouldFocusOnReady&&setTimeout(t.setFocus,0),t.props.playerCallbacks.onReady&&t.state.player&&t.props.playerCallbacks.onReady(t.isPlaylistPreloading()),w.ipad){var e=0;u.default(document).on("dropdownOpened modalOpened",(function(t,a){e+=a,u.default(this.state.player.el()).children("video").removeAttr("controls")})),u.default(document).on("dropdownClosed modalClosed",(function(t,a){0===(e-=a)&&u.default(this.state.player.el()).children("video").attr("controls","controls")}))}t.props.videoProps.metadataLink&&t.retrieveMetadata(),_.videoPreviewEventEmitter.removeAllListeners(b.EventTypes.SEEK_POSITION_AND_PAUSE),_.videoPreviewEventEmitter.addListener(b.EventTypes.SEEK_POSITION_AND_PAUSE,t.onSeekPositionAndPause)},t.onPlay=function(){t.playLatencyTrigger||t.recordPlayLatencyBeginningNow(L.VideoPreviewEvent.VideoStartsPlaying),t.props.playerCallbacks.onPlay&&t.props.playerCallbacks.onPlay(),u.default(".vjs-poster").hide(),u.default(".vjs-big-play-button").hide(),t.rafLoopShouldRun=!0,t.updateTimeLoop()},t.onStartsPlaying=function(){t.props.playerCallbacks.onStartsPlaying&&t.props.playerCallbacks.onStartsPlaying(t.getPlayLatencyInfoEndingNow())},t.onPause=function(){t.recordPlayLatencyBeginningNow(L.VideoPreviewEvent.VideoPaused),t.state.player.currentTime(t.state.player.currentTime()),t.props.playerCallbacks.onPause&&t.props.playerCallbacks.onPause(t.state.player.currentTime()),t.cancelUpdateTimeLoop(!1,!1)},t.onSeekPositionAndPause=function(e){if(t.state.player){var a=t.state.player,n=function(){a.pause(),a.currentTime(e)},i=function(){n(),window.setTimeout((function(){return a.muted(!1)}),250)};a.hasStarted()?n():a.ready((function(){a.muted(!0);var e=a.play();e?e.then(i):i()}))}},t.onLoadStart=function(){var e=y.getTechFromPlayer(t.state.player);e&&e.on("retryplaylist",(function(){var a,n=e.hls.selectPlaylist();e.hls&&n&&(a=n.resolvedUri)&&((++t.playlistRetryCount[a]||(t.playlistRetryCount[a]=1))>S.VIDEOJS_PLAYLIST_RETRY_THRESHOLD&&t.state.player.error({err:"Maximum retry limit reached for "+a}))}))},t.onUserInactive=function(){t.props.playerCallbacks.onUserInactive&&t.props.playerCallbacks.onUserInactive(t.state.player.playbackRate())},t.onEnd=function(){u.default(".vjs-poster").show(),u.default(".vjs-big-play-button").show(),u.default(".vjs-loading-spinner").hide(),t.cancelUpdateTimeLoop(!0,!0)},t.onPlaybackRateChange=function(){t.props.playerCallbacks.onPlaybackRateChange&&t.props.playerCallbacks.onPlaybackRateChange(t.oldPlaybackRate,t.state.player.playbackRate())},t.onStartSeek=function(){t.recordPlayLatencyBeginningNow(L.VideoPreviewEvent.SeekVideo),t.startSeekTime=t.state.player.currentTime()},t.onEndSeek=function(){t.props.playerCallbacks.onSeek&&t.props.playerCallbacks.onSeek(t.startSeekTime,t.state.player.currentTime())},t.onStalled=function(){t.recordPlayLatencyBeginningNow(L.VideoPreviewEvent.VideoStalled),t.props.playerCallbacks.onStalled&&t.props.playerCallbacks.onStalled(t.state.player.currentTime(),t.state.player.playbackRate()),t.cancelUpdateTimeLoop(!1,!1)},t.onThumbLoad=function(){t.props.playerCallbacks.onThumbLoad&&t.props.playerCallbacks.onThumbLoad(t.isPlaylistPreloading())},t.onSeek=function(){t.state.player&&t.state.player.controlBar.currentTimeDisplay.updateContent()},t.onSelectQuality=function(e,a,n){t.props.playerCallbacks.onSelectQuality&&t.props.playerCallbacks.onSelectQuality(e,a)},t.onAudioWaveformLoaded=function(){t.props.playerCallbacks.onAudioWaveformLoaded&&t.props.playerCallbacks.onAudioWaveformLoaded(t.isPlaylistPreloading())},t.displayTruncatedMessage=function(){t.state.player&&t.state.player.addClass("show-truncated-bar")},t.onTimeupdate=function(){t.state.player&&t.props.playerCallbacks.onTimeUpdate&&t.props.playerCallbacks.onTimeUpdate(t.state.player.currentTime())},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){if(!this.shouldUseFlash()||n.default.installed&&n.default.majorAtLeast(10)){this.props.noDownload&&this.videoNode.setAttribute("controlsList","nodownload");var e=this.createVideoJSPlayer();this.setState({player:e}),this.addEventEmitterListeners()}else this.onError("needflash")},t.prototype.componentDidUpdate=function(e){var t=this.props.videoProps,a=this.state.player;if(i.isEqual(t,e.videoProps)||(this.disposeVideoJSPlayer(a),a=this.createVideoJSPlayer(),t.metadataLink&&this.retrieveMetadata(),this.setState({player:a})),a)switch(e.framePreciseCommentsEnabled!==this.props.framePreciseCommentsEnabled?(D(a),this.props.frameRate&&j(a,this.props.frameRate)):e.frameRate!==this.props.frameRate&&this.props.framePreciseCommentsEnabled&&this.props.frameRate&&(D(a),j(a,this.props.frameRate)),this.props.seekPosition){case void 0:case-1:case e.seekPosition:break;default:a.currentTime(this.props.seekPosition)}},t.prototype.componentWillUnmount=function(){this.currentRaf&&this.cancelUpdateTimeLoop(!0,!1),this.props.onClose&&this.state.player&&this.props.onClose(this.state.player.currentTime()),this.removeEventEmitterListeners(),this.disposeVideoJSPlayer(this.state.player)},t.prototype.createVideoJSPlayer=function(){var e=l.default.videojs(this.videoNode,this.getPlayerOptions(),this.onReady);return(function(e){if(!l.default.videojs.getComponent("TruncatedBar")){var t=l.default.videojs.getComponent("Component"),n=l.default.videojs.extend(t,{createEl:function(e,n,i){void 0===e&&(e="div"),void 0===n&&(n={}),void 0===i&&(i={}),n=a.__assign(a.__assign({},n),{className:"truncated-bar"});var r=t.prototype.createEl.call(this,e,n,i);return r.innerText=E.intl.formatMessage({id:"x9y2Yc",defaultMessage:"Youâ€™re watching a preview. To watch the full video, download or add it to your Dropbox."}),r}});l.default.videojs.registerComponent("TruncatedBar",n)}e.addChild("TruncatedBar")})(e),this.props.framePreciseCommentsEnabled&&this.props.frameRate&&j(e,this.props.frameRate),this.addEventListenersToPlayer(e),this.props.onEmbed&&this.props.onEmbed(),e},t.prototype.disposeVideoJSPlayer=function(e){if(u.default(".vjs-big-play-button").blur(),e)try{e.trigger("shutdown"),e.dispose()}catch(e){}},t.prototype.addEventListenersToPlayer=function(e){e.on("loadedmetadata",this.onLoadedMetadata),e.on("timeupdate",this.onTimeupdate),this.props.playerCallbacks.onCanPlay&&e.on("canplay",this.props.playerCallbacks.onCanPlay),this.props.playerCallbacks.onClick&&e.on("click",this.props.playerCallbacks.onClick),e.on("play",this.onPlay),e.on("playing",this.onStartsPlaying),e.on("pause",this.onPause),e.on("userinactive",this.onUserInactive),e.on("ended",this.onEnd),e.on("error",this.onError),e.on("ratechange",this.onPlaybackRateChange),e.on("seeking",this.onStartSeek),e.on("seeked",this.onEndSeek),e.on("stalled",this.onStalled),e.one("loadstart",this.onLoadStart),e.on("mouseleave",this.setUserInactive),e.on("seeked",this.onSeek)},t.prototype.addEventEmitterListeners=function(){var e=this;m.filePreviewEventEmitter.addListener(p.EventType.FilePreviewVideoToggled,this.onVideoToggled),_.videoPreviewEventEmitter.removeAllListeners(b.EventTypes.PAUSE),_.videoPreviewEventEmitter.addListener(b.EventTypes.PAUSE,(function(){e.state.player&&!e.state.player.paused()&&e.state.player.pause()}))},t.prototype.removeEventEmitterListeners=function(){_.videoPreviewEventEmitter.removeAllListeners(b.EventTypes.SEEK_POSITION_AND_PAUSE),_.videoPreviewEventEmitter.removeAllListeners(b.EventTypes.PAUSE),m.filePreviewEventEmitter.removeAllListeners(p.EventType.FilePreviewVideoToggled)},t.prototype.updateTimeLoop=function(){var e=this;this.currentRaf=window.requestAnimationFrame((function(){e.state.player&&e.props.playerCallbacks.onTimeUpdate&&e.props.playerCallbacks.onTimeUpdate(e.state.player.currentTime()),e.rafLoopShouldRun&&e.updateTimeLoop()}))},t.prototype.cancelUpdateTimeLoop=function(e,t){e&&this.currentRaf&&window.cancelAnimationFrame(this.currentRaf),this.rafLoopShouldRun=!1,t&&this.state.player&&this.state.player.currentTime(0)},t.prototype.recordPlayLatencyBeginningNow=function(e){this.playLatencyStart=c.WebTimingUtil.getNow(),this.playLatencyTrigger=e},t.prototype.getPlayLatencyInfoEndingNow=function(){var e=c.WebTimingUtil.getNow();return{trigger:this.playLatencyTrigger,latency:e-this.playLatencyStart}},t.prototype.setFocus=function(){u.default(".vjs-poster").show(),u.default(".vjs-big-play-button").show(),u.default(".vjs-big-play-button").focus()},t.prototype.shouldUseFlash=function(){return null!=w.msie},t.prototype.retrieveMetadata=function(){var e=this;d.SilentBackgroundRequest({url:this.props.videoProps.metadataLink,type:"GET",data:{},skipInjectCsrf:!0,xhrFields:{withCredentials:!0},success:function(t){JSON.parse(t).is_truncated&&(e.props.onTruncated&&e.props.onTruncated(),e.props.shouldShowTruncationMessage&&i.defer(e.displayTruncatedMessage))}})},t.prototype.getPlayerOptions=function(){var e=T.static_url_video_flashls_swf,t=this.shouldUseFlash()||w.is_mobile_or_tablet()?"playbackRateMenuButton":{name:g.VJS_SETTINGS_MENU,initialSrc:{src:this.props.videoProps.src,type:this.props.videoProps.sourceContentType},srcMap:this.props.videoProps.separateResolutionSrcs,showQualityNativeHls:y.showQualityNativeHls(),onSelectQuality:this.onSelectQuality},a={preload:"auto",controls:!0,bigPlayButton:!this.props.isAudio&&{children:[{name:h.VJS_MEDIA_ICON,iconName:"play"}]},controlBar:{children:["progressControl","playToggle","currentTimeDisplay","remainingTimeDisplay","timeDivider","durationDisplay",{name:v.VJS_TITLE,title:this.props.videoProps.title},"volumePanel",t,!this.props.isAudio&&"fullscreenToggle",{name:"OnboardingIndicator",componentClass:M.VJS_PORTAL,elementAttrs:{class:"onboarding-indicator"}}],progressControl:{seekBar:{children:[{name:"markers",componentClass:M.VJS_PORTAL,elementAttrs:{class:"markers"}}],playProgressBar:{timeTooltip:!1},mouseTimeDisplay:!(!w.is_mobile_or_tablet()&&!this.props.isAudio)||{componentClass:I.VTT_THUMBNAILS,src:this.props.videoProps.vttThumbnailsUrl,onScrubberThumbnailsLoaded:this.props.playerCallbacks.onScrubberThumbnailsLoaded}}},playToggle:{children:[{name:h.VJS_MEDIA_ICON,iconName:"play"},{name:h.VJS_MEDIA_ICON,iconName:"pause"}]},volumePanel:{muteToggle:{children:[{name:h.VJS_MEDIA_ICON,iconName:"volume"},{name:h.VJS_MEDIA_ICON,iconName:"volume-muted"}]}},fullscreenToggle:!this.props.isAudio&&{children:[{name:h.VJS_MEDIA_ICON,iconName:"fullscreen"},{name:h.VJS_MEDIA_ICON,iconName:"fullscreen-exit"}]}},flash:{swf:e,flashVars:{contentType:this.props.videoProps.sourceContentType},hls:{withCredentials:!0},params:this.props.isAudio?{bgcolor:"#ffffff"}:{}},html5:{hls:{overrideNative:!0,withCredentials:!0}},onThumbLoad:this.onThumbLoad,techOrder:this.shouldUseFlash()?["flash"]:["html5"],nativeControlsForTouch:!1,audioWaveform:!!this.props.isAudio&&{name:C.AUDIO_WAVEFORM,bytes:this.props.bytes,onAudioWaveformLoaded:this.onAudioWaveformLoaded,onAudioWaveformFailed:this.props.playerCallbacks.onAudioWaveformFailed,waveformUrl:this.props.videoProps.waveformUrl},loadingSpinner:!this.props.isAudio};return i.merge(a,this.props.playerOptions),a},t.prototype.render=function(){var e=this.props,t=e.isAudio,a=e.shouldEnableControls,n=e.videoProps,i=n.src,o=n.sourceContentType,l=s.default("video-player",{"audio-player":this.props.isAudio});return r.default.createElement("div",{className:l},r.default.createElement("div",{key:i,"data-vjs-player":!0},r.default.createElement(q,{videoNodeRef:this.videoNodeRef,isAudio:t,className:"video-js vjs-default-skin vjs-big-play-centered",controls:a},r.default.createElement("source",{src:i,type:o})),this.props.showOnboarding?r.default.createElement(M.VideojsPortal,{childName:"OnboardingIndicator",player:this.state.player},r.default.createElement(P.OnboardingMessage,null)):null,this.state.duration&&this.props.playerIntegrationEnabled?r.default.createElement(k.AnnotationMarkers,{player:this.state.player,duration:this.state.duration}):null))},t})(r.default.Component);t.VideoPlayer=U;var q=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.videoNodeRef,n=e.isAudio,i=e.children,o=a.__rest(e,["videoNodeRef","isAudio","children"]);return n?r.default.createElement("audio",a.__assign({ref:t},o),i):r.default.createElement("video",a.__assign({ref:t},o),i)},t})(r.default.Component)})),define("modules/clean/react/previews/video/video_thumbnails",["require","exports","tslib","react","react-dom","videojs/video","modules/clean/react/previews/video/thumbnails_helper","modules/core/exception"],(function(e,t,a,n,i,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),i=a.__importStar(i),r=a.__importDefault(r),s=a.__importStar(s),t.VTT_THUMBNAILS="vttThumbnails";var l,u=r.default.videojs.getComponent("Component");(function(e){e.Requesting="requesting",e.Failed="failed",e.ImageLoaded="image_loaded"})(l||(l={}));var d=(function(e){function t(t,a){var r,o=e.call(this,t,a)||this;return o.mount=function(){i.render(n.default.createElement(c,{vttUrl:o.src,onScrubberThumbnailsLoaded:o.onScrubberThumbnailsLoaded,ref:function(e){return o.thumbnailComponent=e}}),o.el())},o.src=null!==(r=null==a?void 0:a.src)&&void 0!==r?r:"",o.onScrubberThumbnailsLoaded=null==a?void 0:a.onScrubberThumbnailsLoaded,t&&t.ready(o.mount),o}return a.__extends(t,e),t.prototype.dispose=function(){i.unmountComponentAtNode(this.el())},t.prototype.update=function(e,t){var a=this.player().duration();this.thumbnailComponent&&this.thumbnailComponent.update(e,t,a)},t})(u);t.VttThumbnails=d;var c=(function(e){function t(t){var a=e.call(this,t)||this;return a.state={seekPointX:0,playerWidth:0,formattedTime:"",thumbLoadState:null!=t.vttUrl?l.Requesting:l.Failed},t.vttUrl&&o.loadVtt(t.vttUrl).then((function(e){if(a.thumbs=e,e&&e.length>0)return o.preloadThumbImage(e[0]).then((function(e){a.setState({thumbLoadState:l.ImageLoaded}),t.onScrubberThumbnailsLoaded&&t.onScrubberThumbnailsLoaded(!0)})).catch((function(e){t.onScrubberThumbnailsLoaded&&(t.onScrubberThumbnailsLoaded(!1),a.setState({thumbLoadState:l.Failed}))}))})).catch((function(e){t.onScrubberThumbnailsLoaded&&(t.onScrubberThumbnailsLoaded(!1),a.setState({thumbLoadState:l.Failed})),s.reportException({err:e,tags:["videoPreviews"],severity:s.SEVERITY.NONCRITICAL})})),a}return a.__extends(t,e),t.prototype.update=function(e,t,n){var i,s=t*n,l=e.width*t;if(this.thumbs){var u=this.thumbs.find((function(e){return e.startTime<=s&&e.endTime>=s}));u&&(i=o.parseVttCue(u))}var d=r.default.videojs.formatTime(s,n);this.setState(a.__assign({playerWidth:e.width,seekPointX:l,formattedTime:d},i))},t.prototype.render=function(){var e=this.state,t=e.playerWidth,a=e.seekPointX,i=e.formattedTime,r=e.imageUrl,o=e.imageX,s=e.imageY,u=e.imageWidth,d=e.imageHeight,c=e.thumbLoadState,p={},m=128;switch(c){case l.ImageLoaded:p={background:'url("'+r+'") no-repeat -'+o+"px -"+s+"px",width:u,height:d};break;case l.Failed:m=40,p={display:"none"}}var f=Math.min(Math.max(0,a-m/2),t-m),h={left:f,width:m},v={left:a-(f+m/2)};return n.default.createElement("div",{className:"vjs-thumbnail-wrapper",style:h},n.default.createElement("div",{className:"vjs-thumbnail-image",style:p},c===l.Requesting?n.default.createElement("div",{className:"c-loader"}):null),n.default.createElement("div",{className:"vjs-thumbnail-time"}," ",i," "),n.default.createElement("div",{className:"vjs-time-line",style:v}))},t})(n.default.Component);t.VideoThumbnailsComponent=c,r.default.videojs.registerComponent(t.VTT_THUMBNAILS,d)})),define("modules/clean/react/previews/video/poster_image",["require","exports","tslib","videojs/video","modules/clean/react/previews/image_helpers"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(e){function t(t,a){var n,i,r=e.call(this,t,a)||this;return(null==a?void 0:a.playerOptions)&&(r.onThumbLoad=null===(n=a.playerOptions)||void 0===n?void 0:n.onThumbLoad,r.onThumbError=null===(i=a.playerOptions)||void 0===i?void 0:i.onThumbError),r}return a.__extends(t,e),t.prototype.setSrc=function(t){return a.__awaiter(this,void 0,void 0,(function(){var n;return a.__generator(this,(function(a){switch(a.label){case 0:if(e.prototype.setSrc.call(this,""),!t)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,i.preloadImage(t)];case 2:return a.sent(),this.onThumbLoad&&this.onThumbLoad(),e.prototype.setSrc.call(this,t),[3,4];case 3:return n=a.sent(),this.onThumbError&&this.onThumbError(n),[3,4];case 4:return[2]}}))}))},t})((n=a.__importDefault(n)).default.videojs.getComponent("PosterImage"));t.PosterImage=r})),define("modules/clean/react/previews/video/settings_menu_component",["require","exports","tslib","react","react-dom","external/lodash","videojs/video","modules/clean/react/previews/video/menu/top_level_menu","modules/clean/react/previews/video/menu/settings_sub_menu","modules/clean/react/previews/video/menu/menu_content","modules/clean/react/previews/video/menu/popover_trigger","modules/clean/react/previews/video/menu/popover_wrapper","modules/clean/react/previews/video/menu/click_outside","modules/clean/react/previews/video/menu/quality_selector","modules/clean/react/previews/video/menu/video_quality_manager","modules/clean/react/previews/video/menu/video_quality_manager_native_hls"],(function(e,t,a,n,i,r,o,s,l,u,d,c,p,m,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),i=a.__importStar(i),o=a.__importDefault(o),t.VJS_SETTINGS_MENU="vjsSettingsMenu";var v=(function(e){function t(t,a){var r=e.call(this,t,a)||this;return r.setPlaybackRate=function(e){r.player().playbackRate(e)},r.mount=function(){i.render(n.default.createElement(y,{onPlaybackRateSelected:r.setPlaybackRate,onSelectQuality:r.onSelectQuality,quality:r.qualityManager.generateQualityProps()}),r.el())},null==t||t.ready(r.mount),r.addClass("vjs-settings-menu"),r.onSelectQuality=null==a?void 0:a.onSelectQuality,(null==a?void 0:a.showQualityNativeHls)&&(null==a?void 0:a.initialSrc)&&t?r.qualityManager=new h.VideoQualityManagerNativeHls(t,r.mount,a.initialSrc,a.srcMap):t&&(r.qualityManager=new f.VideoQualityManager(t,r.mount)),r}return a.__extends(t,e),t.prototype.dispose=function(){i.unmountComponentAtNode(this.el())},t})(o.default.videojs.getComponent("Component"));t.VjsSettingsMenu=v;var y=(function(e){function t(t){var a=e.call(this,t)||this;return a.show=function(){a.setState({showing:!0})},a.toggle=function(){a.state.showing?a.setState({showing:!1}):a.show()},a.hide=function(){a.setState({showing:!1})},a.activateTopLevel=function(){return a.setState({activeSubMenu:void 0})},a.selectPlaybackRate=function(e){a.setState({playbackRate:e}),a.props.onPlaybackRateSelected(parseFloat(e))},a.selectQualityLevel=function(e,t){if(a.props.onSelectQuality&&a.props.quality){var n="Auto";!a.props.quality.autoSelecting&&a.props.quality.selectedQuality&&(n=a.props.quality.selectedQuality.label),a.props.onSelectQuality(n,t)}a.props.quality.onQualitySelected(e,t)},a.state={showing:!1,playbackRate:"1.0"},a}return a.__extends(t,e),t.prototype.activateSubMenu=function(e){var t=this;return function(){t.setState({activeSubMenu:e})}},t.prototype.currentQualityLevel=function(){return this.props.quality&&this.props.quality.selectedQuality?this.props.quality.selectedQuality.label:void 0},t.prototype.renderTopLevel=function(){return n.default.createElement(s.TopLevelMenu,null,n.default.createElement(s.TopLevelItem,{label:"Speed",current:this.state.playbackRate+"x",onClick:this.activateSubMenu("playbackRate")}),this.props.quality&&this.props.quality.qualityList.length>1?n.default.createElement(s.TopLevelItem,{label:"Quality",current:this.currentQualityLevel(),onClick:this.activateSubMenu("qualitySelector")}):null)},t.prototype.renderPlaybackRateChooser=function(){return n.default.createElement(l.SettingsSubMenu,{key:"playbackRate",items:g,title:"Speed",onSelected:this.selectPlaybackRate,onBack:this.activateTopLevel,selected:[this.state.playbackRate]})},t.prototype.render=function(){var e=this.props.quality&&this.props.quality.selectedQuality&&this.props.quality.selectedQuality.hd;return n.default.createElement(p.ClickOutside,{disableOnClickOutside:!this.state.showing,handleOutsideClick:this.state.showing?this.hide:void 0},n.default.createElement(c.PopoverWrapper,null,n.default.createElement(d.PopoverTrigger,{onClick:this.toggle,showing:this.state.showing,hd:e}),n.default.createElement(u.MenuContent,{showing:this.state.showing,activeId:this.state.activeSubMenu,topLevel:this.renderTopLevel(),playbackRate:this.renderPlaybackRateChooser(),qualitySelector:this.props.quality?n.default.createElement(m.QualitySelector,a.__assign({onBack:this.activateTopLevel},this.props.quality,{onQualitySelected:this.selectQualityLevel})):null})))},t})(n.default.Component);t.SettingsMenuComponent=y;var g=r.toPairs({.5:"0.5x","1.0":"1.0x",1.25:"1.25x",1.5:"1.5x","2.0":"2.0x","4.0":"4.0x"}).map((function(e){return{key:e[0],label:e[1]}}));o.default.videojs.registerComponent(t.VJS_SETTINGS_MENU,v)})),define("modules/clean/react/previews/video/title",["require","exports","tslib","react","react-dom","videojs/video"],(function(e,t,a,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),i=a.__importStar(i),r=a.__importDefault(r),t.VJS_TITLE="vjsTitle";var o=(function(e){function t(t,a){var r,o=e.call(this,t,a)||this;return o.mount=function(){i.render(n.default.createElement("div",{className:"vjs-title"},o.title),o.el())},o.title=null!==(r=null==a?void 0:a.title)&&void 0!==r?r:"",o.addClass("vjs-title-wrapper"),t&&t.ready(o.mount),o}return a.__extends(t,e),t.prototype.dispose=function(){i.unmountComponentAtNode(this.el()),e.prototype.dispose.call(this)},t})(r.default.videojs.getComponent("Component"));r.default.videojs.registerComponent(t.VJS_TITLE,o)})),define("modules/clean/react/previews/video/menu/click_outside",["require","exports","tslib","react","react-onclickoutside"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),i=a.__importDefault(i);var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.handleClickOutside=function(){this.props.handleOutsideClick&&this.props.handleOutsideClick()},t.prototype.render=function(){return n.default.Children.only(this.props.children)},t})(n.default.Component);t.ClickOutside=i.default(r)})),define("modules/clean/react/previews/video/menu/popover_trigger",["require","exports","tslib","react","classnames","spectrum/icon_action","modules/clean/react/image","modules/clean/static_urls"],(function(e,t,a,n,i,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),i=a.__importDefault(i),t.PopoverTrigger=function(e){var t={role:"menubutton","aria-haspopup":!0,"aria-expanded":e.showing};return n.default.createElement("button",a.__assign({onClick:e.onClick},t,{className:i.default("vjs-button","vjs-control","vjs-menu-button-popup","vjs-settings-menu-trigger")}),e.hd?n.default.createElement(r.IconAction,{className:"gear-icon gear-icon-hd",name:"settings-gear",icon:n.default.createElement(o.Image,{src:s.static_url("/static/images/previews/video/hd-gear-vflS3P3nO.svg")})}):n.default.createElement(r.IconAction,{className:"gear-icon",name:"settings-gear"}))}})),define("modules/clean/react/previews/video/menu/quality_selector",["require","exports","tslib","react","modules/clean/react/previews/video/menu/settings_sub_menu"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectQuality=function(e,a){"auto"===e&&t.props.autoSelecting&&t.props.selectedQuality?t.props.onQualitySelected(t.props.selectedQuality.key,t.props.selectedQuality.label):t.props.autoSelecting?t.props.onQualitySelected(e,a):t.props.selectedQuality&&e!==t.props.selectedQuality.key&&t.props.onQualitySelected(e,a)},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props.autoSelecting?["auto"]:[],t=this.props.selectedQuality?e.concat([this.props.selectedQuality.key]):e,a=this.props.qualityList.map((function(e){return{key:e.key,label:e.label,marginText:e.hd?"HD":void 0}})).concat([{key:"auto",label:"Auto"}]);return n.default.createElement(i.SettingsSubMenu,{key:"qualitySelector",items:a,title:"Quality",onSelected:this.selectQuality,onBack:this.props.onBack,selected:t,allowReselect:!0})},t})((n=a.__importDefault(n)).default.Component);t.QualitySelector=r})),define("modules/clean/react/previews/video/menu/settings_sub_menu",["require","exports","tslib","react","classnames","spectrum/icon_arrow"],(function(e,t,a,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),i=a.__importDefault(i),t.SettingsSubMenu=function(e){var t=e.items.map((function(t){var a=t.key,r=t.label,o=t.marginText,s=e.selected&&e.selected.includes(a);return n.default.createElement("li",{className:"vjs-menu-settings-sub-menu-item-row",key:a},n.default.createElement("div",{className:"vjs-menu-settings-sub-menu-item-margin-text"},o),n.default.createElement("div",{className:i.default({"vjs-menu-settings-sub-menu-item":!0,"vjs-menu-settings-sub-menu-item-selected":s})},n.default.createElement("button",{className:"vjs-menu-settings-sub-menu-item-button",role:"menuitem",onClick:!s||e.allowReselect?function(){return e.onSelected(a,r)}:void 0},r)))}));return n.default.createElement("div",{className:"vjs-menu-settings-sub-menu"},n.default.createElement("button",{role:"button",className:"vjs-menu-settings-sub-menu-title",onClick:e.onBack},n.default.createElement(r.IconArrow,{name:"right",className:"vjs-menu-actually-left-icon"}),n.default.createElement("div",{className:"vjs-menu-settings-sub-menu-title-text"},e.title)),n.default.createElement("ul",null,t))}})),define("modules/clean/react/previews/video/menu/top_level_menu",["require","exports","tslib","react","spectrum/icon_arrow"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),t.TopLevelItem=function(e){return n.default.createElement("li",{onClick:e.onClick,role:"menuitem",className:"vjs-menu-top-level-item"},n.default.createElement("div",{className:"vjs-menu-top-level-item-group"},n.default.createElement("div",{className:"vjs-menu-top-level-item-text"},e.label),n.default.createElement("div",{className:"vjs-menu-top-level-item-selected-value"},e.current),n.default.createElement(i.IconArrow,{name:"right"})))},t.TopLevelMenu=function(e){var t=e.children;return n.default.createElement("div",{className:"vjs-menu-top-level"},t)}})),define("modules/clean/react/previews/video/menu/video_quality_manager",["require","exports","external/lodash","modules/clean/react/previews/video/constants","modules/clean/react/previews/video/utils"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t){var a=this;this.qualityRepresentations=[],this.selectQuality=function(e){var t=a.hls();if(t){t.playlists.on("renditionenabled",a.populateQuality),t.playlists.on("renditiondisabled",a.populateQuality);var n=a.qualityRepresentations.find((function(t){return e===t.id}));n?(n.enabled(!0),a.qualityRepresentations.forEach((function(t){t.enabled(t.id===e)}))):"auto"===e&&a.qualityRepresentations.forEach((function(e){e.enabled(!0)}))}},this.populateQuality=function(){var e=a.hls();a.playlistsByReprId={},e?(a.qualityRepresentations=e.representations(),e.playlists.master.playlists.forEach((function(e){return a.playlistsByReprId[e.id]=e}))):a.qualityRepresentations=[],a.stateUpdated()},this.player=e,this.stateUpdated=t,e.on("loadedmetadata",this.populateQuality),e.on("mediachange",this.populateQuality)}return e.prototype.labelForRepresentation=function(e){return this.playlistsByReprId[e.id]&&this.playlistsByReprId[e.id].attributes.NAME?this.playlistsByReprId[e.id].attributes.NAME:void 0},e.prototype.hls=function(){var e;return null!==(e=i.getTechFromPlayer(this.player).hls)&&void 0!==e?e:void 0},e.prototype.generateQualityProps=function(){var e=this,t=this.hls();if(t){var i=t.playlists.media(),r=a.orderBy(this.qualityRepresentations.filter((function(t){return e.labelForRepresentation(t)})).map((function(t){var a=e.labelForRepresentation(t),i=n.HdLabels.includes(a);return{key:t.id,label:a,hd:i}})),(function(e){return n.QualityLabelOrder.indexOf(e.label)||-1}),"desc");return{selectedQuality:r.find((function(e){return i.id===e.key})),qualityList:r,autoSelecting:this.qualityRepresentations.filter((function(e){return e.enabled()})).length>1,onQualitySelected:this.selectQuality}}},e})();t.VideoQualityManager=r})),define("modules/clean/react/previews/video/menu/video_quality_manager_native_hls",["require","exports","tslib","external/lodash","m3u8-parser","modules/clean/react/previews/video/constants"],(function(e,t,a,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n);var o=(function(){function e(e,t,a,n){var i=this;this.onCanPlay=function(){i.qualitySeekInfo&&i.qualitySeekInfo.seekTime&&(i.player.currentTime(i.qualitySeekInfo.seekTime),i.qualitySeekInfo.paused||i.player.play(),i.qualitySeekInfo=void 0),setTimeout((function(){return i.player.tech({IWillNotUseThisInPlugins:!0}).show()}),1e3)},this.selectQuality=function(e){i.qualitySeekInfo={seekTime:i.player.currentTime(),paused:i.player.paused()},i.player.tech({IWillNotUseThisInPlugins:!0}).hide(),"auto"===e?i.player.src(i.initialSrc):i.player.src({src:e,type:i.initialSrc.type}),i.currentPlaylistId=e,i.stateUpdated()},this.populateQuality=function(e){e&&e.playlists&&(i.validResolutions=e.playlists.filter((function(e){return e.attributes&&e.attributes.NAME})).map((function(e){return e.attributes.NAME})),i.playlists=e.playlists),i.stateUpdated()},this.player=e,this.stateUpdated=t,this.initialSrc=a,this.srcMap=n,this.player.on("canplay",this.onCanPlay),this.loadQuality()}return e.prototype.loadQuality=function(){var e=this;this.loadPlaylist(this.initialSrc.src).then((function(t){var a=new i.Parser;a.push(t),a.end(),e.populateQuality(a.manifest)}))},e.prototype.loadPlaylist=function(e){return new Promise((function(t,a){var n=new XMLHttpRequest;n.withCredentials=!0,n.open("GET",e),n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?t(n.responseText):a())},n.send()}))},e.prototype.getQualityPropsFromPlaylists=function(){var e=this,t=n.orderBy(this.playlists.filter((function(e){return e.attributes&&e.attributes.NAME})).map((function(e){var t=e.attributes.NAME,a=r.HdLabels.includes(t);return{key:e.uri,label:t,hd:a}})),(function(e){return r.QualityLabelOrder.indexOf(e.label)||-1}),"desc"),a=this.currentPlaylistId?n.find(t,(function(t){return e.currentPlaylistId===t.key})):void 0;return{selectedQuality:a,qualityList:t,autoSelecting:!a||"auto"===this.currentPlaylistId,onQualitySelected:this.selectQuality}},e.prototype.getQualityPropsFromSrcMap=function(){var e=this,t=n.orderBy(n.filter(n.map(this.srcMap,(function(e,t){return{key:e,label:t,hd:r.HdLabels.includes(t)}})),(function(t){return e.validResolutions.includes(t.label)})),(function(e){return r.QualityLabelOrder.indexOf(e.label)||-1}),"desc"),a=this.currentPlaylistId?n.find(t,(function(t){return e.currentPlaylistId===t.key})):void 0;return{selectedQuality:a,qualityList:t,autoSelecting:!a||"auto"===this.currentPlaylistId,onQualitySelected:this.selectQuality}},e.prototype.hasSrcMap=function(){return this.srcMap&&n.values(this.srcMap).length>0},e.prototype.generateQualityProps=function(){if(this.playlists||this.hasSrcMap()&&this.validResolutions)return this.playlists&&!this.hasSrcMap()?this.getQualityPropsFromPlaylists():this.getQualityPropsFromSrcMap()},e})();t.VideoQualityManagerNativeHls=o})),define("modules/clean/react/previews/video/thumbnails_helper",["require","exports","tslib","videojs/video","modules/clean/react/previews/image_helpers"],(function(e,t,a,n,i){"use strict";function r(e){var t={},a=e.text.split(/#xywh=/i);if(t.imageUrl=a[0],2===a.length){var n=a[1].split(/[ ,]+/);4===n.length&&(t.imageX=+n[0],t.imageY=+n[1],t.imageWidth=+n[2],t.imageHeight=+n[3])}return t}function o(e){return new Promise((function(t,a){var i=[],r=new n.default.vtt.WebVTT.Parser(window,n.default.vtt,n.default.vtt.WebVTT.StringDecoder());r.oncue=function(e){i.push(e)},r.onparsingerror=function(e){a(e)},r.onflush=function(){t(i)},r.parse(e),r.flush()}))}Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),t.loadVtt=function(e){return(t=e,new Promise((function(e,a){var n=new XMLHttpRequest;n.withCredentials=!0,n.open("GET",t),n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?e(n.responseText):a(new Error("Failed to retrieve vtt file")))},n.send()}))).then(o);var t},t.parseVttCue=r,t.preloadThumbImage=function(e){var t=r(e);return t.imageUrl?i.preloadImage(t.imageUrl):Promise.reject("Unable to get imageUrl from vtt cue")}})),define("modules/clean/react/previews/video/icon",["require","exports","tslib","react","react-dom","videojs/video","spectrum/icon_media"],(function(e,t,a,n,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),i=a.__importStar(i),r=a.__importDefault(r),t.VJS_MEDIA_ICON="vjsMediaIcon";var s=(function(e){function t(t,a){var r,s=e.call(this,t,a)||this;return s.mount=function(){i.render(n.default.createElement(o.IconMedia,{className:s.iconName,name:s.iconName}),s.el())},s.iconName=null!==(r=null==a?void 0:a.iconName)&&void 0!==r?r:"play",t&&t.ready(s.mount),s}return a.__extends(t,e),t.prototype.dispose=function(){i.unmountComponentAtNode(this.el()),e.prototype.dispose.call(this)},t})(r.default.videojs.getComponent("Component"));r.default.videojs.registerComponent(t.VJS_MEDIA_ICON,s)})),define("modules/clean/react/previews/video/menu/menu_content",["require","exports","tslib","react"],(function(e,t,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),t.MenuContent=function(e){return e.showing?n.default.createElement("div",{className:"vjs-menu"},n.default.createElement("ul",{className:"vjs-menu-content"},(function(e){return e.activeId&&e.activeId in e?e[e.activeId]:e.topLevel})(e))):null}})),define("modules/clean/react/previews/video/menu/popover_wrapper",["require","exports","tslib","react","classnames"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),i=a.__importDefault(i),t.PopoverWrapper=function(e){return n.default.createElement("div",{className:i.default("vjs-button","vjs-control","vjs-menu-button-popup")},e.children)}})),define("modules/clean/react/previews/video/audio_waveform/audio_waveform",["require","exports","tslib","classnames","external/lodash","react","react-dom","videojs/video","modules/clean/react/css","modules/clean/react/previews/video/audio_waveform/utils","spectrum/file_icon","spectrum/dimensions","modules/clean/components/loading_indicator"],(function(e,t,a,n,i,r,o,s,l,u,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),i=a.__importStar(i),r=a.__importDefault(r),o=a.__importStar(o),s=a.__importDefault(s),u=a.__importStar(u),t.AUDIO_WAVEFORM="audioWaveform";var m,f=s.default.videojs.getComponent("Component");(function(e){e.Requesting="requesting",e.Failed="failed",e.Loaded="loaded"})(m||(m={}));var h=(function(e){function t(t,a){var n=e.call(this,t,a)||this;return n.setSeekTime=function(e){n.player().currentTime(e)},n.mount=function(){o.render(r.default.createElement(g,{onSeek:n.setSeekTime,duration:n.player().duration(),player:n.player(),bytes:n.bytes,onAudioWaveformLoaded:n.onAudioWaveformLoaded,onAudioWaveformFailed:n.onAudioWaveformFailed,waveformUrl:n.waveformUrl}),n.el())},n.bytes=null==a?void 0:a.bytes,n.onAudioWaveformLoaded=null==a?void 0:a.onAudioWaveformLoaded,n.onAudioWaveformFailed=null==a?void 0:a.onAudioWaveformFailed,n.waveformUrl=null==a?void 0:a.waveformUrl,t&&t.on("loadedmetadata",n.mount),n.addClass("vjs-audio-waveform"),n}return a.__extends(t,e),t.prototype.dispose=function(){o.unmountComponentAtNode(this.el())},t})(f),v=(function(e){function t(t){var a=e.call(this,t)||this;return a.updateWaveformProgress=function(){a.setState({scrubPercentage:a.getProgress()})},a.scrubTime=function(e,t){a.isMouseDown&&a.updateTime(e,t)},a.updateTime=function(e,t){a.updateWaveformScrubToPercentage(t);var n=t*a.props.duration;a.showLoadingIndicatorWhileWaitingForPlayer(),a.props.onSeek(n)},a.showLoadingIndicatorWhileWaitingForPlayer=function(){a.showLoadingIndicator(),a.props.player.one("timeupdate",a.hideLoadingIndicator)},a.showLoadingIndicator=i.debounce((function(){a.setState({showLoadingIndicator:!0})}),10),a.hideLoadingIndicator=function(){a.showLoadingIndicator.cancel(),a.setState({showLoadingIndicator:!1})},a.setMouseDown=function(e,t){a.isMouseDown=!0,a.updateTime(e,t)},a.setMouseUp=function(){a.isMouseDown=!1},a.handleFailedWaveformGeneration=function(){a.setState({waveformLoadState:m.Failed}),a.props.onAudioWaveformFailed&&a.props.onAudioWaveformFailed()},a.handleWaveformLoaded=function(e){a.isRendered&&(a.setState({rawWaveformHeights:e,waveformLoadState:m.Loaded}),a.props.onAudioWaveformLoaded&&a.props.onAudioWaveformLoaded())},a.state={rawWaveformHeights:[],scrubPercentage:0,showLoadingIndicator:!1,waveformLoadState:t.waveformUrl?m.Requesting:m.Failed},a}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.isRendered=!0,this.props.player.on("timeupdate",this.updateWaveformProgress),this.props.waveformUrl?this.sendWaveformRequest():this.setState({waveformLoadState:m.Failed})},t.prototype.componentWillUnmount=function(){this.isRendered=!1,this.showLoadingIndicator.cancel()},t.prototype.getProgress=function(){return this.props.player.currentTime()/(this.props.duration||this.props.player.duration()||1/0)},t.prototype.updateWaveformScrubToPercentage=function(e){this.setState({scrubPercentage:e})},t.prototype.sendWaveformRequest=function(){var e=this,t=new XMLHttpRequest;t.open("GET",this.props.waveformUrl),t.withCredentials=!0,t.onreadystatechange=function(){if(4===t.readyState&&e.isRendered)if(200===t.status){var a=JSON.parse(t.response).waveformHeights;e.handleWaveformLoaded(a)}else e.handleFailedWaveformGeneration()},t.send()},t.prototype.render=function(){return r.default.createElement(y,{height:this.props.windowHeight,isLoaded:this.state.waveformLoadState===m.Loaded,onMouseMove:this.scrubTime,onMouseDown:this.setMouseDown,onMouseUp:this.setMouseUp,scrubPercent:this.state.scrubPercentage,showLoadingIndicator:this.state.showLoadingIndicator,waveformHeights:this.state.rawWaveformHeights,width:this.props.windowWidth})},t})(r.default.Component);t.AudioWaveform=v;var y=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleMouseMove=function(e){t.props.onMouseMove&&t.props.onMouseMove(e,t.getPositionPercentageFromEvent(e))},t.handleMouseDown=function(e){var a=e.nativeEvent;0===a.button&&t.props.onMouseDown&&t.props.onMouseDown(a,t.getPositionPercentageFromEvent(a))},t.handleMouseUp=function(e){t.props.onMouseUp&&t.props.onMouseUp(e,t.getPositionPercentageFromEvent(e))},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.drawWaveform(),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("mousemove",this.handleMouseMove)},t.prototype.componentDidUpdate=function(){this.drawWaveform()},t.prototype.componentWillUnmount=function(){document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("mousemove",this.handleMouseMove)},t.prototype.drawWaveform=function(){var e=this.waveformCanvas;if(e){var t=e.getContext("2d");if(t){var a=this.props,n=a.height,i=a.scrubPercent,r=a.width;if(n&&r){var o=this.generateWaveformHeights(r),s=window.devicePixelRatio||1;e.width=r*s,e.height=n*s,t.scale(s,s),t.globalAlpha=0,t.fillStyle="black",t.fillRect(0,0,r,n),t.globalAlpha=1;var l=i*r,u=0;if(l)for(t.fillStyle="rgba(27, 39, 51, 0.08)",t.fillRect(0,0,l,n),t.fillStyle="#1B2733";u<o.length;u++){var d=4*u,c=(m=o[u])*n,p=(1-m)*n;if(d+2>=l){t.fillRect(d,p,l-d,c),t.globalAlpha=.3,t.fillStyle="#637282",t.fillRect(l,p,d+2-l,c),u++;break}t.fillRect(d,p,2,c)}for(t.globalAlpha=.3,t.fillStyle="#637282";u<o.length;u++){var m=o[u];t.fillRect(4*u,(1-m)*n,2,m*n)}}}}},t.prototype.generateWaveformHeights=function(e){var t=Math.floor((e-2)/4);return u.returnWaveform(this.props.waveformHeights,t,.85)},t.prototype.getPositionPercentageFromEvent=function(e){var t=this.waveformCanvas.getBoundingClientRect();return(e.pageX-t.left)/t.width},t.prototype.render=function(){var e=this,t=this.props,a=t.height,i=t.isLoaded,o=t.width,s=t.showLoadingIndicator;return r.default.createElement("div",{className:n.default({"preview-audio__waveform":!0,"showing-icon":!i}),onMouseDown:this.handleMouseDown},r.default.createElement("canvas",{className:"waveform",ref:function(t){e.waveformCanvas=t},style:{width:o,height:a}}),s?r.default.createElement(p.LoadingIndicator,{style:p.LoadingIndicatorStyle.SPINNER,className:"loading-indicator"}):null,i?null:r.default.createElement(d.FileIcon,{path:".mp3",variant:"large",className:"waveform--hidden"}))},t.defaultProps={scrubPercent:0},t})(r.default.Component),g=l.requireCssWithComponent((function(e){return r.default.createElement(c.Dimensions,{className:"preview-audio__wrapper"},(function(t){var n=t.width,i=t.height;return r.default.createElement(v,a.__assign({},e,{windowHeight:i&&i-51-10,windowWidth:null!=n?n:void 0}))}))}),["/static/css/video/audio_waveform-vflQPrjHt.css"]);s.default.videojs.registerComponent(t.AUDIO_WAVEFORM,h)})),define("modules/clean/react/previews/video/annotation_markers",["require","exports","tslib","external/lodash","react","react-redux","modules/clean/react/comments2/data/selectors","modules/clean/react/previews/video/videojs_portal_component","modules/clean/react/comments2/data/actions"],(function(e,t,a,n,i,r,o,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n);var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){t.props.activateThreadByMarkerClick&&t.props.activateThreadByMarkerClick({thread:t.props.thread})},t.setRef=function(e){t.ref=e},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.ref&&this.ref.addEventListener("click",this.onClick)},t.prototype.componentDidUpdate=function(){this.ref&&this.ref.addEventListener("click",this.onClick)},t.prototype.componentWillUpdate=function(){this.ref&&this.ref.removeEventListener("click",this.onClick)},t.prototype.componentWillUnmount=function(){this.ref&&this.ref.removeEventListener("click",this.onClick)},t.prototype.render=function(){var e=this.props,t=e.thread,a=e.duration,n=t.annotation.time/a;return i.default.createElement("div",{className:"marker-container",key:n,ref:this.setRef,style:{left:n+"%"}},i.default.createElement("div",{className:"marker"}))},t})((i=a.__importDefault(i)).default.PureComponent);t.AnnotationMarker=u;var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.threads,a=e.duration,r=e.activateThreadByMarkerClick,o=void 0===r?function(){}:r,s=n.uniqBy(t,"annotation.time");return i.default.createElement("div",null,s.map((function(e){return i.default.createElement(u,{thread:e,key:e.id,duration:a,activateThreadByMarkerClick:o})})))},t})(i.default.PureComponent);t.AnnotationMarkersImpl=d;var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.activateThreadByMarkerClick,a=e.threads,n=e.duration,r=e.player;return i.default.createElement(s.VideojsPortal,{childName:"markers",player:r},i.default.createElement(d,{activateThreadByMarkerClick:t,threads:a,duration:n}))},t})(i.default.PureComponent);t.AnnotationMarkersPortal=c,t.AnnotationMarkers=r.connect((function(e){return{threads:o.getUnresolvedTimecodeThreads(e)}}),{activateThreadByMarkerClick:l.Actions.activateThreadByMarkerClick})(c)})),define("modules/clean/react/previews/video/comments2_onboarding",["require","exports","tslib","react","videojs/video","modules/clean/acf/components/sprite","react-redux","modules/clean/react/comments2/data/actions","modules/clean/react/comments2/data/logger","modules/clean/react/comments2/data/selectors","modules/clean/react/comments2/data/selectors","modules/clean/react/comments2/video_annotations/annotation_helper","modules/core/i18n"],(function(e,t,a,n,i,r,o,s,l,u,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),i=a.__importDefault(i),l=a.__importStar(l),u=a.__importStar(u);var m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.titleText,a=e.bodyText,i=e.dismiss;return n.default.createElement("div",null,n.default.createElement("h4",null,n.default.createElement("span",{className:"title-elt"},t),n.default.createElement(r.Sprite,{group:"web",name:"xclose_light_gray",alt:"",hoverName:"xclose",onClick:i})),n.default.createElement("div",{className:"body-elt"},a))},t.prototype.componentDidMount=function(){l.logEvent("video_onboarding_shown",{stream:this.props.stream})},t})(n.default.Component);var f=o.connect((function(e){var t=d.getPlayerCurrentTime(e),a={time_code:i.default.videojs.formatTime(c.VideoAnnotationHelper.unitConvertDomainObjectTimeToSeconds(t))};return{titleText:p.intl.formatMessage({id:"fY9HQk",defaultMessage:"Want to comment on {time_code}?"},a),bodyText:p.intl.formatMessage({id:"nYf519",defaultMessage:"Leave feedback on this moment with a time-coded comment."}),stream:u.getStream(e)}}),{dismiss:function(){return s.Actions.markOnboarded("premium_av_preview_surface")}})(m);t.OnboardingMessage=f})),define("modules/clean/react/previews/video/videojs_portal_component",["require","exports","tslib","react-dom","react","videojs/video","modules/clean/react/portal"],(function(e,t,a,n,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n),i=a.__importDefault(i),r=a.__importDefault(r),t.VJS_PORTAL="vjsPortal";var s=r.default.videojs.getComponent("Component"),l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{},this.options_.elementAttrs)},t.prototype.dispose=function(){n.unmountComponentAtNode(this.el())},t})(s);r.default.videojs.registerComponent(t.VJS_PORTAL,l);var u=(function(e){function t(t){var a=e.call(this,t)||this;return a.state={},a}return a.__extends(t,e),t.prototype.findComponent=function(){var e,t=void 0,a=(e=this.props.childName).charAt(0).toUpperCase()+e.slice(1);if(!this.props.player)return t;for(var n=[this.props.player];0!==n.length;){var i=n.shift();if(i){if(i.name()===a){t=i;break}var r=i.children();r&&r.forEach((function(e){e instanceof s&&n.push(e)}))}}return t},t.prototype.updatePortalDestination=function(){var e=this.findComponent();e&&e.contentEl()!==this.state.portalTo&&this.setState({portalTo:e.contentEl()})},t.prototype.componentDidMount=function(){this.updatePortalDestination()},t.prototype.componentDidUpdate=function(){this.updatePortalDestination()},t.prototype.render=function(){return this.state.portalTo?i.default.createElement(o.Portal,{parentElement:this.state.portalTo},this.props.children):null},t})(i.default.Component);t.VideojsPortal=u})),define("spectrum/icon_media",["require","exports","tslib","react","spectrum/icon_templates/stateless","spectrum/svg_icon_bundle","spectrum/icon_media/bundle"],(function(e,t,a,n,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n),t.ICONS=o.ICONS,t.IconMedia=function(e){var t=e.name,a=n.createElement(r.SvgIconBundle,{focusable:"false",icon:o.ICONS[t]});return n.createElement(i.Component,Object.assign({icon:a},e))},t.IconMedia.displayName="IconMedia"})),define("spectrum/icon_media/bundle",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICONS=JSON.parse('\n    {"fullscreen-exit":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#637282\\"><path d=\\"M10.749 12.754L7.853 9.85a.5.5 0 0 1 0-.707l1.29-1.29h.001a.5.5 0 0 1 .707 0l2.899 2.902 1.397-1.394a.5.5 0 0 1 .853.354v5.289H9.702a.5.5 0 0 1-.353-.854l1.4-1.397zM21.251 19.249l2.898 2.897a.5.5 0 0 1 0 .708l-1.29 1.29a.5.5 0 0 1-.708 0l-2.897-2.898-1.4 1.4a.5.5 0 0 1-.854-.353V17h5.293a.5.5 0 0 1 .353.854l-1.395 1.395z\\"></path></g></g>"},"fullscreen":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#637282\\"><path d=\\"M19.752 21.749l-2.896-2.903a.5.5 0 0 1 0-.707l1.291-1.29a.5.5 0 0 1 .708 0l2.898 2.902 1.397-1.394a.5.5 0 0 1 .853.354V24h-5.297a.5.5 0 0 1-.353-.854l1.4-1.397zM12.251 10.249l2.898 2.897a.5.5 0 0 1 0 .708l-1.29 1.29a.5.5 0 0 1-.708 0l-2.897-2.898-1.4 1.4A.5.5 0 0 1 8 13.293V8h5.293a.5.5 0 0 1 .353.854l-1.395 1.395z\\"></path></g></g>"},"gear":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<defs><path d=\\"M3.898 12.646a6.248 6.248 0 0 1-.697-.901l-2.327-.359A8.165 8.165 0 0 1 .243 8.91L2.26 7.494c.05-.388.134-.764.248-1.126L1.25 4.123a8.154 8.154 0 0 1 1.503-1.928l2.391.765a5.948 5.948 0 0 1 1.008-.502L7.048.09a8.002 8.002 0 0 1 2.431.007l.895 2.362c.352.136.69.304 1.007.502l2.36-.755a8.154 8.154 0 0 1 1.513 1.956l-1.239 2.207c.115.362.199.738.248 1.126l1.98 1.389c-.08.885-.3 1.73-.637 2.51l-2.283.352a6.248 6.248 0 0 1-.696.9l.162 2.197a7.953 7.953 0 0 1-2.456 1.15l-1.512-1.454a5.939 5.939 0 0 1-1.117 0L6.182 16a7.95 7.95 0 0 1-2.448-1.13l.164-2.224zm4.364-1.025c1.902 0 3.444-1.56 3.444-3.486 0-1.926-1.542-3.487-3.444-3.487-1.901 0-3.443 1.561-3.443 3.487 0 1.925 1.542 3.486 3.443 3.486z\\" id=\\"mc-media-gear-a\\"></path></defs><g fill=\\"none\\" fill-rule=\\"evenodd\\"><use fill=\\"#637282\\" xlink:href=\\"#mc-media-gear-a\\" transform=\\"rotate(45 2.243 21.9)\\"></use></g>"},"hd-tag":{"attrs":{"width":"18","height":"18","viewBox":"0 0 18 11"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><path d=\\"M0 0h18v11H0z\\"></path><path d=\\"M2 0h14a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm2.394 6.218H6.73V9h1.784V2H6.73v2.837H4.394V2H2.558v7h1.836V6.218zM9.838 9h2.364c2.099 0 3.52-1.217 3.52-3.587 0-2.352-1.403-3.413-3.52-3.413H9.838v7zm1.703-1.345V3.327h.588c1.005 0 1.647.521 1.647 2.123 0 1.683-.642 2.205-1.692 2.205h-.543z\\" fill=\\"#637282\\" fill-rule=\\"nonzero\\"></path></g>"},"pause":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><path d=\\"M11 9h2a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1zm8 0h2a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z\\" fill=\\"#637282\\"></path></g>"},"play":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><path d=\\"M12.524 8.938l10.092 6.21a1 1 0 0 1 0 1.704l-10.092 6.21A1 1 0 0 1 11 22.21V9.79a1 1 0 0 1 1.524-.852z\\" fill=\\"#637282\\"></path></g>"},"speed-100":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><text transform=\\"translate(8 8)\\" fill=\\"#637282\\" font-family=\\"SFUIText-Bold, SF UI Text\\" font-size=\\"12\\" font-weight=\\"bold\\" letter-spacing=\\"-.353\\"><tspan x=\\"2.288\\" y=\\"12\\">1x</tspan></text></g>"},"speed-125":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><text transform=\\"translate(1 8)\\" fill=\\"#637282\\" font-family=\\"SFUIText-Bold, SF UI Text\\" font-size=\\"12\\" font-weight=\\"bold\\" letter-spacing=\\"-.353\\"><tspan x=\\".123\\" y=\\"12\\">1.25x</tspan></text></g>"},"speed-150":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><text transform=\\"translate(4 8)\\" fill=\\"#637282\\" font-family=\\"SFUIText-Bold, SF UI Text\\" font-size=\\"12\\" font-weight=\\"bold\\" letter-spacing=\\"-.353\\"><tspan x=\\".469\\" y=\\"12\\">1.5x</tspan></text></g>"},"speed-200":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><text transform=\\"translate(8 8)\\" fill=\\"#637282\\" font-family=\\"SFUIText-Bold, SF UI Text\\" font-size=\\"12\\" font-weight=\\"bold\\" letter-spacing=\\"-.353\\"><tspan x=\\"1.005\\" y=\\"12\\">2x</tspan></text></g>"},"speed-400":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><text transform=\\"translate(8 8)\\" fill=\\"#637282\\" font-family=\\"SFUIText-Bold, SF UI Text\\" font-size=\\"12\\" font-weight=\\"bold\\" letter-spacing=\\"-.353\\"><tspan x=\\"1.25\\" y=\\"12\\">4x</tspan></text></g>"},"speed-50":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><text transform=\\"translate(4 9)\\" fill=\\"#637282\\" font-family=\\"SFUIText-Bold, SF UI Text\\" font-size=\\"12\\" font-weight=\\"bold\\" letter-spacing=\\"-.353\\"><tspan x=\\".116\\" y=\\"11\\">0.5x</tspan></text></g>"},"volume-muted":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><path d=\\"M10 12l3.293-3.293A1 1 0 0 1 15 9.414v13.172a1 1 0 0 1-1.707.707L10 20H6a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h4z\\" fill=\\"#637282\\"></path><path d=\\"M20.5 16l3.003-3-3.002 3-3.001-3 3 3zm0 0l3 3-3-3-3 3 3-3z\\" stroke=\\"#637282\\" stroke-width=\\"2\\"></path></g>"},"volume":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#637282\\"><path d=\\"M18.682 13.318A4.486 4.486 0 0 1 20 16.5c0 1.277-.532 2.43-1.386 3.249l-1.357-1.47A2.492 2.492 0 0 0 18 16.5c0-.69-.28-1.315-.732-1.768l1.414-1.414zM21.51 10.49A8.473 8.473 0 0 1 24 16.5a8.476 8.476 0 0 1-2.673 6.188l-1.356-1.47A6.482 6.482 0 0 0 22 16.5a6.48 6.48 0 0 0-1.904-4.596l1.414-1.414z\\" fill-rule=\\"nonzero\\"></path><path d=\\"M24.339 7.661A12.46 12.46 0 0 1 28 16.5c0 3.601-1.523 6.846-3.96 9.127l-1.356-1.47A10.471 10.471 0 0 0 26 16.5c0-2.9-1.175-5.524-3.075-7.425l1.414-1.414z\\" fill-rule=\\"nonzero\\"></path><path d=\\"M10 12l3.293-3.293A1 1 0 0 1 15 9.414v13.172a1 1 0 0 1-1.707.707L10 20H6a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h4z\\"></path></g></g>"}}\n  ')})),define("prod_assets_web_modules/m3u8-parser",["exports"],(function(e){"use strict";var t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},n=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},r=(function(){function e(){t(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var a=this.listeners[e].indexOf(t);return this.listeners[e].splice(a,1),a>-1},e.prototype.trigger=function(e){var t=this.listeners[e],a=void 0,n=void 0,i=void 0;if(t)if(2===arguments.length)for(n=t.length,a=0;a<n;++a)t[a].call(this,arguments[1]);else for(i=Array.prototype.slice.call(arguments,1),n=t.length,a=0;a<n;++a)t[a].apply(this,i)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e})(),o=(function(e){function a(){t(this,a);var n=i(this,e.call(this));return n.buffer="",n}return n(a,e),a.prototype.push=function(e){var t=void 0;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},a})(r),s=function(e){for(var t=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),a={},n=t.length,i=void 0;n--;)""!==t[n]&&((i=/([^=]*)=(.*)/.exec(t[n]).slice(1))[0]=i[0].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^['"](.*)['"]$/g,"$1"),a[i[0]]=i[1]);return a},l=(function(e){function a(){t(this,a);var n=i(this,e.call(this));return n.customParsers=[],n}return n(a,e),a.prototype.push=function(e){var t=void 0,a=void 0;if(0!==(e=e.replace(/^[\u0000\s]+|[\u0000\s]+$/g,"")).length)if("#"===e[0]){for(var n=0;n<this.customParsers.length;n++)if(this.customParsers[n].call(this,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))this.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return a={type:"tag",tagType:"inf"},t[1]&&(a.duration=parseFloat(t[1])),t[2]&&(a.title=t[2]),void this.trigger("data",a);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return a={type:"tag",tagType:"targetduration"},t[1]&&(a.duration=parseInt(t[1],10)),void this.trigger("data",a);if(t=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return a={type:"tag",tagType:"totalduration"},t[1]&&(a.duration=parseInt(t[1],10)),void this.trigger("data",a);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return a={type:"tag",tagType:"version"},t[1]&&(a.version=parseInt(t[1],10)),void this.trigger("data",a);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return a={type:"tag",tagType:"media-sequence"},t[1]&&(a.number=parseInt(t[1],10)),void this.trigger("data",a);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return a={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(a.number=parseInt(t[1],10)),void this.trigger("data",a);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return a={type:"tag",tagType:"playlist-type"},t[1]&&(a.playlistType=t[1]),void this.trigger("data",a);if(t=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return a={type:"tag",tagType:"byterange"},t[1]&&(a.length=parseInt(t[1],10)),t[2]&&(a.offset=parseInt(t[2],10)),void this.trigger("data",a);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return a={type:"tag",tagType:"allow-cache"},t[1]&&(a.allowed=!/NO/.test(t[1])),void this.trigger("data",a);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(a={type:"tag",tagType:"map"},t[1]){var i=s(t[1]);if(i.URI&&(a.uri=i.URI),i.BYTERANGE){var r=i.BYTERANGE.split("@"),o=r[0],l=r[1];a.byterange={},o&&(a.byterange.length=parseInt(o,10)),l&&(a.byterange.offset=parseInt(l,10))}}this.trigger("data",a)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(a={type:"tag",tagType:"stream-inf"},t[1]){if(a.attributes=s(t[1]),a.attributes.RESOLUTION){var u=a.attributes.RESOLUTION.split("x"),d={};u[0]&&(d.width=parseInt(u[0],10)),u[1]&&(d.height=parseInt(u[1],10)),a.attributes.RESOLUTION=d}a.attributes.BANDWIDTH&&(a.attributes.BANDWIDTH=parseInt(a.attributes.BANDWIDTH,10)),a.attributes["PROGRAM-ID"]&&(a.attributes["PROGRAM-ID"]=parseInt(a.attributes["PROGRAM-ID"],10))}this.trigger("data",a)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return a={type:"tag",tagType:"media"},t[1]&&(a.attributes=s(t[1])),void this.trigger("data",a);if(t=/^#EXT-X-ENDLIST/.exec(e))this.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))this.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return a={type:"tag",tagType:"program-date-time"},t[1]&&(a.dateTimeString=t[1],a.dateTimeObject=new Date(t[1])),void this.trigger("data",a);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e))return a={type:"tag",tagType:"key"},t[1]&&(a.attributes=s(t[1]),a.attributes.IV&&("0x"===a.attributes.IV.substring(0,2).toLowerCase()&&(a.attributes.IV=a.attributes.IV.substring(2)),a.attributes.IV=a.attributes.IV.match(/.{8}/g),a.attributes.IV[0]=parseInt(a.attributes.IV[0],16),a.attributes.IV[1]=parseInt(a.attributes.IV[1],16),a.attributes.IV[2]=parseInt(a.attributes.IV[2],16),a.attributes.IV[3]=parseInt(a.attributes.IV[3],16),a.attributes.IV=new Uint32Array(a.attributes.IV))),void this.trigger("data",a);if(t=/^#EXT-X-START:?(.*)$/.exec(e))return a={type:"tag",tagType:"start"},t[1]&&(a.attributes=s(t[1]),a.attributes["TIME-OFFSET"]=parseFloat(a.attributes["TIME-OFFSET"]),a.attributes.PRECISE=/YES/.test(a.attributes.PRECISE)),void this.trigger("data",a);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return a={type:"tag",tagType:"cue-out-cont"},t[1]?a.data=t[1]:a.data="",void this.trigger("data",a);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return a={type:"tag",tagType:"cue-out"},t[1]?a.data=t[1]:a.data="",void this.trigger("data",a);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return a={type:"tag",tagType:"cue-in"},t[1]?a.data=t[1]:a.data="",void this.trigger("data",a);this.trigger("data",{type:"tag",data:e.slice(4)})}}}else this.trigger("data",{type:"comment",text:e.slice(1)})}else this.trigger("data",{type:"uri",uri:e})},a.prototype.addParser=function(e){var t=this,a=e.expression,n=e.customType,i=e.dataParser,r=e.segment;"function"!=typeof i&&(i=function(e){return e}),this.customParsers.push((function(e){if(a.exec(e))return t.trigger("data",{type:"custom",data:i(e),customType:n,segment:r}),!0}))},a})(r),u=(function(e){function r(){t(this,r);var n=i(this,e.call(this));n.lineStream=new o,n.parseStream=new l,n.lineStream.pipe(n.parseStream);var s=n,u=[],d={},c=void 0,p=void 0,m=function(){},f={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},h=0;return n.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},n.parseStream.on("data",(function(e){var t=void 0,n=void 0;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&(d.byterange=t,t.length=e.length,"offset"in e||(this.trigger("info",{message:"defaulting offset to zero"}),e.offset=0)),"offset"in e&&(d.byterange=t,t.offset=e.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.duration>0&&(d.duration=e.duration),0===e.duration&&(d.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=u},key:function(){e.attributes?"NONE"!==e.attributes.METHOD?e.attributes.URI?(e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),p={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},void 0!==e.attributes.IV&&(p.iv=e.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):p=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,h=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){c={},e.uri&&(c.uri=e.uri),e.byterange&&(c.byterange=e.byterange)},"stream-inf":function(){this.manifest.playlists=u,this.manifest.mediaGroups=this.manifest.mediaGroups||f,e.attributes?(d.attributes||(d.attributes={}),a(d.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||f,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var a=this.manifest.mediaGroups[e.attributes.TYPE];a[e.attributes["GROUP-ID"]]=a[e.attributes["GROUP-ID"]]||{},t=a[e.attributes["GROUP-ID"]],(n={default:/yes/i.test(e.attributes.DEFAULT)}).default?n.autoselect=!0:n.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(n.language=e.attributes.LANGUAGE),e.attributes.URI&&(n.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(n.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(n.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(n.forced=/yes/i.test(e.attributes.FORCED)),t[e.attributes.NAME]=n}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){h+=1,d.discontinuity=!0,this.manifest.discontinuityStarts.push(u.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),d.dateTimeString=e.dateTimeString,d.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):this.manifest.targetDuration=e.duration},totalduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration}):this.manifest.totalDuration=e.duration},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){d.cueOut=e.data},"cue-out-cont":function(){d.cueOutCont=e.data},"cue-in":function(){d.cueIn=e.data}}[e.tagType]||m).call(s)},uri:function(){d.uri=e.uri,u.push(d),this.manifest.targetDuration&&!("duration"in d)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),d.duration=this.manifest.targetDuration),p&&(d.key=p),d.timeline=h,c&&(d.map=c),d={}},comment:function(){},custom:function(){e.segment?(d.custom=d.custom||{},d.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(s)})),n}return n(r,e),r.prototype.push=function(e){this.lineStream.push(e)},r.prototype.end=function(){this.lineStream.push("\n")},r.prototype.addParser=function(e){this.parseStream.addParser(e)},r})(r);e.LineStream=o,e.ParseStream=l,e.Parser=u,Object.defineProperty(e,"__esModule",{value:!0})})),define("prod_assets_web_modules/react-onclickoutside",["exports","react","react-dom"],(function(e,t,a){"use strict";function n(e,t,a){return e===t||(e.correspondingElement?e.correspondingElement.classList.contains(a):e.classList.contains(a))}var i,r,o=(void 0===i&&(i=0),function(){return++i}),s={},l={},u=["touchstart","touchmove"];function d(e,t){var a=null;return-1!==u.indexOf(t)&&r&&(a={passive:!e.props.preventDefault}),a}e.IGNORE_CLASS_NAME="ignore-react-onclickoutside",e.default=function(e,i){var u,c;return c=u=(function(u){var c,p;function m(e){var t;return(t=u.call(this,e)||this).__outsideClickHandler=function(e){if("function"!=typeof t.__clickOutsideHandlerProp){var a=t.getInstance();if("function"!=typeof a.props.handleClickOutside){if("function"!=typeof a.handleClickOutside)throw new Error("WrappedComponent lacks a handleClickOutside(event) function for processing outside click events.");a.handleClickOutside(e)}else a.props.handleClickOutside(e)}else t.__clickOutsideHandlerProp(e)},t.enableOnClickOutside=function(){if("undefined"!=typeof document&&!l[t._uid]){void 0===r&&(r=(function(){if("undefined"!=typeof window&&"function"==typeof window.addEventListener){var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}}),a=function(){};return window.addEventListener("testPassiveEventSupport",a,t),window.removeEventListener("testPassiveEventSupport",a,t),e}})()),l[t._uid]=!0;var e=t.props.eventTypes;e.forEach||(e=[e]),s[t._uid]=function(e){var a;t.props.disableOnClickOutside||null!==t.componentNode&&(t.props.preventDefault&&e.preventDefault(),t.props.stopPropagation&&e.stopPropagation(),t.props.excludeScrollbar&&(a=e,document.documentElement.clientWidth<=a.clientX||document.documentElement.clientHeight<=a.clientY)||(function(e,t,a){if(e===t)return!0;for(;e.parentNode;){if(n(e,t,a))return!0;e=e.parentNode}return e})(e.target,t.componentNode,t.props.outsideClickIgnoreClass)===document&&t.__outsideClickHandler(e))},e.forEach((function(e){document.addEventListener(e,s[t._uid],d(t,e))}))}},t.disableOnClickOutside=function(){delete l[t._uid];var e=s[t._uid];if(e&&"undefined"!=typeof document){var a=t.props.eventTypes;a.forEach||(a=[a]),a.forEach((function(a){return document.removeEventListener(a,e,d(t,a))})),delete s[t._uid]}},t.getRef=function(e){return t.instanceRef=e},t._uid=o(),t}p=u,(c=m).prototype=Object.create(p.prototype),c.prototype.constructor=c,c.__proto__=p;var f=m.prototype;return f.getInstance=function(){if(!e.prototype.isReactComponent)return this;var t=this.instanceRef;return t.getInstance?t.getInstance():t},f.componentDidMount=function(){if("undefined"!=typeof document&&document.createElement){var e=this.getInstance();if(i&&"function"==typeof i.handleClickOutside&&(this.__clickOutsideHandlerProp=i.handleClickOutside(e),"function"!=typeof this.__clickOutsideHandlerProp))throw new Error("WrappedComponent lacks a function for processing outside click events specified by the handleClickOutside config option.");this.componentNode=a.findDOMNode(this.getInstance()),this.enableOnClickOutside()}},f.componentDidUpdate=function(){this.componentNode=a.findDOMNode(this.getInstance())},f.componentWillUnmount=function(){this.disableOnClickOutside()},f.render=function(){var a=this.props,n=(a.excludeScrollbar,(function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i})(a,["excludeScrollbar"]));return e.prototype.isReactComponent?n.ref=this.getRef:n.wrappedRef=this.getRef,n.disableOnClickOutside=this.disableOnClickOutside,n.enableOnClickOutside=this.enableOnClickOutside,t.createElement(e,n)},m})(t.Component),u.displayName="OnClickOutside("+(e.displayName||e.name||"Component")+")",u.defaultProps={eventTypes:["mousedown","touchstart"],excludeScrollbar:i&&i.excludeScrollbar||!1,outsideClickIgnoreClass:"ignore-react-onclickoutside",preventDefault:!1,stopPropagation:!1},u.getClass=function(){return e.getClass?e.getClass():e},c},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=pkg-file_viewer_video.min.js-vfl-YKStz.map