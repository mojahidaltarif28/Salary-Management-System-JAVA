define(["require","exports","tslib","rondo/v1/index","rondo-forms/v1/types","rondo-forms/v1/utils","rondo-saga/v1"],(function(t,e,n,r,s,i,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WizardBehavior=function(t){var e=t.steps,c=t.firstStep,o=t.nextAction,u=t.nextAsyncAction,p=t.previousAction;return(function(){function t(){this.initialState=function(){return r.invariant(Object.keys(e).indexOf(c)>=0,"First step is not part of the wizard steps"),{firstStep:c,currentStep:c||Object.keys(e)[0],totalSteps:Object.keys(e).length,steps:e}},this.run=r.createSaga((function(){var t,e,r,s,i,o;return n.__generator(this,(function(n){switch(n.label){case 0:t=[],n.label=1;case 1:return[4,a.race({next:a.take([this.actionNext]),nextAsync:a.take([this.actionNextAsync]),previous:a.take([this.actionPrevious])})];case 2:return e=n.sent(),r=e.next,s=e.nextAsync,i=e.previous,r||s?[4,this.moveNext((r||s).payload,!!s)]:[3,4];case 3:return(o=n.sent())&&o!==this.getState().currentStep&&t.push(o),[3,6];case 4:return i?[4,a.put(this.actionSetCurrentStep)(t.length>0?t.pop():c)]:[3,6];case 5:n.sent(),n.label=6;case 6:return[3,1];case 7:return[2]}}))})),this.actionNext=r.createOrUseIn(this,o),this.actionPrevious=r.createOrUseIn(this,p),this.actionNextAsync=r.createOrUseIn(this,u),this.actionSetCurrentStep=r.createAction().handle((function(t,e){var n=t.steps;return r.invariant(n.hasOwnProperty(e),e+" is not in wizard steps: "+n),{currentStep:e}})),this.currentStepInfo=r.createSelector((function(t){return t.steps[t.currentStep]})),this.stepValidInfo=r.createSelector(n.__spread([this.currentStepInfo],Object.keys(e).reduce((function(t,n){return e[n].validator?t.concat(e[n].validator):t}),[])),(function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.validator?t.validator():s.ValidInfoValid})),this.stepValid=r.createSelector(this.stepValidInfo,(function(t){return t.valid})),this.isFinal=r.createSelector(this.currentStepInfo,(function(t){return t.isFinal}))}return t.prototype.moveNext=function(t,s){var c,o,u,p,l,h,f;return void 0===s&&(s=!1),n.__generator(this,(function(n){switch(n.label){case 0:return[4,a.select(this)];case 1:if(c=n.sent(),o=c.currentStep,u=e[o],p=u.validator,!t&&!u.next&&(!s||s&&!u.nextAsync))return[2,o];if(l=void 0,p){if(!p().valid)return[2];l=t||(s?u.nextAsync:u.next)}else l=t||!u.next&&!s?t:s?u.nextAsync:u.next;return"string"!=typeof l?[3,3]:[4,a.put(this.actionSetCurrentStep)(l)];case 2:return n.sent(),[3,11];case 3:return"function"!=typeof l||r.isActionCreator(l)?[3,9]:(h=l(c),i.isPromise(h)?[4,h]:[3,6]);case 4:return f=n.sent(),[4,a.put(this.actionSetCurrentStep)(f)];case 5:return n.sent(),[3,8];case 6:return[4,a.put(this.actionSetCurrentStep)(h)];case 7:n.sent(),n.label=8;case 8:return[3,11];case 9:return r.isActionCreator(l)?[4,a.put(l)()]:[3,11];case 10:n.sent(),n.label=11;case 11:return[2,o]}}))},t.displayName="Wizard",t})()}}));
//# sourceMappingURL=wizard_behavior.min.js-vflbaEmuq.map