define(["require","exports","tslib","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/snackbar","dig-components/tooltips","file-transfers/common/helpers","modules/clean/growth/smb_funnel/smb_funnel_logger","modules/clean/react/css","modules/clean/react/admin/teams/onboarding/web/constants","modules/clean/react/admin/teams/onboarding/web/util/invite_common","modules/core/exception","modules/core/i18n"],(function(e,t,n,i,s,o,r,a,c,u,l,d,h,p,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i);var b=(function(e){function t(t){var s=e.call(this,t)||this;return s.buttonRef=i.default.createRef(),s.copyLink=function(e){try{u.copyToClipboard(e),s.showMessage(m.intl.formatMessage({id:"5rX/EF",defaultMessage:"Link copied!"})),s.props.onLinkCopied&&s.props.onLinkCopied()}catch(e){s.showMessage(m.intl.formatMessage({id:"fodvBV",defaultMessage:"Failed to copy invite link."})),f.reportStack("Copy to clipboard failed: "+e,{tags:["activation-smb","smb-funnel","MobileWebInvites"]})}},s.createInviteLink=function(){return n.__awaiter(s,void 0,Promise,(function(){var e,t,i,s,o,r,a;return n.__generator(this,(function(n){switch(n.label){case 0:e=this.props,t=e.userId,i=e.linkExpiration,s=void 0===i?2592e3:i,o={source:"invite_link_button"},n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,p.createInviteLink(t,s)];case 2:return r=n.sent().invite_link_url,o.success="true",[2,r];case 3:throw a=n.sent(),o.success="false",o.error=null==a?void 0:a.error[".tag"],a;case 4:return l.SMBFunnelLogger.log(h.AMPMetrics.ACTIVATION_INVITE_LINK_CREATE,o),[7];case 5:return[2]}}))}))},s.handleClick=function(){return n.__awaiter(s,void 0,void 0,(function(){var e,t,i,s,o,r,a,c,u=this;return n.__generator(this,(function(n){switch(n.label){case 0:e=this.props,t=e.onClick,i=void 0===t?function(){}:t,s=e.onShareAction,o=void 0===s?function(){}:s,r=e.onShareDismiss,a=void 0===r?function(){}:r,i(),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.createInviteLinkPromise];case 2:return c=n.sent(),void 0!==navigator.share?navigator.share({url:c}).then((function(){return o()})).catch((function(e){"AbortError"!==e.name?u.copyLink(c):a()})):this.copyLink(c),[3,4];case 3:return n.sent(),this.showMessage(m.intl.formatMessage({id:"0zm/8C",defaultMessage:"Failed to create invite link."})),[3,4];case 4:return[2]}}))}))},s.hideMessage=function(){s.setState({message:"",showSnackbar:!1,showTooltip:!1})},s.showMessage=function(e){void 0===e&&(e=""),e&&s.setState({message:e,showSnackbar:s.useSnackbar,showTooltip:s.useTooltip})},s.state={message:"",showSnackbar:!1,showTooltip:!1},s}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.createInviteLinkPromise=this.createInviteLink(),this.useTooltip&&this.buttonRef.current&&(this.buttonRef.current.addEventListener("mouseleave",this.hideMessage),this.buttonRef.current.addEventListener("blur",this.hideMessage))},t.prototype.componentWillUnmount=function(){this.useTooltip&&this.buttonRef.current&&(this.buttonRef.current.removeEventListener("mouseleave",this.hideMessage),this.buttonRef.current.removeEventListener("blur",this.hideMessage))},t.prototype.render=function(){var e=this.props,t=e.buttonClass,n=void 0===t?"":t,u=e.children,l=this.state,d=l.message,h=l.showTooltip,p=l.showSnackbar;return i.default.createElement("div",{className:"invite-link-btn"},i.default.createElement(s.Button,{className:n,variant:"outline",size:"large",onClick:this.handleClick,ref:this.buttonRef},i.default.createElement(o.UIIcon,{src:r.LinkLine}),u||m.intl.formatMessage({id:"dev6I3",defaultMessage:"Share invite link"})),this.useSnackbar&&i.default.createElement(a.Snackbar,{className:"invite-link-btn__snackbar",open:p,onRequestClose:this.hideMessage},i.default.createElement(a.Snackbar.Message,null,d)),this.useTooltip&&i.default.createElement(c.Tooltip.Control,{triggerRef:this.buttonRef,open:h,auto:!0,placement:"top"},d))},Object.defineProperty(t.prototype,"useTooltip",{get:function(){return"tooltip"===this.props.notifyWith},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useSnackbar",{get:function(){return"snackbar"===this.props.notifyWith},enumerable:!0,configurable:!0}),t})(i.default.Component);t.InviteLinkButtonView=b,t.InviteLinkButton=d.requireCssWithComponent(b,["/static/css/admin/teams/essential_setup/invite_link_button-vflo9hqDl.css"])}));
//# sourceMappingURL=invite_link_button.min.js-vflWul-ys.map