define(["require","exports","tslib","prop-types","react","spectrum-sharing/utils/sharing_constants","modules/clean/auth/login_or_register/types","modules/clean/cloud_docs/types","modules/clean/react/file_viewer/file_viewer","modules/clean/react/file_viewer/sdk_file_viewer/async_file_viewer","modules/clean/react/file_viewer/sdk_file_viewer/utils","modules/clean/open_in_app/actions","modules/clean/sharing/async_share_modal_util","modules/clean/viewer","modules/clean/react/file_viewer/data/store","modules/clean/web_timing_logger","modules/clean/react/extensions/data/store","modules/clean/integrations/zoom_share_dialog/async_modal","modules/constants/file_viewer","file-viewer/public/support","modules/clean/previews/util"],(function(e,i,n,t,o,r,s,a,l,d,u,p,c,h,_,f,m,g,w,v,I){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),t=n.__importDefault(t);var y=(function(i){function y(e){var n=i.call(this,e)||this,t=h.Viewer.get_viewer(),o=e.userId?t.get_user_by_id(e.userId):t.work_user||t.personal_user;n.state={user:o},f.log_js_modules_application_code_start();var r=e.file,s=_.getStoreForFileViewer();return _.hydrateFileViewerNamespace(s,{file:r},o),o&&m.initializeStore(o,[r]),n}return n.__extends(y,i),y.prototype.componentDidMount=function(){var i,t=this,r=this.props,l=r.shareEmail,d=r.shareModalVariant,u=r.sharedLinkInfo,h=r.file;if(l||d&&d!==a.ShareModalVariant.closed&&this.state.user)new Promise((function(i,n){e(["modules/clean/react/browse/models"],i,n)})).then(n.__importStar).then((function(e){var i=e.File,n=l?l.split(","):[];c.asyncShowPrefilledShareModal({user:t.state.user,sharePrefillEmails:n,content:new i(t.props.file)})}));else if(this.props.authModalKind!==s.LoginOrRegisterKind.IMMEDIATE||this.state.user)this.props.presentInZoom&&this.state.user&&g.asyncShowModal(this.state.user.id,h.file_id,"file-viewer-modal-overlay","desktop");else{i=this.props.encryptionOptions,n.__awaiter(t,void 0,void 0,(function(){var t,r,a;return n.__generator(this,(function(l){switch(l.label){case 0:return[4,Promise.all([new Promise((function(i,n){e(["modules/clean/react/modal"],i,n)})).then(n.__importStar),new Promise((function(i,n){e(["modules/clean/auth/login_or_register/modal"],i,n)})).then(n.__importStar)])];case 1:return t=l.sent(),r=t[0].Modal,a=t[1].LoginOrRegisterModal,r.showInstance(o.default.createElement(a,{downloadAction:null,id:"shared-link-immediate-signup-modal",initialMode:s.Mode.REGISTER,kind:s.LoginOrRegisterKind.IMMEDIATE,onAuthenticateSuccess:function(){},onCancel:function(){},signup_tag:"shmodel_modal_register",showGoogleRegistration:!0,googleRegisterProps:u?{signupContinuationUrl:u.url}:void 0,encryptionOptions:i})),[2]}}))}))}if(this.props.openImmediatelyInApp){var _=this.props.file;p.openImmediately(_.open_in_app_data)}},y.prototype.shouldUseSDKToRender=function(e,i){var n=this.props.sharedLinkInfo,t=n&&!n.hasPublicAudienceOrVisibility&&i.linkType===r.SharedLinkType.Content;return Boolean(t&&v.isPreviewTypeSupported(e.preview,u.INBAND_SUPPORTED_TYPES)&&!I.isCloudDocPreview(e))},y.prototype.isInbandExperimentEnabled=function(){return w.INBAND_FVSDK_LINKS},y.prototype.isBrandingInfoDefined=function(){var e=this.props.brandingInfo;return e&&Object.keys(e).some((function(i){return!!e[i]}))},y.prototype.render=function(){var e=this.props,i=e.file,t=e.fileViewerProps,r=e.onCloseUrl,s=e.isEmbedded,a=e.brandingInfo,u=e.encryptionOptions,p=e.openInHelloSign,c=e.openInHelloSignSrc,h=e.sharedLinkInfo,_=e.shareToken,f=e.sharePermission,m=e.LoggedOutUXGoogleVariant,g=e.authModalKind,w=this.state.user,v=w&&h&&_&&!this.isBrandingInfoDefined()&&this.shouldUseSDKToRender(i,_),I=v&&this.isInbandExperimentEnabled()&&_&&h&&w?o.default.createElement(d.AsyncFileViewer,{file:i,sharedLinkInfo:h,sharePermission:f,shareToken:_,user:w}):o.default.createElement(l.FileViewer,n.__assign({},t,{fileCount:1,fileIndex:0,titleBarCloseUrl:r,sharedLinkInfo:h,brandingInfo:a,openInHelloSign:p,openInHelloSignSrc:c,shareToken:_,sharePermission:f,user:w,transparentBackground:!1,LoggedOutUXGoogleVariant:m,encryptionOptions:u,authModalKind:g,isInbandExperiment:!!v}));return s?o.default.createElement("div",{className:"embedded"},I):I},y.prototype.getChildContext=function(){return{authModalKind:this.props.authModalKind}},y.childContextTypes={authModalKind:t.default.oneOf(["download","immediate",null])},y})((o=n.__importDefault(o)).default.Component);i.FileViewerContainer=y}));
//# sourceMappingURL=container.min.js-vflEjOatW.map