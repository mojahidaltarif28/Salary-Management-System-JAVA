define("file-viewer/libraries/frame_messenger",["require","exports","file-viewer/libraries/frame_messenger/frame_messenger_client","file-viewer/libraries/frame_messenger/frame_messenger_host","file-viewer/libraries/frame_messenger/frame_messenger_logger"],(function(e,t,r,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FrameMessengerClient=r.FrameMessengerClient,t.FrameMessengerHost=s.FrameMessengerHost,t.logFrameMessage=i.logFrameMessage})),define("file-viewer/libraries/frame_messenger/frame_messenger_base",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t,r){var s=this;void 0===t&&(t=function(e){return JSON.parse(e.data)}),void 0===r&&(r=function(e){return JSON.stringify(e)}),this._window=window,this.handleUntrustedMessage=function(e){if(s.isOriginAllowed(e.origin)){var t;try{t=s.receiveMessageConverter(e)}catch(e){return}null!=t.action&&s.handleTrustedMessage(e,t)}},this.allowedOrigins=e,this.receiveMessageConverter=t,this.sendMessageConverter=r}return e.prototype.getWindow=function(){return this._window},e.prototype.setWindow=function(e){this._window=e},e.prototype.startListening=function(){this.getWindow().addEventListener("message",this.handleUntrustedMessage)},e.prototype.stopListening=function(){this.getWindow().removeEventListener("message",this.handleUntrustedMessage)},e.prototype.regexIn=function(e,t){for(var r=0,s=t;r<s.length;r++){var i=s[r];if(i instanceof RegExp&&e.match(i))return!0;if("string"==typeof i&&i===e)return!0}return!1},e.stripStandardPort=function(e){return"http://"===e.substr(0,7)?e.replace(/:80$/,""):"https://"===e.substr(0,8)?e.replace(/:443$/,""):e},e.prototype.isOriginAllowed=function(t){return this.regexIn(e.stripStandardPort(t),this.allowedOrigins)},e.prototype.packagePostMessage=function(e,t){var r={action:e,parameters:t};return this.sendMessageConverter(r)},e})();t.FrameMessengerBase=r})),define("file-viewer/libraries/frame_messenger/frame_messenger_client",["require","exports","tslib","file-viewer/libraries/frame_messenger/frame_messenger_base","file-viewer/libraries/frame_messenger/frame_messenger_logger"],(function(e,t,r,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(){var t=e.apply(this,arguments)||this;return t.trustedOriginForPosting=null,t.validActions=[],t.trustedMessageHandler=null,t.parentMessageQueue=[],t.onParentReady=null,t}return r.__extends(t,e),t.prototype.configureParentMessaging=function(e,t,r){void 0===r&&(r=null),this.resetOriginsForPosting(),this.validActions=t,this.trustedMessageHandler=e,this.onParentReady=r},t.prototype.startListening=function(){e.prototype.startListening.call(this),this.requestParentOrigin()},t.prototype.postMessageToParent=function(e,t){void 0===t&&(t={});var r=this.packagePostMessage(e,t);null===this.trustedOriginForPosting?this.parentMessageQueue.push(r):this.getWindow().parent.postMessage(r,this.trustedOriginForPosting)},t.prototype.handleTrustedMessage=function(e,t){i.logFrameMessage&&i.logFrameMessage("frame_messenger_client",{event:e,message:t}),"parent-ready"===t.action&&this.updateParentOrigin(e.origin),-1!==this.validActions.indexOf(t.action)&&null!==this.trustedMessageHandler&&this.trustedMessageHandler(t)},t.prototype.resetOriginsForPosting=function(){this.trustedOriginForPosting=null},t.prototype.updateParentOrigin=function(e){var t=this,r=this.trustedOriginForPosting;return!!this.isOriginAllowed(e)&&(this.trustedOriginForPosting=e,this.parentMessageQueue.length>0&&(this.parentMessageQueue.forEach((function(e){var r=JSON.parse(e);t.postMessageToParent(r.action,r.parameters)})),this.parentMessageQueue=[]),null!=this.trustedOriginForPosting&&null==r&&null!=this.onParentReady&&this.onParentReady(),!0)},t.prototype.requestParentOrigin=function(){var e=this;this.getWindow().parent.postMessage('{"action": "child-requesting-parent-origin"}',"*");this.getWindow().setTimeout((function(){null==e.trustedOriginForPosting&&e.requestParentOrigin()}),t._REQUEST_PARENT_ORIGIN_POLL_DELAY)},t})(s.FrameMessengerBase);t.FrameMessengerClient=n,n._REQUEST_PARENT_ORIGIN_POLL_DELAY=100})),define("file-viewer/libraries/frame_messenger/frame_messenger_host",["require","exports","tslib","file-viewer/libraries/frame_messenger/frame_messenger_base","file-viewer/libraries/frame_messenger/frame_messenger_logger"],(function(e,t,r,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(){var t=e.apply(this,arguments)||this;return t.trustedChildOriginForPosting=null,t.validActionsFromChild=[],t.trustedMessageFromChildHandler=null,t.getChildIframes=function(){return[]},t}return r.__extends(t,e),t.prototype.configureChildMessaging=function(e,t,r){if("string"==typeof e){var s=e;this.getChildIframes=function(){return[].slice.call(document.querySelectorAll(s),0)}}else this.getChildIframes=e;this.trustedChildOriginForPosting=null,this.validActionsFromChild=r,this.trustedMessageFromChildHandler=t},t.prototype.startListening=function(){e.prototype.startListening.call(this),this.postMessageToChildren("parent-ready")},t.prototype.getTrustedChildOriginForPosting=function(){if(null!=this.trustedChildOriginForPosting)return this.trustedChildOriginForPosting;for(var e=0,t=this.getChildIframes();e<t.length;e++){var r=""+t[e].getAttribute("src"),s=this.getOriginFromUrl(r);if(this.isOriginAllowed(s))return this.updateChildOrigin(s),this.trustedChildOriginForPosting}return this.trustedChildOriginForPosting},t.prototype.childIsValidated=function(){return null!=this.trustedChildOriginForPosting},t.prototype.isNumber=function(e){return!isNaN(parseInt(e,10))},t.prototype.getOriginFromUrl=function(e){var t=document.createElement("a");t.href=e;var r=t.origin;if(r)return"null"===r?"*":r;var s=this.isNumber(t.port)?":"+t.port:"";return t.protocol+"//"+t.hostname+s},t.prototype.postMessageToChildren=function(e,t){void 0===t&&(t={});var r=this.getChildIframes();this.postMessageToChildElements(r,e,t)},t.prototype.resetOriginsForPosting=function(){this.trustedChildOriginForPosting=null},t.prototype.updateChildOrigin=function(e){"null"===e&&(e="*"),this.trustedChildOriginForPosting=e},t.prototype.handleTrustedMessage=function(e,t){i.logFrameMessage&&i.logFrameMessage("frame_messenger_host",{event:e,message:t}),this.updateChildOrigin(e.origin),"child-requesting-parent-origin"===t.action&&this.postMessageToChildren("parent-ready"),-1!==this.validActionsFromChild.indexOf(t.action)&&null!=this.trustedMessageFromChildHandler&&this.trustedMessageFromChildHandler(t)},t.prototype.postMessageToChildElements=function(e,t,r){void 0===r&&(r={});var s=this.getTrustedChildOriginForPosting();if(null!=s){var i=this.packagePostMessage(t,r);e.forEach((function(e){e.contentWindow&&e.contentWindow.postMessage(i,s)}))}},t})(s.FrameMessengerBase);t.FrameMessengerHost=n})),define("file-viewer/libraries/frame_messenger/frame_messenger_logger",["require","exports","external/lodash"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=[];r.debounce((function(){console.groupCollapsed("Frame Messenger Events"),console.table(s),console.groupEnd()}),1e3);t.logFrameMessage=function(e,t){t.eventName,t.message,t.event,t.data}}));
//# sourceMappingURL=pkg-frame_messenger.min.js-vflSLv2FW.map