define(["require","exports","tslib","react","dig-components/avatar","spectrum/token","spectrum/tokenized_input","modules/clean/analytics","modules/clean/validators/email_validator"],(function(e,t,n,r,a,u,l,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),o=n.__importDefault(o),t.EmailTokenizer=function(e){var t=e.placeholder,c=e.emails,s=e.memberList,f=e.onChange,d=r.useState(),m=d[0],v=d[1],p=r.useState(),_=p[0],g=p[1],E=r.useState(c),k=E[0],y=E[1],b=function(e){return e.split(",").map((function(e){return e.trim()})).filter((function(e){return e.length&&!k.includes(e)}))},h=function(e){var t=e.email,n=s&&s.find((function(e){return e.email===t}));return n?r.default.createElement(r.default.Fragment,null,n.photo_url&&r.default.createElement(a.Avatar,{src:n.photo_url,size:"xsmall",hasNoOutline:!0}),n.display_name):r.default.createElement(r.default.Fragment,null,t)};return r.default.createElement(l.TokenizedInput,{className:"email-tokenizer",inputProps:{autoFocus:!0,placeholder:t,onChange:function(e){v(e.currentTarget.value);var t=b(e.currentTarget.value);t&&f(n.__spreadArrays(k,t))},onFocus:function(){return g(void 0)},onKeyDown:function(e){var t,r=e.key,a=e.currentTarget,u=a.selectionStart,l=a.selectionEnd,o=a.previousElementSibling;if(0===u&&l===u&&("ArrowLeft"!==r&&"Backspace"!==r||(e.preventDefault(),null===(t=o)||void 0===t||t.focus())),m&&["Enter","Tab",","," "].includes(r)){var c=b(m);c&&(e.preventDefault(),c.forEach((function(e){var t=s&&s.find((function(t){return t.email===e}));i.TeamsWebActionsLogger.log("invite_member_email_added",{email:e,user_id:null==t?void 0:t.user_id})})),f(n.__spreadArrays(k,c)),y(n.__spreadArrays(k,c)),v(""))}},value:m},tokens:k.map((function(e){return r.default.createElement(u.Token,{key:e,variant:o.default.validate(e).every((function(e){return e.valid}))?"default":"error",selected:e===_,onClick:function(){return g(e)},onFocus:function(){return g(e)},onClose:function(t){return(function(e,t){var n,r,a=e.currentTarget.closest(".mc-token"),u=a.previousElementSibling;null===(n=a.nextElementSibling)||void 0===n||n.focus(),null===(r=u)||void 0===r||r.focus(),y(k.filter((function(e){return e!==t}))),f(c.filter((function(e){return e!==t})))})(t,e)}},r.default.createElement(h,{email:e}))}))})}}));
//# sourceMappingURL=email_tokenizer.min.js-vflRlPFU4.map