define(["require","exports","tslib","react","modules/clean/analytics","dig-components/typography","modules/core/i18n","modules/clean/profile_services/profile_services_link","modules/clean/profile_services/profile_services_constants","modules/clean/viewer","modules/clean/api_v2/user_client","modules/clean/static_urls"],(function(e,t,o,i,r,n,a,s,c,l,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=o.__importStar(i),c=o.__importDefault(c),t.searchLinkText=a.intl.formatMessage({id:"H9rZ+V",defaultMessage:"Search Google contacts"}),t.importLinkText=a.intl.formatMessage({id:"qrH/PP",defaultMessage:"Import Google contacts"}),t.sharingDisclosureMessage=a.intl.formatMessage({id:"LPpAbn",defaultMessage:"We'll import your organization contacts for you and other admins to use"});var d=c.default.to_api_service_type(c.default.GOOGLE),m=c.default.from_api_to_img(d);t.googleIconAltName=c.default.from_api_to_name(d),t.ImportContactsLink=function(e){var a=e.launchImportModal,d=i.useState({".tag":"other"}),g=d[0],f=d[1];i.useEffect((function(){p()}),[]);var v=i.useMemo((function(){return function(e){return o.__awaiter(void 0,void 0,void 0,(function(){var t,i,n;return o.__generator(this,(function(o){switch(o.label){case 0:return e.preventDefault(),e.stopPropagation(),"not_connected"!==g[".tag"]?(a(),[2]):(t=new s.ProfileServicesLinkingHandler,i=l.Viewer.get_viewer().work_user,r.TeamsWebActionsLogger.log("google_directory_oauth_start"),[4,t.auth_service_with_user_promise(c.default.GOOGLE,i.id,"invite_members_modal","link_directory_members",s.AuthWindowOption.POP_UP)]);case 1:return n=o.sent(),s.ProfileServicesLinkingHandler.show_import_notifications(n),n.success?(r.TeamsWebActionsLogger.log("google_directory_oauth_success"),a()):r.TeamsWebActionsLogger.log("google_directory_oauth_fail",{failure_reason:n.err_msg?n.err_msg:"unspecified"}),[2]}}))}))}}),[a,g]),p=function(){return o.__awaiter(void 0,void 0,void 0,(function(){var e,t,i,n;return o.__generator(this,(function(o){switch(o.label){case 0:return e=l.Viewer.get_viewer(),[4,(new u.UserApiV2Client).ns("domain_contacts").rpc("check_status",void 0,{subjectUserId:e.work_user.id})];case 1:return t=o.sent(),i={".tag":"not_connected"},-1!==(n=t.import_statuses.findIndex((function(e){return"google"===e.service[".tag"]})))&&(i=t.import_statuses[n].status),r.TeamsWebActionsLogger.log("google_directory_import_link_shown",{domain_contacts_connected:"not_connected"!==i[".tag"]}),f(i),[2]}}))}))};if("other"===g[".tag"])return null;var h="not_connected"===g[".tag"];return i.default.createElement("div",{className:"invite-modal__invite-from-gsuite-wrapper"},i.default.createElement("div",{className:"invite-modal__invite-from-gsuite-link"},i.default.createElement(n.Link,{href:"",hasNoUnderline:!0,onClick:v},i.default.createElement("img",{className:"invite-modal__invite-from-gsuite-icon",src:_.static_url(m),alt:t.googleIconAltName}),h?t.importLinkText:t.searchLinkText)),h&&i.default.createElement(n.Text,{className:"invite-modal__invite-from-gsuite-disclosure",color:"faint",size:"small",tagName:"div"},t.sharingDisclosureMessage))}}));
//# sourceMappingURL=import_contacts_link.min.js-vflYeQD2N.map