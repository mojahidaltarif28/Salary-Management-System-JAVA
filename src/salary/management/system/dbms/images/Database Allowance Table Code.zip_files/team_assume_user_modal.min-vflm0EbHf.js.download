define(["require","exports","tslib","react","modules/core/i18n","modules/clean/teams/admin/modals/action_utility_modal","modules/clean/components/modals/show_modal","modules/clean/teams/admin/modals/modal_ajax","modules/core/browser","spectrum/button","modules/clean/rondo/forms/index","modules/clean/react/css"],(function(e,t,a,i,n,s,o,r,d,l,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=a.__importDefault(i),d=a.__importStar(d);t.NOTIFICATION_MODE_ASSUMED_MEMBER="member",t.NOTIFICATION_MODE_ALL_TEAM_ADMINS="admins",t._getNotificationModeInitState=function(e){return e?t.NOTIFICATION_MODE_ALL_TEAM_ADMINS:t.NOTIFICATION_MODE_ASSUMED_MEMBER};var c=(function(e){function o(s){var o=e.call(this,s)||this;return o._getAssumeModalBody=function(){return i.default.createElement("div",{className:"team-assume-user-modal"},o._getNotificationOptionText()," ",n.intl.formatMessage({id:"k8YyVZ",defaultMessage:"All actions you perform while signed in as {name} will be recorded in the activity log."},{name:o.props.displayName})+" ",o._shouldShowSettingsModalLink()&&i.default.createElement("button",{className:"button-as-href",id:"assume_change_settings",onClick:o._goToSettings},n.intl.formatMessage({id:"XthdPa",defaultMessage:"Change notification settings"})),i.default.createElement("div",{className:"member-page-settings-notification"},n.intl.formatMessage({id:"5ujupL",defaultMessage:"<b>Note:</b> {firstname}’s settings can only be changed in the <a>members page.</a>"},{a:function(e){return i.default.createElement("a",{href:"/team/admin/members/member?id="+o.props.userId},e)},b:function(e){return i.default.createElement("span",{className:"bold-text"},e)},firstname:o.props.firstName})))},o._goToSettings=function(){o.setState({isSettingsPage:!0,currNotificationMode:o.props.notificationMode.fieldValue})},o._goToAssumeUser=function(){o.setState({isSettingsPage:!1,currNotificationMode:o.props.notificationMode.fieldValue})},o._clearSettingsAndGoToAssumeUser=function(){o.props.notificationMode.fieldValue=o.state.currNotificationMode,o._goToAssumeUser()},o._getNotificationOptionText=function(){return o._isSingleAdminWithNoMemberNotification()?n.intl.formatMessage({id:"CIiM/g",defaultMessage:"A record will be made in the activity log that you have signed in to {name}’s account."},{name:o.props.displayName}):i.default.createElement("span",null,o._getWillBeNotifiedText(o._getNotificantDisplayName()))},o._isSingleAdminWithNoMemberNotification=function(){return!o._hasAdditionalAdmins()&&o.props.notificationMode.fieldValue!==t.NOTIFICATION_MODE_ASSUMED_MEMBER},o._hasAdditionalAdmins=function(){return o.props.shouldNotifyAdmins},o._getNotificantDisplayName=function(){switch(o.props.notificationMode.fieldValue){case t.NOTIFICATION_MODE_ASSUMED_MEMBER:return o.props.displayName+" ";case t.NOTIFICATION_MODE_ALL_TEAM_ADMINS:return"All team admins ";default:return"Nobody "}},o._getWillBeNotifiedText=function(e){switch(o.props.notificationMode.fieldValue){case t.NOTIFICATION_MODE_ASSUMED_MEMBER:return n.intl.formatMessage({id:"Bzjp8Q",defaultMessage:"<b>{name}</b> will be notified that you’ve signed in to their account."},{b:function(e){return i.default.createElement("span",{className:"bold-text"},e)},name:e});default:return n.intl.formatMessage({id:"OTHFTR",defaultMessage:"<b>{name}</b> will be notified that you’ve signed in to {assume_name}’s account."},{b:function(e){return i.default.createElement("span",{className:"bold-text"},e)},name:e,assume_name:o.props.displayName})}},o._shouldShowSettingsModalLink=function(){return!o.props.isUserSuspended||o._hasAdditionalAdmins()},o._getSettingsModalBody=function(){return i.default.createElement("div",{className:"team-assume-user-modal"},o._renderSettingPhrase(),o._renderSettingsOptions())},o._renderSettingsOptions=function(){return i.default.createElement("div",{className:"settings-selection"},i.default.createElement("div",null,i.default.createElement(u.RadioButton,a.__assign({value:t.NOTIFICATION_MODE_ASSUMED_MEMBER,name:"notificationMode",disabled:o.props.isUserSuspended},o.props.notificationMode),o._radioButtonTextNotificationAssumedMembmer())),i.default.createElement("div",null,i.default.createElement(u.RadioButton,a.__assign({value:t.NOTIFICATION_MODE_ALL_TEAM_ADMINS,name:"notificationMode"},o.props.notificationMode),o._radioButtonTextNotificationAllTeamAdmins())))},o._renderSettingPhrase=function(){return i.default.createElement("div",null,o._hasAdditionalAdmins()?n.intl.formatMessage({id:"WZHfy+",defaultMessage:"Who should be notified when you sign in to this member’s account? They will receive an email stating that you signed in as {display_name}."},{display_name:o.props.displayName}):n.intl.formatMessage({id:"iNPp9N",defaultMessage:"Where should a record be made when you sign in to this member’s account? If your choice is the member, they will receive an email stating that you signed into their account."}),i.default.createElement("a",{className:"textual-button",id:"assume_learn_more",href:"/help/9185",target:"blank",rel:"noreferrer"},n.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"})))},o.state={isSettingsPage:!1,currNotificationMode:t._getNotificationModeInitState(o.props.isUserSuspended)},o}return a.__extends(o,e),o.prototype._radioButtonTextNotificationAssumedMembmer=function(){return n.intl.formatMessage({id:"9epGvB",defaultMessage:"The member and activity log (recommended)"})},o.prototype._radioButtonTextNotificationAllTeamAdmins=function(){return this._hasAdditionalAdmins()?n.intl.formatMessage({id:"pO0iXG",defaultMessage:"All team admins and activity log"}):n.intl.formatMessage({id:"kgR0li",defaultMessage:"Team activity log only"})},o.prototype._settingsActionButton=function(){return i.default.createElement(l.Button,{onClick:this._goToAssumeUser},n.intl.formatMessage({id:"kTq6n5",defaultMessage:"Save settings"}))},o.prototype._settingsCancelButton=function(){return i.default.createElement(l.Button,{variant:"secondary",onClick:this._clearSettingsAndGoToAssumeUser},n.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}))},o.prototype.render=function(){var e=this,t=this.props,a=t.displayName,o=t.onPrimaryAction,r=t.onSecondaryAction,d=t.onRequestClose,l=this.state.isSettingsPage,u=l?n.intl.formatMessage({id:"pWpyyE",defaultMessage:"Sign in as member settings"}):n.intl.formatMessage({id:"MIJqaa",defaultMessage:"Sign in as {name}?"},{name:a}),m=l?this._getSettingsModalBody():this._getAssumeModalBody(),c=l?function(){return e._settingsActionButton()}:n.intl.formatMessage({id:"raLp6W",defaultMessage:"Sign in"}),f=l?function(){return e._settingsCancelButton()}:n.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"});return i.default.createElement(s.ActionUtilityModal,{title:u,id:"team-assume-user-modal",primaryAction:c,secondaryAction:f,onPrimaryAction:o,onSecondaryAction:r,onRequestClose:d},m)},o})(i.default.Component);t.TeamAssumeUserModal=m.requireCssWithComponent(c,["/static/css/team_assume_user_modal-vflqfLhJ1.css"]),t.ASSUME_TEAM_USER_URL="/team/admin/assume_user",t.TeamAssumeUserModalApp=function(e){var i=e.displayName,n=e.firstName,s=e.userId,o=e.isUserSuspended,l=e.shouldNotifyAdmins,u=a.__rest(e,["displayName","firstName","userId","isUserSuspended","shouldNotifyAdmins"]);return r.modalAjax({modal:t.TeamAssumeUserModal,ajax:{url:t.ASSUME_TEAM_USER_URL,data:function(e){var t=e.notificationMode;return{user_id:s,notification_mode:t,return_url:d.get_href()}}},fields:{notificationMode:{fieldValue:t._getNotificationModeInitState(o)}}})(a.__assign({displayName:i,firstName:n,userId:s,isUserSuspended:o,shouldNotifyAdmins:l},u))},t.showTeamAssumeUserModal=function(e){return o.showModal(i.default.createElement(t.TeamAssumeUserModalApp,a.__assign({},e)))}}));
//# sourceMappingURL=team_assume_user_modal.min.js-vflUzaUAW.map