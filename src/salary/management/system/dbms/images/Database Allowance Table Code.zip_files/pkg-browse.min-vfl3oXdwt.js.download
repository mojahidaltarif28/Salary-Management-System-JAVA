define("spectrum/icon_mode",["require","exports","tslib","react","spectrum/icon_templates/stateless","spectrum/svg_icon_bundle","spectrum/icon_mode/bundle"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.ICONS=s.ICONS,t.IconMode=function(e){var t=e.name,r=o.createElement(i.SvgIconBundle,{focusable:"false",icon:s.ICONS[t]});return o.createElement(n.Component,Object.assign({icon:r},e))},t.IconMode.displayName="IconMode"})),define("spectrum/icon_mode/bundle",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICONS=JSON.parse('\n    {"grid":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"#637282\\" fill-rule=\\"evenodd\\"><path d=\\"M7 7h2v2H7zM11 7h2v2h-2zM15 7h2v2h-2zM7 11h2v2H7zM11 11h2v2h-2zM15 11h2v2h-2zM7 15h2v2H7zM11 15h2v2h-2zM15 15h2v2h-2z\\"></path></g>"},"list":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"#637282\\" fill-rule=\\"evenodd\\"><path d=\\"M6 15h2v2H6zM10 15h8v2h-8zM6 11h2v2H6zM10 11h8v2h-8zM6 7h2v2H6zM10 7h8v2h-8z\\"></path></g>"},"tiles":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"#637282\\" fill-rule=\\"evenodd\\"><path d=\\"M7 7h4v4H7zM13 7h4v4h-4zM13 13h4v4h-4zM7 13h4v4H7z\\"></path></g>"}}\n  ')})),define("modules/clean/cloud_docs/create_api",["require","exports","tslib","react","apex-metrics","modules/clean/api_v2/user_client","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/create_pointer_modal","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/types","modules/clean/filepath","modules/clean/logging/hive/schemas/web-modal-activity","modules/clean/react/async_file_modal_controller","modules/clean/react/folder_dialog/async","modules/clean/react/modal","modules/clean/react/snackbar","modules/clean/react/browse/api","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events","modules/core/browser","modules/core/cookies","modules/core/i18n","spectrum/util/uuid_generator","modules/clean/cloud_docs/shared_components/survey_modal","modules/clean/metrics/index","modules/clean/cloud_docs/constants"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b,I,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),d=r.__importStar(d),p=r.__importStar(p),_=r.__importStar(_),h=r.__importStar(h),E=r.__importStar(E);var F=w.intl.formatMessage({id:"UpDkTB",defaultMessage:"Create file in..."}),C=w.intl.formatMessage({id:"7E4VWP",defaultMessage:"Create shortcut in..."}),O=w.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),A=w.intl.formatMessage({id:"GDikFY",defaultMessage:"Choose folder"});t.CloudDocSnackbarId="create-cloud-doc",t.getDepthFromPath=function(e){return(e.replace(/\/$/,"").match(/\//g)||[]).length},t.logCreateFileAttempt=function(e,t){l.logUserAction({actionEvent:c.UserActionEventType.PRE_CREATE,userId:t.userId,actionSource:t.action_source,data:{webOpenId:e}})},t.logCreateFileCallback=function(e){var t=e.ts,o=e.documentType,i=e.selectionMode,s=e.emptyFolder,a=e.error;return r.__awaiter(void 0,void 0,void 0,(function(){var e,l;return r.__generator(this,(function(r){return e=I.getMetricsReporter(),(l={}).document_type=o||"unknown",l.selection_mode=i||"undefined",l.empty_folder=String(s),l.error=a?"true":"false",e.createStats({ns:y.CLOUD_DOCS_AMP_NAMESPACE,name:"web/createFile"},l).recordDuration(Date.now()-t,n.TimeUnit.MILLISECONDS),[2]}))}))},t.logCreateFileSuccessCallback=function(e){var r=e.ts,o=e.openId,n=e.selection_mode,i=e.empty_folder;return function(e){t.logCreateFileCallback({ts:Date.now(),documentType:e.documentType,selectionMode:n,emptyFolder:i}),g.logFileCreateSuccess({uid:e.userId,document_type:e.documentType,time_elapsed:Date.now()-r,open_id:o,selection_mode:n,empty_folder:i}),l.logUserAction({actionEvent:c.UserActionEventType.CREATE,userId:e.userId,docPathOrId:e.fq_path,actionSource:e.action_source,data:{webOpenId:o}})}},t.showAsyncFolderDialog=function(e){var r=e.user,o=e.source,n=e.documentType,i=e.selection_mode,a=e.empty_folder,l=e.handleClickNewFolder,c=e.initialPath,d=s.isPointerFileType(n),p=d?C:F,f=d?A:O;_.showFolderDialog({modalName:u.ModalName.CLOUD_DOCS_CREATE,user:r,title:p,primaryActionLabel:f,handleClickNewFolder:l,initialPath:c,onSuccess:function(e,s){var l=e||"/";g.logFileCreateClick({uid:r.id,source:o,action:S.WebUserActionLogEvent.FILE_CREATE_HOME_FOLDER_SELECTED,depth_folder_selected:t.getDepthFromPath(l),selection_mode:i,empty_folder:a}),t.createNewFile({user:r,path:l,documentType:n,source:o,selection_mode:i,empty_folder:a})}})},t.createNewFile=function(o){var n=o.user,i=o.path,c=o.documentType,d=o.source,u=o.selection_mode,p=o.empty_folder,_=o.enableShortcutExtensionFeedback;return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(o){return[2,Promise.all([new Promise((function(t,r){e(["modules/clean/account/email"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/account/email_verify_reasons"],t,r)})).then(r.__importStar)]).then((function(e){var r=e[0].EmailVerification,o=e[1].CLOUD_DOCS;if(r.get_for_user(n).verified_or_show(o)){var f=T.generateUUID("web-create");if(s.isMicrosoftFileType(c)){t.logCreateFileAttempt(f,{userId:n.id,action_source:l.getActionSourceFromNewFileMenuType(d)});var m=t.logCreateFileSuccessCallback({ts:Date.now(),openId:f,selection_mode:u,empty_folder:p});P({userId:n.id,path:i,documentType:c,logSuccessCallback:m,source:d})}else if(s.isPointerFileType(c))a.CreatePointerModal.showInstance({createOnSubmit:function(e){t.logCreateFileAttempt(f,{userId:n.id,action_source:l.getActionSourceFromNewFileMenuType(d)});var r=t.logCreateFileSuccessCallback({ts:Date.now(),openId:f,selection_mode:u,empty_folder:p});t.createNewPointer({userId:n.id,pathName:i,name:e.pointerData.name,url:e.pointerData.url,onError:e.onError,logSuccessCallback:r,source:d,enableShortcutExtensionFeedback:_})}});else{t.logCreateFileAttempt(f,{userId:n.id,action_source:l.getActionSourceFromNewFileMenuType(d)});m=t.logCreateFileSuccessCallback({ts:Date.now(),openId:f,selection_mode:u,empty_folder:p});t.createNewCloudOnlyDoc({userId:n.id,pathName:i,title:w.intl.formatMessage({id:"j+AeKy",defaultMessage:"Untitled"}),documentType:c,logSuccessCallback:m,source:d,openId:f,selection_mode:u,empty_folder:p})}}}))]}))}))};var P=function(e){var r=e.userId,o=e.path,n=e.documentType,i=e.logSuccessCallback,s=e.source,a={fq_path:o,extension:n,action_source:t.getCreateActionSource(s),_subject_uid:String(r),t:v.Cookies.read("__Host-js_csrf")},c=t.constructFormForCreateNewMicrosoftFile(a);document.body.appendChild(c),c.submit(),i({userId:r,documentType:n,action_source:l.getActionSourceFromNewFileMenuType(s)})};t.constructFormForCreateNewMicrosoftFile=function(e){var t=document.createElement("form");t.action="/ow/msft/create_new_file",t.method="POST",t.target="_blank";for(var r=0,o=Object.keys(e);r<o.length;r++){var n=o[r],i=document.createElement("input");i.type="hidden",i.name=n,i.value=e[n],t.appendChild(i)}return t},t.createPlaceholderTabForNewCloudDoc=function(){return E.open_tab(s.LOADING_PAGE_URL,!0)},t.createNewCloudOnlyDoc=function(e){var r=e.userId,n=e.pathName,i=e.title,a=e.documentType,c=e.logSuccessCallback,d=e.source,u=e.openId,_=e.selection_mode,g=e.empty_folder,S=w.intl.formatMessage({id:"XcMi4Q",defaultMessage:"Creating new file…"}),E=w.intl.formatMessage({id:"5VrbkU",defaultMessage:"File created!"}),v=function(e){return e.preventDefault(),e.returnValue="",""};window.addEventListener("beforeunload",v);var T=t.createPlaceholderTabForNewCloudDoc(),I=function(e){m.Snackbar.sync(S,!0,t.CloudDocSnackbarId),h.createCloudDoc({pathName:n,title:i,documentType:a,userId:r,onSuccess:function(e){e.changesets;var n=e.createdFile,i=e.failureDetails;if(i){T.close(),m.Snackbar.close(t.CloudDocSnackbarId),window.removeEventListener("beforeunload",v),p.showFileSystemWarningsModal({fsws:i,confirmText:w.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),onFinalAccept:function(){c=t.logCreateFileSuccessCallback({ts:Date.now(),openId:u,selection_mode:_,empty_folder:g}),T=t.createPlaceholderTabForNewCloudDoc(),I(!1)}})}else if(m.Snackbar.complete(E,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",v),null!==n){if(c({userId:r,documentType:a,fq_path:n.fq_path,action_source:l.getActionSourceFromNewFileMenuType(d)}),T){var h=n.open_to_url;try{var S=new URL(h);S.searchParams.set("web_open_id",u),h=S.toString()}catch(e){}T.location.replace(h)}s.isGoogleFileType(a)&&f.Modal.showInstance(o.default.createElement(b.GoogleSurveyModal,{userId:r,documentType:a}))}},onError:function(e){t.logCreateFileCallback({ts:Date.now(),documentType:a,selectionMode:_,emptyFolder:g,error:!0}),m.Snackbar.fail(e,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",v)},checkFSWs:e})};I(!0)},t.createNewPointer=function(t){var n=t.userId,a=t.pathName,u=t.name,p=t.url,_=t.onError,h=t.logSuccessCallback,g=t.source,S=t.enableShortcutExtensionFeedback,E=new i.UserApiV2Client,v=w.intl.formatMessage({id:"l6L9q8",defaultMessage:"Creating new shortcut"}),T=w.intl.formatMessage({id:"EqUCHi",defaultMessage:"Created shortcut"});return m.Snackbar.sync(v,!0,"create-cloud-shortcut"),E.ns("cloud_docs").rpc("create",{to_path:d.normalize(a)||"/",title:u,cloud_doc_type:c.SimplePointer,pointer_url:p},{subjectUserId:n}).then((function(t){h({userId:n,documentType:s.PointerFileTypes.SIMPLE_POINTER,fq_path:t.result_path,action_source:l.getActionSourceFromNewFileMenuType(g)}),f.Modal.close(),m.Snackbar.complete(T+' "'+d.filename(t.result_path)+'"',"create-cloud-shortcut"),S&&new Promise((function(t,r){e(["modules/clean/cloud_docs/shortcuts/feedback_modal"],t,r)})).then(r.__importStar).then((function(e){var r=e.ShortcutsFeedbackModal,i=e.ShortcutsFeedbackModalFlagMask;f.Modal.showInstance(o.default.createElement(r,{userId:n,entryMask:i.CREATE_MENU,source:"create_menu",fqPath:t.result_path}))}))})).catch((function(e){_(),m.Snackbar.fail(w.intl.formatMessage({id:"fi9Okp",defaultMessage:"Oops, something went wrong. Please try again later."}),"create-cloud-shortcut")}))},t.getCreateActionSource=function(e){switch(e){case s.NewFileMenuFromType.BROWSE:return s.ActionSourceValue.WEB_BROWSE;case s.NewFileMenuFromType.HOME:return s.ActionSourceValue.WEB_HOME;default:return s.ActionSourceValue.WEB}}})),define("modules/clean/cloud_docs/create_pointer_modal",["require","exports","tslib","react","modules/clean/cloud_docs/pointers_common","modules/clean/react/css","modules/clean/react/modal","modules/core/i18n","spectrum/button","spectrum/modal"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var d=a.intl.formatMessage({id:"Qq0yqO",defaultMessage:"Create a new shortcut"}),u=a.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),p=a.intl.formatMessage({id:"KOp2Z9",defaultMessage:"Creating..."}),_=a.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),f=a.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"}),m=a.intl.formatMessage({id:"Di2bB3",defaultMessage:"URL"}),h=a.intl.formatMessage({id:"vtIvYJ",defaultMessage:"Invalid URL"}),g=(function(e){function t(t){var r=e.call(this,t)||this;return r.onChange=function(e){r.setState({pointerData:e})},r.handleCreateOnClick=function(){r.setState({creationInProgress:!0}),r.props.createOnSubmit({pointerData:{name:r.state.pointerData.name.trim(),url:r.state.pointerData.url.trim()},onError:r.handleSubmitError})},r.handleSubmitError=function(){r.setState({creationInProgress:!1})},r.renderCreateButton=function(){var e=n.CreatePointerFields.canSubmit(r.state.pointerData)&&!r.state.creationInProgress;return o.default.createElement(l.Button,{variant:"primary",disabled:!e,onClick:r.handleCreateOnClick},r.state.creationInProgress?p:u)},r.closeModal=function(){s.Modal.close()},r.renderCancelButton=function(){return o.default.createElement(l.Button,{variant:"secondary",onClick:r.closeModal},_)},r.state={pointerData:{name:"",url:""},creationInProgress:!1},r}return r.__extends(t,e),t.prototype.render=function(){return o.default.createElement(c.UtilityModal,{title:d,ariaLabel:"Shortcut Creation Modal",primaryAction:this.renderCreateButton,secondaryAction:this.renderCancelButton,open:!0,shouldRequestCloseOnActions:!1,overlayClickClose:!0,variant:"regular"},o.default.createElement(n.CreatePointerFields,{name:this.state.pointerData.name,url:this.state.pointerData.url,onChange:this.onChange,onSubmit:this.handleCreateOnClick,nameLabel:f,urlLabel:m,urlValidationMessage:h}))},t.showInstance=function(e){return s.Modal.showInstance(o.default.createElement(S,r.__assign({},e)))},t})(o.default.Component);t.CreatePointerModal=g;var S=i.requireCssWithComponent(g,["/static/css/spectrum/index.web-vfl6Z83yw.css","/static/css/cloud_docs/create_pointer_modal-vflATc8Dt.css"])})),define("modules/clean/cloud_docs/event_logging",["require","exports","tslib","modules/clean/api_v2/user_client","modules/clean/api_v2/noauth_client","modules/clean/cloud_docs/types","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/clean/logging/hive/schemas/web-user-action","modules/clean/logging/telemetry","modules/constants/python","modules/clean/cloud_docs/constants","modules/core/browser","modules/clean/perf_tools/web_timing_utils","modules/core/exception","modules/clean/filepath"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s),c=r.__importStar(c),p=r.__importStar(p);var h=void 0;t.getStartTime=function(){try{h=h||p.performance().timing.fetchStart}catch(e){f.reportStack("Unable to get fetchStart from browser.",{severity:f.SEVERITY.NONCRITICAL}),h=s.start_time()}return h},t.logViewEvent=function(e,t,r){var n={file_views:[{file_info:{shared_link_details:{url:t}},platform_type:{".tag":r}}]};(new o.UserApiV2Client).ns("seen_state").rpc("log_file_view",n,{subjectUserId:e})},t.logClientEvent=function(e,r,o,a,l){var c=l||[];c.push({key:"time_on_page_with_redirect",value:s.time_since_start().toString()}),c.some((function(e){return"time_now"===e.key}))||c.push({key:"time_now",value:Date.now().toString()}),(new n.NoAuthApiV2Client).ns("cloud_docs").rpc("log_client_event",{client:i.editorTypeToClient[r],doc_id:e,event_name:o,auth_token:a,time_on_page:_.WebTimingUtil.getNow()-t.getStartTime(),extras:c},{})},t.logUserAction=function(e){var t,r=(new o.UserApiV2Client).ns("cloud_docs");e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(t={".tag":"path_or_id",path_or_id:e.docPathOrId});var n=e.data&&e.data.webOpenId,i=e.data&&e.data.origDest,s=e.data&&e.data.routingDest;r.rpc("log_user_action",{action:e.actionEvent,doc_id:t,source:e.actionSource,open_id:n,orig_dest:i,routing_dest:s,extra_info:e.extra},{subjectUserId:e.userId})},t.logLoggedOutUserAction=function(e){var t,r=(new n.NoAuthApiV2Client).ns("cloud_docs");e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(t={".tag":"path_or_id",path_or_id:e.docPathOrId});var o=e.data&&e.data.webOpenId,i=e.data&&e.data.origDest,s=e.data&&e.data.routingDest;r.rpc("logged_out/log_user_action",{action:e.actionEvent,doc_id:t,source:e.actionSource,open_id:o,orig_dest:i,routing_dest:s,extra_info:e.extra},{})},t.checkAndLogNpu=function(e,t,r,n,i){(new o.UserApiV2Client).ns("cloud_docs").rpc("log_new_partner_users",{partner:t,cloud_doc_type:m.file_extension(r),cloud_editor:n,platform:i},{subjectUserId:e})},t.getActionSourceFromSurface=function(e){return"search"===e?i.UserActionSourceType.WEB_SEARCH:"previews"===e?i.UserActionSourceType.WEB_PREVIEW:"home_recent"===e||"home_starred"===e?i.UserActionSourceType.WEB_HOME:"browse"===e||"sidebar"===e?i.UserActionSourceType.WEB_BROWSE:i.UserActionSourceType.WEB},t.getActionSourceFromSourceArgs=function(e){return e.fileViewAction===d.FileViewActionType.SEARCH||e.fileViewOrigin===d.FileViewOriginType.SEARCH?i.UserActionSourceType.WEB_SEARCH:e.fileViewOrigin===d.FileViewOriginType.BROWSE?i.UserActionSourceType.WEB_BROWSE:e.fileViewOrigin===d.FileViewOriginType.HOME?i.UserActionSourceType.WEB_HOME:i.UserActionSourceType.WEB},t.getActionSourceFromNewFileMenuType=function(e){switch(e){case u.NewFileMenuFromType.BROWSE:return i.UserActionSourceType.WEB_BROWSE;case u.NewFileMenuFromType.HOME:return i.UserActionSourceType.WEB_HOME;default:return i.UserActionSourceType.WEB}},t.logFileOpenPromptAction=function(e,t,r,o,n){(new c.HiveLogger).log(new l.WebUserActionRow({user_id:e,event_name:a.WebUserActionLogEvent.FILE_OPEN_PROMPT_ACTION,extra:{file_type:t,integration_name:r,prompt_action:o,ask_again:n}}))},t.logFileConvertPromptAction=function(e,t,r,o){(new c.HiveLogger).log(new l.WebUserActionRow({user_id:e,event_name:a.WebUserActionLogEvent.FILE_CONVERT_PROMPT_ACTION,extra:{prompt_action:t,integration_name:r,file_extension:o}}))},t.logInterstitialLoginAction=function(e,t,r){(new c.HiveLogger).log(new l.WebUserActionRow({event_name:a.WebUserActionLogEvent.INTERSTITIAL_LOGIN_ACTION,extra:{prompt_action:e,logged_out_ux_google_variant:t,file_extension:r}}))},t.logLoggedOutUXSnackBarAction=function(e,t,r){(new c.HiveLogger).log(new l.WebUserActionRow({event_name:a.WebUserActionLogEvent.LOGGED_OUT_UX_SNACKBAR_ACTION,extra:{prompt_action:e,file_extension:t,logged_out_ux_google_variant:r||""}}))}})),define("modules/clean/cloud_docs/open_with_utils",["require","exports","tslib","apex-metrics","modules/core/browser","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/types","modules/clean/referrer_cleansing_redirect","modules/clean/cloud_docs/constants","modules/core/uri","modules/clean/cloud_docs/utils","modules/clean/open_with","spectrum/util/uuid_generator","modules/core/browser_detection","modules/clean/cloud_docs/create_api","modules/clean/metrics/index"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h){"use strict";function g(){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/api_v2/user_client"],t,r)})).then(r.__importStar)];case 1:return[2,(new(0,t.sent().UserApiV2Client)).ns("cloud_docs")]}}))}))}var S,E;function v(e){if(void 0!==e&&void 0!==e.error&&void 0!==e.error[".tag"])return e.error[".tag"]}function w(e){switch(v(e)){case"invalid_file_id":case"permission_denied":case"other":default:return}}function T(e,t,r,o,i,l,c){var u=_.generateUUID("web_open_id"),p=d.URI.parse(e.cloud_editor_url).updateQuery({cloud_editor:i,web_open_id:u});l&&p.updateQuery({ignore_lock:"1"});var f=p.toString();f&&(void 0===c&&(c=a.UserActionSourceType.WEB),s.logUserAction({actionEvent:a.UserActionEventType.PRE_OPEN,userId:o,docPathOrId:r,actionSource:c,data:{webOpenId:u}}),null!=t?n.redirect(f,t):n.open_tab(f))}function b(e){return[".gdoc",".gsheet",".gslides"].indexOf(u.getFileExt(e))>=0}function I(e){return".web"===u.getFileExt(e)}function y(e,t){for(var r=u.getFileExt(e),o=0,n=Object.keys(c.DSS_TYPE_TO_SUPPORTED_EXTS);o<n.length;o++){var i=n[o];if(c.DSS_TYPE_TO_SUPPORTED_EXTS[i].indexOf(r)>=0)return i}switch(r){case".gdoc":return c.GoogleFileTypes.GOOGLE_DSS_DOC;case".gsheet":return c.GoogleFileTypes.GOOGLE_DSS_SHEET;case".gslides":return c.GoogleFileTypes.GOOGLE_DSS_SLIDES}return null}Object.defineProperty(t,"__esModule",{value:!0}),l=r.__importStar(l),p=r.__importDefault(p),f=r.__importStar(f),t.getCloudEditorUrlCached=function(e,o){return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(r){return S||(S=t.getCloudEditorUrl(e,o)),[2,S]}))}))},t.getCloudEditorUrl=function(e,t){return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,g()];case 1:return[2,r.sent().rpc("get_cloud_editor_url",{file_id:t},{subjectUserId:e})]}}))}))},t.decodeAPIError=v,t.handleError=w,t.isInEdgeIframe=function(){var e=!1;if(f.edge||f.msie||f.edgeChromium())try{e=window.self!==window.top}catch(t){e=!0}return e},t.openCloudEditorUrl=T,t.fileToOpenWithParams=function(e){return{fileId:e.file_id,openToUrl:e.open_to_url}},t.openWithCloudEditor=function(e,n,s,a,l){var c=e.fileId,d=e.openToUrl;return r.__awaiter(void 0,void 0,void 0,(function(){var e,u,p,_,f,g,S;return r.__generator(this,(function(r){switch(r.label){case 0:r.trys.push([0,11,,12]),e=performance.now(),u=h.getMetricsReporter(),p={},r.label=1;case 1:return r.trys.push([1,8,9,10]),p.editor=s,l&&(p.source=l[".tag"]),_=t.isInEdgeIframe(),p.isInEdgeIframe=String(_),d&&d.startsWith("https://www.dropbox.com/scl/fi/")?(p.usedOpenToURLFromFile="true",T({cloud_editor_url:d},null,c,n,s,a,l),[3,7]):[3,2];case 2:return p.usedOpenToURLFromFile="false",f=_?null:m.createPlaceholderTabForNewCloudDoc(),_?[4,t.getCloudEditorUrlCached(n,c)]:[3,4];case 3:return g=r.sent(),[3,6];case 4:return[4,t.getCloudEditorUrl(n,c)];case 5:g=r.sent(),r.label=6;case 6:T(g,f,c,n,s,a,l),r.label=7;case 7:return p.error="false",[3,10];case 8:return S=r.sent(),p.error="true",w(S),[3,10];case 9:return u.createStats({ns:i.CLOUD_DOCS_AMP_NAMESPACE,name:"web/openWithCloudEditor"},p).recordDuration(performance.now()-e,o.TimeUnit.MILLISECONDS),[7];case 10:return[3,12];case 11:return w(r.sent()),[3,12];case 12:return[2]}}))}))},t.openCloudDoc=function(t,o,c){if(c||(c=a.UserActionSourceType.WEB),t.href)if(i.isPointerByExtension(t.ns_path))l.safe_open_tab_and_redirect(t.href),s.logUserAction({actionEvent:a.UserActionEventType.PRE_OPEN,userId:o.id,docPathOrId:t.file_id,actionSource:c});else{var u=_.generateUUID("web_open_id"),p=d.URI.parse(t.href).updateQuery("web_open_id",u).toString();n.open_tab(p),s.logUserAction({actionEvent:a.UserActionEventType.PRE_OPEN,userId:o.id,docPathOrId:t.file_id,actionSource:c,data:{webOpenId:u}})}else{var f=m.createPlaceholderTabForNewCloudDoc();new Promise((function(t,r){e(["modules/clean/previews/data/actions"],t,r)})).then(r.__importStar).then((function(e){return e.fetchPreviewUrl(t,o)})).then((function(e){e&&null!==f&&l.redirect(e,f,!0)}))}},(function(e){e.OfficeOnline="OfficeOnline",e.GoogleDSS="GoogleDSS"})(E=t.OpenWithCloudDocProvider||(t.OpenWithCloudDocProvider={})),t.getOpenWithCloudEditorInfo=function(e,r,o,n){var i=[],s=t.getOpenWithWopiEditorInfo(e,r,n);s&&o.wopi&&i.push(s);var a=t.getOpenWithGoogleEditorInfo(e,r,n);return a&&o.gdd&&i.push(a),i},t.getOpenWithGoogleEditorInfo=function(e,r,o){var n=y(e,r);return n?{text:c.DSS_TYPE_TO_TEXT[n],iconUrl:c.DSS_TYPE_TO_OPEN_WITH_ICONS[n],handler:function(){return t.openWithCloudEditor(t.fileToOpenWithParams(e),r.id,n,!1,o)},provider:E.GoogleDSS}:null},t.getOpenWithWopiEditorInfo=function(e,r,o){var n=p.default.getWopiOpenWithButtonInfo(e);return n?{text:n.name,spriteName:n.icon,handler:function(){return t.openWithCloudEditor(t.fileToOpenWithParams(e),r.id,n.editor,!1,o)},provider:E.OfficeOnline}:null},t.isGoogleDoc=b,t.isShortcut=I,t.isCloudBasedDoc=function(e){return!!b(e)||!!I(e)},t.getGoogleEditorType=y})),define("modules/clean/cloud_docs/pointers_common",["require","exports","tslib","modules/clean/keycode","react","spectrum/input"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.handleKeyPress=function(e){e.charCode===o.KeyCode.ENTER&&t.canSubmit({name:r.props.name,url:r.props.url})&&r.props.onSubmit()},r.handleNameChange=function(e){var t=e.target.value;r.props.onChange({name:t,url:r.props.url})},r.handleUrlChange=function(e){var t=e.target.value;r.props.onChange({name:r.props.name,url:t})},r.setNameFieldRef=function(e){r.nameRef=e},r}return r.__extends(t,e),t.prototype.render=function(){var e=""===this.props.url||t.isUrlValid(this.props.url),r=e?"default":"invalid",o="";return e||(o=this.props.urlValidationMessage),n.createElement("div",{className:"create-pointer--fields"},n.createElement("div",{className:"create-pointer--fieldset"},n.createElement("label",{htmlFor:"create-pointer--link_input"},this.props.urlLabel),n.createElement("div",{className:"create-pointer--fieldset-with-icon"},this.props.urlIcon,n.createElement(i.Input,{id:"create-pointer--link_input",className:"create-pointer--link_input",variant:r,onChange:this.handleUrlChange,onKeyPress:this.handleKeyPress,value:this.props.url,autoFocus:!0}))),n.createElement("div",{className:"create-pointer--url-validation-warning"},o),n.createElement("div",{className:"create-pointer--fieldset"},n.createElement("label",{htmlFor:"create-pointer--name_input"},this.props.nameLabel),n.createElement(i.Input,{id:"create-pointer--name_input",className:"create-pointer--name_input",onChange:this.handleNameChange,onKeyPress:this.handleKeyPress,forwardedRef:this.setNameFieldRef})))},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return this.props.urlPrepopulateFunction?[4,this.props.urlPrepopulateFunction()]:[3,2];case 1:(e=t.sent())&&(this.props.onChange({name:this.props.name,url:e}),this.nameRef.focus()),t.label=2;case 2:return[2]}}))}))},t.isUrlValid=function(e){return/^((http|https):\/\/)?([^.:/\\?#@!]+?\.)+[^.:/\\?#@!]+/i.test(e.trim())},t.canSubmit=function(e){return""!==e.name&&""!==e.url&&t.isUrlValid(e.url)},t})((n=r.__importStar(n)).Component);t.CreatePointerFields=s})),define("modules/clean/cloud_docs/preferred_editor_utils",["require","exports","tslib","modules/core/i18n","modules/core/browser","modules/core/exception","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/utils","modules/clean/cloud_docs/types","react","modules/clean/filepath","modules/clean/cloud_docs/open_with_utils","modules/core/uri","modules/clean/cloud_docs/cloud_doc_api_client","spectrum/util/uuid_generator","modules/clean/cloud_docs/preferred_editor_constants","modules/clean/cloud_docs/create_api"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),c=r.__importDefault(c),t.hasPreferredEditorSupport=function(e){var t=a.getFileExt(e);return m.PREFERRED_EDITOR_SUPPORTED_EXTS.indexOf(t)>=0},t.openInPreferredEditor=function(e,t,r,o,c){var d=a.getFileExt(t),g=r[e.id],S="";if(g)try{var E=g[m.EXTENSION_TO_DOC_TYPE[d]],v=E===m.PreferredEditorTypes.GoogleDSS||E===m.PreferredEditorTypes.OfficeOnline,w=f.generateUUID("web_open_id");if(t.is_in_vault_folder)return v&&s.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:s.getActionSourceFromSourceArgs(c),data:{webOpenId:w},extra:{block_vault_content:"true"}}),void o();if(v){var T=h.createPlaceholderTabForNewCloudDoc();u.getCloudEditorUrl(e.id,t.file_id).then((function(r){S=p.URI.parse(r.cloud_editor_url).updateQuery("web_open_id",w).toString(),T?T.location.replace(S):o(),s.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:s.getActionSourceFromSourceArgs(c),data:{webOpenId:w}})})).catch((function(e){i.reportStack("Error getting cloud editor url from preferred editor open.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:S,file_ext:d,preferred_editor_configs:g,error:e.message}}),T&&T.close(),o()}))}else _.getPreferredUrl(e.id,t.file_id,d).then((function(r){r.preferred_editor_url&&(S=p.URI.parse(r.preferred_editor_url).updateQuery("web_open_id",w).toString(),s.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:s.getActionSourceFromSourceArgs(c),data:{webOpenId:w}}),n.redirect(S))})).catch((function(e){i.reportStack("Error getting preferred editor url from preferred editor open.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:S,file_ext:d,preferred_editor_configs:g,error:e.message}})})),o()}catch(e){i.reportStack("Error opening docs in preferred editor.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:S,file_ext:d,preferred_editor_configs:g,error:e.message}}),o()}else o()},t.getPreferredEditorPrompt=function(e,t){var r="."+d.file_extension(e),n=m.EXTENSION_TO_DOC_TYPE[r],i=m.INTEGRATION_NAME_TO_PROMPT[t][n];return i?{title:o.intl.formatMessage({id:"jXF9I9",defaultMessage:"Would you like to open <b>{file_extension}</b> files with {web_editor_name} by default?"},{file_extension:r,web_editor_name:i,b:function(e){return c.default.createElement("b",null,e)}}),body:o.intl.formatMessage({id:"f37GH8",defaultMessage:"{web_editor_name} will automatically be used to open your <b>{file_extension}</b> files in Dropbox. You can always update this later in your Dropbox settings."},{file_extension:r,web_editor_name:i,b:function(e){return c.default.createElement("b",null,e)}})}:null}})),define("modules/clean/cloud_docs/preferred_editor_constants",["require","exports","modules/core/i18n","modules/clean/cloud_docs/types"],(function(e,t,r,o){"use strict";var n,i,s,a,l,c,d;Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.Unknown=0]="Unknown",e[e.FileViewer=1]="FileViewer",e[e.OfficeOnline=2]="OfficeOnline",e[e.GoogleDSS=3]="GoogleDSS"})(c=t.PreferredEditorTypes||(t.PreferredEditorTypes={})),(function(e){e.WORD="ms_word",e.EXCEL="ms_excel",e.POWERPOINT="ms_powerpoint"})(d=t.PreferredEditorDocTypes||(t.PreferredEditorDocTypes={})),t.PreferredEditorOptionsMap=((n={})[d.WORD]={1:r.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:r.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),3:r.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"})},n[d.EXCEL]={1:r.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:r.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),3:r.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"})},n[d.POWERPOINT]={1:r.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:r.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"}),3:r.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"})},n),t.EXTENSION_TO_DOC_TYPE={".docx":d.WORD,".doc":d.WORD,".xlsx":d.EXCEL,".xls":d.EXCEL,".pptx":d.POWERPOINT,".ppt":d.POWERPOINT},t.PREFERRED_EDITOR_SUPPORTED_EXTS=Object.keys(t.EXTENSION_TO_DOC_TYPE),t.INTEGRATION_NAME_TO_PROMPT=((i={})[o.IntegrationName.GOOGLE_DSS]=((s={})[d.WORD]=r.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),s[d.EXCEL]=r.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),s[d.POWERPOINT]=r.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"}),s),i[o.IntegrationName.OFFICE_ONLINE]=((a={})[d.WORD]=r.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),a[d.EXCEL]=r.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),a[d.POWERPOINT]=r.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"}),a),i[o.IntegrationName.PAPER_INTEGRATION]={},i),t.IntegrationNameToPreferredEditorEnums=((l={})[o.IntegrationName.GOOGLE_DSS]=c.GoogleDSS,l[o.IntegrationName.OFFICE_ONLINE]=c.OfficeOnline,l[o.IntegrationName.PAPER_INTEGRATION]=c.Unknown,l)})),define("modules/clean/cloud_docs/utils",["require","exports","modules/clean/filepath","spectrum-sharing/utils/sharing_constants","modules/clean/cloud_docs/types"],(function(e,t,r,o,n){"use strict";function i(e){return e.replace(/[/?<>:*\\]/g,"_")}Object.defineProperty(t,"__esModule",{value:!0}),t.getFileExt=function(e){var t="";return e.hasOwnProperty("ext")?t=e.ext:e.hasOwnProperty("filename")?(t=r.file_extension(e.filename))&&(t="."+t):(t=r.file_extension(e))&&(t="."+t),t},t.integrationNameToShareActionOrigin=function(e){switch(e){case n.IntegrationName.GOOGLE_DSS:return o.SHARE_ACTION_ORIGIN_TYPE.GOOGLE_DSS;case n.IntegrationName.PAPER_INTEGRATION:return o.SHARE_ACTION_ORIGIN_TYPE.PAPER_INTEGRATION;case n.IntegrationName.OFFICE_ONLINE:return o.SHARE_ACTION_ORIGIN_TYPE.OFFICE_INTEGRATION;default:throw"No mapping for integration to share action origin: "+e}},t.replaceInvalidFilenameChars=i,t.replaceInvalidURLFilenameChars=function(e){return i(e).replace(/\ /g,"-")}})),define("modules/clean/cloud_docs/shared_components/survey_modal",["require","exports","tslib","react","modules/clean/static_urls","modules/clean/cloud_docs/cloud_doc_api_client","modules/clean/cloud_docs/constants","modules/clean/react/modal","modules/clean/referrer_cleansing_redirect","modules/constants/page_load"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var d=(function(e){function t(t){var r=e.call(this,t)||this;return r.state={hasSeenSurvey:null},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return[4,i.getGoogleSurveyAsync(this.props.userId)];case 1:return e=t.sent().has_seen_google_survey,this.setState({hasSeenSurvey:e}),e?[3,3]:[4,i.setGoogleSurveyAsync(this.props.userId)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},t.prototype.googleFileTypeToString=function(e){return e===s.GoogleFileTypes.GOOGLE_DSS_SHEET?"Google Sheet":e===s.GoogleFileTypes.GOOGLE_DSS_SLIDES?"Google Slide":"Google Doc"},t.prototype.render=function(){return["en","en_GB"].includes(c.USER_LOCALE)?this.state.hasSeenSurvey||null===this.state.hasSeenSurvey?null:o.default.createElement(a.Modal,{width:440,style:"clean",acceptButtonText:"Submit feedback",altAction:o.default.createElement("a",{onClick:function(){return a.Modal.close()}},"No, thank you"),onAccept:function(){l.safe_open_tab_and_redirect("https://forms.gle/XTVr6LNw5w77dUEJ9")},submitting:!1,className:"shortcuts-feedback-modal"},o.default.createElement("img",{src:n.static_url("/static/images/shortcuts/shortcuts-survey-modal-vflB35Wls.png"),alt:"Image of cartoon holding globe"}),o.default.createElement("h1",null,"Congrats on creating a "+this.googleFileTypeToString(this.props.documentType)+" in Dropbox!"),o.default.createElement("div",null,"Please take a moment to give us feedback on your experience.")):null},t})(o.default.Component);t.GoogleSurveyModal=d})),define("modules/clean/file_actions/create-folder",["require","exports","tslib","modules/clean/file_actions/metrics","modules/clean/file_actions/strings","modules/clean/metrics/index","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/snackbar","modules/clean/web_user_action_events","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";function p(e){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){return[2,new Promise((function(t){s.showFileSystemWarningsModal({fsws:e,onFinalAccept:function(){t(!0)},onAbortAction:function(){t(!1)},confirmText:u.intl.formatMessage(n.createFolderFswConfirmText)})}))]}))}))}function _(e,t,r){a.logWebUserAction({event_name:d.WebUserActionLogEvent.CREATE_FOLDER_ERROR,extra:{error_summary:e||null,error:t||null,origin:r||null}})}function f(e){a.logWebUserAction({event_name:d.WebUserActionLogEvent.CREATE_FOLDER_CANCEL,extra:{origin:e||null}})}function m(e){a.logWebUserAction({event_name:d.WebUserActionLogEvent.CREATE_FOLDER_PENDING,extra:{origin:e||null}})}function h(e){a.logWebUserAction({event_name:d.WebUserActionLogEvent.CREATE_FOLDER_SUCCESS,extra:{origin:e||null}})}Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s),l=r.__importStar(l),t.createFolder=function(e){var s=e.user,a=e.name,d=e.destination,g=e.checkFsw,S=e.origin,E=e.surface;return r.__awaiter(void 0,void 0,Promise,(function(){var e,v,w,T;return r.__generator(this,(function(r){switch(r.label){case 0:return e=i.getMetricsReporter(),v={surface:E},w={latency:e.createTimer({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"create-folder/latency_ms"},v),completed:e.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"create-folder/completed"},v)},m(S),c.Snackbar.sync(u.intl.formatMessage(n.createFolderSnackbarProgress),!1,"browse-action"),[4,l.createFolder(d,a,s,g)];case 1:return(T=r.sent()).isError&&"path"===T.error[".tag"]&&"file_system_warnings"===T.error.path[".tag"]?(c.Snackbar.close("browse-action"),[4,p(T.error.path.details)]):[3,5];case 2:return r.sent()?[4,t.createFolder({user:s,name:a,destination:d,checkFsw:!1,origin:S,surface:E})]:[3,4];case 3:return[2,r.sent()];case 4:return f(S),[2,{type:"cancel"}];case 5:return w.latency.record(),T.isError?("path"===T.error[".tag"]&&"malformed_path"===T.error.path[".tag"]?(c.Snackbar.fail(u.intl.formatMessage(n.createFolderErrorMalformedPath),"browse-action"),w.completed.record(1)):(c.Snackbar.fail(u.intl.formatMessage(n.createFolderErrorGeneric),"browse-action"),w.completed.record(0)),_(T.error_summary,T.error[".tag"],S),[2,{type:"error",summary:T.error_summary,error:T.error[".tag"]}]):(c.Snackbar.complete(u.intl.formatMessage(n.createFolderSnackbarSuccess),"browse-action"),h(S),w.completed.record(1),[2,{type:"success",folder:T.result.metadata}])}}))}))},t.logCreateFolder=function(e){var t=e.uid,r=e.view_type,o=e.origin;a.logWebUserAction({user_id:t,event_name:d.WebUserActionLogEvent.CREATE_FOLDER,view_type:r||null,extra:{origin:o}})},t.logCreateFolderError=_,t.logCreateFolderCancel=f,t.logCreateFolderPending=m,t.logCreateFolderSuccess=h})),define("modules/clean/file_actions/metrics",["require","exports","tslib","modules/clean/metrics/index"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FILE_ACTIONS_AMP_NAMESPACE="web_file_actions",t.bucketForBatchSize=function(e){return 1===e?"single":e<=10?"small":e<=100?"medium":e<=1e3?"large":"massive"},t.batchContentType=function(e){return e.every((function(e){return e.is_dir}))?"folders":e.every((function(e){return!e.is_dir}))?"files":"mixed"};t.recordPathLookupErrors=function(e,n,i){var s={};for(var a in e.forEach((function(e){if("path_lookup"===e.failure[".tag"]){var t=e.failure.path_lookup[".tag"];s[t]=(s[t]||0)+1}})),s)s.hasOwnProperty(a)&&o.getMetricsReporter().createStats({ns:t.FILE_ACTIONS_AMP_NAMESPACE,name:"common/failure/path_lookup"},r.__assign(r.__assign({},i),{lookupFailureType:a,operation:n})).record(s[a])}})),define("modules/clean/file_actions/strings",["require","exports","react-intl"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSnackbarProgressMessage=r.defineMessage({id:"z7/sbf",defaultMessage:"{count, plural, one{Deleting {count} item...} other{Deleting {count} items...}}"}),t.deleteFswConfirmText=r.defineMessage({id:"da2lvf",defaultMessage:"Delete"}),t.deleteUndoSnackbarMessage=r.defineMessage({id:"hCpZct",defaultMessage:"Delete undone."}),t.renameErrorInvalidName=r.defineMessage({id:"KYHY0Z",defaultMessage:"Name was invalid."}),t.renameSnackbarProgressMessage=r.defineMessage({id:"8j6sBp",defaultMessage:"Renaming"}),t.renameFswConfirmText=r.defineMessage({id:"NYv8Vp",defaultMessage:"Rename"}),t.renameUndoSnackbarProgressMessage=r.defineMessage({id:"deJ8cD",defaultMessage:"Undoing rename..."}),t.renameUndoSnackbarErrorMessage=r.defineMessage({id:"n4o67d",defaultMessage:"Undo failed."}),t.renameUndoSnackbarSuccessMessage=r.defineMessage({id:"6RXx/7",defaultMessage:"Rename undone."}),t.renameSnackbarSuccessMessage=r.defineMessage({id:"NqCfwG",defaultMessage:"Renamed 1 item."}),t.createFolderSnackbarProgress=r.defineMessage({id:"U3y3i9",defaultMessage:"Creating folder..."}),t.createFolderErrorMalformedPath=r.defineMessage({id:"HOb8Zp",defaultMessage:'The following characters are not allowed: angle brackets \\ / : ? * " |'}),t.createFolderErrorGeneric=r.defineMessage({id:"qZTFM0",defaultMessage:"Can’t create folder."}),t.createFolderFswConfirmText=r.defineMessage({id:"VDjS9+",defaultMessage:"Create folder"}),t.createFolderSnackbarSuccess=r.defineMessage({id:"1zC4ih",defaultMessage:"Folder created."})})),define("modules/clean/file_operations/notifications",["require","exports","tslib","external/lodash","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath","modules/clean/react/browse/api","modules/clean/undo","modules/core/html","modules/core/i18n","modules/core/notify"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";function p(e,t,r,o){l.notifyWithUndo(e,r,(function(){return a.rollbackChangeSets({changesets:r,userId:t.id,progressText:d.intl.formatMessage({id:"wKzr7W",defaultMessage:"Undoing…"}),onSuccess:function(){u.Notify.success(d.intl.formatMessage({id:"t6mPeQ",defaultMessage:"Undo complete."})),o&&o()}})}))}function _(e,t){var r=n.browse_uri_for_fq_path(t,e),a=i.Emstring.em_snippet(s.filename(e),40);return{href:r,text:o.escape(a)}}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),s=r.__importStar(s),a=r.__importStar(a),l=r.__importStar(l),t.notifyCopySuccess=function(e,t,r,o,n){var i;if(o){var s=_(o,t);i=d.intl.formatMessage({id:"UZ+XVI",defaultMessage:"{count, plural, one{Copied {count} item to {dest}.} other{Copied {count} items to {dest}.}}"},{count:e,dest:'<a href="'+s.href.toString()+'">'+s.text+"</a>"}),i=new c.HTML(i)}else i=d.intl.formatMessage({id:"BDtFp+",defaultMessage:"{count, plural, one{Copied {count} item.} other{Copied {count} items.}}"},{count:e});p(i,t,r,n)},t.notifyMoveSuccess=function(e,t,r,o,n){var i;if(o){var s=_(o,t);i=d.intl.formatMessage({id:"GBu2Ic",defaultMessage:"{count, plural, one{Moved {count} item to {dest}.} other{Moved {count} items to {dest}.}}"},{count:e,dest:'<a href="'+s.href.toString()+'">'+s.text+"</a>"}),i=new c.HTML(i)}else i=d.intl.formatMessage({id:"tFGyx0",defaultMessage:"{count, plural, one{Moved {count} item.} other{Moved {count} items.}}"},{count:e});p(i,t,r,n)},t.notifyDeleteSuccess=function(e,t,r,o){p(d.intl.formatMessage({id:"THAbub",defaultMessage:"{count, plural, one{Deleted {count} item.} other{Deleted {count} items.}}"},{count:e}),t,r,o)},t.notifyRenameSuccess=function(e,t,r){p(d.intl.formatMessage({id:"sAZa2U",defaultMessage:"Rename complete."}),e,t,r)},t.notifyFolderCreationSuccess=function(e,t,r){p(d.intl.formatMessage({id:"ndMNx/",defaultMessage:"Created folder {folder_name}."},{folder_name:e}),t,r)},t.notifyPurgeSuccess=function(e){var t=d.intl.formatMessage({id:"jh+GyF",defaultMessage:"{count, plural, one{Permanently deleted {count} item.} other{Permanently deleted {count} items.}}"},{count:e});u.Notify.success(t)},t.notifyRestoreSuccess=function(e){var t,r=e.length;if(1===r){var n=o.escape(s.filename(e[0].fq_path));t=d.intl.formatMessage({id:"TAukDw",defaultMessage:"Restored <strong>{filename}</strong>."},{strong:function(e){return"<strong>"+e+"</strong>"},filename:n}),t=new c.HTML(t)}else t=d.intl.formatMessage({id:"8N7KT8",defaultMessage:"{count, plural, one{Restored {count} file.} other{Restored {count} files.}}"},{count:r});u.Notify.success(t,30)}})),define("modules/clean/growth/smb_funnel/smb_funnel_logger",["require","exports","tslib","modules/clean/metrics/index","modules/core/exception","apex-metrics"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.WEB="web",e.DESKTOP_SSCV="desktop_sscv",e.MOBILE_WEB="mobile_web"})(t.Platform||(t.Platform={}));var s=["platform","variant"],a=function(e){var t={};return Object.keys(e).forEach((function(r){s.indexOf(r)>=0&&(t[r]=e[r])})),t},l=function(e){var t=this;void 0===e&&(e={}),this.setCommonTags=function(e){var r=a(e);Object.keys(r).forEach((function(r){t.commonTags[r]&&t.commonTags[r]!==e[r]&&n.reportStack("Attempting to change "+r+" after it was already set",{severity:n.SEVERITY.NONCRITICAL,tags:["activation-smb","smb-funnel"]})})),t.commonTags=r},this.log=function(e,o){void 0===o&&(o={});var n=r.__assign(r.__assign({},t.commonTags),o),i=t.metricsReporter.createCounter({ns:"smb_funnel",name:e},n);i.increment(),i.record()},this.logDuration=function(e,o,n){void 0===n&&(n={});var s=r.__assign(r.__assign({},t.commonTags),n);t.metricsReporter.createStats({ns:"smb_funnel",name:e},s).recordDuration(o,i.TimeUnit.MILLISECONDS)},this.commonTags=a(e),this.metricsReporter=o.getMetricsReporter()};t.SMBFunnelLoggerSingleton=l,t.SMBFunnelLogger=new l})),define("modules/clean/react/admin/teams/onboarding/web/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FRAMEWORK="team_setup_essential",t.MODULE_NAME="smooth_transitions",(function(e){e.VERIFICATION="verification",e.RIGHTSIZING="rightsizing",e.TEAM_INFO="team_info",e.MOVE_FOLDERS="move_folders",e.CONFIRM_FOLDERS="confirm_folders",e.RESULTS_FOLDERS="results_folders",e.INVITE_MEMBERS="invite_members",e.SUGGESTED_INVITE_MEMBERS="suggested_invite_members",e.INVITE_MOBILE="invite_mobile",e.INSTALL="install",e.INSTALL_MOBILE="install_mobile",e.ROLE="role",e.COLLABORATION="collaboration",e.LOADING_SCREEN="loading_screen",e.OPEN="team_install_page_open",e.DOWNLOAD="team_install_page_download",e.DOWNLOAD_COMPLETE="download_complete",e.MOBILE_INSTALL="mobile_install",e.JOIN_ACCEPT="join_accept",e.JOIN_LOGIN="join_login",e.JOIN_MOVE_FILES="join_move_files",e.JOIN_PRIVACY_QUESTION="privacy_question",e.JOIN_TWO_ACCOUNT_SUGGESTION="two_account_suggestion",e.JOIN_ONE_ACCOUNT_SUGGESTION="one_account_suggestion",e.JOIN_CREATE_NEW_PERSONAL="create_new_personal",e.JOIN_PERSONAL_VERIFICATION="personal_verification"})(t.Steps||(t.Steps={})),(function(e){e.Inactive="inactive",e.Active="active",e.Completed="completed"})(t.StepStatus||(t.StepStatus={})),(function(e){e.CELADON="celadon",e.CLOUD="cloud",e.ORCHID="orchid",e.SAPPHIRE="sapphire",e.SAND="sand",e.VANILLA="vanilla"})(t.BackgroundColors||(t.BackgroundColors={})),(function(e){e.DESKTOP_WEB="desktop_web",e.DESKTOP_SSCV="desktop_sscv",e.MOBILE_WEB="mobile_web"})(t.Platform||(t.Platform={})),(function(e){e.SETUP_START="setup/start",e.SETUP_FINISH="setup/finish",e.SETUP_STEP_START="setup/step/start",e.SETUP_STEP_FINISH="setup/step/finish",e.SETUP_STEP_ERROR="setup/step/error",e.SETUP_STEP_INTERRUPT="setup/step/interrupt",e.SETUP_STEP_CTA="setup/step/cta",e.SETUP_STEP_FETCH="setup/step/fetch",e.ACTIVATION_IMM_VIEW="activation/imm/view",e.ACTIVATION_IMM_ADD_MEMBERS="activation/imm/add_members",e.ACTIVATION_DESKTOP_ICON_OPEN="activation/desktop_icon/open",e.ACTIVATION_EMPTY_STATE_VIEW="activation/empty_state/view",e.ACTIVATION_SUGGESTED_FOLDER_CREATE="activation/suggested_folder/create",e.ACTIVATION_SUGGESTED_FOLDER_DISMISS="activation/suggested_folder/dismiss",e.ACTIVATION_SUGGESTED_FOLDER_TOGGLE="activation/suggested_folder/toggle",e.ACTIVATION_QUICK_ACTIONS_PANEL_VIEW="activation/quick_actions_panel/view",e.ACTIVATION_QUICK_ACTION_CREATE_CF="activation/quick_action/create_cf",e.ACTIVATION_QUICK_ACTION_REDIRECT="activation/quick_action/redirect",e.ACTIVATION_QUICK_ACTION_SEE_SF="activation/quick_action/see_sf",e.ACTIVATION_QUICK_ACTION_DISMISS="activation/quick_action/dismiss",e.ACTIVATION_COLLECTION_FOLDER_VIEW="activation/collection_folder/view",e.ACTIVATION_COLLECTIONS_ACTION_REDIRECT="activation/collections_action/redirect",e.ACTIVATION_COLLECTIONS_ACTION_UPLOAD="activation/collections_action/upload",e.ACTIVATION_COLLECTIONS_ACTION_CREATE="activation/collections_action/create",e.ACTIVATION_COLLECTIONS_ACTION_PAPER="activation/collections_action/paper",e.ACTIVATION_COLLECTIONS_ACTION_OPEN_DESKTOP="activation/collections_action/open_desktop",e.ACTIVATION_COLLECTIONS_ACTION_OPEN_SETTINGS="activation/collections_action/open_settings",e.ACTIVATION_INVITE_LINK_CREATE="activation/invite_link/create",e.ACTIVATION_MOBILE_LINK_SEND="activation/mobile_link/send",e.ACTIVATION_DESKTOP_LINK_DISMISS="activation/desktop_link/dismiss",e.ACTIVATION_DESKTOP_LINK_INIT="activation/desktop_link/init",e.ACTIVATION_DESKTOP_LINK_SEND="activation/desktop_link/send"})(t.AMPMetrics||(t.AMPMetrics={})),(function(e){e[e.ESSENTIAL_SETUP=1]="ESSENTIAL_SETUP",e[e.PERSONALIZATION=2]="PERSONALIZATION",e[e.MOBILE_WEB_INVITES=3]="MOBILE_WEB_INVITES",e[e.FOLDER_MIGRATION=4]="FOLDER_MIGRATION",e[e.MOBILE_APP_LINKS=5]="MOBILE_APP_LINKS",e[e.P13N_COLLECTIONS=6]="P13N_COLLECTIONS",e[e.PISCES_BIZ_BASIC=7]="PISCES_BIZ_BASIC",e[e.P13N_SF_ITERATION=8]="P13N_SF_ITERATION",e[e.TEAM_JOINER_FLOW=9]="TEAM_JOINER_FLOW",e[e.SPLIT_TMF_TSD=10]="SPLIT_TMF_TSD"})(t.FlowId||(t.FlowId={})),(function(e){e.DEFAULT="",e.WORK="/work",e.ESSENTIAL_SETUP="/team/setup/essential"})(t.ContUrl||(t.ContUrl={}))})),define("modules/clean/react/folder_overview/api",["require","exports","tslib","modules/clean/api_v2/types","modules/clean/api_v2/user_client"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=new n.UserApiV2Client,s=(function(e){function t(t,r){var o=e.call(this,r)||this;return o.user=t,o}return r.__extends(t,e),t.prototype._headers=function(t){var n;return this.user.is_cdm_member&&this.user.is_team_admin&&this.user.team_member_id?r.__assign(((n={})[o.ApiV2HeaderNames.DropboxApiSelectAdmin]=this.user.team_member_id,n),e.prototype._headers.call(this,t)):e.prototype._headers.call(this,t)},t})(n.UserApiV2Client);t.getDescription=function(e,t){return i.ns("files").rpc("get_description_batch",{file_ids:[t]},{subjectUserId:e}).then((function(e){if(!e||!e.items||1!==e.items.length)throw new Error("Unexpected response from get_description_batch");return e.items[0]}))},t.setDescription=function(e,t,r,o,n){return new s(e).ns("files").rpc("set_description",{file_id:t,current_revision_id:r,text:o,format_version:n},{subjectUserId:e.id})},t.getContentReferences=function(e,t){return i.ns("files").rpc("get_content_references_info",{file_id:t},{subjectUserId:e})},t.removeContentReferences=function(e,t,r){return i.ns("files").rpc("remove_content_references",{anchor_file_id:t,return_roots_as_ns_ids:!0,file_ids:r},{subjectUserId:e})},t.addContentReferences=function(e,t,r){return i.ns("files").rpc("add_content_references",{anchor_file_id:t,return_roots_as_ns_ids:!0,file_ids:r},{subjectUserId:e})},t.addContentReferencesToPath=function(e,t,r){return i.ns("files").rpc("add_content_references_to_path",{path:t,return_roots_as_ns_ids:!0,file_ids:r},{subjectUserId:e})},t.getFolderAccess=function(e){var t=e.userId,r=e.sharedFolderId,o=e.accountId,n=e.accountEmail;return i.ns("folder_overview").rpc("has_folder_access",{shared_folder_id:r,account_id:o,account_email:n},{subjectUserId:t})},t.getSharedFolderPath=function(e){var t=e.userId,r=e.sharedFolderId;return i.ns("files").rpc("get_metadata",{path:"ns:"+r},{subjectUserId:t}).then((function(e){return e.is_shareable?e.path_display:void 0}))},t.getLoggingFileId=function(e){var t=e.userId,r=e.path;return i.ns("files").rpc("get_metadata",{path:r},{subjectUserId:t}).then((function(e){return e.id}))},t.isConflictError=function(e){return e.error&&e.error.status&&"conflict"===e.error.status[".tag"]},t.isFormatVersionError=function(e){return e.error&&e.error.status&&"bad_format_version"===e.error.status[".tag"]},t.getUserAccount=function(e){var t=e.userId,r=e.accountId;return i.ns("users").rpc("get_account",{account_id:r},{subjectUserId:t})}})),define("modules/clean/react/folder_overview/async_components",["require","exports","tslib","react","modules/clean/react/async/loadable","modules/clean/react/folder_overview/placeholder"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.AsyncFolderOverviewDescription=n.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/folder_overview/description"],t,r)})).then(r.__importStar).then((function(e){return e.FolderOverviewDescription}))},loading:function(e){return o.default.createElement(i.WrappedFolderOverviewPlaceholder,{showExamples:e.showExamplesInPlaceholder,isReadOnly:e.isReadOnly,showExamplesAsButton:!0})}}),t.AsyncFolderOverviewContentReferences=n.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/folder_overview/content_references"],t,r)})).then(r.__importStar).then((function(e){return e.FolderOverviewContentReferences}))}}),t.AsyncFolderOverviewLastEdit=n.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/folder_overview/last_edit"],t,r)})).then(r.__importStar).then((function(e){return e.FolderOverviewLastEdit}))}}),t.asyncShowOverviewExamples=function(){new Promise((function(t,r){e(["modules/clean/react/folder_overview/examples_modal"],t,r)})).then(r.__importStar).then((function(e){return e.OverviewExamplesModal.show()}))},t.asyncShowPinToModal=function(t){new Promise((function(t,r){e(["modules/clean/react/folder_overview/pin_to_modal"],t,r)})).then(r.__importStar).then((function(e){return e.FolderOverviewPinToModal.show(t)}))}})),define("modules/clean/react/folder_overview/constants",["require","exports","modules/core/i18n","react-intl"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DATA_CACHE_TTL_MS=3e4,t.DESCRIPTION_PLACEHOLDER=r.intl.formatMessage({id:"5wJAeB",defaultMessage:"Click here to describe this folder and turn it into a Space"}),t.DESCRIPTION_PLACEHOLDER_FOR_SPACE=r.intl.formatMessage({id:"uBopyb",defaultMessage:"Click here to describe this Space"}),t.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON=r.intl.formatMessage({id:"PR6SPH",defaultMessage:"Show examples"}),t.DESCRIPTION_PLACEHOLDER_READ_ONLY=r.intl.formatMessage({id:"PYQBlc",defaultMessage:"To edit this overview, ask the folder admin for access"}),t.FOLDER_EXAMPLES_LINK_LABEL=r.intl.formatMessage({id:"PR6SPH",defaultMessage:"Show examples"}),t.FOLDER_EXAMPLES_LINK_URI="https://www.dropbox.com/help/desktop-web/folder-overviews",t.ERROR_DESCRIPTION_CONFLICT=r.intl.formatMessage({id:"ssdefa",defaultMessage:"Can’t save changes. Paste text elsewhere to save, then click Refresh."}),t.ERROR_DESCRIPTION_FORMAT_VERSION=r.intl.formatMessage({id:"5dt0hu",defaultMessage:"Can’t save changes. Reload the page and try again."}),t.ERROR_DESCRIPTION_SAVE=r.intl.formatMessage({id:"PM6K+P",defaultMessage:"Can’t save changes."}),t.ERROR_SHARE_PERSONAL_FOLDER=r.intl.formatMessage({id:"9C/lc5",defaultMessage:"Can’t @mention someone in your Personal Dropbox."}),t.ERROR_SHARE_MEMBER_FOLDER=r.intl.formatMessage({id:"+dhj1b",defaultMessage:"Can’t @mention someone in your member folder."}),t.ERROR_SHARE_NO_PERMISSION=r.intl.formatMessage({id:"b7//2e",defaultMessage:"You don’t have permission to share this folder."}),t.DESCRIPTION_SAVE_DELAY_MS=3e3,t.DESCRIPTION_SAVE_ERROR_DELAY_MS=10*t.DESCRIPTION_SAVE_DELAY_MS,t.OPT_KEY=r.intl.formatMessage({id:"HRXOjw",defaultMessage:"opt"}),t.ALT_KEY=r.intl.formatMessage({id:"RIxWSs",defaultMessage:"alt"}),t.CTRL_KEY=r.intl.formatMessage({id:"FL9yea",defaultMessage:"ctrl"}),t.CMD_KEY=r.intl.formatMessage({id:"NWv/3R",defaultMessage:"⌘"}),t.FOLDER_OVERVIEW_EDITOR_EDITING=r.intl.formatMessage({id:"Kud10T",defaultMessage:"Everyone in this folder can see notes, tasks, and pinned items"}),t.SHARING_MODAL_MESSAGE_SAME_FOLDER=o.defineMessage({id:"xkXFjI",defaultMessage:"Hi {user_name}, I @mentioned you in this folder. Take a look."}),t.SHARING_MODAL_MESSAGE_PARENT_FOLDER=o.defineMessage({id:"YzaJIx",defaultMessage:"Hi {user_name}, I @mentioned you in the {folder_name} folder. Take a look."}),t.SHARING_MODAL_MESSAGE_SAME_FOLDER_NO_NAME=r.intl.formatMessage({id:"sl5Fj7",defaultMessage:"I @mentioned you in this folder. Take a look."}),t.SHARING_MODAL_MESSAGE_PARENT_FOLDER_NO_NAME=o.defineMessage({id:"erm7J0",defaultMessage:"I @mentioned you in the {folder_name} folder. Take a look."}),t.DESCRIPTION_VERSION=[1,0,1],t.PIN_TO_MODAL_TITLE_SINGLE=o.defineMessage({id:"kh62rs",defaultMessage:"Pin “{name}” to..."}),t.PIN_TO_MODAL_TITLE_MULTIPLE=o.defineMessage({id:"oU0z79",defaultMessage:"Pin {num} items to..."}),t.PIN_TO_FAILURE_PERMISSION_DENIED=o.defineMessage({id:"BGyZpk",defaultMessage:"You do not have permission to pin to {path}"}),t.DESCRIPTION_LAST_EDIT_EMPTY_YOU=o.defineMessage({id:"PX5Hq1",defaultMessage:"Deleted {time_ago} by you"}),t.DESCRIPTION_LAST_EDIT_EMPTY=o.defineMessage({id:"7V5b6j",defaultMessage:"Deleted {time_ago} by {name}"}),t.DESCRIPTION_LAST_EDIT_YOU=o.defineMessage({id:"oA46AW",defaultMessage:"Updated {time_ago} by you"}),t.DESCRIPTION_LAST_EDIT=o.defineMessage({id:"MP7zas",defaultMessage:"Updated {time_ago} by {name}"}),t.CONFLICT_POPUP_TITLE=o.defineMessage({id:"PHRYz8",defaultMessage:"Your changes weren’t saved because you and {user} are editing at the same time."}),t.CONFLICT_POPUP_TITLE_YOU=r.intl.formatMessage({id:"tc/4YZ",defaultMessage:"Your changes weren’t saved because you are editing this description elsewhere."}),t.CONFLICT_POPUP_CONTENT=r.intl.formatMessage({id:"4aEgv5",defaultMessage:"Please wait until they’re done before making changes."}),t.CONFLICT_POPUP_CONTENT_YOU=r.intl.formatMessage({id:"oYSO1Z",defaultMessage:"Please save your other changes before making them here."}),t.CONFLICT_POPUP_BUTTON=r.intl.formatMessage({id:"nOO9Qi",defaultMessage:"OK"})})),define("modules/clean/react/folder_overview/controller",["require","exports","tslib","classnames","react","react-redux","retrieval-components/collapsable-section","modules/clean/filepath","modules/clean/react/browse/data/selectors","modules/clean/react/browse/logger","modules/clean/react/browse/uri_helper","modules/clean/react/css","modules/clean/react/files_view/types","modules/clean/react/folder_overview/async_components","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/store","modules/clean/react/folder_overview/live_update","modules/clean/react/folder_overview/logging","modules/clean/react/folder_overview/placeholder","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),a=r.__importStar(a),l=r.__importStar(l),f=r.__importStar(f),m=r.__importStar(m);var b=h.getStoreForFolderOverview();c.browseLogger.registerRowInjector((function(){var e=m.makeFolderNsIdSelector(),t=m.makeDoesFolderOverviewExistSelector(),r=m.makeIsFolderOverviewEmptySelector(),o=m.makeFolderFileIdSelector(),n=b.getState(),i=l.path(n),s=S.extractNsIdAndPath(e(n,{path:i})),a=s.nsPath,c=s.nsId;return{extra:{in_folder_with_overview:t(n,{path:i})&&!r(n,{path:i})?"1":"0",folder_file_id:o(n,{path:i})||null,ns_id:c||null,resource_namespace_path:S.hashPath(a)}}}));var I={updateFolderData:f.updateFolderDataCache,saveFolderData:f.saveFolderPreferences,addLoadedComponent:f.addLoadedComponent,removeLoadedComponent:f.removeLoadedComponent,fetchDataForFolder:f.fetchDataForFolder,reloadDescription:f.reloadDescription,reloadContentReferences:f.reloadContentReferences},y=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleHeaderClick=function(){var e=r.props,t=e.folderFileId,o=e.isOpen;t&&(r.props.updateFolderData({fileId:t,folderData:{isCollapsed:o}}),r.props.saveFolderData({folderFileId:t}),S.logFolderOverviewAction(w.WebUserActionLogEvent.FOLDER_OVERVIEW_TOGGLED,r.props.user.id,null,{opened:o?"0":"1"}))},r.handleLiveUpdate=function(e){var t=e.type,o=r.props,n=o.folderFileId,i=o.componentNamespace;if(n)switch(t){case"description":r.props.reloadDescription({folderFileId:n,componentNamespace:i});break;case"content_references":r.props.reloadContentReferences({folderFileId:n,componentNamespace:i})}},r.shouldRenderFolderOverview=function(e){return!e.shouldHideFolderOverview},r.handlePlaceholderClick=function(){r.setState({showPlaceholder:!1})},r.handleExamplesButtonClick=function(){_.asyncShowOverviewExamples()},r.setContainerRef=function(e){return r.container=e},r.state={showPlaceholder:!0},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,r=t.path,o=t.componentNamespace;(this.props.folderFileId||this.props.folderNsId)&&this.props.fetchDataForFolder({path:r,componentNamespace:o,fetchContentReferences:!0}),g.folderOverviewLiveUpdateManager.addListener("update",this.handleLiveUpdate),this.shouldRenderFolderOverview(this.props)||this.props.addLoadedComponent({componentNamespace:o,component:"draftjs"}),this.props.loadedComponents&&this.props.loadedComponents.includes("description")&&(this.props.descriptionBaseRevision?this.setState({showPlaceholder:!1}):this.props.addLoadedComponent({componentNamespace:o,component:"draftjs"})),v.waitForTTI().then((function(){e.setState({showPlaceholder:!1})}))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.path,r=e.componentNamespace;(!a.paths_are_equal(t,this.props.path)&&(e.folderFileId||e.folderNsId)||!this.props.folderNsId&&!this.props.folderFileId&&e.folderNsId)&&this.props.fetchDataForFolder({path:t,componentNamespace:r,fetchContentReferences:!0}),!this.props.folderFileId&&e.folderFileId&&d.getQueryArgs().folder_overview&&(this.props.updateFolderData({fileId:e.folderFileId,folderData:{isCollapsed:!1}}),this.props.saveFolderData({folderFileId:e.folderFileId}))},t.prototype.componentDidUpdate=function(e){this.container&&this.props.onChangeHeight(this.container.getBoundingClientRect().height),!(e.loadedComponents||[]).includes("description")&&this.props.loadedComponents&&this.props.loadedComponents.includes("description")&&(this.props.descriptionBaseRevision?this.setState({showPlaceholder:!1}):this.props.addLoadedComponent({componentNamespace:this.props.componentNamespace,component:"draftjs"}))},t.prototype.componentWillUnmount=function(){g.folderOverviewLiveUpdateManager.removeListener("update",this.handleLiveUpdate),g.folderOverviewLiveUpdateManager.stop()},t.prototype.render=function(){if(!this.shouldRenderFolderOverview(this.props))return null;var e=!this.props.haveAllComponentsLoaded||this.props.hasFailedToLoad||this.props.browseLoadingState===p.LoadingState.LOADING_FIRST_PAGE;return n.default.createElement("div",{"aria-hidden":e||!this.props.isOpen,className:o.default({"folder-overview":!0,"folder-overview--expanded":this.props.isOpen,"folder-overview--loading":e}),ref:this.setContainerRef},n.default.createElement(s.CollapsableSection,{title:T.intl.formatMessage({id:"OFYmCJ",defaultMessage:"Overview"}),isOpen:this.props.isOpen,onHeaderClick:this.handleHeaderClick,strings:{buttonClose:T.intl.formatMessage({id:"NNi2D+",defaultMessage:"Hide"}),buttonOpen:T.intl.formatMessage({id:"2X0e4z",defaultMessage:"Show"})},containerClassName:o.default({"folder-overview__border":this.props.descriptionHasFocus,"folder-overview__fixed-toolbar-container":!0})},this.state.showPlaceholder?n.default.createElement(E.WrappedFolderOverviewPlaceholder,{showExamples:!0,isReadOnly:this.props.isReadOnly,showExamplesAsButton:!0,onClick:this.handlePlaceholderClick,onExampleButtonClick:this.handleExamplesButtonClick}):n.default.createElement(_.AsyncFolderOverviewDescription,{path:this.props.path,componentNamespace:this.props.componentNamespace,isReadOnly:this.props.isReadOnly||!this.props.descriptionFormatValid,showReadOnlyIcon:!0,descriptionKey:[this.props.folderFileId,this.props.descriptionBaseRevision].join("-"),showExamplesInPlaceholder:!0,shouldHidePlaceholder:!1,limitedWidth:!1,toolbarTopMargin:146,canShareFolder:this.props.canShareFolder}),n.default.createElement(_.AsyncFolderOverviewContentReferences,{path:this.props.path,componentNamespace:this.props.componentNamespace,isReadOnly:this.props.isReadOnly,onNavigateToFileOrFolder:this.props.onNavigateToFileOrFolder}),n.default.createElement(_.AsyncFolderOverviewLastEdit,{path:this.props.path,componentNamespace:this.props.componentNamespace})))},t})(n.default.PureComponent);t.FolderOverviewController=y;var F=i.connect((function(){var e=m.makeHaveAllComponentsLoadedSelector(),t=m.makeHasFailedToLoadSelector(),r=m.makeFolderFileIdSelector(),o=m.makeFolderNsIdSelector(),n=m.makeLoadedComponentsSelector(),i=m.makeIsCollapsedSelector(),s=m.makeDescriptionBaseRevisionSelector(),a=m.makeDescriptionHasFocusSelector(),l=m.makeDescriptionFormatValidSelector(),c=m.makeDoesFolderOverviewExistSelector();return function(d,u){return{user:m.user(d),haveAllComponentsLoaded:e(d,u),hasFailedToLoad:!!t(d,u),loadedComponents:n(d,u),folderFileId:r(d,u),folderNsId:o(d,u),isOpen:!i(d,u),descriptionBaseRevision:s(d,u),descriptionFormatValid:l(d,u),doesFolderOverviewExist:c(d,u),descriptionHasFocus:a(d,u)}}}),I)(y);t.FolderOverview=u.requireCssWithComponent(F,["/static/css/browse/folder_overview-vfl53GDaS.css","/static/js/comments2/index.web-vfl1j5gMw.css","/static/js/retrieval-components/index.web-vfl3U9nJm.css"])})),define("modules/clean/react/folder_overview/data/action_creators",["require","exports","tslib","modules/clean/filepath","modules/clean/react/browse/data/selectors","modules/clean/react/folder_overview/api","modules/clean/react/folder_overview/constants","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/types","modules/clean/react/folder_overview/errors","modules/clean/react/folder_overview/live_update","modules/clean/react/folder_overview/logging","modules/clean/react/folder_overview/utils","modules/clean/react/snackbar","modules/clean/storage","modules/clean/viewer","modules/clean/web_user_action_events","modules/core/exception","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importStar(i),a=r.__importStar(a),p=r.__importStar(p),g=r.__importStar(g),t.fetchDataForFolder=function(e){var o=e.path,n=e.nsId,c=e.componentNamespace,d=e.fetchContentReferences;return function(e,u){return r.__awaiter(void 0,void 0,void 0,(function(){var _,f,m,h,S,E,v,w,I,y,F,C,O,A,P;return r.__generator(this,(function(r){switch(r.label){case 0:f=!1,m=p.normalizePath(o),h=Date.now(),(S=a.componentDataCache(u())[c])&&0!==S.requiredComponents.length||(E=d?["content_references","description","draftjs"]:["description","draftjs"],e(t.setRequiredComponents({componentNamespace:c,requiredComponents:E}))),v=[],r.label=1;case 1:if(r.trys.push([1,3,,4]),w=a.user(u()).id,_=a.fileIdCache(u())[m],!(I=_||a.nsIdCache(u())[m]||n))throw new Error("Unable to get file ID or NS ID for current folder");return e(t.setFailedToLoad({componentNamespace:c,hasFailedToLoad:!1})),(y=_?a.folderDataCache(u())[_]:void 0)&&y.descriptionLastUpdated&&h-y.descriptionLastUpdated<s.DATA_CACHE_TTL_MS?(f=!!y.descriptionBaseRevision,e(t.addLoadedComponent({componentNamespace:c,component:"description"})),v.push(Promise.resolve(null))):(e(t.removeLoadedComponent({componentNamespace:c,component:"description"})),v.push(i.getDescription(w,I))),y&&y.contentReferencesLastUpdated&&h-y.contentReferencesLastUpdated<s.DATA_CACHE_TTL_MS?(e(t.addLoadedComponent({componentNamespace:c,component:"content_references"})),v.push(Promise.resolve(null))):d&&(e(t.removeLoadedComponent({componentNamespace:c,component:"content_references"})),v.push(i.getContentReferences(w,I))),[4,Promise.all(v)];case 2:if(F=r.sent(),C=F[0],O=F[1],C&&(_=C.file_obj_id),!_)throw new Error("Did not get a file ID from the Sprinkle description payload");return e({type:l.ActionTypes.UPDATE_FILE_ID_CACHE,payload:{fileIdCache:(P={},P[p.normalizePath(o)]=_,P)}}),f=!!C&&T(e,_,C,c,h),O&&b(e,_,O,f,c,h),(y=a.folderDataCache(u())[_])&&y.sharedFolderPath||e(t.fetchSharedFolderName({path:o})),y&&y.loggingFileId||e(t.fetchLoggingFileId({path:o})),e(t.loadFolderPreferences({folderFileId:_})),[3,4];case 3:return A=r.sent(),g.reportException({err:A,severity:"non-critical",exc_extra:{path:o}}),e(t.setFailedToLoad({componentNamespace:c,hasFailedToLoad:!0})),[3,4];case 4:return[2]}}))}))}},t.handlePrefetch=function(e){var o=e.path,n=e.content_references,i=e.description,s=e.componentNamespace,a=e.ts,c=void 0===a?Date.now():a;return function(e){return r.__awaiter(void 0,void 0,void 0,(function(){var a,d,u,_,f;return r.__generator(this,(function(r){try{if(d=n||{},!(u=(a=i||{}).file_obj_id))throw new Error("Did not get a file ID from the Odyssey prefetch payload");e({type:l.ActionTypes.UPDATE_FILE_ID_CACHE,payload:{fileIdCache:(f={},f[p.normalizePath(o)]=u,f)}}),_=a&&T(e,u,a,s,c),d&&d&&b(e,u,d,_,s,c)}catch(r){g.reportException({err:r,severity:"non-critical",exc_extra:{path:o}}),e(t.setFailedToLoad({componentNamespace:s,hasFailedToLoad:!0}))}return[2]}))}))}},t.loadFolderPreferences=function(e){var o=e.folderFileId;return function(e,n){return r.__awaiter(void 0,void 0,void 0,(function(){var i,s;return r.__generator(this,(function(r){return i=a.user(n()).id,f.UserLocalStorage.clearOtherUsers([i]),(s=f.UserLocalStorage.get(i,"folder-overview-"+o))?(e(t.updateFolderDataCache({fileId:o,folderData:s})),[2]):[2]}))}))}},t.saveFolderPreferences=function(e){var t=e.folderFileId;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(r){return e=a.user(o()).id,f.UserLocalStorage.clearOtherUsers([e]),(n=a.folderDataCache(o())[t])?(f.UserLocalStorage.set(e,"folder-overview-"+t,{isCollapsed:n.isCollapsed}),[2]):[2]}))}))}},t.addLoadedComponent=function(e){var t=e.componentNamespace,r=e.component;return{type:l.ActionTypes.ADD_LOADED_COMPONENT,payload:{componentNamespace:t,component:r}}},t.removeLoadedComponent=function(e){var t=e.componentNamespace,r=e.component;return{type:l.ActionTypes.REMOVE_LOADED_COMPONENT,payload:{componentNamespace:t,component:r}}},t.setFailedToLoad=function(e){var t=e.componentNamespace,r=e.hasFailedToLoad;return{type:l.ActionTypes.SET_FAILED_TO_LOAD,payload:{componentNamespace:t,hasFailedToLoad:r}}},t.setDescriptionData=function(e,r,o){var n=e.text,i=e.latest_revision_id,s=e.file_obj_id,a=e.bolt_channel_state,c=e.format_version,d=e.last_modified_time,u=e.last_modified_user;if(!s)throw new Error("Unexpected response from Sprinkle");var p=i||"";r(t.updateFolderDataCache({fileId:s,folderData:{description:n,descriptionBaseRevision:p,descriptionDraft:void 0,descriptionSaveState:l.DescriptionSaveState.IDLE,descriptionFormatVersion:c,descriptionBoltChannelState:a,descriptionLastUpdated:Date.now()}})),r(t.addLoadedComponent({componentNamespace:o,component:"description"})),r(v({folderFileId:s,time:d,userId:u})),t.subscribeToBolt("description",a)},t.reloadDescription=function(e){var o=e.folderFileId,n=e.componentNamespace;return function(e,s){return r.__awaiter(void 0,void 0,void 0,(function(){var l,c,d;return r.__generator(this,(function(r){switch(r.label){case 0:l=a.user(s()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getDescription(l.id,o)];case 2:return c=r.sent(),e(t.updateFolderDataCache({fileId:o,folderData:{descriptionBaseRevision:""}})),t.setDescriptionData(c,e,n),[3,4];case 3:return d=r.sent(),g.reportException({err:d,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"],exc_extra:{fileId:o,isReload:!0}}),[3,4];case 4:return[2]}}))}))}},t.saveDescriptionDraft=function(e){var o=e.folderFileId,n=e.componentNamespace;return function(e,d){return r.__awaiter(void 0,void 0,void 0,(function(){function p(r){e(t.updateFolderDataCache({fileId:o,folderData:r}))}var f,m,g,v,T,b,I,y,F,C,O,A;return r.__generator(this,(function(t){switch(t.label){case 0:f=a.user(d()),t.label=1;case 1:return t.trys.push([1,3,,4]),m=a.folderDataCache(d()),(g=m[o])&&E(g)?(p({descriptionSaveState:l.DescriptionSaveState.SAVING}),[4,i.setDescription(f,o,g.descriptionLatestRevision,g.descriptionDraft,s.DESCRIPTION_VERSION.join("."))]):[2];case 2:return v=t.sent(),T=g.description?S.intl.formatMessage({id:"BV1uZg",defaultMessage:"Folder overview changed."}):S.intl.formatMessage({id:"MLktc7",defaultMessage:"Folder overview added."}),_.Snackbar.generic(T,"folder-overview-change"),b=v.text,I=v.latest_revision_id,y=v.last_modified_time,F=v.last_modified_user,p({description:b,descriptionSaveState:l.DescriptionSaveState.IDLE,lastModifiedTime:y,lastModifiedUserId:F,descriptionBaseRevision:I,descriptionLatestRevision:I}),C="BROWSE"===n?h.ActionSurfaceLogValue.CENTER_PANE:h.ActionSurfaceLogValue.RIGHT_SIDEBAR,O="search-sidebar"===n?h.RetrievalSourceValue.SEARCH:h.RetrievalSourceValue.BROWSE,u.logOverviewEdited({folderFileId:o,action_surface:C,retrievalSource:O,loggingFileId:g.loggingFileId}),[3,4];case 3:return A=t.sent(),i.isConflictError(A)?(p({descriptionSaveState:l.DescriptionSaveState.CONFLICT,lastModifiedUserId:void 0}),e(w({folderFileId:o}))):i.isFormatVersionError(A)?(c.showDescriptionFormatError(),p({descriptionSaveState:l.DescriptionSaveState.ERROR})):(c.showDescriptionSaveError(),p({descriptionSaveState:l.DescriptionSaveState.ERROR})),[3,4];case 4:return[2]}}))}))}},t.setContentReferencesData=function(e,r,o,n){var i=r.content_references||[],s=r.latest_revision_id,a=r.last_modified_time,l=r.last_modified_user;o(t.updateFolderDataCache({fileId:e,folderData:{contentReferences:i,contentReferencesRevision:s,contentReferencesBoltChannelState:r.bolt_channel_state,contentReferencesLastUpdated:Date.now()}})),o(v({folderFileId:e,time:a,userId:l})),o(t.addLoadedComponent({componentNamespace:n,component:"content_references"})),t.subscribeToBolt("content_references",r.bolt_channel_state)},t.reloadContentReferences=function(e){var o=e.folderFileId,n=e.componentNamespace;return function(e,s){return r.__awaiter(void 0,void 0,void 0,(function(){var l,c,d;return r.__generator(this,(function(r){switch(r.label){case 0:l=a.user(s()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getContentReferences(l.id,o)];case 2:return c=r.sent(),t.setContentReferencesData(o,c,e,n),[3,4];case 3:return d=r.sent(),g.reportException({err:d,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"],exc_extra:{fileId:o,isReload:!0}}),[3,4];case 4:return[2]}}))}))}},t.addContentReferences=function(e){var o=e.folderFileId,n=e.fileIds,s=e.componentNamespace;return function(e,l){return r.__awaiter(void 0,void 0,void 0,(function(){var c,d,p,_,f,m;return r.__generator(this,(function(r){switch(r.label){case 0:if(null===n||0===n.length)return[2];c=a.user(l()).id,d=a.folderDataCache(l())[o],p=d&&d.loggingFileId,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.addContentReferences(c,o,n)];case 2:return r.sent(),e(t.reloadContentReferences({folderFileId:o,componentNamespace:s})),_="BROWSE"===s?h.ActionSurfaceLogValue.CENTER_PANE:h.ActionSurfaceLogValue.RIGHT_SIDEBAR,f="search-sidebar"===s?h.RetrievalSourceValue.SEARCH:h.RetrievalSourceValue.BROWSE,u.logOverviewEdited({folderFileId:o,action_surface:_,retrievalSource:f,loggingFileId:p}),[3,4];case 3:return m=r.sent(),g.reportException({err:m,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}}))}))}},t.addContentReferencesForPath=function(e){var n=e.path,l=e.files,c=e.currentPath;return function(e,d){return r.__awaiter(void 0,void 0,void 0,(function(){var u,f,h;return r.__generator(this,(function(r){switch(r.label){case 0:u=a.user(d()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.addContentReferencesToPath(u.id,n,l.map(p.fileToContentReferenceId))];case 2:return r.sent(),c!==n&&_.Snackbar.complete(S.intl.formatMessage({id:"Mflc9Z",defaultMessage:"{count, plural, one{Pinned {count} item to {folder}.} other{Pinned {count} items to {folder}.}}"},{count:l.length,folder:o.filename(n,m.Viewer.get_root_name(u))}),"folder-overview-pin"),(f=a.fileIdCache(d())[p.normalizePath(n)])&&e(t.reloadContentReferences({folderFileId:f,componentNamespace:"BROWSE"})),[3,4];case 3:h=r.sent(),g.reportException({err:h,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]});try{if("permission_denied"===h.error.status[".tag"])return _.Snackbar.fail(S.intl.formatMessage(s.PIN_TO_FAILURE_PERMISSION_DENIED,{file:o.filename(l[0].fq_path),path:o.filename(n,m.Viewer.get_root_name(u))}),"folder-overview-pin"),[2]}catch(e){}return _.Snackbar.fail(S.intl.formatMessage({id:"LYVKP8",defaultMessage:"{count, plural, one{Failed to pin {count} item to {folder}.} other{Failed to pin {count} items to {folder}.}}"},{count:l.length,folder:o.filename(n,m.Viewer.get_root_name(u))}),"folder-overview-pin"),[3,4];case 4:return[2]}}))}))}},t.removeContentReferences=function(e){var o=e.folderFileId,n=e.fileIds,s=e.componentNamespace;return function(e,l){return r.__awaiter(void 0,void 0,void 0,(function(){var c,d,p,f,m,E;return r.__generator(this,(function(r){switch(r.label){case 0:c=a.user(l()).id,d=a.folderDataCache(l())[o],p=d&&d.loggingFileId,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.removeContentReferences(c,o,n)];case 2:return r.sent(),_.Snackbar.generic(S.intl.formatMessage({id:"0bkx9E",defaultMessage:"{count, plural, one{Unpinned {count} item.} other{Unpinned {count} items.}}"},{count:n.length}),"folder-overview-unpin"),e(t.reloadContentReferences({folderFileId:o,componentNamespace:s})),f="BROWSE"===s?h.ActionSurfaceLogValue.CENTER_PANE:h.ActionSurfaceLogValue.RIGHT_SIDEBAR,m="search-sidebar"===s?h.RetrievalSourceValue.SEARCH:h.RetrievalSourceValue.BROWSE,u.logOverviewEdited({folderFileId:o,action_surface:f,retrievalSource:m,loggingFileId:p}),[3,4];case 3:return E=r.sent(),g.reportException({err:E,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}}))}))}},t.updateFolderDataCache=function(e){var t=e.fileId,r=e.folderData;return{type:l.ActionTypes.UPDATE_FOLDER_DATA_CACHE,payload:{fileId:t,folderData:r}}},t.setRequiredComponents=function(e){var t=e.componentNamespace,r=e.requiredComponents;return{type:l.ActionTypes.SET_REQUIRED_COMPONENTS,payload:{componentNamespace:t,requiredComponents:r}}},t.setDescriptionHasFocus=function(e){var r=e.componentNamespace,o=e.descriptionHasFocus,n=e.folderFileId;return function(e,i){var s=a.componentDataCache(i())[r];if(o&&s&&!s.descriptionHasFocus){var c=a.folderDataCache(i())[n].descriptionBaseRevision;e(t.updateFolderDataCache({fileId:n,folderData:{descriptionLatestRevision:c}}))}e({type:l.ActionTypes.SET_DESCRIPTION_HAS_FOCUS,payload:{componentNamespace:r,descriptionHasFocus:o}})}};var E=function(e){return!!e&&(e.descriptionSaveState!==l.DescriptionSaveState.CONFLICT&&(e.descriptionSaveState!==l.DescriptionSaveState.SAVING&&p.hasUnsavedDescriptionDraft(e)))};t.fetchSharedFolderName=function(e){var n=e.path;return function(e,s){return r.__awaiter(void 0,void 0,void 0,(function(){var l,c,d,u,_,f,m;return r.__generator(this,(function(r){switch(r.label){case 0:if(o.paths_are_equal(n,"/"))return[2];if(l=p.normalizePath(n),!(c=a.nsIdCache(s())[l]))return[2];if(d=a.fileIdCache(s())[l],u=a.user(s()).id,!(_=p.extractSharedFolderId(c)))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getSharedFolderPath({userId:u,sharedFolderId:_})];case 2:return f=r.sent(),e(t.updateFolderDataCache({fileId:d,folderData:{sharedFolderPath:f}})),[3,4];case 3:return m=r.sent(),g.reportException({err:m,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}}))}))}},t.fetchAccountForUserId=function(e){var t=e.accountId;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){var n,s,c;return r.__generator(this,(function(r){switch(r.label){case 0:return n=a.user(o()),t?t in a.accountCache(o())?[2]:t===n.account_id?[2]:[4,i.getUserAccount({userId:n.id,accountId:t})]:[2];case 1:return s=r.sent(),e({type:l.ActionTypes.UPDATE_ACCOUNT_CACHE,payload:{accountCache:(c={},c[t]=s,c)}}),[2]}}))}))}},t.fetchLoggingFileId=function(e){var s=e.path;return function(e,l){return r.__awaiter(void 0,void 0,void 0,(function(){var c,d,u,_,f;return r.__generator(this,(function(r){switch(r.label){case 0:if(o.paths_are_equal(s,"/"))return[2];if(o.paths_are_equal(n.context(l()).currentFQPath,s)&&!n.context(l()).currentNSPath)return[2];c=p.normalizePath(s),d=a.fileIdCache(l())[c],u=a.user(l()).id,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getLoggingFileId({userId:u,path:c})];case 2:return _=r.sent(),e(t.updateFolderDataCache({fileId:d,folderData:{loggingFileId:_}})),[3,4];case 3:return f=r.sent(),g.reportException({err:f,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}}))}))}};var v=function(e){var r=e.folderFileId,o=e.time,n=e.userId;return function(e,i){if(o&&n){var s=a.folderDataCache(i())[r];s&&(s.lastModifiedTime&&o<s.lastModifiedTime||(e(t.updateFolderDataCache({fileId:r,folderData:{lastModifiedTime:o,lastModifiedUserId:n}})),e(t.fetchAccountForUserId({accountId:n}))))}}};t.subscribeToBolt=function(e,t){if(void 0!==t)try{var r=t.channel_id,o=t.revision,n=t.token;if(void 0===r||void 0===o||void 0===n)return;var i=r.unique_id,s=r.app_id;if(void 0===i||void 0===s)return;d.folderOverviewLiveUpdateManager.setUpdateChannelForType(e,{uniqueId:i,appId:s,token:n,revision:""+o})}catch(e){g.reportException({err:e,severity:g.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]})}};var w=function(e){var t=e.folderFileId;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){var n,s,l,c;return r.__generator(this,(function(r){switch(r.label){case 0:return n=a.user(o()),[4,i.getDescription(n.id,t)];case 1:return s=r.sent(),l=s.last_modified_time,c=s.last_modified_user,e(v({folderFileId:t,time:l,userId:c})),[2]}}))}))}},T=function(e,r,o,n,i){return o.latest_revision_id?(t.setDescriptionData(o,e,n),!0):(e(t.addLoadedComponent({componentNamespace:n,component:"description"})),e(t.updateFolderDataCache({fileId:r,folderData:{descriptionBoltChannelState:o.bolt_channel_state,descriptionLastUpdated:i}})),t.subscribeToBolt("description",o.bolt_channel_state),!1)},b=function(e,r,o,n,i,s){return o.latest_revision_id?(t.setContentReferencesData(r,o,e,i),!0):(e(t.updateFolderDataCache({fileId:r,folderData:{contentReferences:[],contentReferencesBoltChannelState:o.bolt_channel_state,contentReferencesLastUpdated:s}})),e(t.addLoadedComponent({componentNamespace:i,component:"content_references"})),!1)}})),define("modules/clean/react/folder_overview/data/reducer",["require","exports","tslib","modules/clean/react/browse/data/types","modules/clean/react/browse/models","modules/clean/react/folder_overview/data/types","modules/clean/react/folder_overview/utils","modules/clean/search/single_page/data/types"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFolderOverviewState={folderDataCache:{},fileIdCache:{},accountCache:{},nsIdCache:{},componentDataCache:{}};var l=function(e,t){var r=e.componentDataCache[t];return r||{requiredComponents:[],loadedComponents:[],hasFailedToLoad:!1,descriptionHasFocus:!1}},c=function(e){var t={};return e.forEach((function(e){t[s.normalizePath(e.fq_path)]=e.target_ns?"ns:"+e.target_ns+"/":"ns:"+e.ns_id+"/"+e.ns_path})),t};t.folderOverviewReducer=function(e,d){switch(void 0===e&&(e=t.defaultFolderOverviewState),d.type){case i.ActionTypes.UPDATE_FOLDER_DATA_CACHE:return(function(e,t){var o,n=t.fileId,i=t.folderData;return r.__assign(r.__assign({},e),{folderDataCache:r.__assign(r.__assign({},e.folderDataCache),(o={},o[n]=r.__assign(r.__assign({},e.folderDataCache[n]),i),o))})})(e,d.payload);case i.ActionTypes.UPDATE_FILE_ID_CACHE:return(function(e,t){var o=t.fileIdCache;return r.__assign(r.__assign({},e),{fileIdCache:r.__assign(r.__assign({},e.fileIdCache),o)})})(e,d.payload);case i.ActionTypes.UPDATE_ACCOUNT_CACHE:return(function(e,t){var o=t.accountCache;return r.__assign(r.__assign({},e),{accountCache:r.__assign(r.__assign({},e.accountCache),o)})})(e,d.payload);case i.ActionTypes.SET_REQUIRED_COMPONENTS:return(function(e,t){var o,n=t.componentNamespace,i=t.requiredComponents,s=l(e,n);return r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(o={},o[n]=r.__assign(r.__assign({},s),{requiredComponents:i}),o))})})(e,d.payload);case o.ActionTypes.SET_CONTEXT:return(function(e,t){var o,n=t.context;return r.__assign(r.__assign({},e),{nsIdCache:r.__assign(r.__assign({},e.nsIdCache),(o={},o[s.normalizePath(n.currentFQPath)]="ns:"+n.currentNSID+"/"+n.currentNSPath,o))})})(e,d.payload);case i.ActionTypes.REMOVE_LOADED_COMPONENT:return(function(e,t){var o,n=t.componentNamespace,i=t.component,s=l(e,n),a=s.loadedComponents;return r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(o={},o[n]=r.__assign(r.__assign({},s),{loadedComponents:a.filter((function(e){return e!==i}))}),o))})})(e,d.payload);case i.ActionTypes.ADD_LOADED_COMPONENT:return(function(e,t){var o,n=t.componentNamespace,i=t.component,s=l(e,n),a=s.loadedComponents;return a.includes(i)?e:r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(o={},o[n]=r.__assign(r.__assign({},s),{loadedComponents:r.__spreadArrays(a,[i])}),o))})})(e,d.payload);case i.ActionTypes.SET_FAILED_TO_LOAD:return(function(e,t){var o,n=t.componentNamespace,i=t.hasFailedToLoad,s=l(e,n);return r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(o={},o[n]=r.__assign(r.__assign({},s),{hasFailedToLoad:i}),o))})})(e,d.payload);case i.ActionTypes.SET_DESCRIPTION_HAS_FOCUS:return(function(e,t){var o,n=t.componentNamespace,i=t.descriptionHasFocus,s=l(e,n);return r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(o={},o[n]=r.__assign(r.__assign({},s),{descriptionHasFocus:i}),o))})})(e,d.payload);case o.ActionTypes.SET_UNSORTED_FILES:return(function(e,t){var o=t.unsortedFiles.filter((function(e){return e.is_dir})).toArray();return r.__assign(r.__assign({},e),{nsIdCache:r.__assign(r.__assign({},e.nsIdCache),c(o))})})(e,d.payload);case a.ActionTypes.SET_RESULTS:case a.ActionTypes.APPEND_RESULTS:return(function(e,t){var o=t.searchResults.results.filter((function(e){return e instanceof n.File&&e.is_dir}));return r.__assign(r.__assign({},e),{nsIdCache:r.__assign(r.__assign({},e.nsIdCache),c(o))})})(e,d.payload)}return e}})),define("modules/clean/react/folder_overview/data/selectors",["require","exports","tslib","reselect","modules/clean/filepath","modules/clean/react/folder_overview/constants","modules/clean/react/folder_overview/data/reducer","modules/clean/react/folder_overview/utils","comments2/components/folder_overview_utils","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/user"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),a=r.__importStar(a);var p=[],_=function(e){return d.getStateAtNamespace(e,c.FOLDER_OVERVIEW_NAMESPACE_KEY)||s.defaultFolderOverviewState};t.folderDataCache=function(e){return _(e).folderDataCache},t.fileIdCache=function(e){return _(e).fileIdCache};var f=function(e,r){return t.fileIdCache(e)[a.normalizePath(r.path)]};t.nsIdCache=function(e){return _(e).nsIdCache};var m=function(e,r){return t.nsIdCache(e)[a.normalizePath(r.path)]};t.accountCache=function(e){return _(e).accountCache},t.componentDataCache=function(e){return _(e).componentDataCache},t.user=function(e){return e.BROWSE&&e.BROWSE.user||u.mkUser(e.SEARCH.user)};var h=function(e,r){return t.componentDataCache(e)[r.componentNamespace]},g=function(e,r){var o=f(e,r);return t.folderDataCache(e)[o]},S=function(e,t){var r=g(e,t);return r?r.sharedFolderPath||t.path:void 0},E=function(e,t){var r=g(e,t);return r?r.lastModifiedUserId:void 0},v=o.createSelector(g,(function(e){return e?e.descriptionFormatVersion:void 0})),w=o.createSelector(g,(function(e){if(e&&e.description)try{return JSON.parse(e.description)}catch(e){return}})),T=o.createSelector(g,(function(e){if(void 0!==e&&void 0!==e.contentReferences)return 0===e.contentReferences.length?p:a.convertContentReferencesToSortedFiles(e.contentReferences)})),b=o.createSelector(w,l.isEmptyDescription);t.makeLoadedComponentsSelector=function(){return o.createSelector(h,(function(e){return e?e.loadedComponents:void 0}))},t.makeHaveAllComponentsLoadedSelector=function(){return o.createSelector(h,(function(e){return!(!e||0===e.requiredComponents.length)&&0===e.requiredComponents.filter((function(t){return!e.loadedComponents.includes(t)})).length}))},t.makeHasFailedToLoadSelector=function(){return o.createSelector(h,(function(e){return!!e&&e.hasFailedToLoad}))},t.makeDescriptionHasFocusSelector=function(){return o.createSelector(h,(function(e){return!!e&&e.descriptionHasFocus}))},t.makeFolderFileIdSelector=function(){return o.createSelector(f,(function(e){return e}))},t.makeFolderNsIdSelector=function(){return o.createSelector(m,(function(e){return e}))},t.makeSharedFolderIdSelector=function(){return o.createSelector(m,(function(e){if(e)return a.extractSharedFolderId(e)}))},t.descriptionAuthorSelector=o.createSelector(t.user,a.convertDbxUserToIUser),t.makeIsCollapsedSelector=function(){return o.createSelector(g,(function(e){return!!e&&!!e.isCollapsed}))},t.makeDescriptionBaseRevisionSelector=function(){return o.createSelector(g,(function(e){return e?e.descriptionBaseRevision:void 0}))},t.makeLastModifiedTimeSelector=function(){return o.createSelector(g,(function(e){return e?e.lastModifiedTime:void 0}))},t.makeLastModifiedUserIdSelector=function(){return o.createSelector(E,(function(e){return e}))},t.makeLastModifiedUserSelector=function(){return o.createSelector(E,t.accountCache,(function(e,t){return e?t[e]:void 0}))},t.makeDescriptionSaveStateSelector=function(){return o.createSelector(g,(function(e){return e?e.descriptionSaveState:void 0}))},t.makeDescriptionFormatValidSelector=function(){return o.createSelector(v,(function(e){if(!e)return!0;var t=e.split(".").map((function(e){return parseInt(e,10)}));return!(t[0]>i.DESCRIPTION_VERSION[0])&&!(t[0]===i.DESCRIPTION_VERSION[0]&&t[1]>i.DESCRIPTION_VERSION[1])}))},t.makeHasUnsavedDescriptionDraftSelector=function(){return o.createSelector(g,a.hasUnsavedDescriptionDraft)},t.makeSharedFolderPathSelector=function(){return o.createSelector(S,(function(e){return e}))},t.makeSharedFolderNameSelector=function(){return o.createSelector(S,(function(e){return e?n.filename(e):void 0}))},t.makeLoggingFileIdSelector=function(){return o.createSelector(g,(function(e){return e?e.loggingFileId:void 0}))},t.makeDescriptionContentSelector=function(){return o.createSelector(w,(function(e){return e}))},t.makePinnedItemsSelector=function(){return o.createSelector(T,(function(e){return e}))},t.makeIsFolderOverviewEmptySelector=function(){return o.createSelector(b,T,(function(e,t){return e&&!(t&&t.length)}))},t.makeIsSpaceSelector=function(){return o.createSelector(b,T,(function(e,t){return!e||!(!t||!t.length)}))},t.makeDoesFolderOverviewExistSelector=function(){return o.createSelector(g,(function(e){return!!e&&(!!e.descriptionBaseRevision||!!e.contentReferencesRevision)}))}})),define("modules/clean/react/folder_overview/data/store",["require","exports","modules/clean/react/folder_overview/data/reducer","modules/clean/redux/store","modules/clean/redux/namespaces"],(function(e,t,r,o,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForFolderOverview=function(){var e;return i||(i=o.getStoreAndRegisterReducers(((e={})[n.FOLDER_OVERVIEW_NAMESPACE_KEY]=r.folderOverviewReducer,e))),i}})),define("modules/clean/react/folder_overview/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.UPDATE_FOLDER_DATA_CACHE="FOLDER_OVERVIEW/UPDATE_FOLDER_DATA_CACHE",e.UPDATE_FILE_ID_CACHE="FOLDER_OVERVIEW/UPDATE_FILE_ID_CACHE",e.REMOVE_LOADED_COMPONENT="FOLDER_OVERVIEW/REMOVE_LOADED_COMPONENT",e.ADD_LOADED_COMPONENT="FOLDER_OVERVIEW/ADD_LOADED_COMPONENT",e.SET_FAILED_TO_LOAD="FOLDER_OVERVIEW/SET_FAILED_TO_LOAD",e.SET_DESCRIPTION_HAS_FOCUS="FOLDER_OVERVIEW/SET_DESCRIPTION_HAS_FOCUS",e.UPDATE_ACCOUNT_CACHE="FOLDER_OVERVIEW/UPDATE_ACCOUNT_CACHE",e.SET_REQUIRED_COMPONENTS="FOLDER_OVERVIEW/SET_REQUIRED_COMPONENTS"})(t.ActionTypes||(t.ActionTypes={})),(function(e){e.IDLE="IDLE",e.SAVING="SAVING",e.CONFLICT="CONFLICT",e.ERROR="ERROR"})(t.DescriptionSaveState||(t.DescriptionSaveState={}))})),define("modules/clean/react/folder_overview/errors",["require","exports","modules/clean/react/folder_overview/constants","modules/clean/react/snackbar"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDescriptionFormatError=function(){o.Snackbar.fail(r.ERROR_DESCRIPTION_FORMAT_VERSION,"folder-overview")},t.showDescriptionSaveError=function(){o.Snackbar.fail(r.ERROR_DESCRIPTION_SAVE,"folder-overview")}})),define("modules/clean/react/folder_overview/live_update",["require","exports","tslib","external/lodash","eventemitter3","modules/clean/bolt"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var s=(function(e){function t(){var t=e.call(this)||this;return t.setUpdateChannelForType=function(e,r){t.signedChannelStates[e]=new i.SignedChannelState(r.appId,r.uniqueId,r.revision,r.token),t.boltClient.update_states(o.values(t.signedChannelStates)),t.boltClient.start()},t.handleUpdate=function(e){var r=[];e.forEach((function(e){var n=o.findKey(t.signedChannelStates,{app_id:e.app_id,unique_id:e.unique_id});n&&!r.includes(n)&&(t.emit("update",{type:n}),r.push(n))}))},t.handleRefresh=function(){t.boltClient.update_states(o.values(t.signedChannelStates))},t.boltClient=new i.BoltClient([],t.handleUpdate,t.handleRefresh),t.signedChannelStates={},t}return r.__extends(t,e),t.prototype.stop=function(){this.boltClient.unsubscribe()},t})((n=r.__importDefault(n)).default);t.FolderOverviewLiveUpdateManager=s,t.folderOverviewLiveUpdateManager=new s})),define("modules/clean/react/folder_overview/logging",["require","exports","tslib","sjcl","immutable","modules/clean/filepath","modules/clean/logging/hive/schemas/web-user-action","modules/clean/logging/telemetry","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/store","modules/clean/react/folder_overview/utils","modules/clean/web_user_action_events"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";function p(e){return e.blocks.map((function(e){return e.text.length})).reduce((function(e,t){return e+t}),0)}function _(e){var t=n.OrderedSet();return t=t.merge(e.blocks.map((function(e){return e.type})).filter((function(e){return"unstyled"!==e}))),e.blocks.forEach((function(e){return e.inlineStyleRanges.forEach((function(e){t=t.add(e.style)}))})),e.blocks.forEach((function(r){return r.entityRanges.forEach((function(r){t=t.add(e.entityMap[r.key].type)}))})),t.toArray().sort()}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),i=r.__importStar(i),a=r.__importStar(a),l=r.__importStar(l),t.hiveLogger=new a.HiveLogger;var f=function(e,t){var r=l.folderDataCache(t)[e];return r&&r.contentReferences||[]},m=function(e){if(!e)return"";var t=o.hash.sha256.hash(e.toLowerCase());return o.codec.hex.fromBits(t)};t.hashPath=function(e){return(e||"/").split("/").map(m).join("/")};var h=function(e){var t=i.normalize(e).split("/");return m(t.pop())};t.extractNsIdAndPath=function(e){return e?{nsId:d.extractSharedFolderId(e),nsPath:d.extractSharedFolderPath(e)}:{}},t.makeEditedData=function(e){var o,n,i=e.folderFileId,s=e.loggingFileId,a=e.action_surface,d=e.retrievalSource,u=c.getStoreForFolderOverview().getState(),m=(o=(function(e,t){var r=l.folderDataCache(t)[e];if(r&&r.descriptionDraft)try{return JSON.parse(r.descriptionDraft)}catch(e){return}})(i,u),n=(function(e){var t={all:0,checked:0};return e?(e.blocks.forEach((function(e){"task-block"===e.type&&(t.all+=1,e.data&&e.data.checked&&(t.checked+=1))})),t):t})(o),{length:o?p(o):0,features:o?_(o):[],tasks:n.all,checkedTasks:n.checked}),g=t.makeOverviewResourceExtras({folderFileId:i,loggingFileId:s,action_surface:a,retrievalSource:d});if(g)return r.__assign(r.__assign({},g),{length:m.length.toString(),formatting:JSON.stringify(m.features),tasks:m.tasks.toString(),checkedTasks:m.checkedTasks.toString(),pins:JSON.stringify(f(i,u).map((function(e){return{file_id:e.ns_path?e.file_id:e.ns_id,file_obj_id:e.file_id,resource:{resource_title:h(e.fq_path),resource_type:e.is_dir?"SFJ_FOLDER":"SFJ_FILE",ns_id:""+e.ns_id,resource_path:t.hashPath(e.fq_path),resource_namespace_path:t.hashPath(e.ns_path)}}})))})},t.makeOverviewResourceExtras=function(e){var r=e.folderFileId,o=e.loggingFileId,n=e.action_surface,i=e.retrievalSource,s=c.getStoreForFolderOverview().getState(),a=(function(e,t){var r=l.fileIdCache(t);for(var o in r)if(r[o]===e)return o})(r,s);if(void 0!==a){var d=t.extractNsIdAndPath(l.nsIdCache(s)[a]),u=d.nsId,p=d.nsPath;if(u)return{resource_type:"SFJ_FOLDER",resource_title:h(a),ns_id:u,resource_path:t.hashPath(a),resource_namespace_path:t.hashPath(p),file_id:(p?o:u)||null,file_obj_id:r,is_offline:"false",action_surface:n,retrieval_source:i}}},t.logOverviewEdited=function(e){var r=e.folderFileId,o=e.loggingFileId,n=e.action_surface,i=e.retrievalSource,s=c.getStoreForFolderOverview().getState();t.logFolderOverviewAction(u.WebUserActionLogEvent.FOLDER_OVERVIEW_EDITED,l.user(s).id,null,t.makeEditedData({folderFileId:r,loggingFileId:o,action_surface:n,retrievalSource:i}))},t.logFolderOverviewAction=function(e,o,n,a){void 0===a&&(a={});var l={user_id:o,event_name:e};n&&(l=r.__assign(r.__assign({},l),{file_nsid:n.ns_id,file_sjid:n.sjid,file_id:n.file_id,file_name:i.filename(n.fq_path),file_path:n.fq_path,file_extension:n.ext})),t.hiveLogger.log(new s.WebUserActionRow(r.__assign(r.__assign({},l),{extra:r.__assign({},a)})))}})),define("modules/clean/react/folder_overview/placeholder",["require","exports","tslib","react","spectrum/button","modules/clean/react/folder_overview/constants"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.FolderOverviewPlaceholder=function(e){var r=e.isReadOnly?i.DESCRIPTION_PLACEHOLDER_READ_ONLY:e.isSpace?i.DESCRIPTION_PLACEHOLDER_FOR_SPACE:i.DESCRIPTION_PLACEHOLDER;return o.default.createElement("div",{className:"folder-overview__description--placeholder",onClick:e.onClick},o.default.createElement("span",null,r),e.showExamples&&o.default.createElement(t.FolderOverviewPlaceholderExample,{showExamplesAsButton:e.showExamplesAsButton,onExampleButtonClick:e.onExampleButtonClick}))},t.FolderOverviewPlaceholderExample=function(e){return e.showExamplesAsButton?o.default.createElement(n.Button,{"aria-label":i.FOLDER_EXAMPLES_LINK_LABEL,onClick:e.onExampleButtonClick,className:"folder_overview__examples-button",variant:"secondary"},i.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON):o.default.createElement("a",{"aria-label":i.FOLDER_EXAMPLES_LINK_LABEL,href:i.FOLDER_EXAMPLES_LINK_URI,target:"_blank",rel:"noreferrer"},i.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON)},t.WrappedFolderOverviewPlaceholder=function(e){return o.default.createElement("div",{className:"folder-overview__description folder-overview__placeholder folder-overview__fixed-toolbar"},o.default.createElement(t.FolderOverviewPlaceholder,{showExamples:e.showExamples,isReadOnly:e.isReadOnly,showExamplesAsButton:e.showExamplesAsButton,onClick:e.onClick}))}})),define("modules/clean/react/folder_overview/sidebar_controller",["require","exports","tslib","classnames","react-redux","react","modules/clean/react/css","modules/clean/react/folder_overview/async_components","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/store","modules/clean/react/folder_overview/live_update"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importDefault(i),l=r.__importStar(l),c=r.__importStar(c),d.getStoreForFolderOverview();var p={fetchDataForFolder:l.fetchDataForFolder,reloadDescription:l.reloadDescription},_=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleLiveUpdate=function(e){"description"===e.type&&t.props.reloadDescription({folderFileId:t.props.folderFileId,componentNamespace:t.props.componentNamespace})},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.fetchDataForFolder({path:this.props.path,nsId:this.props.nsId,componentNamespace:this.props.componentNamespace,fetchContentReferences:!0}),u.folderOverviewLiveUpdateManager.addListener("update",this.handleLiveUpdate)},t.prototype.componentWillUnmount=function(){u.folderOverviewLiveUpdateManager.removeListener("update",this.handleLiveUpdate),u.folderOverviewLiveUpdateManager.stop()},t.prototype.render=function(){return i.default.createElement("div",{className:o.default({"folder-overview":!0,"folder-overview--loading":!this.props.haveAllComponentsLoaded||this.props.hasFailedToLoad,"folder-overview__fixed-toolbar-container":!0,"folder-overview__border":this.props.descriptionHasFocus})},i.default.createElement(a.AsyncFolderOverviewDescription,{path:this.props.path,componentNamespace:this.props.componentNamespace,isReadOnly:this.props.isReadOnly||!this.props.descriptionFormatValid,showReadOnlyIcon:!0,descriptionKey:[this.props.folderFileId,this.props.descriptionBaseRevision].join("-"),showExamplesInPlaceholder:!1,limitedWidth:!0,canShareFolder:this.props.canShareFolder}),i.default.createElement(a.AsyncFolderOverviewLastEdit,{path:this.props.path,componentNamespace:this.props.componentNamespace}))},t})(i.default.PureComponent),f=n.connect((function(){var e=c.makeHaveAllComponentsLoadedSelector(),t=c.makeHasFailedToLoadSelector(),r=c.makeFolderFileIdSelector(),o=c.makeDescriptionBaseRevisionSelector(),n=c.makeDescriptionHasFocusSelector(),i=c.makeDescriptionFormatValidSelector(),s=c.makeDoesFolderOverviewExistSelector();return function(a,l){return{user:c.user(a),haveAllComponentsLoaded:e(a,l),hasFailedToLoad:t(a,l),folderFileId:r(a,l),descriptionBaseRevision:o(a,l),descriptionFormatValid:i(a,l),descriptionHasFocus:n(a,l),doesFolderOverviewExist:s(a,l)}}}),p)(_);t.SidebarFolderOverview=s.requireCssWithComponent(f,["/static/css/browse/folder_overview-vfl53GDaS.css","/static/js/comments2/index.web-vfl1j5gMw.css","/static/js/retrieval-components/index.web-vfl3U9nJm.css"])})),define("modules/clean/react/folder_overview/utils",["require","exports","tslib","modules/clean/filepath","modules/clean/react/browse/models","modules/core/i18n","comments2/components/folder_overview_utils"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.convertDbxUserToIUser=function(e){return{id:e.id.toString(),name:{display:e.display_name,initials:[e.fname.substr(0,1),e.lname.substr(0,1)].join(""),public:e.familiar_name},photoUrl:e.initials_url}},t.normalizePath=function(e){return o.normalize(e).toLowerCase()},t.hasUnsavedDescriptionDraft=function(e){if(!e)return!1;try{var t=void 0===e.description||""===e.description||s.isEmptyDescription(JSON.parse(e.description)),r=void 0===e.descriptionDraft||""===e.descriptionDraft||s.isEmptyDescription(JSON.parse(e.descriptionDraft));if(t&&r)return!1}catch(e){}return e.description!==e.descriptionDraft&&void 0!==e.descriptionDraft},t.convertContentReferencesToSortedFiles=function(e){var r=[];e.forEach((function(e){var o={file_id:e.file_id,fq_path:e.fq_path,href:e.href,icon:e.icon,is_cloud_doc:e.is_cloud_doc,is_dir:e.is_dir,thumbnail_url_tmpl:e.thumbnail_url_tmpl,ns_id:e.ns_id,ns_path:e.ns_path,sjid:e.sjid,isDeleted:e.is_deleted,ext:t.getFileExtension(e.fq_path)},i=new n.File(o);r.push(i)}));var o=i.case_insensitive_comparator(!0);return r.sort((function(e,t){return o(n.File.getFilename(e),n.File.getFilename(t))}))},t.getFileExtension=function(e){if(!e)return"";var t=o.file_extension(e);return t?"."+t:""},t.extractSharedFolderId=function(e){var t=/^ns:([0-9]+)\/?/.exec(e);return t?t[1]:void 0},t.extractSharedFolderPath=function(e){var t=/^ns:[0-9]+\/?(.*)/.exec(e);return t?t[1]:void 0},t.pathFromSharingFolder=function(e,t){return e.length>=t.length?o.filename(t):r.__spreadArrays([o.filename(e)],t.substr(e.length).split("/").filter((function(e){return!!e}))).join(" › ")},t.fileToContentReferenceId=function(e){return e.is_dir&&e.target_ns?"ns:"+e.target_ns:e.file_id};t.userInitials=function(e){return(function(e){return"fname"in e})(e)?e.fname.substr(0,1)+e.lname.substr(0,1):e.name.given_name.substr(0,1)+e.name.surname.substr(0,1)},t.canEditOverviewForFile=function(e){return(!e.is_dir||!e.isDeleted)&&(e.target_ns?!e._mount_access_perms||!(!e._mount_access_perms||!e._mount_access_perms.includes("can_edit")):!e.read_only)}})),define("modules/clean/react/folder_subscriptions/follow/async_folder_unfollower",["require","exports","tslib","react"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o=r.__importDefault(o)).default.lazy((function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/folder_subscriptions/follow/folder_unfollower"],t,r)})).then(r.__importStar)];case 1:return[2,{default:t.sent().FolderUnfollower}]}}))}))}));t.AsyncFolderUnfollower=function(){return o.default.createElement(o.default.Suspense,{fallback:null},o.default.createElement(n,null))}})),define("modules/clean/react/folder_subscriptions/customization/async_customization_modal",["require","exports","tslib","modules/clean/react/async/loadable"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncCustomizationModal=o.Loadable({displayName:"AsyncCustomizationModal",loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/folder_subscriptions/customization/customization_modal_controller"],t,r)})).then(r.__importStar)];case 1:return[2,t.sent().CustomizationModalController]}}))}))}})})),define("modules/clean/react/folder_subscriptions/customization/query_param_filter",["require","exports","tslib","react","modules/clean/history","modules/clean/react/folder_subscriptions/data/types"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importDefault(n),t.QueryParamFilter=function(e){var t=e.children,r=o.useState(n.default.deconstruct_url().qargs[i.CUSTOMIZATION_QUERY_PARAM]),s=r[0],a=r[1];return o.useEffect((function(){function e(e,t){a(t[i.CUSTOMIZATION_QUERY_PARAM])}var t="/"+n.default.get_url().split(/[/?]/)[1];return n.default.add_callback(t,e),function(){n.default.remove_callback(t,e)}}),[s]),void 0===s||Array.isArray(s)?null:o.default.cloneElement(t,{param:s})}})),define("modules/clean/react/folder_subscriptions/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CUSTOMIZATION_QUERY_PARAM="manage_folder_subscription",t.Frequencies={INSTANT:{".tag":"instant"},DAILY:{".tag":"daily"}},(function(e){e.IDLE="idle",e.READY="ready",e.INFLIGHT="inflight",e.ERROR="error"})(t.RequestFlightStatus||(t.RequestFlightStatus={})),(function(e){e.FOLLOWING="FOLLOWING",e.FOLLOWING_PARENT="FOLLOWING_PARENT",e.NOT_FOLLOWING="NOT_FOLLOWING"})(t.FolderSubscriptionState||(t.FolderSubscriptionState={})),(function(e){e.FETCHING_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/FETCHING_FOLDER_SUBSCRIPTION",e.OPTIMISTIC_SET_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/OPTIMISTIC_SET_FOLDER_SUBSCRIPTION",e.CONFIRM_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/CONFIRM_FOLDER_SUBSCRIPTION",e.ERROR_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/ERROR_FOLDER_SUBSCRIPTION"})(t.ActionTypes||(t.ActionTypes={}))})),define("modules/clean/pagination_manager",["require","exports","tslib","modules/clean/ajax","modules/core/i18n","modules/core/notify","modules/clean/react/snackbar"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var a=(function(){function e(e){this.hasMoreItems=e}return e.prototype.areAllItemsReady=function(){return!this.hasMoreItems},e.prototype.invalidateHasMore=function(){this.hasMoreItems=!0},e.prototype.addDataToAjax=function(e){},e})(),l=(function(){function e(e){var t=this;this.handleNextPageSuccess=function(e){t.nextRequestVoucher=e.next_request_voucher,t.mode.hasMoreItems=e.has_more_items,t.autoFetching&&t.fetchNext(),t.addPage(e.items)},this.ajaxURL=e.ajaxURL,this.newDataCallback=e.newDataAvailableCallback,this.autoFetching=!1,this.mode=e.mode,this.keyName=e.keyName,this.items={},this.pages=[],this.nextRequestVoucher=e.firstPage.next_request_voucher,this.userID=e.userID,this.fqPathPrefix=e.fqPathPrefix?"/"+e.fqPathPrefix:"",this.addPage(e.firstPage.items),this.fetchNextFn=e.fetchNextFn}return e.prototype.areAllItemsReady=function(){return this.mode.areAllItemsReady()},e.prototype.addPage=function(e){for(var t=[],r=[],o=0,s=e;o<s.length;o++){var a=s[o],l=a[this.keyName];if(null==l)return void i.Notify.warning(n.intl.formatMessage({id:"xlabvw",defaultMessage:"Invalid server response"}));null==this.items[l]&&(this.items[l]=a,r.push(a),t.push(l))}this.pages.push(t),this.newDataCallback(this,r)},e.prototype.startAutoFetching=function(){this.autoFetching=!0,this.fetchNext()},e.prototype.stopAutoFetching=function(){this.autoFetching=!1},e.prototype.reSync=function(e){void 0===e&&(e=!1),e&&(this.nextRequestVoucher=null,this.items={},this.pages=[]);var t=this.autoFetching&&this.mode.areAllItemsReady();this.mode.invalidateHasMore(),t&&this.startAutoFetching()},e.prototype.fetchNext=function(){var e=this;if(!this.mode.areAllItemsReady()){var t={};this.nextRequestVoucher&&(t.voucher=this.nextRequestVoucher),this.mode.addDataToAjax(t),this.fetchNextFn?this.fetchNextFn(this.nextRequestVoucher||"",this.fqPathPrefix,this.userID).then((function(t){e.handleNextPageSuccess(t)})).catch((function(){s.Snackbar.fail(n.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}),"browse")})):o.WebRequest({url:this.ajaxURL,data:t,subject_user:this.userID,success:function(t){for(var r=JSON.parse(t),o=0,n=r.items;o<n.length;o++){var i=n[o];i.fq_path=e.fqPathPrefix+i.fq_path}var s={next_request_voucher:r.next_request_voucher,has_more_items:r.has_more_items,items:r.items};e.handleNextPageSuccess(s)},error:function(){s.Snackbar.fail(n.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}),"browse")}})}},e.prototype.loadedPageCount=function(){return this.pages.length},e.prototype.getLoadedPage=function(e){var t=this,r=this.pages[e];return null==r?null:r.map((function(e){return t.items[e]}))},e.prototype.getLastLoadedPage=function(){return this.getLoadedPage(this.loadedPageCount()-1)},e})();t.BasePaginationManager=l;var c=(function(e){function t(t){return e.call(this,r.__assign(r.__assign({},t),{mode:new a(t.firstPage.has_more_items)}))||this}return r.__extends(t,e),t.create=function(e){return new t(e)},t})(l);t.PaginationManager=c})),define("modules/clean/react/app_actions/education/async_extensions_edu_modal",["require","exports","tslib","react","modules/clean/react/modal"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.asyncShowExtensionsEduModal=function(t,i){var s=this;return new Promise((function(t){return r.__awaiter(s,void 0,void 0,(function(){var s;return r.__generator(this,(function(a){switch(a.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/app_actions/education/edu_modal_component"],t,r)})).then(r.__importStar)];case 1:return s=a.sent().AppActionsEduModal,n.Modal.showInstance(o.default.createElement(s,{appName:i})),t(),[2]}}))}))}))}})),define("modules/clean/react/extensions/app_recommendations_modal/async_modal",["require","exports","tslib","react","modules/clean/react/modal"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.asyncShowAppRecommendationModal=function(t,i){return r.__awaiter(this,void 0,Promise,(function(){var s,a,l,c;return r.__generator(this,(function(d){switch(d.label){case 0:return[4,Promise.all([new Promise((function(t,r){e(["modules/clean/react/extensions/app_recommendations_modal/util"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/extensions/app_recommendations_modal/modal"],t,r)})).then(r.__importStar)])];case 1:return s=d.sent(),a=s[0].fetchAppRecommendationEntries,l=s[1].AppRecommendationsModal,[4,a(t)];case 2:return c=d.sent(),n.Modal.showInstance(o.default.createElement(l,{appEntries:c,userId:t,launcherTag:i})),[2]}}))}))}}));var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/async_fileops_modals",["require","exports"],(function(e,t){"use strict";function r(t){new Promise((function(t,r){e(["modules/clean/react/fileops_modals"],t,r)})).then(__importStar).then(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.showMove=function(e){r((function(t){return(0,t.showMove)(e)}))},t.showUpload=function(e){r((function(t){return(0,t.showUpload)(e)}))},t.showAdminUpload=function(e){r((function(t){return(0,t.showAdminUpload)(e)}))},t.showMoveDialog=function(t){new Promise((function(t,r){e(["modules/clean/react/folder_dialog/move_dialog_modal"],t,r)})).then(__importStar).then((function(e){return e.MoveDialogModal.show(t)}))}})),define("modules/clean/react/browse/actions",["require","exports","tslib","immutable","modules/clean/cloud_docs/open_with_utils","modules/clean/cloud_docs/preferred_editor_utils","modules/clean/cloud_docs/types","modules/clean/downloads","modules/clean/file_actions/create-folder","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/filetypes","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators/index","modules/clean/react/browse/data/action_creators/file_actions","modules/clean/react/browse/data/helpers","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/browse/models","modules/clean/react/file_uploader/constants","modules/clean/react/file_viewer/async_controller","modules/clean/react/fileops_actions","modules/clean/react/files_view/types","modules/clean/pnm/utils","modules/clean/react/plusplus/logging","modules/clean/react/plusplus/file_actions","modules/clean/react/share_download/api","modules/clean/react/snackbar","modules/clean/react/vault/constants","modules/clean/sharing/browse_exports","modules/clean/user_education/user_education_client","modules/constants/python","modules/core/browser","modules/core/i18n","modules/clean/react/browse/fss_experiment_carousel_util"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b,I,y,F,C,O,A,P,L,D,M,R,N,x,k,U){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),a=r.__importStar(a),c=r.__importStar(c),d=r.__importStar(d),_=r.__importDefault(_),f=r.__importStar(f),m=r.__importStar(m),g=r.__importStar(g),S=r.__importStar(S),v=r.__importStar(v),y=r.__importStar(y),P=r.__importStar(P),x=r.__importStar(x);var V=(function(){function V(){var n=this;this.initializeEverything=function(e){var t=e.path,i=e.files,s=e.paginatedTotalNumFiles,a=e.context,l=e.mountPoints,c=e.fqPathsToSelect,d=e.loadingState,u=e.teamFolders;n.reduxStore.dispatch(g.setPath({path:t})),n.reduxStore.dispatch(g.appendFiles({path:t,files:r.__spreadArrays(i,u)})),n.reduxStore.dispatch(g.setPaginatedTotalNumFiles({paginatedTotalNumFiles:s})),n.reduxStore.dispatch(g.setMountPoints({mountPoints:l})),n.reduxStore.dispatch(g.setLoadingState({loadingState:d,path:t})),d===F.LoadingState.LOADED?n.reduxStore.dispatch(g.selectFilesByFqPath({fqPathsToSelect:c})):n.reduxStore.dispatch(g.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(c)})),n.reduxStore.dispatch(g.setContext({context:a})),p.Dispatcher.dispatch({type:b.UploaderActionType.SET_PATH,data:{path:t,hasPermissionToUploadToFolder:a.isCurrentPathWriteable(),isMovingIntoVault:a.isInsideVaultFolder}}),p.Dispatcher.dispatch({type:h.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:t,files:i}})},this.addFilesAndSetLoadingState=function(e){var t=e.path,r=e.loadingState,o=e.files,i=e.paginatedTotalNumFiles;n.reduxStore.dispatch(g.appendFiles({path:t,files:o})),n.reduxStore.dispatch(g.setPaginatedTotalNumFiles({paginatedTotalNumFiles:i})),n.reduxStore.dispatch(g.setLoadingState({loadingState:r,path:t})),p.Dispatcher.dispatch({type:h.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:t,files:o}})},this.setUrl=function(e){var t=e.path,r=e.qargs;n.reduxStore.dispatch(g.setUrl({path:t,qargs:r}))},this.nameNewFolder=function(){n.reduxStore.dispatch(g.setNewFolderCreationState({newFolderCreationState:F.NewFolderCreationState.PENDING_INPUT}))},this.createFolderPending=function(){l.logCreateFolderPending(),n.reduxStore.dispatch(g.setNewFolderCreationState({newFolderCreationState:F.NewFolderCreationState.SAVING_INPUT}))},this.cancelCreateFolder=function(e){l.logCreateFolderCancel(e),n.reduxStore.dispatch(g.setNewFolderCreationState({newFolderCreationState:F.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),window.setTimeout((function(){R.UEClient.sendEvent("CdmNewFolderModal","maybeFinished")}),2500)},this.createFolderComplete=function(){l.logCreateFolderSuccess(),n.reduxStore.dispatch(g.setNewFolderCreationState({newFolderCreationState:F.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),L.Snackbar.complete(k.intl.formatMessage({id:"a26imc",defaultMessage:"Folder created."}),"browse-action"),window.setTimeout((function(){R.UEClient.sendEvent("CdmNewFolderModal","maybeFinished")}),2500)},this.createFolder=function(e){n.reduxStore.dispatch(g.createFolder(e))},this.createFolderInNewFolderModal=function(e){var r=e.folderName,o=e.isConfidential,i=e.user,s=e.context,a=e.redirectOnSuccess,l=e.redirectOnCancel,c=e.fqPath,d=e.selectCreatedFolder,u=e.origin,p=s?s.currentFQPath:c,_=s?s.rootNSID:i.root_ns_id;if(o&&s&&!s.isInsideTeamFolderTree)M.asyncShowNewFolderShareModal(i,null,p,r,!1,!1,null,n.setUrl);else{var f=(i.is_cdm_member||o)&&!!s&&s.isInsideTeamFolderTree;t.browseActions.createFolder({pathName:p,folderName:r,nsId:_,checkFSWs:!1,showShareModalOnSuccess:f?n.handleShowShareModal:null,redirectOnSuccess:a,redirectOnCancel:l,selectCreatedFolder:d,origin:u})}},this.handleNewFolderRedirectOnSuccess=function(e){n.setUrl({path:e})},this.doDeleteFilesWithModal=function(e){var t=e.files,o=v.user(n.reduxStore.getState()),i=v.context(n.reduxStore.getState());f.showDelete(o,t,i,d.filename(i.currentFQPath),(function(){return r.__awaiter(n,void 0,void 0,(function(){return r.__generator(this,(function(e){return this.reduxStore.dispatch(S.deleteFiles({files:r.__spreadArrays(t),checkFSWs:!0})),[2]}))}))}))},this.purgeSuccessCallback=function(e){t.browseActions.reloadCurrentPath()},this.onPurgeBatch=function(t,o){new Promise((function(t,r){e(["modules/clean/react/trash/actions"],t,r)})).then(r.__importStar).then((function(e){(0,e.purgeByPathBatch)(t,o,n.purgeSuccessCallback)}))},this.doPermanentDeleteWithModal=function(e){var t=v.user(n.reduxStore.getState()),r=v.context(n.reduxStore.getState());f.showPurgeModal({userId:t.id,context:r,files:e,onPurge:n.onPurgeBatch})},this.onRestore=function(e,t,r){m.restoreFiles({files:t,userId:e,onSuccess:function(){c.notifyRestoreSuccess(t)},isSearchMode:r})},this.doRestoreFilesWithUnifiedTrashModal=function(e){var t=e.files,r=v.user(n.reduxStore.getState()),o=v.context(n.reduxStore.getState());f.showUnifiedTrashModal({userId:r.id,context:o,files:t,onRestore:function(e,t){n.onRestore(e,t,!1)}})},this.handleShowRewindPanel=function(){_.default.update_query_param(h.BrowseQueryArg.rewind,"true"),n.reduxStore.dispatch(g.showRewind())},this.fetchFolderSizes=function(e){var t=e.file;return r.__awaiter(n,void 0,Promise,(function(){var e,o,n,i,s,a,l,c;return r.__generator(this,(function(d){switch(d.label){case 0:e=v.user(this.reduxStore.getState()),o=h.MAX_FOLDER_SIZE_ITERATIONS,d.label=1;case 1:return d.trys.push([1,7,,8]),this.reduxStore.dispatch(g.requestFolderSizes({fqPath:t.fq_path})),[4,m.fetchSharedFolderSizes(e.id,{fq_path:t.fq_path})];case 2:return n=d.sent(),this.reduxStore.dispatch(g.setFolderSizesPending({fetchFolderSizesResp:n})),i=[],[4,this.fetchAndSetSameNamespaceFolderSize(e.id,{fq_path:t.fq_path,folder_limit:h.MAX_FOLDERS_PER_CALL})];case 3:(s=d.sent()).queue&&(i=r.__spreadArrays(i,s.queue)),d.label=4;case 4:return i.length>0&&o>0?(o--,a=Math.min(h.MAX_FOLDER_SIZE_QUEUE_SIZE,i.length),l=i.splice(0,a),[4,this.fetchAndSetSameNamespaceFolderSize(e.id,{fq_path:t.fq_path,folder_limit:h.MAX_FOLDERS_PER_CALL,queue:l})]):[3,6];case 5:return(s=d.sent()).queue&&i&&(i=r.__spreadArrays(i,s.queue)),[3,4];case 6:return c=0!==o&&s.queue&&0===s.queue.length?F.FetchFolderSizeState.COMPLETE:F.FetchFolderSizeState.ERROR,this.reduxStore.dispatch(g.completeFolderSizes({fetchFolderSizeState:c})),[3,8];case 7:return d.sent(),this.reduxStore.dispatch(g.setFolderSizesPending({fetchFolderSizesResp:{sizes_dict:[{fq_path:t.fq_path,size:0}],queue:[]}})),this.reduxStore.dispatch(g.completeFolderSizes({fetchFolderSizeState:F.FetchFolderSizeState.ERROR})),[3,8];case 8:return[2]}}))}))},this.fetchMultipleFolderSizes=function(e){var t=e.files;return r.__awaiter(n,void 0,Promise,(function(){var e,o,n;return r.__generator(this,(function(r){switch(r.label){case 0:e=0,o=t.toArray(),r.label=1;case 1:return e<o.length?(n=o[e],[4,this.fetchFolderSizes({file:n})]):[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},this.handleShowShareModal=function(e,t){var r=v.user(n.reduxStore.getState()),o=v.context(n.reduxStore.getState());M.asyncShowShareModal(r,e,{browseContext:o,origin:t,onCancel:function(){U.asyncShowFssExpr(r,e.ns_id,e.ns_path,e.is_dir)},onSuccessSharing:function(){U.asyncShowFssExpr(r,e.ns_id,e.ns_path,e.is_dir)}},n.setUrl)},this.reduxStore=w.getStoreForBrowse()}return V.prototype.reloadCurrentPath=function(){this.setUrl({path:v.path(this.reduxStore.getState()),qargs:{reload:!0}})},V.prototype.selectRowsFromBoltClient=function(e){void 0===e&&(e=[]),this.reduxStore.dispatch(g.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(e.map((function(e){return e.fq_path})))}))},V.prototype.copyFiles=function(e){y.copyFiles(e)},V.prototype.selectFilesAfterUpload=function(e){var t=e.fqPathsToSelect,r=v.unsortedFilesWithFolderSizes(this.reduxStore.getState());t.every((function(e){return r.has(e)}))?this.reduxStore.dispatch(g.selectFilesByFqPath({fqPathsToSelect:t})):this.reduxStore.dispatch(g.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(t)}))},V.prototype.selectFilesByFqPath=function(e){var t=e.fqPathsToSelect;this.reduxStore.dispatch(g.selectFilesByFqPath({fqPathsToSelect:t}))},V.prototype.navigateToFileOrFolder=function(e){var t=this,r=e.file,o=e.shouldFocusComment,n=void 0!==o&&o,s=e.onFileViewerUnmount,a=e.fileViewAction,l=void 0===a?N.FileViewActionType.CLICK:a,c=e.fileViewOrigin,d=void 0===c?N.FileViewOriginType.BROWSE:c,p=v.user(this.reduxStore.getState()),_=v.context(this.reduxStore.getState());if(r.isDeleted)this.doRestoreFilesWithUnifiedTrashModal({files:[r]});else{if(C.isSupportedLinkNodeClickAction(r.per_node_metadata))return void A.handleLinkNodeAction(r.per_node_metadata,(function(e){O.logProductAnalytics(p.id,"web","select",e,"files_main_bar")}));if(r.is_dir)r.type===u.FileTypes.VAULT_FOLDER?x.redirect(D.VAULT_URL):T.File.isNoAccessSharedFolder(r)?f.showNoAccess(p,r.fq_path,_):this.setUrl({path:r.fq_path});else{var m=function(){t.openPreviewForBrowseFile({file:r,shouldFocusComment:n,user:p,fileViewAction:l,fileViewOrigin:d,onFileViewerUnmount:s})},h=v.browsePostTTIData(this.reduxStore.getState()).preferredEditors;!n&&h&&i.hasPreferredEditorSupport(r)?i.openInPreferredEditor(p,r,h,m,{fileViewAction:l,fileViewOrigin:d}):m()}}},V.prototype.openPreviewForBrowseFile=function(e){var t=this,r=e.file,o=e.shouldFocusComment,i=e.user,a=e.fileViewAction,l=e.fileViewOrigin,c=e.onFileViewerUnmount,d=E.getIndexOfFile(r,this.reduxStore.getState()),u=d<0?[r]:v.sortedFilesWithFolderSizes(this.reduxStore.getState()).toArray();if(d<0?d=0:u[d]=r,r.is_cloud_doc)n.openCloudDoc(r,i,a===N.FileViewActionType.SEARCH?s.WebSearchSource:s.WebBrowseSource);else{var p;I.asyncOpenPreview({containerId:h.BROWSE_FILE_VIEWER_ELEMENT_ID,files:u,indexOfPreviewFile:d,shouldFocusComment:o,user:i,onFileViewerDidMount:function(){p=document.querySelector(":focus"),I.hideElementsBehindFileViewer(),t.reduxStore.dispatch(g.setIsFileViewerShown({isShown:!0}))},onFileViewerUnmount:function(){I.showElementsBehindFileViewer(),t.reduxStore.dispatch(g.setIsFileViewerShown({isShown:!1})),c&&c(),p&&p.focus()},fileViewAction:a,fileViewOrigin:l,fileViewTarget:N.FileViewTargetType.PRIVATE})}},V.prototype.setShouldShowDeletedFiles=function(e){e.shouldShowDeletedFiles?_.default.update_query_param(h.BrowseQueryArg.d,"1"):_.default.remove_query_param(h.BrowseQueryArg.d)},V.prototype.downloadFiles=function(e){var t=e.files,o=e.context,n=e.user;return r.__awaiter(this,void 0,void 0,(function(){var e,i,s,l,c;return r.__generator(this,(function(r){switch(r.label){case 0:return 1!==t.count()||t.first().is_dir?[3,4]:(e=t.first())instanceof T.FileSharedWithMe?[4,P.fetchDownloadUrl(e.href)]:[3,2];case 1:return s=r.sent(),[3,3];case 2:s=e.href,r.label=3;case 3:return i=s,a.get({url:i}),[2];case 4:return o.blockHash?(l=o.currentFQPath,c=t.toArray().map((function(e){return e.fq_path})),a.get_zip({fq_paths:c,subject_uid:n.id,block_hash:o.blockHash,parent_path:l}),[2]):[2]}}))}))},V.prototype.fetchAndSetSameNamespaceFolderSize=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){var o;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,m.fetchSameNamespaceFolderSizes(e,t)];case 1:return o=r.sent(),this.reduxStore.dispatch(g.setFolderSizesPending({fetchFolderSizesResp:o})),[2,o]}}))}))},V})();t.browseActions=new V})),define("modules/clean/react/browse/api",["require","exports","tslib","external/lodash","modules/clean/ajax","modules/clean/api_v2/user_client","modules/clean/csrf","modules/clean/filepath","modules/clean/react/browse/crypto_subtle_digest","modules/clean/react/browse/models","modules/clean/react/file_uploader/constants","modules/core/exception","modules/core/html","modules/core/i18n","modules/core/notify","modules/core/uri"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m){"use strict";function h(e){try{return JSON.parse(e)}catch(e){if(!(e instanceof SyntaxError))throw e}return null}function g(e){if(void 0===e)return{};for(var t={},r=0,o=e;r<o.length;r++){var n=o[r];void 0!==n.ns_id&&void 0!==n.mount_point&&(t[n.ns_id]=n.mount_point)}return t}function S(e){return{isError:!1,result:e}}function E(e){return{isError:!0,error:e}}function v(e){return"locked_team"===e.error?d.UploadErrorType.LOCKED_TEAM_ERROR:d.UploadErrorType.OVER_QUOTA_ERROR}function w(e){return new Promise((function(t){var r=new FileReader;r.onloadend=function(e){if(!(null!==e&&e.target&&e.target.result instanceof ArrayBuffer))throw new Error;t(e.target.result)},r.readAsArrayBuffer(e)}))}function T(e){return r.__awaiter(this,void 0,Promise,(function(){var t,o,n,i,s;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,w(e)];case 1:return t=r.sent(),[3,3];case 2:return r.sent(),[2,E({type:d.UploadErrorType.FILE_READER_NULL_RESULT_ERROR})];case 3:return r.trys.push([3,5,,6]),[4,l.encryptArrayBuffer(t)];case 4:return o=r.sent(),n=btoa(String.fromCharCode.apply(null,new Uint8Array(o))),i=n.replace(/\//g,"_").replace(/\+/g,"-"),(s=(function(e){for(;e.endsWith("=");)e=e.slice(0,-1);return e})(i))?[2,S({hash:s})]:[2,E({type:d.UploadErrorType.CLIENT_HASH_EMPTY_ERROR})];case 5:return r.sent(),[2,E({type:d.UploadErrorType.CLIENT_HASH_DIGEST_ERROR})];case 6:return[2]}}))}))}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),a=r.__importStar(a),u=r.__importStar(u),t.loadPath=function(e){var t=e.sortLabel,r=e.sortIsAscending,o=e.path,i=e.userId,s=e.onSuccess,a=e.includeDeletedFiles,l=void 0!==a&&a,c=e.onError;return n.WebRequest({data:{sort_label:t,sort_is_ascending:r.toString(),show_deleted:l||"",sort_folders_first:!0,include_file_info:"True",path2:o},url:"/browse",subject_user:i,success:function(e,t,r){var n=h(e);n&&s({path:o,data:n,xhr:r})},error:function(e,t,r){c&&c(e,t,r)}})},t.loadPath2=function(e){var t,o,n;return r.__awaiter(this,void 0,Promise,(function(){var s,a,l,d,p,_;return r.__generator(this,(function(r){switch(r.label){case 0:return s=e.userId,a=e.path,l=e.sortType,d=e.sortIsAscending,p=e.includeDeleted,[4,(new i.UserApiV2Client).ns("files").rpc("browse",{fq_path:a,include_deleted:p,sort_type:l,sort_is_ascending:d,sort_folders_first:!0,include_xattrs:!0,include_folder_overview:!0},{subjectUserId:s})];case 1:return _=r.sent(),u.assert(void 0!==_.context,"context is undefined"),u.assert(void 0!==_.paginated_file_info,"paginated_file_info is undefined"),u.assert(void 0!==_.total_count,"total_count is undefined"),[2,{folderOverview:null!==(t=_.folder_overview)&&void 0!==t?t:null,mountPoints:g(_.context.ns_id_infos),context:c.BrowseContext.fromApiV2Object(_.context),items:_.paginated_file_info.map((function(e){return e.file_info})),hasMore:null!==(o=_.has_more)&&void 0!==o&&o,nextRequestVoucher:null!==(n=_.next_request_voucher)&&void 0!==n?n:null,paginatedTotalNumFiles:_.total_count}]}}))}))},t.loadPath2Continue=function(e,t){return(new i.UserApiV2Client).ns("files").rpc("browse_continue",{cursor:e},{subjectUserId:t})},t.copyFiles=function(e){var t=e.files,r=e.newPath,i=e.userId,s=e.onSuccess,a=e.checkFSWs,l=t.map((function(e){return e.fq_path}));return l.includes(r)?(f.Notify.error(_.intl.formatMessage({id:"wWiDtY",defaultMessage:"You can’t copy a folder into itself."})),null):n.WebProgressRequest({url:"/cmd/copy",data:{files:l,to_path:r,fsw_request:a?"check":void 0},subject_user:i,progress_text:_.intl.formatMessage({id:"AZPIG5",defaultMessage:"Copying files..."}),success:function(e){try{var t=o.isString(e)?JSON.parse(e):e,n=t.new_browse_files?t.new_browse_files.map(c.File.fromServerObject):[];s({newFiles:n,destinationPath:r,changesets:t.changesets,failureDetails:t.failure_details})}catch(e){}}})},t.isRewindButtonEnabled=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(r){2;try{return"/"===e&&(e=""),[2,(new i.UserApiV2Client).ns("chronicle").rpc("can_rewind",{path:e,version:2},{subjectUserId:t})]}catch(e){return[2,{can_rewind:!1}]}return[2]}))}))},t.moveFiles=function(e){var t=e.path,r=e.files,i=e.newPath,s=e.userId,l=e.onSuccess,d=e.allowOwnershipTransfer,u=e.checkFSWs;if(void 0!==t&&a.paths_are_equal(t,i))return f.Notify.error(_.intl.formatMessage({id:"V6/bVk",defaultMessage:"Those files already exist in that folder."})),null;var m=r.map((function(e){return e.fq_path}));return m.includes(i)?(f.Notify.error(_.intl.formatMessage({id:"blAaiJ",defaultMessage:"You can’t move a folder into itself."})),null):n.WebProgressRequest({url:"/cmd/move",data:{files:m,to_path:i,allow_ownership_transfer:d,fsw_request:u?"check":void 0},subject_user:s,progress_text:_.intl.formatMessage({id:"FdTkAn",defaultMessage:"Moving files..."}),skipNotifyError:!d,success:function(e){try{var r=o.isString(e)?JSON.parse(e):e,n=r.new_browse_files?r.new_browse_files.map(c.File.fromServerObject):[];l({path:t,destinationPath:i,newFiles:n,changesets:r.changesets,failureDetails:r.failure_details})}catch(e){}},error:function(t,r,o){f.Notify.error(new p.HTML(o)),e.onError&&e.onError(o)}})},t.restoreFiles=function(e){var t=e.files,r=e.userId,o=e.onSuccess,i=e.isSearchMode;return n.WebProgressRequest({url:"/cmd/restore",data:{files:t.map((function(e){return e.fq_path})),source:i?"search":"browse"},subject_user:r,dataType:"text",progress_text:_.intl.formatMessage({id:"kBkLSN",defaultMessage:"Restoring…"}),success:function(){o()}})},t.rollbackChangeSets=function(e){var t=e.userId,r=e.changesets,o=void 0===r?null:r,i=e.progressText,s=e.onSuccess;return n.WebProgressRequest({url:"/cmd/rollback",data:{ns_to_cs:JSON.stringify(o)},subject_user:t,progress_text:i,success:function(){s()}})},t.createNewFolder=function(e){var t=e.pathName,r=e.folderName,o=e.userId,i=e.onSuccess,s=e.onError,a=e.checkFSWs;return n.WebProgressRequest({url:new m.URI({path:"/cmd/new"+t}).toString(),data:{to_path:r,folder:"yes",fsw_request:a?"check":void 0},subject_user:o,success:function(e){var t=h(e);if(t){var r=t.new_browse_files?c.File.fromServerObject(t.new_browse_files[0]):null;i({changesets:t.changesets,createdFolder:r,failureDetails:t.failure_details})}},error:function(){s()}})},t.createCloudDoc=function(e){var t=e.pathName,r=e.title,o=e.documentType,i=e.userId,s=e.onSuccess,a=e.onError,l=e.checkFSWs,d=e.actionSource,u=(t+"/"+r+"."+o).replace("//","/");return n.WebRequest({url:new m.URI({path:"/cmd/create_cloud_doc"}).toString(),subject_user:i,data:{to_path:u,title:r,fsw_request:l?"check":void 0,action_source:d},success:function(e){var t=h(e);if(t){var r=t.new_browse_files?c.File.fromServerObject(t.new_browse_files[0]):null;s({changesets:null,createdFile:r,failureDetails:t.failure_details})}},error:function(e,t,r){a(r)},skipNotifyError:!0})},t.getChangesForDirectory=function(e){var t=e.path,r=e.userId,i=e.namespaceToJournalIdMap,s=e.onSuccess,a=e.includeDeletedFiles,l={fq_dir:"/"===t?"":t,ns_map:o.map(i,(function(e,t){return t+"_"+e})).join(","),show_deleted:!!a};return n.WebRequest({url:"/update/list_dir",subject_user:r,data:l,dataType:"text",success:function(e){var t=h(e);t&&s(t)}})},t.fetchSharedFolderSizes=function(e,t){return(new i.UserApiV2Client).ns("folders").rpc("get_shared_subfolder_sizes",t,{subjectUserId:e})},t.fetchSameNamespaceFolderSizes=function(e,t){return(new i.UserApiV2Client).ns("folders").rpc("get_subfolder_sizes_in_same_namespace",t,{subjectUserId:e})},t.commitBlocks=function(e,t,r,o,n){return new Promise((function(i,a){try{var l=new m.URI({scheme:"https",authority:"www.dropbox.com",path:"/commit_web_upload_by_token",query:{_subject_uid:e.toString(),dest:t,name:r,overwrite:"1",reported_total_size:o.toString(),t:s.readCsrfToken()||""}}),c=new XMLHttpRequest;c.withCredentials=!0;return c.onreadystatechange=function(){c.readyState===XMLHttpRequest.DONE&&(200===c.status?"complete"===JSON.parse(c.responseText).status?i(S({})):i(E({type:d.UploadErrorType.HTTP_ERROR})):i(E({type:507===c.status?v(c):0===c.status?d.UploadErrorType.CONNECTION_ERROR:d.UploadErrorType.COMMIT_HTTP_ERROR})))},c.open("POST",l.toString(),!0),c.setRequestHeader("Content-Type","application/octet-stream"),c.send(JSON.stringify(n)),c}catch(e){return void i(E({type:d.UploadErrorType.HTTP_ERROR}))}}))},t.uploadBlock=function(e,t,o,n,i){return new Promise((function(a){return r.__awaiter(void 0,void 0,void 0,(function(){var c,u,p,_,f;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),l.windowHasCryptoSubtleDigest()?[4,T(n)]:[3,2];case 1:if((u=r.sent()).isError)return[2,a(u)];c=u.result.hash,r.label=2;case 2:return p=new m.URI({scheme:"https",authority:"dl-web.dropbox.com",path:"/put_block_returning_token",query:{owner_id:e.toString(),_subject_uid:e.toString(),t:s.readCsrfToken()||"",reported_block_size:n.size.toString(),num_blocks:Math.ceil(o/n.size).toString(),ns_id_for_routing:t.toString()}}),(_=new XMLHttpRequest).withCredentials=!0,f=function(){return{type:507===_.status?v(_):0===_.status?d.UploadErrorType.CONNECTION_ERROR:d.UploadErrorType.UPLOAD_BLOCK_ERROR}},_.onreadystatechange=function(){if(_.readyState===XMLHttpRequest.DONE){if(200!==_.status)return a(E({type:d.UploadErrorType.HTTP_ERROR}));var e=JSON.parse(_.responseText);return e.token?l.windowHasCryptoSubtleDigest()&&e.block_hash!==c?a(E({type:d.UploadErrorType.HASHES_NOT_EQUAL_ERROR})):void a(S({token:e.token})):a(E({type:d.UploadErrorType.HTTP_ERROR}))}},_.onerror=function(){a(E(f()))},_.upload&&(_.upload.onprogress=i),_.onload=function(){_.status>=400&&a(E(f()))},_.open("POST",p.toString(),!0),_.setRequestHeader("Content-Type","application/octet-stream"),_.send(n),[2,_];case 3:return r.sent(),a(E({type:d.UploadErrorType.HTTP_ERROR})),[2];case 4:return[2]}}))}))}))}})),define("modules/clean/react/browse/app_action_util",["require","exports"],(function(e,t){"use strict";function r(e){return"function"==typeof e?e:{displayName:e.label,popoverMenuName:e.popoverLabel,iconName:e.iconName,handleClick:e.performAction,disabled:e.disabled,className:e.className,badge:e.badge,ariaLabel:e.ariaLabel,ariaPressed:e.ariaPressed,key:e.key,icon:e.icon}}Object.defineProperty(t,"__esModule",{value:!0}),t.browseAppActionToPrimaryMenuItem=function(e){if("function"==typeof e)return e;var t=void 0;return e.subItems&&(t=e.subItems.map(r)),{displayName:e.label,iconName:e.iconName,handleClick:e.performAction,disabled:e.disabled,className:e.className,subItems:t,ariaLabel:e.ariaLabel,ariaPressed:e.ariaPressed,key:e.key,icon:e.icon}},t.browseAppActionToSecondaryMenuItem=r})),define("modules/clean/react/browse/async_extensions",["require","exports","tslib","modules/clean/web_timing_logger","modules/clean/redux/store"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function t(){var e=this;this.initOnce=!1,this.emptyState={},this.sharingServiceInfo=function(){return e.emptyState},this.getFeatureFlags=function(){return e.emptyState},this.initializeStore=function(t,r){return e.files=r,e.user=t,n.getStoreAndRegisterReducers({})}}return t.prototype.init=function(){var e=this;this.initOnce||(o.waitForTTI().then((function(){return e.loadExtensionsStore()})),this.initOnce=!0)},t.prototype.loadExtensionsStore=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,o,n,i,s,a,l;return r.__generator(this,(function(c){switch(c.label){case 0:return[4,Promise.all([new Promise((function(t,r){e(["modules/clean/react/extensions/data/store"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/extensions/data/selectors"],t,r)})).then(r.__importStar)])];case 1:return t=c.sent(),o=t[0],n=o.getStore,i=o.initializeStore,s=t[1],a=s.sharingServiceInfo,l=s.getFeatureFlags,n(),this.sharingServiceInfo=a,this.getFeatureFlags=l,this.initializeStore=i,this.user&&this.initializeStore(this.user,this.files),[2]}}))}))},t})();t.asyncExtensions=new i})),define("modules/clean/react/browse/browse_action_toolbar",["require","exports","tslib","react","react-redux","modules/clean/cloud_docs/constants","modules/clean/react/new_file_menu/new_file_menu","modules/clean/react/browse/action_logger","modules/clean/react/browse/browse_async_modules","modules/clean/react/browse/components/first_task_create_folder_button","modules/clean/react/browse/components/personalization_upload_files_button","modules/clean/react/browse/components/import_painted_door_button","modules/clean/react/browse/constants","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/selectors","modules/clean/react/browse/global_actions/browse_global_actions","modules/clean/react/browse/data/action_creators/index","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/util","modules/clean/react/growth/personalization/util","retrieval-components/view-mode-toggle"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),a=r.__importStar(a),_=r.__importStar(_),f=r.__importStar(f),h=r.__importStar(h),g=r.__importStar(g);var w={setViewType:h.setViewType},T=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shouldShowDesktopCta=function(){if(t.props.browsePostTTIExperiments.expPersonalizedFirstPaths){if(!t.props.context.isInsideMyTeamFolderTree||!t.props.context.isCurrentlyInRoot)return!0;var e=t.props.browsePostTTIData.firstTaskProps.member_info;return E.enableDesktopCta(e.users.length,t.props.initialTotalNumItems,t.props.browsePostTTIExperiments.expPersonalizedFirstPaths)}return t.props.browsePostTTIData.firstTaskProps.is_eligible_team},t.enableSecondaryForNewFileMenu=function(){var e=t.props.browsePostTTIData.firstTaskProps.member_info;return E.enableInvitePanel(t.props.browsePostTTIExperiments.expPersonalizedFirstPaths)&&e.users.length<=1||E.enableDownloadAppPanel(t.props.initialTotalNumItems,t.props.browsePostTTIExperiments.expPersonalizedFirstPaths)},t.shouldShowActionsForPersonalizationExp=function(){var e=t.props,r=e.browsePostTTIExperiments,o=e.isFirstTaskEmptyState;return E.enableCreateFolderCta(o,r.expPersonalizedFirstPaths)},t.handleViewModeSelection=function(e){var r=t.props.setViewType,o=S.viewTypeFromViewMode(e);a.logSwitchViewType({uid:t.props.user.id,isSearchMode:!1,viewType:o}),r(o)},t}return r.__extends(t,e),t.prototype.renderOpenDesktopCta=function(){var e=this.props,t=e.browsePostTTIData,r=e.browsePostTTIExperiments,n=e.context,i=e.hasLinkedMobile,s=e.initialTotalNumItems,a=e.totalNumItems,c=r.expMobileAppLinks,d=r.expMobileAppLinksVariant,u=r.growthActSmbMpIteration;return c?o.default.createElement("div",{className:"create-button-container-right-accessory"},o.default.createElement(l.AsyncOpenInMenu,{browseContext:n,needsPairingToken:t.firstTaskProps.needs_pairing_token,totalNumItems:a,hasLinkedMobile:!!i,growthActSmbMpIteration:u,expMobileAppLinksVariant:d})):this.shouldShowDesktopCta()?o.default.createElement("div",{className:"create-button-container-right-accessory"},o.default.createElement(l.AsyncOpenInDesktop,{needsPairingToken:t.firstTaskProps.needs_pairing_token,totalNumItems:a,textType:E.getDesktopCtaType(s,r.expPersonalizedFirstPaths),growthActSmbMpIteration:r.growthActSmbMpIteration})):null},t.prototype.render=function(){var e=this.props,t=e.user,r=e.path,n=e.selectedFiles,a=e.emptyFolder,l=e.viewType,p=e.autoTeamGroupId,_=e.browseExperiments,f=e.browsePostTTIExperiments,h=e.context,g=e.showCondensedListViewOption,E=e.handleUploadButtonClick,w=e.initialHideState,T=f.expEnableCloudDocsPaperCreate,b=f.expEnableCloudDocsBinderCreate,I=f.expEnableCloudDocsGddCreate,y=f.expImportPaintedDoor,F=this.shouldShowActionsForPersonalizationExp();return w?null:o.default.createElement("div",{className:"create-button-container sapphire-button"},o.default.createElement("div",{className:"create-button-container-left-accessory"},!F&&o.default.createElement(s.NewFileMenu,{key:"new-file-menu",user:t,source:i.NewFileMenuFromType.BROWSE,disabled:!h.isCurrentPathWriteable(),path:r,showGdd:!!I,showPaper:!!T,showBinder:!!b,selection_mode:n.count()>0?"selected":"unselected",empty_folder:a,forceLongLabel:!0,enableSecondary:this.enableSecondaryForNewFileMenu()}),F&&o.default.createElement(o.default.Fragment,null,o.default.createElement(d.PersonalizationUploadFilesButton,{handleUploadButtonClick:E}),o.default.createElement(c.FirstTaskCreateFolderButton,{createFolderAction:m.getCreateFolderAction(t,l,h,_.goldenGateRaclsEnabled,p)})),y&&o.default.createElement(u.ImportPaintedDoorButton,{userId:t.id})),!_.browseColumnHeaderImprovements&&this.renderOpenDesktopCta(),_.browseColumnHeaderImprovements&&o.default.createElement("div",{className:"create-button-container-right-accessory"},o.default.createElement(v.ViewModeToggle,{currentMode:S.viewModeFromViewType(l),onSelection:this.handleViewModeSelection,treatLargeListAsList:!g})))},t})(o.default.PureComponent);t.BrowseActionToolbarController=T;var b=n.connect((function(e){var t=f.context,r=f.path,o=f.selectedFiles,n=f.user,i=f.browsePostTTIExperiments,s=f.browsePostTTIData,a=f.hasLinkedMobile,l=f.autoTeamGroupId,c=f.experiments,d=f.showCondensedListViewOption,u=_.emptyFolder,m=_.paginatedTotalNumFiles,h=g.selectViewType;return{context:t(e),path:r(e),selectedFiles:o(e),user:n(e),browsePostTTIExperiments:i(e),emptyFolder:u(e,{instanceId:p.BROWSE_FILES_VIEW_ID}),totalNumItems:m(e),viewType:h(e,{instanceId:p.BROWSE_FILES_VIEW_ID}),browsePostTTIData:s(e),hasLinkedMobile:a(e),autoTeamGroupId:l(e),browseExperiments:c(e),showCondensedListViewOption:d(e)}}),w);t.BrowseActionToolbar=b(T)})),define("modules/clean/react/browse/browse_sidebar",["require","exports","tslib","react","retrieval-components/blades","retrieval-components/details-pane"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.BrowseSidebar=function(){var e=o.default.useState(!1),t=e[0],r=e[1],s=o.default.useCallback((function(e){r(e)}),[]);return o.default.createElement(i.DetailsPane,{isCollapsed:t,onTogglePane:s,expandedContent:o.default.createElement(n.BladesExample,null)})}})),define("modules/clean/react/browse/browse_async_modules",["require","exports","tslib","react","modules/clean/react/async/loadable","modules/clean/react/css","modules/clean/web_timing_logger"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.AsyncOpenInDesktop=n.Loadable({displayName:"AsyncOpenInDesktop",loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/open_in_desktop"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().OpenInDesktop]}}))}))}}),t.AsyncOpenInMenu=n.Loadable({displayName:"AsyncOpenInMenu",loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/open_in_menu"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().OpenInMenu]}}))}))}}),t.AsyncMobileWebInviteButton=n.Loadable({displayName:"AsyncMobileWebInviteButton",loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/components/mobile_web_invite_button"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().MobileWebInviteButton]}}))}))}}),t.AsyncCollectionsQuickActions=n.Loadable({displayName:"AsyncCollectionsQuickActions",loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/personalization/collections_quick_actions/collections_quick_actions"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().CollectionsQuickActions]}}))}))}}),t.AsyncMobileWebUploadButton=n.Loadable({displayName:"AsyncMobileWebUploadButton",loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/components/mobile_web_upload_button"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().MobileWebUploadButton]}}))}))}}),t.AsyncSharedWithController=n.Loadable({displayName:"AsyncSharedWithController",loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/shared_with"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().SharedWithController]}}))}))}}),t.AsyncRewindPanel=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/delorean/delorean"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().RewindPanel]}}))}))}}),t.AsyncFolderHistoryPanel=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/delorean/folder_history_panel"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().FolderHistoryPanel]}}))}))}}),t.AsyncCollectionFolder=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/personalization/collection_folder/collection_folder"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().CollectionFolder]}}))}))}}),t.AsyncHomeInlineContentPrompt=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){var t;return r.__generator(this,(function(o){switch(o.label){case 0:return[4,s.waitForTTI()];case 1:return o.sent(),[4,new Promise((function(t,r){e(["modules/clean/upsell/home_inline_location"],t,r)})).then(r.__importStar)];case 2:return t=o.sent().HomeInlineContentPrompt,[2,i.requireCssWithComponent(t,["/static/css/upsell/home_inline_content-vfl8mrNRC.css","/static/js/retrieval-components/index.web-vfl3U9nJm.css"])]}}))}))}}),t.AsyncBrowseActionToolbarV2=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/browse_action_toolbar_v2"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().BrowseActionToolbarV2]}}))}))},loading:function(){return o.default.createElement("div",{className:"brws-action-toolbar"})}}),t.AsyncBrowseInlineActionBar=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/browse_inline_action_bar"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().BrowseInlineActionBar]}}))}))}}),t.AsyncBrowseSidebar=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/browse_sidebar"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().BrowseSidebar]}}))}))}}),t.AsyncSidebarSharingSection=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/sidebar_view_sharing_section"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().SidebarViewSharingSection]}}))}))}}),t.AsyncCopyLinkButton=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/sharing/views/copy_link_button"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().CopyLinkButton]}}))}))}})})),define("modules/clean/react/browse/browse_files_view",["require","exports","tslib","classnames","immutable","react","react-redux","redux","dig-components/icons/src","modules/clean/browse_uri_interface","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/async_extensions","modules/clean/react/browse/browse_async_modules","modules/clean/react/browse/browse_fixed_header","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators/file_actions","modules/clean/react/browse/data/action_creators/index","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/selectors","modules/clean/react/browse/global_actions/browse_global_actions","modules/clean/react/browse/logger_util","modules/clean/react/browse/scroll_position","modules/clean/react/browse/web_team_sharing_experiment","modules/clean/react/file_uploader/file_uploader","modules/clean/react/file_viewer/async_controller","modules/clean/react/fileops_actions","modules/clean/react/files_view/constants","modules/clean/react/files_view/controller","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/growth/personalization/team_space_empty_zone/team_space_empty_zone","modules/clean/react/growth/personalization/util","modules/clean/react/plusplus/loadables","modules/clean/sharing/access_level","modules/clean/web_user_action_events","modules/constants/python","modules/core/browser","modules/core/browser_detection","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b,I,y,F,C,O,A,P,L,D,M,R,N,x,k,U,V,H,B,W,G,q){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),i=r.__importDefault(i),d=r.__importStar(d),p=r.__importStar(p),S=r.__importStar(S),E=r.__importStar(E),v=r.__importStar(v),w=r.__importStar(w),b=r.__importStar(b),O=r.__importStar(O),L=r.__importStar(L),D=r.__importStar(D),M=r.__importStar(M),W=r.__importStar(W),G=r.__importStar(G);var z=[V.NameSpaceAccess.ACCESS_NO_ACCESS,V.NameSpaceAccess.ACCESS_READER,V.NameSpaceAccess.ACCESS_READER_NO_COMMENT];function j(e){var t=e.selectedFiles,r=e.context,o=e.isDraggingInternalFiles,n=e.isDraggingExternalFiles,i=e.isUploadModalOpen;return r.isInsideSharedFolder&&z.includes(r.currentSharedFolderPermissionRole)?R.DropTargetHighlightMode.NONE:o?t.some((function(e){return e.isDeleted||e.type===u.FileTypes.TEAM_SHARED_FOLDER}))?R.DropTargetHighlightMode.NONE:t.some((function(e){return e.type===u.FileTypes.SHARED_FOLDER}))?r.currentNSAllowsNesting?R.DropTargetHighlightMode.NONSELECTED_FOLDERS:R.DropTargetHighlightMode.NONSELECTED_NONSHARED_FOLDERS:R.DropTargetHighlightMode.NONSELECTED_FOLDERS:n&&!i?R.DropTargetHighlightMode.ALL_FOLDERS:R.DropTargetHighlightMode.NONE}t.getCurrentDropTargetHighlightMode=j;var K=(function(t){function s(o){var s=t.call(this,o)||this;return s.scrollContainer=i.default.createRef(),s.handlePresentInZoom=function(e){C.asyncOpenPreview({containerId:g.BROWSE_FILE_VIEWER_ELEMENT_ID,files:[e],indexOfPreviewFile:0,shouldFocusComment:!1,user:s.props.user,onFileViewerDidMount:C.hideElementsBehindFileViewer,onFileViewerUnmount:C.showElementsBehindFileViewer,fileViewAction:B.FileViewActionType.CLICK,fileViewOrigin:B.FileViewOriginType.BROWSE,fileViewTarget:B.FileViewTargetType.PRIVATE,shouldPresentInZoom:!0})},s.filesViewActionHandlers={onDelete:function(t){new Promise((function(t,r){e(["modules/clean/react/browse/file_actions/action_handlers"],t,r)})).then(r.__importStar).then((function(e){(0,e.handleDelete)({user:s.props.user,files:t,isSearchMode:!1,viewType:s.props.viewType},s.props.context)}))},onShowRename:function(e){return s.props.setFileRename({file:e,renameState:R.RenameState.PENDING_INPUT})},onSetClipboard:function(e){return s.props.setFilesToClipboard({clipboard:e})},onPasteFromClipboard:function(){return s.props.pasteFilesFromClipboard({copyFiles:O.copyFiles,moveFiles:O.moveFiles})},onNewFolderSubmit:function(e){return _.browseActions.createFolder({pathName:s.props.context.currentFQPath,folderName:e,nsId:s.props.context.rootNSID,checkFSWs:!0})},onNewFolderCancel:function(){return _.browseActions.cancelCreateFolder()},onRenameSubmit:function(e,t){return s.props.renameFile({file:e,name:t,checkFSWs:!0})},onRenameCancel:function(e){return s.props.setFileRename({file:e,renameState:null})},onSwitchViewType:function(e){p.logSwitchViewType({uid:s.props.user.id,isSearchMode:!1,viewType:e}),s.props.setViewType(e),window.setTimeout((function(){var e=document.querySelector(".brws-view-type-column-header-menu-trigger");e&&e.focus()}),0)},onColumnsChanged:function(e,t,r,o,n){s.props.setViewTypeColumns({columns:e,viewType:t,user:s.props.user,viewTypeScope:s.props.viewTypeScope,useViewPreferences:o,updateGlobalScope:!0,numVisibleColumns:n}),s.props.setCanDisplayFolderSizes({canDisplayFolderSizes:r})},onCanDisplayFolderSizesChanged:function(e){return s.props.setCanDisplayFolderSizes({canDisplayFolderSizes:e})},onAddFileJumpKeyCode:function(e){return s.props.addFileJumpKeyCode({keyChar:e})},onResetFileJump:function(){return s.props.resetFileJumpFilter()},onShowShare:_.browseActions.handleShowShareModal,onPresentInZoom:s.handlePresentInZoom},s.shouldShowEmptyStateDropTarget=function(){return s.props.context.isInsideMyTeamFolderTree&&s.props.context.isCurrentlyInRoot&&1===s.props.totalNumItems||s.props.isFirstTaskEmptyState},s.shouldShowFilesView=function(){var e=s.props,t=e.browsePostTTIExperiments,r=e.context,o=r.isCurrentlyInRoot,n=r.isInsideMyTeamFolderTree,i=e.initialHideState,a=e.isFirstTaskEmptyState,l=e.isInsideEmptyCollectionFolder,c=e.shouldHideFilesAndSidebar,d=e.shouldShowVaultEmptyState,u=e.totalNumItems;return!(c||d||l||k.shouldHideFilesPerSplitTmfTsd(i,n,o,a,u,t.expPersonalizedFirstPaths))},s.getDropTargetProps=function(){var e=[],t=q.intl.formatMessage({id:"SHYorf",defaultMessage:"Upload files to the team space"});return e.push({iconName:"upload-file",iconSrc:l.UploadFileLine,displayName:q.intl.formatMessage({id:"Qayhb5",defaultMessage:"Upload files"}),handleClick:function(){return s.props.handleUploadButtonClick(!1)}}),G.is_input_webkitdirectory_supported()&&(t=q.intl.formatMessage({id:"ZmstxO",defaultMessage:"Add files and folders to the team space"}),e.push({iconName:"upload-folder",iconSrc:l.UploadFolderLine,displayName:q.intl.formatMessage({id:"53oUlv",defaultMessage:"Upload folder"}),handleClick:function(){return s.props.handleUploadButtonClick(!0)}})),{popoverOptions:e,ariaLabel:t,isDropTargetRoot:!s.state.currentDropTarget,isDraggingFiles:s.props.isDraggingExternalFiles||s.props.isDraggingInternalFiles,isLoading:s.props.loadingState===R.LoadingState.LOADING_FIRST_PAGE}},s.getIsFileJumping=function(){return s.props.isFileJumping},s.handleUpdateDropTarget=function(e){s.props.isFirstTaskEmptyState&&s.setState({currentDropTarget:e})},s.handleFixedHeaderHeightChange=function(e){var t=s.props.browsePostTTIData.firstTaskProps.is_eligible_team?38:0;s.setState({fixedHeaderHeight:(e||0)+t})},s.handleGetOverflowMenuActions=function(e,t,r){var o=s.props.handleGetFileActionsForSetOfFiles(n.Set([e]),t,r,!1),i=new Array;return o.forEach((function(e){"function"!=typeof e&&i.push(e)})),[i]},s.handleLocationLinkClick=function(e,t){if(!t){var r=d.parent_dir(e.fq_path);s.props.setUrl({path:r})}},s.handleOpenPaper=function(e){W.redirect(e.url)},s.handleFocusSearchBar=function(){document.getElementsByClassName("search__input")[0].focus()},s.handleFileListSortChange=function(e,t){s.props.setAndStoreSortOrder({sortField:e,sortDirection:t})},s.handleSelectionChange=function(e,t){s.props.setSelection({selection:e,actionSource:t})},s.handleStarClick=function(e,t){var r=t?H.WebUserActionLogEvent.STAR:H.WebUserActionLogEvent.REMOVE_STAR,o=s.props,n=o.user,i=o.viewType,a=o.selectedFiles,l=b.countFilesAndFolders(a),c=l.num_files_selected,d=l.num_folders_selected;p.logBrowseAction({uid:n.id,source:"BROWSE",action:r,num_files_selected:c,num_folders_selected:d,view_type:i,result:e})},s.handleOpenFileSharedWithMe=function(e){W.redirect(e.href)},s.handleNavigateToParentFolder=function(){I.ScrollPositionHandler.navigateUpFolder();var e=d.parent_dir(s.props.path);s.props.setUrl({path:e})},s.onContainerClick=function(e){N.shouldClickDeselect(e)&&s.props.onClearSelection({actionSource:H.ActionSourceValue.WHITESPACE})},s.renderSharedWithController=function(e,t){var r=s.props,o=r.context,n=r.user;if(e.type===u.FileTypes.TEAM_SHARED_FOLDER&&("archived"===e.team_folder_status||"archive_in_progress"===e.team_folder_status))return null;var a=!!s.props.selectedFiles.size;return i.default.createElement("div",{className:"brws-vertically-center brws-shared-with-wrapper"},i.default.createElement(m.AsyncSharedWithController,{file:e,browseContext:o,inSelectMode:a,user:n,tabIndex:t}))},s.getItems=function(){var e=s.props,t=e.browsePostTTIExperiments,r=e.context,o=r.isCurrentlyInRoot,n=r.isInsideMyTeamFolderTree,i=e.files,a=e.filesWithoutTeamFolders,l=e.initialHideState,c=e.shouldShowPinnedTeamFolders,d=e.user.cdm_tmf_path;return c?a:k.shouldFilterItemsPerSplitTmfTsd(l,n,o,t.expPersonalizedFirstPaths)?i.filter(k.filterOutNonTeamFoldersPerSplitTmfTsd(d)):i},s.state={fixedHeaderHeight:0},s}return r.__extends(s,t),s.prototype.componentDidMount=function(){I.ScrollPositionHandler.register(),this.updateScroll(),this.shouldShowFilesView()||this.props.handleComponentTTI("FilesViewController")},s.prototype.componentWillUnmount=function(){I.ScrollPositionHandler.unregister()},s.prototype.componentDidUpdate=function(e){e.loadingState===R.LoadingState.LOADING_FIRST_PAGE&&this.props.loadingState!==e.loadingState&&this.updateScroll()},s.prototype.updateScroll=function(){var e=I.ScrollPositionHandler.getLastScrollPosition(this.props.path);if(e){var t=this.props,r=t.selection;(0,t.setSelection)({selection:r.set("selected",n.OrderedSet([e])).set("anchor",e),skipLogging:!0})}},s.prototype.render=function(){var e=this.props,t=e.shouldShowPinnedTeamFolders,n=e.preSetupPlusFeatures,s=e.files,a=e.context,l=e.selectedFiles,d=e.isDraggingExternalFiles,u=e.isDraggingInternalFiles,p=e.isUploadModalOpen,_=e.loadingState,f=e.browsePostTTIExperiments,S=e.browsePostTTIData,E=e.responsive,v=e.handleUploadButtonClick,w=e.user,b=e.browseExperiments,I=e.path,C=e.autoTeamGroupId,O=e.initialTotalNumItems,L=e.isFirstTaskEmptyState,D=e.initialHideState,M=e.onNavigateToFileOrFolder,N=e.vaultContentSlot,k=e.viewType,V=e.isRewindVisible,H=e.isFolderHistoryVisible,B=e.createNewFolderState,W=e.currentSort,G=e.fileRename,q=e.isFileViewerShown,z=e.arePostTTIModulesLoaded,K=e.sharingServiceInfo,Y=e.extensionsFeatureFlags,Q=e.handleComponentTTI,X=e.selection,J=e.handleShowFileUploader,Z=e.teamFolders,$=e.totalNumItems,ee=e.isQueryingFolderSizes,te=e.viewTypeColumns,re=e.starredState,oe=e.shouldShowTeamSpaceEmptyZone,ne=e.shouldShowNewFeaturesTable,ie=e.uploadAjaxInterceptor,se=e.viewTypeScope,ae=e.viewTypes,le=e.vaultEmptyContentSlot,ce=e.shouldHideFilesAndSidebar,de=e.isActionBarEnabled,ue=e.isDragToSelectEnabled,pe=e.isCutActionEnabled,_e=e.clipboard,fe=e.isMoreColumnsEnabled,me=e.isActive,he=e.isColumnResizingEnabled,ge=this.getItems(),Se=j({context:a,selectedFiles:l,isDraggingExternalFiles:d,isDraggingInternalFiles:u,isUploadModalOpen:p}),Ee=-1;de&&(Ee+=g.BROWSE_ACTION_BAR_HEIGHT);var ve=this.shouldShowEmptyStateDropTarget(),we=o.default("maestro-browse-app-content","maestro-content-scroll",{"maestro-content-scroll_scroll-disabled":_===R.LoadingState.LOADING_FIRST_PAGE,"maestro-browse-app-content--empty-state":ve}),Te=o.default({"maestro-browse-app-content--empty-state-content":ve}),be=null;if(f.expMobileWebInvites&&!E.isMatchedLarge){var Ie=T.getUploadActions(a.isCurrentPathWriteable(),v);Ie.length>0&&(be=i.default.createElement(m.AsyncMobileWebUploadButton,{onClick:Ie[0].performAction}))}return i.default.createElement("div",{className:we,ref:this.scrollContainer,onClick:this.onContainerClick},i.default.createElement("div",{className:Te},i.default.createElement(y.WebTeamSharingModalExperiment,{context:a,user:w,path:I,selectedFiles:l,browsePostTTIExperiments:f}),i.default.createElement(h.BrowseFixedHeader,{initialTotalNumItems:O,responsive:E,isFirstTaskEmptyState:L,handleUploadButtonClick:v,initialHideState:D,onNavigateToFileOrFolder:M,handleFixedHeaderHeightChange:this.handleFixedHeaderHeightChange,uploadAjaxInterceptor:ie}),a.isInsideVaultFolder&&i.default.createElement("div",{ref:N}),a.isInsideVaultFolder&&!ce&&de&&i.default.createElement(i.default.Fragment,null,i.default.createElement(m.AsyncBrowseActionToolbarV2,{uploadAjaxInterceptor:ie,responsive:E}),i.default.createElement("div",{className:"brws-vault-empty-content",ref:le})),ne?i.default.createElement(U.AsyncNewFeaturesTable,{items:n,userId:w.id,platform:"web"}):null,this.shouldShowFilesView()&&i.default.createElement(P.FilesViewController,r.__assign({id:g.BROWSE_FILES_VIEW_ID},this.filesViewActionHandlers,{disabledMultiselect:V||H,getOverflowMenuActions:this.handleGetOverflowMenuActions,renderSharedWithController:this.renderSharedWithController,hrefForFile:c.href_for_file,onLocationLinkClick:this.handleLocationLinkClick,onNavigateToFileOrFolder:M,onOpenFileSharedWithMe:this.handleOpenFileSharedWithMe,onNavigateToParentFolder:this.handleNavigateToParentFolder,onOpenPaper:this.handleOpenPaper,onFocusSearchBar:this.handleFocusSearchBar,context:a,createNewFolderState:B,currentSort:W,dropTargetHighlightMode:Se,fileRename:G,items:ge,responsive:E,getIsFileJumping:this.getIsFileJumping,isDraggingExternalFiles:d,isDraggingInternalFiles:u,isFileViewerShown:q,isOverFreeQuota:S.isOverFreeQuota,shouldShowPinnedTeamFolders:t,arePostTTIModulesLoaded:z,sharingServiceInfo:K,extensionsFeatureFlags:Y,loadingState:_,onComponentTTI:Q,columnHeaderImprovements:!!b.browseColumnHeaderImprovements,columnResizing:!!b.browseColumnResizing,onSelectionChange:this.handleSelectionChange,onSortChange:this.handleFileListSortChange,onStarClick:this.handleStarClick,path:I,selectedFiles:l,selection:X,setFileUploaderPath:F.FileUploaderController.setPathAndPermissions,showFileUploaderModal:J,teamFolders:Z,totalNumFiles:$,user:w,isQueryingFolderSizes:ee,columns:te[k],viewTypeColumns:te,viewTypes:ae,viewTypeLabels:A.ViewTypeLabels,viewTypeScope:se,starredState:re,stickyOffsetTop:Ee,scrollContainer:this.scrollContainer,isStickyColumnHeader:!0,scrollPositionOffset:this.state.fixedHeaderHeight,highDensity:!0,updateDropTarget:this.handleUpdateDropTarget,eligibleForFirstTaskSubtitle:S.firstTaskProps.is_subtitle,isFirstTaskEmptyState:L,expVaultEnableViewOnlySharing:f.expVaultEnableViewOnlySharing||!1,expEntryPointCopyLink:f.expEntryPointCopyLink,customEmptyFolderView:be?function(){return i.default.createElement("div",{className:"mobile-web-invites-empty-state"})}:void 0,isActionBarEnabled:de,inlineActionBar:m.AsyncBrowseInlineActionBar,enableUnity:!0,isDragToSelectEnabled:ue,isCutActionEnabled:pe,clipboard:_e,isMoreColumnsEnabled:fe,isActive:me,isColumnResizingEnabled:he})),oe&&i.default.createElement(x.TeamSpaceEmptyZone,{numItems:$,numInitialItems:O,numMembers:S.firstTaskProps.member_info.users.length,dropTargetProps:this.getDropTargetProps(),suggestedFoldersContext:{userId:w.id,autoTeamGroupId:C,files:s},personalizedConfigs:f.expPersonalizedFirstPaths}),be))},s})(i.default.Component);t.BrowseFilesViewController=K,t.BrowseFilesView=s.connect((function(e){var t=w.context,r=w.sortedFilesWithFoldersSizesWithoutTeamFolders,o=w.sortedFilesWithFolderSizes,n=w.isFolderHistoryVisible,i=w.teamFolders,s=w.path,a=w.selection,l=w.selectedFiles,c=w.newFolderCreationState,d=w.isRewindVisible,u=w.sortOrder,p=w.isQueryingFolderSizes,_=w.user,m=w.browsePostTTIExperiments,h=w.isFileJumping,S=w.preSetupPlusFeatures,E=w.shouldShowTeamSpaceEmptyZone,T=w.browsePostTTIData,b=w.autoTeamGroupId,I=w.experiments,y=w.arePostTTIModulesLoaded,F=w.shouldShowNewFeaturesTable,C=w.selectViewTypeScope,O=w.selectViewTypes,A=w.isInsideEmptyCollectionFolder,P=w.shouldHideFilesAndSidebar,L=w.isActionBarEnabled,R=w.isDragToSelectEnabled,N=w.isCutActionEnabled,x=w.clipboard,k=w.isMoreColumnsEnabled,U=w.isColumnResizingEnabled,V=v.paginatedTotalNumFiles,H=v.loadingState,B=v.shouldShowPinnedTeamFolders,W=v.shouldShowVaultEmptyState,G=D.viewTypeColumns,q=M.selectViewType;return f.asyncExtensions.init(),{arePostTTIModulesLoaded:y(e),files:o(e),filesWithoutTeamFolders:r(e),user:_(e),context:t(e),path:s(e),selection:a(e),selectedFiles:l(e),browsePostTTIExperiments:m(e),viewType:q(e,{instanceId:g.BROWSE_FILES_VIEW_ID}),isRewindVisible:d(e),currentSort:u(e),isFileJumping:h(e),loadingState:H(e),teamFolders:i(e),sharingServiceInfo:f.asyncExtensions.sharingServiceInfo(e),extensionsFeatureFlags:f.asyncExtensions.getFeatureFlags(e),viewTypeColumns:G(e),isQueryingFolderSizes:p(e),totalNumItems:V(e),fileRename:D.fileRename(e),shouldShowPinnedTeamFolders:B(e,{instanceId:g.BROWSE_FILES_VIEW_ID}),createNewFolderState:c(e),isFolderHistoryVisible:n(e),preSetupPlusFeatures:S(e),shouldShowTeamSpaceEmptyZone:E(e),browsePostTTIData:T(e),autoTeamGroupId:b(e),browseExperiments:I(e),shouldShowNewFeaturesTable:F(e),viewTypeScope:C(e),viewTypes:O(e),shouldShowVaultEmptyState:W(e),isInsideEmptyCollectionFolder:A(e),shouldHideFilesAndSidebar:P(e),isActionBarEnabled:L(e),isDragToSelectEnabled:R(e),isCutActionEnabled:N(e),clipboard:x(e),isMoreColumnsEnabled:k(e),isColumnResizingEnabled:U(e)}}),(function(e){return a.bindActionCreators({addFileJumpKeyCode:E.addFileJumpKeyCode,resetFileJumpFilter:E.resetFileJumpFilter,setAndStoreSortOrder:E.setAndStoreSortOrder,onClearSelection:E.clearSelection,setSelection:E.setSelection,setUrl:E.setUrl,setFilesToClipboard:E.setFilesToClipboard,pasteFilesFromClipboard:E.pasteFilesFromClipboard,renameFile:S.renameFile,setCanDisplayFolderSizes:E.setCanDisplayFolderSizes,setFileRename:L.setFileRename,setViewType:E.setViewType,setViewTypeColumns:L.setViewTypeColumns},e)}))(K)})),define("modules/clean/react/browse/browse_fixed_header",["require","exports","tslib","react","react-redux","modules/clean/react/browse/browse_action_toolbar","modules/clean/react/browse/browse_async_modules","modules/clean/react/browse/constants","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/selectors","modules/clean/react/files_view/types","modules/clean/react/folder_overview/controller","modules/clean/react/growth/personalization/util"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),l=r.__importStar(l),c=r.__importStar(c);var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onFolderOverviewNavigateToFileOrFolder=function(e){return t.props.onNavigateToFileOrFolder(e,{actionSource:d.FilesViewActionSource.FOLDER_OVERVIEW})},t.shouldShowMobileWebInvitesButton=function(e){return t.props.browsePostTTIExperiments.expMobileWebInvites&&!e.isMatchedLarge&&t.props.context.isInsideMyTeamFolderTree&&t.props.context.isCurrentlyInRoot},t.shouldHideFolderOverview=function(){return!!(t.props.context.isInsideVaultFolder||t.props.initialHideState||t.props.isInsideCollectionFolder)||(t.props.browsePostTTIExperiments.expPersonalizedFirstPaths?t.props.context.isInsideMyTeamFolderTree&&t.props.context.isCurrentlyInRoot&&p.enableHideFolderOverview(t.props.initialTotalNumItems,t.props.browsePostTTIExperiments.expPersonalizedFirstPaths):t.props.isFirstTaskEmptyState)},t.shouldShowCollectionsQuickActions=function(){return p.enableCollectionsQuickActions(t.props.browsePostTTIExperiments.expPersonalizedFirstPaths)&&t.props.context.isInsideMyTeamFolderTree&&t.props.context.isCurrentlyInRoot},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.canEditFolderOverview,r=e.user,n=e.loadingState,l=e.browsePostTTIExperiments,c=l.expTeamInviteLinkEnable,_=l.expPersonalizedFirstPaths,f=e.browsePostTTIData.firstTaskProps,m=e.context,h=e.responsive,g=e.isInsideCollectionFolder,S=e.isInsideEmptyCollectionFolder,E=e.initialTotalNumItems,v=e.isFirstTaskEmptyState,w=e.handleUploadButtonClick,T=e.uploadAjaxInterceptor,b=e.isActionBarEnabled,I=e.initialHideState;return o.default.createElement(o.default.Fragment,null,"/"===m.currentFQPath?o.default.createElement(s.AsyncHomeInlineContentPrompt,{canRenderItems:!0,isOnBrowse:!0}):null,this.shouldShowCollectionsQuickActions()&&o.default.createElement(s.AsyncCollectionsQuickActions,{userId:r.id}),g&&o.default.createElement(s.AsyncCollectionFolder,{user:r,context:m,role:p.getRole(_),handleUploadButtonClick:w}),this.shouldShowMobileWebInvitesButton(h)&&o.default.createElement(s.AsyncMobileWebInviteButton,{memberInfo:f.member_info,isInviteLinkEnabled:!!c}),o.default.createElement(u.FolderOverview,{componentNamespace:a.BrowseFolderOverviewComponentNamespace,key:m.currentFQPath,path:m.currentFQPath,onNavigateToFileOrFolder:this.onFolderOverviewNavigateToFileOrFolder,isReadOnly:!t,browseLoadingState:n,onChangeHeight:this.props.handleFixedHeaderHeightChange,canShareFolder:!m.isCurrentlyInRoot&&m.canViewContainingNSMembers,shouldHideFolderOverview:this.shouldHideFolderOverview()}),[d.LoadingState.LOADED,d.LoadingState.LOAD_ERROR].includes(n)&&!m.isInsideVaultFolder&&b?o.default.createElement(s.AsyncBrowseActionToolbarV2,{uploadAjaxInterceptor:T,responsive:h}):!m.isInsideVaultFolder&&!S&&[d.LoadingState.LOADED,d.LoadingState.LOAD_ERROR].includes(n)&&o.default.createElement(i.BrowseActionToolbar,{initialTotalNumItems:E,isFirstTaskEmptyState:v,handleUploadButtonClick:w,initialHideState:I}))},t})(o.default.PureComponent);t.BrowseFixedHeaderController=_,t.BrowseFixedHeader=n.connect((function(e){var t=c.canEditFolderOverview,r=c.context,o=c.user,n=c.browsePostTTIExperiments,i=c.isInsideCollectionFolder,s=c.isInsideEmptyCollectionFolder,a=c.browsePostTTIData,d=c.isActionBarEnabled,u=l.loadingState;return{canEditFolderOverview:t(e),context:r(e),user:o(e),browsePostTTIExperiments:n(e),isInsideCollectionFolder:i(e),isInsideEmptyCollectionFolder:s(e),loadingState:u(e),browsePostTTIData:a(e),isActionBarEnabled:d(e)}}))(_)})),define("modules/clean/react/browse/browse_prefetch_loader",["require","exports","tslib","modules/core/exception","modules/clean/react/files_view/types","modules/clean/react/browse/models","modules/clean/pagination_manager","modules/core/notify","modules/clean/web_timing_logger","modules/clean/react/browse/api"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";function d(e){if(0===e.indexOf("err:")){var t=e.substr("err:".length);a.Notify.error(t)}}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),l=r.__importStar(l),c=r.__importStar(c),t.apiV2FetchNextFn=function(e,t,r){return c.loadPath2Continue(e,r).then((function(e){for(var r=new Array,n=0,i=e.paginated_file_info;n<i.length;n++){var s=i[n];o.assert(void 0!==s.file_info,"file_info is undefined");var a=s.file_info;a.fq_path=t+a.fq_path,r.push(a)}return{next_request_voucher:e.next_request_voucher||null,has_more_items:e.has_more||!1,items:r}}))};var u=function(e,r,a,c){var u=this,p=e.user,_=e.path,f=e.fqPathsToSelect,m=e.useApiv2NextPage,h=r.onPrefetchComplete,g=r.onPrefetchError,S=r.onLoadComplete,E=r.onPostTTIPrefetchComplete,v=r.onPostTTIPrefetchError,w=a.onInitializeEverything,T=a.onAddFilesAndSetLoadingState;void 0===c&&(c=window),this.isPrefetching=function(){return!!u.browsePreloadHandler&&!!u.firstPagePreloadHandler},this.handlePrefetch=function(){o.assert(u.isPrefetching(),"trying to handle prefetching and think we aren't prefetching at the same time.  something is wrong"),u.browsePreloadHandler(u.handlePrefetchDataSuccess,u.onPrefetchError),l.waitForTTI().then((function(){u.postTTIPreloadHandler(u.handlePostTTIDataSuccess,u.onPostTTIPrefetchError)}))},this.handlePostTTIDataSuccess=function(e){var t=void 0;try{t=JSON.parse(e)}catch(e){return void u.onPostTTIPrefetchError(e)}t?u.onPostTTIPrefetchComplete(t):u.onPostTTIPrefetchError()},this.handlePrefetchDataSuccess=function(e){var t=u.extractAjaxInitData(e);if(t){var r=i.BrowseContext.fromServerObject(t);u.firstPagePreloadHandler((function(e){u.handleFirstPagePrefetchDataSuccess(e,t,r)}),u.onPrefetchError)}else u.onPrefetchError()},this.handleFirstPagePrefetchDataSuccess=function(e,t,r){var o=u.extractAjaxFileInfo(e);if(o){var s=[],a=0,l=n.LoadingState.LOADING_FIRST_PAGE,c=o.file_info,d=o.first_page;d?(s=[],a=d.total_num_items,l=n.LoadingState.LOADING_REMAINING_PAGES):c&&(a=(s=c).length,l=n.LoadingState.LOADED),u.onInitializeEverything({path:u.path,files:s.map(i.File.fromServerObject),paginatedTotalNumFiles:a,context:r,mountPoints:t.ns_id_to_mount_point,fqPathsToSelect:u.fqPathsToSelect,loadingState:l,teamFolders:t.team_folders_js_info&&t.team_folders_js_info.map(i.File.fromServerObject)}),d?u.initializePaginationManager(d):u.onLoadComplete(),u.onPrefetchComplete(t)}else u.onPrefetchError()},this.extractAjaxInitData=function(e){var t=void 0;try{t=JSON.parse(e)}catch(t){d(e)}return t},this.extractAjaxFileInfo=function(e){var t=void 0;try{t=JSON.parse(e)}catch(t){d(e)}return t},this.initializePaginationManager=function(e){var r=e.total_num_items,o=s.PaginationManager.create({firstPage:{items:e.items,has_more_items:e.has_more_items,next_request_voucher:e.next_request_voucher},keyName:"sjid",ajaxURL:"/browse_get_next",userID:u.user.id,newDataAvailableCallback:function(e,t){var o=e.areAllItemsReady(),s=o?n.LoadingState.LOADED:n.LoadingState.LOADING_REMAINING_PAGES;u.onAddFilesAndSetLoadingState({path:u.path,files:t.map((function(e){return"object"==typeof e.type?i.File.fromApiV2Object(e):i.File.fromServerObject(e)})),paginatedTotalNumFiles:r,loadingState:s}),o&&(e.stopAutoFetching(),u.onLoadComplete())},fetchNextFn:u.useApiv2NextPage?t.apiV2FetchNextFn:void 0});l.waitForTTI().then((function(){return o.startAutoFetching()}))},this.user=p,this.path=_,this.fqPathsToSelect=f,this.onPrefetchComplete=h,this.onPrefetchError=g,this.onLoadComplete=S,this.onPostTTIPrefetchComplete=E,this.onPostTTIPrefetchError=v,this.onInitializeEverything=w,this.onAddFilesAndSetLoadingState=T,this.browsePreloadHandler=c.__REGISTER_BROWSE_PRELOAD_HANDLER,this.firstPagePreloadHandler=c.__REGISTER_BROWSE_FIRST_PAGE_PRELOAD_HANDLER,this.postTTIPreloadHandler=c.__REGISTER_BROWSE_POST_TTI_PRELOAD_HANDLER,this.useApiv2NextPage=m};t.BrowsePrefetchLoader=u})),define("modules/clean/react/browse/browse_upload_provider",["require","exports","tslib","react","react-redux","modules/clean/filepath","modules/clean/react/browse/api","modules/clean/react/browse/data/selectors","modules/clean/react/file_uploader/actions_adapter","modules/clean/react/file_uploader/processors","modules/clean/react/file_uploader/utils","modules/clean/react/upload_kit/uploader/context","modules/clean/viewer","modules/core/exception"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_){"use strict";function f(e,t){var r=i.normalize(e),o=i.parent_dir(t);return""===r?"/"===o?"/":"/"+o:"/"===o?r:r+"/"+o}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importStar(i),s=r.__importStar(s),a=r.__importStar(a),d=r.__importStar(d),_=r.__importStar(_),t.getDestinationDir=f;var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProcessedFiles=[],t.onBeforeUpload=function(e){return new Promise((function(t){l.ActionsAdapter.emit("beforeUpload",{uploadItems:e,beforeUploadComplete:function(e){var r=e.items;t(r)}})}))},t.onFilesAdded=function(e,t){return new Promise((function(r){l.ActionsAdapter.emit("filesAdded",{uploadItems:e,allUploadItems:t,filesAddedComplete:r})}))},t.onChoose=function(e){return r.__awaiter(t,void 0,Promise,(function(){var t=this;return r.__generator(this,(function(r){return[2,e.map((function(e){return[e,{parentPath:t.props.context.currentFQPath}]}))]}))}))},t.onChooseDropboxFile=function(e){return r.__awaiter(t,void 0,Promise,(function(){var t=this;return r.__generator(this,(function(r){return[2,e.map((function(e){return[e,{parentPath:t.props.context.currentFQPath}]}))]}))}))},t.processFiles=function(e,o,n){return r.__awaiter(t,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(i){switch(i.label){case 0:t=p.Viewer.get_viewer().get_user_by_id(this.props.userId),o.forEach((function(e){var r=e.item,o=e.error;l.ActionsAdapter.emit("error",{user:t,uploadItem:r,errorType:l.convertValidationError(o),loggingOnly:!0})})),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,c.processFiles(e,o)];case 2:return n=i.sent(),[3,4];case 3:return i.sent(),n=[],[3,4];case 4:return this.allProcessedFiles=r.__spreadArrays(this.allProcessedFiles,n),[4,this.onFilesAdded(n,this.allProcessedFiles)];case 5:return n=i.sent(),[4,this.onBeforeUpload(n)];case 6:return n=i.sent(),this.allProcessedFiles=[],[2,{items:n,errors:o}]}}))}))},t.nsIdForRouting=function(e){var r=p.Viewer.get_viewer().get_user_by_id(t.props.userId),o=""===t.props.context.currentFQPath,n=f(e.parentPath||"",e.destPath);return o?r.root_ns_id:(_.assert(null!=t.props.mountPoints,"mountPoints is null"),_.assert(null!=t.props.rootNSID,"rootNSID is null"),d.getNsId(t.props.mountPoints,t.props.rootNSID,n))},t.uploadBlock=function(e,o,n){return r.__awaiter(t,void 0,void 0,(function(){var t,i,a;return r.__generator(this,(function(r){switch(r.label){case 0:return t=p.Viewer.get_viewer().get_user_by_id(this.props.userId),i=function(t){n&&n(t.loaded),l.ActionsAdapter.emit("uploadProgress",{uploadItem:e})},[4,s.uploadBlock(t.id,this.nsIdForRouting(e),e.bytes,o,i)];case 1:if((a=r.sent()).isError)throw l.ActionsAdapter.emit("error",{uploadItem:e,errorType:a.error.type,user:t}),new Error;return[2,a.result.token]}}))}))},t.commitBlocksBatch=function(e){var o=p.Viewer.get_viewer().get_user_by_id(t.props.userId);return Promise.all(e.map((function(e){var n=e.info,a=e.tokens;return r.__awaiter(t,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.commitBlocks(o.id,f(n.parentPath||"",n.destPath),i.filename(n.destPath),n.bytes,a)];case 1:return(e=t.sent()).isError?l.ActionsAdapter.emit("error",{uploadItem:n,errorType:e.error.type,user:o}):l.ActionsAdapter.emit("fileUploaded",{uploadItem:n}),[2]}}))}))})))},t}return r.__extends(t,e),t.prototype.render=function(){return o.default.createElement(u.UploadProvider,{userId:this.props.userId,selectMultiple:!0,onChoose:this.onChoose,onChooseDropboxFile:this.onChooseDropboxFile,processFiles:this.processFiles,commitBlocksBatch:this.commitBlocksBatch,uploadBlock:this.uploadBlock,maxFileSize:524288e5,startUploadOnAdd:!0,Scheduler:this.props.Scheduler},this.props.children)},t})(o.default.Component);t.UnconnectedBrowseUploadProvider=m,t.BrowseUploadProvider=n.connect((function(e){return{context:a.context(e)}}))(m)})),define("modules/clean/react/browse/browse_view",["require","exports","tslib","classnames","immutable","react","modules/clean/browse_uri_interface","modules/clean/filetypes","modules/clean/react/browse/action_logger","modules/clean/react/browse/browse_async_modules","modules/clean/react/browse/browse_files_view","modules/clean/react/browse/sidebar_view","modules/clean/react/browse/title","modules/clean/react/browse/uri_helper","modules/clean/react/family/family_browse_root_async","modules/clean/react/file_uploader/file_uploader","modules/clean/react/files_view/types","modules/clean/react/folder_subscriptions/customization/async_customization_modal","modules/clean/react/folder_subscriptions/follow/async_folder_unfollower","modules/clean/react/growth/personalization/util","modules/clean/react/maestro/layout/search","modules/clean/react/plusplus/loadables","modules/clean/react/snackbar","modules/clean/react/snackbar_manager","modules/clean/react/vault/vault_browse_root_async","modules/clean/sharing/access_level","modules/clean/upsell/top_notification_listener","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b,I,y,F,C,O,A,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),i=r.__importDefault(i),l=r.__importStar(l);var L=[y.NameSpaceAccess.ACCESS_NO_ACCESS,y.NameSpaceAccess.ACCESS_READER,y.NameSpaceAccess.ACCESS_READER_NO_COMMENT];t.getCurrentDropTargetHighlightMode=function(e){var t=e.selectedFiles,r=e.context,o=e.isDraggingInternalFiles,n=e.isDraggingExternalFiles,i=e.isUploadModalOpen;return r.isInsideSharedFolder&&L.includes(r.currentSharedFolderPermissionRole)?h.DropTargetHighlightMode.NONE:o?t.some((function(e){return e.isDeleted||e.type===a.FileTypes.TEAM_SHARED_FOLDER}))?h.DropTargetHighlightMode.NONE:t.some((function(e){return e.type===a.FileTypes.SHARED_FOLDER}))?r.currentNSAllowsNesting?h.DropTargetHighlightMode.NONSELECTED_FOLDERS:h.DropTargetHighlightMode.NONSELECTED_NONSHARED_FOLDERS:h.DropTargetHighlightMode.NONSELECTED_FOLDERS:n&&!i?h.DropTargetHighlightMode.ALL_FOLDERS:h.DropTargetHighlightMode.NONE};var D=(function(t){function a(e){var r=t.call(this,e)||this;return r.snackbarManager=i.default.createRef(),r.vaultContentSlot=i.default.createRef(),r.vaultHeaderSlot=i.default.createRef(),r.vaultLockButtonSlot=i.default.createRef(),r.vaultEmptyContentSlot=i.default.createRef(),r.familyRoomHeaderSlot=i.default.createRef(),r.handleGetFileActionsForSetOfFiles=function(e,t,o,n){var i=r.props,s=i.context,a=i.user,l=i.isQueryingFolderSizes,c=i.browsePostTTIExperiments,d=i.browsePostTTIData,u=i.viewType,p=i.extensionsFeatureFlags,_=i.sharingServiceInfo,f=i.pinnedItems,m=r.state.fileActionsModule;if(!m)return[];var h=c.showAddToTransfer,g=c.showAddFolderToTransfer,S=c.expShowFileLocking,E=c.expVaultEnableViewOnlySharing,v=c.expMoveToRestrictiveFolder,w=r.props.browseExperiments.folderHistoryRollbacks;return m.getActionsForFileCollection({files:e,context:s,user:a,viewType:u,sharingServiceInfo:_,extensionsFeatureFlags:p,canDisplayFolderSizes:t,isSearchMode:!1,isOverFreeQuota:d.isOverFreeQuota,hasExcludedNsIds:d.hasExcludedNsIds,isQueryingFolderSizes:l,isSidebar:n,responsive:o,showAddToTransfer:!!h,showAddFolderToTransfer:!!g,pinnedItems:f,expFolderHistoryRollbacks:w,expShowFileLocking:S,forceSplitShareSecondary:!0,expVaultEnableViewOnlySharing:E,expMoveToRestrictiveFolder:v})},r.handleUploadButtonClick=function(e){m.FileUploaderController.setPath(r.props.path),m.FileUploaderController.handleUploadButtonClick(e)},r.handleShowFileUploader=function(){m.FileUploaderController.setPath(r.props.path),m.FileUploaderController.showModal()},r.handleSidebarContextMenuClick=function(){var e=r.props,t=e.selectedFiles,o=e.user,n=e.viewType,i=t?t.count((function(e){return e.is_dir})):0,s=t?t.count()-i:0;l.logContextMenuClick({uid:o.id,viewType:n,action_surface:A.ActionSurfaceLogValue.RIGHT_SIDEBAR,numFilesSelected:s,numFoldersSelected:i})},r.isInTeamSpaceRoot=function(){return r.props.context.isInsideMyTeamFolderTree&&r.props.context.isCurrentlyInRoot},r.isInitialEmptyAtTeamSpaceRoot=function(){return r.isInTeamSpaceRoot()&&1===r.state.initialTotalNumItems},r.shouldHideRightsideActions=function(){var e=r.props.browsePostTTIExperiments.expPersonalizedFirstPaths,t=r.props.browsePostTTIData.firstTaskProps.member_info;return!!e&&(e.firstPath!==E.FirstPathId.COLLECTIONS&&r.isInitialEmptyAtTeamSpaceRoot()&&t.users.length<=1&&E.enableHideRightsideActions(r.props.browsePostTTIExperiments.expPersonalizedFirstPaths))},r.shouldHideSideBarCtas=function(){var e=r.props.browsePostTTIExperiments.expPersonalizedFirstPaths;return!!r.state.initialHideState||(e?r.isInTeamSpaceRoot()&&1===r.props.totalNumItems&&E.enableHideRightsideActions(r.props.browsePostTTIExperiments.expPersonalizedFirstPaths):r.isFirstTaskEmptyState())},r.shouldHideSelectionPreviewPane=function(){if(r.state.initialHideState)return!0;var e=r.props.browsePostTTIData.firstTaskProps.member_info;return r.props.browsePostTTIExperiments.expPersonalizedFirstPaths?r.isInitialEmptyAtTeamSpaceRoot()&&e.users.length<=1&&E.enableHideRightsideActions(r.props.browsePostTTIExperiments.expPersonalizedFirstPaths):r.isFirstTaskEmptyState()},r.isInviteMode=function(){return E.enableInvitePanel(r.props.browsePostTTIExperiments.expPersonalizedFirstPaths)&&r.props.browsePostTTIData.firstTaskProps.member_info.users.length<=1},r.isFirstTaskEmptyState=function(){return r.props.browsePostTTIData.firstTaskProps.is_eligible_team&&r.isInTeamSpaceRoot()&&1===r.props.totalNumItems},r.setHideFilesAndSidebar=function(e){r.props.setHideFilesAndSidebar({shouldHideFilesAndSidebar:e})},r.renderFilesViewController=function(e,t){return r.props.loadingState===h.LoadingState.LOAD_ERROR?i.default.createElement(i.default.Suspense,{fallback:i.default.createElement("div",null,P.intl.formatMessage({id:"zD5i93",defaultMessage:"Something went wrong on our end."}))},i.default.createElement(M,null)):i.default.createElement(d.BrowseFilesView,{responsive:e,vaultContentSlot:r.vaultContentSlot,vaultEmptyContentSlot:r.vaultEmptyContentSlot,isFirstTaskEmptyState:r.isFirstTaskEmptyState(),initialTotalNumItems:r.state.initialTotalNumItems,handleShowFileUploader:r.handleShowFileUploader,handleUploadButtonClick:r.handleUploadButtonClick,handleGetFileActionsForSetOfFiles:r.handleGetFileActionsForSetOfFiles,isDraggingExternalFiles:r.props.isDraggingExternalFiles,isDraggingInternalFiles:r.props.isDraggingInternalFiles,isUploadModalOpen:r.props.isUploadModalOpen,onNavigateToFileOrFolder:r.props.onNavigateToFileOrFolder,isFileViewerShown:r.props.isFileViewerShown,handleComponentTTI:r.props.handleComponentTTI,starredState:r.props.starredState,initialHideState:r.state.initialHideState,uploadAjaxInterceptor:r.props.uploadAjaxInterceptor,isActive:!!t})},r.renderSidebar=function(e,t){return r.props.shouldHideFilesAndSidebar?null:"V2"===r.props.browseExperiments.browseActionToolbar?i.default.createElement(c.AsyncBrowseSidebar,null):i.default.createElement(u.BrowseSidebarView,{handleComponentTTI:r.props.handleComponentTTI,starredState:r.props.starredState,uploadAjaxInterceptor:r.props.uploadAjaxInterceptor,onUploadButtonClick:r.handleUploadButtonClick,onGetFileActionsForFiles:r.handleGetFileActionsForSetOfFiles,responsive:e,onContextMenuClick:r.handleSidebarContextMenuClick,scrollableSidebarRef:t,hideSidebarCtas:r.shouldHideSideBarCtas(),hideSelectionPreviewPane:r.shouldHideSelectionPreviewPane(),hideRightsideActions:r.shouldHideRightsideActions(),showInviteSidePanel:r.isInviteMode(),personalizationLogCtx:r.getPersonalizationLogCtx()})},r.renderTitle=function(){var e=r.props,t=e.context,o=e.isDraggingInternalFiles,n=e.isUploadModalOpen;return i.default.createElement(i.default.Fragment,null,t.isInsideVaultFolder&&i.default.createElement("div",{ref:r.vaultLockButtonSlot}),i.default.createElement(p.BrowseTitle,{isDraggingInternalFiles:o,isUploadModalOpen:n}),t.isInsideVaultFolder&&i.default.createElement("div",{ref:r.vaultHeaderSlot}),t.isInFamilySharedFolder&&i.default.createElement("div",{ref:r.familyRoomHeaderSlot}))},r.state={searchBarProps:r.getCurrentSearchBarProps(r.props),initialTotalNumItems:r.props.totalNumItems||1,initialHideState:!!r.props.isSmbPersonalization,hideFilesAndSidebar:!1},r}return r.__extends(a,t),a.prototype.UNSAFE_componentWillMount=function(){var e=this;this.topNotificationListener=F.createTopNotificationListener((function(t){e.setState({hasTopNotification:t})}))},a.prototype.UNSAFE_componentWillReceiveProps=function(e){e.path!==this.props.path&&this.setState({searchBarProps:this.getCurrentSearchBarProps(e)})},a.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var t=this;return r.__generator(this,(function(o){switch(o.label){case 0:return T.Snackbar.manager=this.snackbarManager.current,[4,O.waitForTTI()];case 1:return o.sent(),Promise.all([new Promise((function(t,r){e(["modules/clean/react/browse/file_actions/file_actions"],t,r)})).then(r.__importStar)]).then((function(e){var r=e[0];t.setState({fileActionsModule:r})})),m.FileUploaderController.loadCoreComponent(),this.props.shouldOpenUploadModal&&this.handleShowFileUploader(),C.UEClient.sendEvent("BrowseView","componentDidMount",this.props.context.toJSON()),l.logPageView(this.getPageVieworBrowseLoadedData()),[2]}}))}))},a.prototype.componentDidUpdate=function(e){void 0!==this.props.browsePostTTIExperiments.expPersonalizedFirstPaths&&this.state.initialHideState&&this.setState({initialHideState:!1}),this.props.loadingState===h.LoadingState.LOADED&&C.UEClient.sendEvent("BrowseView","componentDidUpdate",this.props.context.toJSON()),this.props.loadingState===h.LoadingState.LOADED&&e.loadingState===h.LoadingState.LOADING_FIRST_PAGE&&(l.logBrowseLoaded(this.getPageVieworBrowseLoadedData()),this.setState({initialTotalNumItems:this.props.totalNumItems})),this.props.isInsideEmptyCollectionFolder&&!e.isInsideEmptyCollectionFolder&&this.props.handleComponentTTI("AppActionsView")},a.prototype.getCurrentFolderType=function(){var e=this.props,t=e.context,r=e.user;if(t.isInsideVaultFolder)return"vault";if(r.is_cdm_member){if("/"===t.currentFQPath&&t.currentNSID===t.rootNSID)return"root";if(t.isCurrentlyInRoot)return"team_folder"}else if(t.isCurrentlyInRoot)return"root";return t.isInsideTeamFolderTree?"team_shared_folder":t.isInsideSharedFolder&&""===t.currentNSPath?"shared_folder":"folder"},a.prototype.getPageVieworBrowseLoadedData=function(){var e=this.props,t=e.context,r=e.user,o=e.viewType,n=t.currentFQPath.split("/").filter((function(e){return!!e})).length;return 0===n?{uid:r.id,view_type:o,url:s.get_browse_root(r),folder_type:this.getCurrentFolderType()}:{uid:r.id,view_type:o,url:s.get_browse_root(r)+"/*",navigation_depth:n,folder_type:this.getCurrentFolderType()}},a.prototype.componentWillUnmount=function(){this.topNotificationListener.unsubscribe()},a.prototype.getCurrentSearchBarProps=function(e){return{searchVariant:"full-page",currentPath:e.path}},a.prototype.getPersonalizationLogCtx=function(){return{role:E.getRole(this.props.browsePostTTIExperiments.expPersonalizedFirstPaths),totalNumItems:this.props.totalNumItems}},a.prototype.render=function(){var e=this.props,t=e.user,r=e.clickRewindTimestamp,n=e.clickFolderHistoryTimestamp,s=e.context,a=e.handleComponentTTI,l=e.isRewindVisible,d=e.isFolderHistoryVisible,u=e.browsePostTTIExperiments,p=u.expMobileWebInvites,m=u.expVaultAutoLockWeb,h=e.browseExperiments,E=h.folderHistoryRollbacks,T=h.plusPlusEnabled,y=e.showPlusPlusSetupModal,F=e.path,C=e.onCloseRewind,O=e.onCloseFolderHistoryPanel,A=e.userVersionHistoryLength,P=e.shouldShowVaultEmptyState,L=o.default("exp-details-pane-variants",{"exp-mobile-web-invites":p}),D=o.default(L,"dig2--enabled");return i.default.createElement("div",{className:L},i.default.createElement(c.AsyncRewindPanel,{clickBrowseButtonTimestampMs:r,user:t,fromDesktopClient:"true"===_.getQueryArgs().from_desktop_client,browseContext:s,close:C,isVisible:l,expFolderHistoryRollbacks:E||!1,userVersionHistoryLength:A}),i.default.createElement(c.AsyncFolderHistoryPanel,{browseContext:s,clickFolderHistoryButtonInBrowseTimestampMs:n,close:O,isVisible:d,user:t,userVersionHistoryLength:A}),T?i.default.createElement(w.AsyncPlusPlusSetupModal,{userId:t.id,forceShow:y}):null,s.isInsideVaultFolder&&i.default.createElement(I.AsyncVaultRoot,{contentSlot:this.vaultContentSlot,vaultEmptyContentSlot:this.props.isActionBarEnabled?this.vaultEmptyContentSlot:void 0,headerSlot:this.vaultHeaderSlot,lockButtonSlot:this.vaultLockButtonSlot,handleComponentTTI:a,shouldShowVaultEmptyState:P,encryptionOptions:this.props.encryptionOptions,expVaultAutoLockWeb:m,setHideFilesAndSidebar:this.setHideFilesAndSidebar,path:F,user:t}),s.isInFamilySharedFolder&&i.default.createElement(f.AsyncFamilyRoot,{user:t,path:F,expFamilyFeedbackForm:this.props.browsePostTTIExperiments.expFamilyFeedbackForm,headerSlot:this.familyRoomHeaderSlot}),_.getQueryArgs().unfollow_folder&&i.default.createElement(S.AsyncFolderUnfollower,null),i.default.createElement(g.AsyncCustomizationModal,{path:s.currentFQPath}),i.default.createElement(v.SearchChrome,{user:t,titleRegion:this.renderTitle(),titleClass:"page-header__title-overflow",embeddedAppRegion:this.renderFilesViewController,actionSidebarRegion:this.renderSidebar,searchBarProps:this.state.searchBarProps,scrollableSidebarRegion:this.renderSidebar,useScrollableSidebar:!0,chromeClass:D,useMaestroPortal:!0,useSidebarV2:"V2"===this.props.browseExperiments.browseActionToolbar}),i.default.createElement(b.SnackbarManager,{ref:this.snackbarManager,getParentElement:b.SnackbarManager.getEmbeddedAppPagelet,useDigSnackbars:!0}))},a.defaultProps={selectedFiles:n.OrderedMap(),viewType:h.ViewType.List},a})(i.default.PureComponent);t.BrowseView=D;var M=i.default.lazy((function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/browse/components/post_tti/error"],t,r)})).then(r.__importStar)];case 1:return[2,{default:t.sent().ErrorComponent}]}}))}))}))})),define("modules/clean/react/browse/browse",["require","exports","tslib","react","react-intl","react-redux","dropbox/proto/js_init_data/browse_web/browse_web","dropbox/proto/js_init_data/web_timing_logger/web_timing_logger","proto_utils/unpack","modules/clean/react/browse/async_extensions","modules/clean/react/browse/constants","modules/clean/react/browse/controller","modules/clean/react/browse/data/action_creators/index","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/store","modules/clean/react/files_view/types","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/maestro_nav/folder_explorer/data/store","modules/clean/search/search_bar/data/action_creators","modules/clean/search/search_bar/data/selectors","modules/clean/viewer","modules/clean/web_timing_logger","modules/core/browser_detection","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b,I,y,F,C,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),p=r.__importStar(p),_=r.__importStar(_),f=r.__importStar(f),h=r.__importStar(h),g=r.__importStar(g),S=r.__importStar(S),w=r.__importStar(w),b=r.__importStar(b),I=r.__importStar(I),F=r.__importStar(F),t.AsyncBoltHandler=o.default.lazy((function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,F.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/bolt/handler"],t,r)})).then(r.__importStar)];case 2:return[2,{default:t.sent().ConnectedBoltHandler}]}}))}))}));var A={appendFiles:p.appendFiles,blurSearchBar:b.blurSearchBar,clearSearchBar:b.clearSearchBar,setIsRewindButtonEnabled:p.setIsRewindButtonEnabled,hideRewind:p.hideRewind,showRewind:p.showRewind,hideFolderHistoryPanel:p.hideFolderHistoryPanel,showFolderHistoryPanel:p.showFolderHistoryPanel,setBrowsePostTTIExperiments:p.setBrowsePostTTIExperiments,setBrowsePostTTIData:p.setBrowsePostTTIData,setLoadingState:p.setLoadingState,setMountPoints:p.setMountPoints,setPath:p.setPath,setPathData:p.setPathData,setShouldShowDeletedFiles:p.setShouldShowDeletedFiles,setUrl:p.setUrl,setArePostTTIModulesLoaded:p.setArePostTTIModulesLoaded,setIsFileViewerShown:p.setIsFileViewerShown,handleFolderOverviewPrefetch:w.handlePrefetch,addFolderOverviewLoadedComponent:w.addLoadedComponent,setHideFilesAndSidebar:p.setHideFilesAndSidebar},P=i.connect((function(e){var t=f.context,r=f.sortedFilesWithFolderSizes,o=f.isFolderHistoryVisible,n=f.path,i=f.selection,s=f.selectedFiles,a=f.shouldShowDeletedFiles,l=f.isRewindVisible,u=f.urlPrefix,p=f.canDisplayFolderSizes,m=f.isQueryingFolderSizes,h=f.user,E=f.viewer,v=f.browsePostTTIExperiments,w=f.mountPoints,T=f.clickRewindTimestamp,b=f.clickFolderHistoryTimestamp,y=f.sortOrder,F=f.isInsideEmptyCollectionFolder,C=f.browsePostTTIData,O=f.shouldHideFilesAndSidebar,A=f.isActionBarEnabled,P=_.paginatedTotalNumFiles,L=_.loadingState,D=_.folderOverviewPinnedItems,M=_.shouldShowVaultEmptyState,R=g.viewTypeColumns,N=S.selectViewType,x=I.searchSessionId,k=I.isSearchBarFocused;return c.asyncExtensions.init(),{files:r(e),paginatedTotalNumFiles:P(e),loadingState:L(e),path:n(e),shouldShowDeletedFiles:a(e),isFolderHistoryVisible:o(e),isRewindVisible:l(e),clickRewindTimestamp:T(e),clickFolderHistoryTimestamp:b(e),urlPrefix:u(e),canDisplayFolderSizes:p(e),viewTypeColumns:R(e),isQueryingFolderSizes:m(e),user:h(e),viewer:E(e),currentSort:y(e),browsePostTTIExperiments:v(e),browseContext:t(e),selection:i(e),selectedFiles:s(e),mountPoints:w(e),searchSessionId:x(e),isSearchBarFocused:k(e),viewType:N(e,{instanceId:d.BROWSE_FILES_VIEW_ID}),sharingServiceInfo:c.asyncExtensions.sharingServiceInfo(e),extensionsFeatureFlags:c.asyncExtensions.getFeatureFlags(e),pinnedItems:D(e),emptyFolder:_.emptyFolder(e,{instanceId:d.BROWSE_FILES_VIEW_ID}),isInsideEmptyCollectionFolder:F(e),shouldShowVaultEmptyState:M(e),browsePostTTIData:C(e),shouldHideFilesAndSidebar:O(e),isActionBarEnabled:A(e)}}),A)(u.BrowseController),L=(function(e){function s(t){var r,o,n=e.call(this,t)||this;F.log_js_modules_application_code_start(),E.getStoreForFilesView(),T.getStoreForFileExplorer(),n.reduxStore=m.getStoreForBrowse();var i=y.Viewer.get_viewer(),s=i.get_user_by_id(t.userId),a="M1"===(null===(r=t.browseExperiments)||void 0===r?void 0:r.browseBetterViewSettings),l="M1"!==(null===(o=t.browseExperiments)||void 0===o?void 0:o.browseHighDensityListView)||C.is_supported_mobile_browser()?void 0:v.ViewType.CondensedList;return n.reduxStore.dispatch(h.loadViewTypes({user:s,useViewPreferences:a,defaultViewType:l})),n.reduxStore.dispatch(h.loadViewTypeColumns({user:s,useViewPreferences:a})),n.reduxStore.dispatch(p.setPath({path:t.initFqPath||"/"})),n.reduxStore.dispatch(p.appInit({props:t,user:s,viewer:i})),n}return r.__extends(s,e),s.prototype.render=function(){return o.default.createElement(i.Provider,{store:this.reduxStore},o.default.createElement(n.RawIntlProvider,{value:O.intl},o.default.createElement(o.default.Fragment,null,o.default.createElement(P,r.__assign({},this.props)),o.default.createElement(o.default.Suspense,{fallback:o.default.createElement(o.default.Fragment,null)},o.default.createElement(t.AsyncBoltHandler,null)))))},s})(o.default.PureComponent);t.BrowseApp=L,t.RootComponent=function(e){var t=l.unpackProto(e.encodedProto,s.browse_web.BrowseWebPageProps),n=t.webTimingLoggerServerContext,i=r.__rest(t,["webTimingLoggerServerContext"]);return F.initialize({log_time_to_view:!0,log_time_to_interactive:!0},l.unpackProto(n,a.web_timing_logger.WebTimingLoggerServerContext)),o.default.createElement(L,r.__assign({},i))}})),define("dropbox/proto/js_init_data/browse_web/browse_web",["require","exports","tslib","protobufjs/minimal","dropbox/proto/js_init_data/login_form/login_form"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(o=r.__importStar(o)).Reader,s=o.Writer,a=o.util,l=o.roots.default||(o.roots.default={});t.default=l,t.browse_web=l.browse_web=((n=l.browse_web||{}).BrowseExperiments=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.goldenGateRaclsEnabled=!1,e.prototype.folderHistoryRollbacks=!1,e.prototype.lifeVault=!1,e.prototype.sidebarNavigationDelegation=!1,e.prototype.plusPlusEnabled=!1,e.prototype.browseWebHqlPilot=!1,e.prototype.useMaestroPortal="",e.prototype.parallelFileUploads=!1,e.prototype.browseActionToolbar="",e.prototype.browseBetterViewSettings="",e.prototype.browseColumnHeaderImprovements=!1,e.prototype.browseHighDensityListView="",e.prototype.browseColumnResizing=!1,e.prototype.browsePinnedTeamFolders="",e.prototype.browseCutAndPaste=!1,e.prototype.browseDragToSelect="",e.prototype.spacesFssModalVariant="",e.prototype.browseMoreColumns="",e.prototype.splitTmfTsd=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.goldenGateRaclsEnabled&&Object.hasOwnProperty.call(e,"goldenGateRaclsEnabled")&&t.uint32(8).bool(e.goldenGateRaclsEnabled),null!=e.folderHistoryRollbacks&&Object.hasOwnProperty.call(e,"folderHistoryRollbacks")&&t.uint32(24).bool(e.folderHistoryRollbacks),null!=e.lifeVault&&Object.hasOwnProperty.call(e,"lifeVault")&&t.uint32(72).bool(e.lifeVault),null!=e.sidebarNavigationDelegation&&Object.hasOwnProperty.call(e,"sidebarNavigationDelegation")&&t.uint32(88).bool(e.sidebarNavigationDelegation),null!=e.plusPlusEnabled&&Object.hasOwnProperty.call(e,"plusPlusEnabled")&&t.uint32(112).bool(e.plusPlusEnabled),null!=e.browseWebHqlPilot&&Object.hasOwnProperty.call(e,"browseWebHqlPilot")&&t.uint32(120).bool(e.browseWebHqlPilot),null!=e.useMaestroPortal&&Object.hasOwnProperty.call(e,"useMaestroPortal")&&t.uint32(130).string(e.useMaestroPortal),null!=e.parallelFileUploads&&Object.hasOwnProperty.call(e,"parallelFileUploads")&&t.uint32(152).bool(e.parallelFileUploads),null!=e.browseActionToolbar&&Object.hasOwnProperty.call(e,"browseActionToolbar")&&t.uint32(162).string(e.browseActionToolbar),null!=e.browseBetterViewSettings&&Object.hasOwnProperty.call(e,"browseBetterViewSettings")&&t.uint32(170).string(e.browseBetterViewSettings),null!=e.browseColumnHeaderImprovements&&Object.hasOwnProperty.call(e,"browseColumnHeaderImprovements")&&t.uint32(176).bool(e.browseColumnHeaderImprovements),null!=e.browseHighDensityListView&&Object.hasOwnProperty.call(e,"browseHighDensityListView")&&t.uint32(186).string(e.browseHighDensityListView),null!=e.browseColumnResizing&&Object.hasOwnProperty.call(e,"browseColumnResizing")&&t.uint32(192).bool(e.browseColumnResizing),null!=e.browsePinnedTeamFolders&&Object.hasOwnProperty.call(e,"browsePinnedTeamFolders")&&t.uint32(202).string(e.browsePinnedTeamFolders),null!=e.browseCutAndPaste&&Object.hasOwnProperty.call(e,"browseCutAndPaste")&&t.uint32(208).bool(e.browseCutAndPaste),null!=e.browseDragToSelect&&Object.hasOwnProperty.call(e,"browseDragToSelect")&&t.uint32(218).string(e.browseDragToSelect),null!=e.spacesFssModalVariant&&Object.hasOwnProperty.call(e,"spacesFssModalVariant")&&t.uint32(226).string(e.spacesFssModalVariant),null!=e.browseMoreColumns&&Object.hasOwnProperty.call(e,"browseMoreColumns")&&t.uint32(234).string(e.browseMoreColumns),null!=e.splitTmfTsd&&Object.hasOwnProperty.call(e,"splitTmfTsd")&&t.uint32(240).bool(e.splitTmfTsd),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new l.browse_web.BrowseExperiments;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.goldenGateRaclsEnabled=e.bool();break;case 3:o.folderHistoryRollbacks=e.bool();break;case 9:o.lifeVault=e.bool();break;case 11:o.sidebarNavigationDelegation=e.bool();break;case 14:o.plusPlusEnabled=e.bool();break;case 15:o.browseWebHqlPilot=e.bool();break;case 16:o.useMaestroPortal=e.string();break;case 19:o.parallelFileUploads=e.bool();break;case 20:o.browseActionToolbar=e.string();break;case 21:o.browseBetterViewSettings=e.string();break;case 22:o.browseColumnHeaderImprovements=e.bool();break;case 23:o.browseHighDensityListView=e.string();break;case 24:o.browseColumnResizing=e.bool();break;case 25:o.browsePinnedTeamFolders=e.string();break;case 26:o.browseCutAndPaste=e.bool();break;case 27:o.browseDragToSelect=e.string();break;case 28:o.spacesFssModalVariant=e.string();break;case 29:o.browseMoreColumns=e.string();break;case 30:o.splitTmfTsd=e.bool();break;default:e.skipType(7&n)}}return o},e.getTypeUrl=function(){return"type.googleapis.com/browse_web.BrowseExperiments"},e})(n.BrowseExperiments||{}),n.BrowseWebPageProps=(function(e){function e(e){if(this.selectFqPaths=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.autoTeamGroupId="",e.prototype.emailJustVerified=!1,e.prototype.emailJustVerifiedAndChanged=!1,e.prototype.fromSclSyncModal=!1,e.prototype.initFqPath="",e.prototype.nsId=a.Long?a.Long.fromBits(0,0,!1):0,e.prototype.nsPath="",e.prototype.openPreview=!1,e.prototype.selectFqPaths=a.emptyArray,e.prototype.sendVerificationEmail=!1,e.prototype.shareLink=!1,e.prototype.sharePrefillEmail="",e.prototype.shouldShowDeletedFiles=!1,e.prototype.shouldShowUnsyncNotification=!1,e.prototype.shouldOpenExtensionsEduModal="",e.prototype.shouldOpenAppRecommendationsModal=!1,e.prototype.shouldOpenUploadModal=!1,e.prototype.showShareModal=!1,e.prototype.showShareSuccessSnackbar=!1,e.prototype.showingClientModal=!1,e.prototype.showingMobileBillingModal=!1,e.prototype.userId=a.Long?a.Long.fromBits(0,0,!1):0,e.prototype.userVersionHistoryLength=0,e.prototype.browseExperiments=null,e.prototype.webTimingLoggerServerContext="",e.prototype.showPlusPlusSetupModal=!1,e.prototype.isSmbPersonalization=!1,e.prototype.hasLinkedMobile=!1,e.prototype.encryptionOptions=null,e.prototype.fromCtl=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.autoTeamGroupId&&Object.hasOwnProperty.call(e,"autoTeamGroupId")&&t.uint32(10).string(e.autoTeamGroupId),null!=e.emailJustVerified&&Object.hasOwnProperty.call(e,"emailJustVerified")&&t.uint32(16).bool(e.emailJustVerified),null!=e.emailJustVerifiedAndChanged&&Object.hasOwnProperty.call(e,"emailJustVerifiedAndChanged")&&t.uint32(24).bool(e.emailJustVerifiedAndChanged),null!=e.fromSclSyncModal&&Object.hasOwnProperty.call(e,"fromSclSyncModal")&&t.uint32(32).bool(e.fromSclSyncModal),null!=e.initFqPath&&Object.hasOwnProperty.call(e,"initFqPath")&&t.uint32(42).string(e.initFqPath),null!=e.nsId&&Object.hasOwnProperty.call(e,"nsId")&&t.uint32(48).int64(e.nsId),null!=e.nsPath&&Object.hasOwnProperty.call(e,"nsPath")&&t.uint32(58).string(e.nsPath),null!=e.openPreview&&Object.hasOwnProperty.call(e,"openPreview")&&t.uint32(64).bool(e.openPreview),null!=e.selectFqPaths&&e.selectFqPaths.length)for(var r=0;r<e.selectFqPaths.length;++r)t.uint32(74).string(e.selectFqPaths[r]);return null!=e.sendVerificationEmail&&Object.hasOwnProperty.call(e,"sendVerificationEmail")&&t.uint32(80).bool(e.sendVerificationEmail),null!=e.shareLink&&Object.hasOwnProperty.call(e,"shareLink")&&t.uint32(88).bool(e.shareLink),null!=e.sharePrefillEmail&&Object.hasOwnProperty.call(e,"sharePrefillEmail")&&t.uint32(98).string(e.sharePrefillEmail),null!=e.shouldShowDeletedFiles&&Object.hasOwnProperty.call(e,"shouldShowDeletedFiles")&&t.uint32(104).bool(e.shouldShowDeletedFiles),null!=e.shouldShowUnsyncNotification&&Object.hasOwnProperty.call(e,"shouldShowUnsyncNotification")&&t.uint32(112).bool(e.shouldShowUnsyncNotification),null!=e.shouldOpenExtensionsEduModal&&Object.hasOwnProperty.call(e,"shouldOpenExtensionsEduModal")&&t.uint32(122).string(e.shouldOpenExtensionsEduModal),null!=e.shouldOpenAppRecommendationsModal&&Object.hasOwnProperty.call(e,"shouldOpenAppRecommendationsModal")&&t.uint32(128).bool(e.shouldOpenAppRecommendationsModal),null!=e.shouldOpenUploadModal&&Object.hasOwnProperty.call(e,"shouldOpenUploadModal")&&t.uint32(136).bool(e.shouldOpenUploadModal),null!=e.showShareModal&&Object.hasOwnProperty.call(e,"showShareModal")&&t.uint32(144).bool(e.showShareModal),null!=e.showShareSuccessSnackbar&&Object.hasOwnProperty.call(e,"showShareSuccessSnackbar")&&t.uint32(152).bool(e.showShareSuccessSnackbar),null!=e.showingClientModal&&Object.hasOwnProperty.call(e,"showingClientModal")&&t.uint32(160).bool(e.showingClientModal),null!=e.showingMobileBillingModal&&Object.hasOwnProperty.call(e,"showingMobileBillingModal")&&t.uint32(168).bool(e.showingMobileBillingModal),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(176).int64(e.userId),null!=e.userVersionHistoryLength&&Object.hasOwnProperty.call(e,"userVersionHistoryLength")&&t.uint32(184).int32(e.userVersionHistoryLength),null!=e.browseExperiments&&Object.hasOwnProperty.call(e,"browseExperiments")&&l.browse_web.BrowseExperiments.encode(e.browseExperiments,t.uint32(194).fork()).ldelim(),null!=e.webTimingLoggerServerContext&&Object.hasOwnProperty.call(e,"webTimingLoggerServerContext")&&t.uint32(210).string(e.webTimingLoggerServerContext),null!=e.showPlusPlusSetupModal&&Object.hasOwnProperty.call(e,"showPlusPlusSetupModal")&&t.uint32(216).bool(e.showPlusPlusSetupModal),null!=e.isSmbPersonalization&&Object.hasOwnProperty.call(e,"isSmbPersonalization")&&t.uint32(224).bool(e.isSmbPersonalization),null!=e.hasLinkedMobile&&Object.hasOwnProperty.call(e,"hasLinkedMobile")&&t.uint32(232).bool(e.hasLinkedMobile),null!=e.encryptionOptions&&Object.hasOwnProperty.call(e,"encryptionOptions")&&l.login_form.EncryptionOptions.encode(e.encryptionOptions,t.uint32(242).fork()).ldelim(),null!=e.fromCtl&&Object.hasOwnProperty.call(e,"fromCtl")&&t.uint32(248).bool(e.fromCtl),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new l.browse_web.BrowseWebPageProps;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.autoTeamGroupId=e.string();break;case 2:o.emailJustVerified=e.bool();break;case 3:o.emailJustVerifiedAndChanged=e.bool();break;case 4:o.fromSclSyncModal=e.bool();break;case 5:o.initFqPath=e.string();break;case 6:o.nsId=e.int64();break;case 7:o.nsPath=e.string();break;case 8:o.openPreview=e.bool();break;case 9:o.selectFqPaths&&o.selectFqPaths.length||(o.selectFqPaths=[]),o.selectFqPaths.push(e.string());break;case 10:o.sendVerificationEmail=e.bool();break;case 11:o.shareLink=e.bool();break;case 12:o.sharePrefillEmail=e.string();break;case 13:o.shouldShowDeletedFiles=e.bool();break;case 14:o.shouldShowUnsyncNotification=e.bool();break;case 15:o.shouldOpenExtensionsEduModal=e.string();break;case 16:o.shouldOpenAppRecommendationsModal=e.bool();break;case 17:o.shouldOpenUploadModal=e.bool();break;case 18:o.showShareModal=e.bool();break;case 19:o.showShareSuccessSnackbar=e.bool();break;case 20:o.showingClientModal=e.bool();break;case 21:o.showingMobileBillingModal=e.bool();break;case 22:o.userId=e.int64();break;case 23:o.userVersionHistoryLength=e.int32();break;case 24:o.browseExperiments=l.browse_web.BrowseExperiments.decode(e,e.uint32());break;case 26:o.webTimingLoggerServerContext=e.string();break;case 27:o.showPlusPlusSetupModal=e.bool();break;case 28:o.isSmbPersonalization=e.bool();break;case 29:o.hasLinkedMobile=e.bool();break;case 30:o.encryptionOptions=l.login_form.EncryptionOptions.decode(e,e.uint32());break;case 31:o.fromCtl=e.bool();break;default:e.skipType(7&n)}}return o},e.getTypeUrl=function(){return"type.googleapis.com/browse_web.BrowseWebPageProps"},e})(n.BrowseWebPageProps||{}),n)})),define("modules/clean/react/browse/components/first_task_create_folder_button",["require","exports","tslib","react","dig-components/buttons","modules/clean/react/css"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);t.FirstTaskCreateFolderButton=i.requireCssWithComponent((function(e){var t=e.createFolderAction;return o.default.createElement("div",{className:"first-task-create-folder-button-container"},o.default.createElement(n.Button,{variant:"opacity",className:"first-task-create-folder-button",onClick:function(){t.handleClick&&t.handleClick()},disabled:t.disabled},t.displayName))}),["/static/css/dig-components/index.web-vflrectwC.css","/static/css/browse/first_task_create_folder_button-vflhhsdlT.css"])})),define("modules/clean/react/browse/components/import_painted_door_button",["require","exports","tslib","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","modules/clean/static_urls","modules/clean/react/css","modules/core/i18n","modules/core/browser","modules/clean/web_user_action_logger","modules/clean/web_user_action_events","modules/clean/react/image"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),u=r.__importStar(u);var m=[{key:"google drive",displayName:d.intl.formatMessage({id:"B8KWTE",defaultMessage:"Google Drive"}),icon:o.default.createElement(f.Image,{className:"import-painted-door-icon import-painted-door-icon__drive",width:20,height:20,src:l.static_url("/static/images/growth/import_painted_door/google_drive_logo-vflKwckuX.png")})},{key:"icloud",displayName:d.intl.formatMessage({id:"bKRt8R",defaultMessage:"iCloud"}),icon:o.default.createElement(f.Image,{className:"import-painted-door-icon import-painted-door-icon__icloud",width:20,height:20,src:l.static_url("/static/images/growth/import_painted_door/apple_icloud_logo-vfllCi8cM.png")})},{key:"microsoft onedrive",displayName:d.intl.formatMessage({id:"RpeoU1",defaultMessage:"Microsoft OneDrive"}),icon:o.default.createElement(f.Image,{className:"import-painted-door-icon import-painted-door-icon__onedrive",width:20,height:20,src:l.static_url("/static/images/growth/import_painted_door/microsoft_office_logo-vfl4Twkzl.png")})},{key:"other",displayName:d.intl.formatMessage({id:"TBg4yk",defaultMessage:"Other services"}),icon:o.default.createElement(i.UIIcon,{className:"import-painted-door-icon",src:s.DownloadLine})}];t.ImportPaintedDoorButton=c.requireCssWithComponent((function(e){var t=function(e,t){return o.default.createElement(a.Menu.ActionItem,{className:"import-painted-door-item",key:e.key,value:e,withLeftAccessory:o.default.createElement("div",{className:"import-painted-door-item__icon"},e.icon)},e.displayName)},i=function(){p.WebUserActionLog.log(e.userId,_.WebUserActionLogEvent.IMPORT_CLICK,{})};return o.default.createElement(a.Menu.Wrapper,{onSelection:function(t){p.WebUserActionLog.log(e.userId,_.WebUserActionLogEvent.IMPORT_OPTION_CLICK,{option:t.key}).then((function(){u.redirect("https://help.dropbox.com/es-la/installs-integrations/sync-uploads/import-files")}))},className:"import-painted-door-container "+e.className},(function(e){var s=e.getContentProps,l=e.getTriggerProps;return o.default.createElement(o.default.Fragment,null,o.default.createElement(n.Button,r.__assign({},l({onClick:i}),{variant:"opacity",withDropdownIcon:!0,className:"import-painted-door-button"}),d.intl.formatMessage({id:"dP8mnr",defaultMessage:"Import"})),o.default.createElement(a.Menu.Content,r.__assign({},s()),o.default.createElement(a.Menu.Segment,null,m.map(t))))}))}),["/static/css/spectrum/index.web-vfl6Z83yw.css","/static/css/browse/import_painted_door_button-vfl0dU2NL.css"])})),define("modules/clean/react/browse/components/personalization_upload_files_button",["require","exports","tslib","react","modules/clean/react/css","modules/core/i18n","modules/clean/analytics","modules/clean/react/growth/teams_web_actions_logger_events","dig-components/buttons"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);t.PersonalizationUploadFilesButton=n.requireCssWithComponent((function(e){var t=e.handleUploadButtonClick;return o.default.createElement(l.Button,{type:"button",onClick:function(){s.TeamsWebActionsLogger.log(a.TeamSpaceEmptyZoneCTALoggerEvents.UPLOAD_FILES_CLICKED,{empty_state_personalization:!0}),t(!1)},variant:"primary"},i.intl.formatMessage({id:"YrKf3U",defaultMessage:"Upload files"}))}),["/static/css/dig-components/index.web-vflrectwC.css"])})),define("modules/clean/react/browse/controller",["require","exports","tslib","external/lodash","react","spectrum-sharing/utils/sharing_constants","modules/clean/analytics","modules/clean/css","modules/clean/em_string","modules/clean/filepath","modules/clean/filetypes","modules/clean/history","modules/clean/navigation","modules/clean/pagelet_logger","modules/clean/pagination_manager","modules/clean/react/app_actions/education/async_extensions_edu_modal","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/api","modules/clean/react/browse/browse_prefetch_loader","modules/clean/react/browse/browse_upload_provider","modules/clean/react/browse/browse_view","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/extensions/app_recommendations_modal/async_modal","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/file_uploader","modules/clean/react/file_uploader/parallel_scheduler","modules/clean/react/file_uploader/store","modules/clean/react/file_uploader/utils","modules/clean/react/file_viewer/async_controller","modules/clean/react/files_view/constants","modules/clean/react/files_view/types","modules/clean/react/snackbar","modules/clean/react/vault/constants","modules/clean/react/vault/lib/browse_utils","modules/clean/sharing/browse_exports","modules/clean/sharing/ui_notifications_util","modules/clean/storage","modules/clean/upsell/prompt_event_emitter","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/constants/python","modules/core/browser","modules/core/exception","modules/core/html","modules/core/i18n","modules/core/notify","modules/core/uri"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b,I,y,F,C,O,A,P,L,D,M,R,N,x,k,U,V,H,B,W,G,q,z,j,K,Y,Q){"use strict";function X(e){return!!e&&e.isShown()}function J(e){return o.pick.apply(o,r.__spreadArrays([e,T.BrowseQueryArg.d,T.BrowseQueryArg.select,T.BrowseQueryArg.preview,T.BrowseQueryArg.activity,T.BrowseQueryArg.rewind,T.BrowseQueryArg.folder_history,T.BrowseQueryArg.from_desktop_client,T.BrowseQueryArg.preselected_for_showcase,T.BrowseQueryArg.folder_overview,T.BrowseQueryArg.unfollow_folder,T.BrowseQueryArg.manage_folder_subscription],T.FRAMEWORK_ARGS))}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importDefault(n),c=r.__importStar(c),u=r.__importDefault(u),h=r.__importStar(h),S=r.__importStar(S),P=r.__importStar(P),W=r.__importStar(W),q=r.__importStar(q),z=r.__importStar(z);var Z=(function(t){function Z(n){var i=t.call(this,n)||this;return i.deferredCheckForMissingStarredData=o.noop,i.showEmailVerificationModalsIfNeeded=function(){return r.__awaiter(i,void 0,void 0,(function(){var t;return r.__generator(this,(function(o){switch(o.label){case 0:return this.props.emailJustVerified||this.props.emailJustVerifiedAndChanged||this.props.sendVerificationEmail?[4,new Promise((function(t,r){e(["modules/clean/account/email"],t,r)})).then(r.__importStar)]:[2];case 1:return t=o.sent().EmailVerification,this.props.emailJustVerified?t.getForRole(this.props.user.role).show_verified_modal():this.props.emailJustVerifiedAndChanged?t.getForRole(this.props.user.role).show_verified_and_changed_modal():this.props.sendVerificationEmail&&t.getForRole(this.props.user.role).show_sent_modal(),[2]}}))}))},i.handlePostTTIPrefetchComplete=function(t){return r.__awaiter(i,void 0,void 0,(function(){var o,n,i,s,a,l,c,d,u,p,_,f,m;return r.__generator(this,(function(h){switch(h.label){case 0:return o=t["exp-browse-post-tti-experiments"],n=t["exp-uploader-post-tti-experiments"],i=!!t["is-over-free-quota"],s=!!t["maybe-render-team-admin-modals"],a=!!t["has-excluded-ns-ids"],l=t["preferred-editors"],c=t["first-task-props"],o.expShouldShowNcctPaywall&&q.redirect("/ncct-trial-end"),this.props.setBrowsePostTTIExperiments({browsePostTTIExperiments:o}),this.props.setBrowsePostTTIData({browsePostTTIData:{isOverFreeQuota:i,hasExcludedNsIds:a,uploaderPostTTIExperiments:n,preferredEditors:l,firstTaskProps:c}}),s?[4,new Promise((function(t,r){e(["modules/clean/react/ncct/post_tti_ncct_modal"],t,r)})).then(r.__importStar)]:[3,2];case 1:(0,h.sent().postTTINCCTReminderModal)(),h.label=2;case 2:return[4,new Promise((function(t,r){e(["modules/clean/react/growth/first_task/first_task"],t,r)})).then(r.__importStar)];case 3:return d=h.sent(),u=d.markClinkTooltipSeenAndHide,p=d.showClinkTooltip,_=d.TooltipType,f=c.seen_desktop_tooltip,m=c.member_info,f?u():m&&m.users.length>1&&p(_.Members),[2]}}))}))},i.handlePostTTIPrefetchError=function(e){z.reportException({err:new Error("failed to load post TTI experiments")})},i.handlePreviewAndShareModalsOnLoad=function(t){var o=i.getPathFromProps(),n=i.props.user,s=!!i.props.openPreview,a=!!i.props.showShareModal,l=i.props.sharePrefillEmail,c=l?l.split(","):void 0;if(s&&!t){Y.Notify.error(K.intl.formatMessage({id:"D+KIIm",defaultMessage:"The file doesn’t exist"}));var d=i.props.urlPrefix,p=i.getUrlForFQPath(d,o),_=u.default.deconstruct_url().qargs;delete _.preview,u.default.replace_state(p,_)}if(t){var f=b.File.fromServerObject(t);L.asyncOpenPreview({containerId:T.BROWSE_FILE_VIEWER_ELEMENT_ID,files:[f],fileViewAction:G.FileViewActionType.CLICK,fileViewOrigin:G.FileViewOriginType.BROWSE,fileViewTarget:G.FileViewTargetType.PRIVATE,indexOfPreviewFile:0,user:n,updateBrowserLocation:!1,onFileViewerDidMount:function(){L.hideElementsBehindFileViewer(),i.props.setIsFileViewerShown({isShown:!0})},onFileViewerUnmount:function(){L.showElementsBehindFileViewer(),i.props.setIsFileViewerShown({isShown:!1}),i.restoreUrlAfterFileViewClose()}}),a&&W.waitForTTI().then((function(){i.mounted&&k.asyncShowPrefilledShareModal({user:n,sharePrefillEmails:c,content:f,setUrl:i.props.setUrl})}))}else a&&i.showShareModalForCurrentPath(c);a||i.props.showingMobileBillingModal||i.props.showingClientModal||W.waitForTTI().then((function(){H.promptBufferedEventEmitter.on(H.Events.ON_PROMPT_INITIALIZED,(function(t){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(o){switch(o.label){case 0:return t&&(t.didMainCampaignLoad()||t.didCampaignForUserEducationLoad())?[2]:[4,new Promise((function(t,r){e(["modules/clean/react/ncct/post_tti_ncct_modal"],t,r)})).then(r.__importStar)];case 1:return[4,(0,o.sent().postTTINCCTReminderModal)()];case 2:return o.sent(),[2]}}))}))}))}))},i.receiveStateFromStores=function(){i.setState(i.getStateFromStores())},i.handleComponentTTI=function(e){i.browseLogger&&(!i.browseLogger.ttiLogged||"FilesViewController"!==e&&"SearchResultsTitle"!==e?i.browseLogger.componentReady(e):i.ajaxRequestWebTimer&&(i.ajaxRequestWebTimer.markTimeToInteractive(),delete i.ajaxRequestWebTimer))},i.onAllUploadsComplete=function(e){var t=e,r=t&&t.detail&&t.detail.files;if(r){var o=r.map((function(e){return c.normalize(e.path)+c.normalize(e.name)}));g.browseActions.selectFilesAfterUpload({fqPathsToSelect:o})}},i.getFileByFilename=function(e){return i.props.files.find((function(t){return c.filename(t.fq_path)===e}))||null},i.toggleRewindIfNecessary=function(){var e=I.getQueryArgs().activity||I.getQueryArgs().rewind;e&&!i.props.isRewindVisible&&i.props.showRewind(),!e&&i.props.isRewindVisible&&i.props.hideRewind()},i.toggleFolderHistoryIfNecessary=function(){var e=I.getQueryArgs().folder_history;e&&!i.props.isFolderHistoryVisible&&i.props.showFolderHistoryPanel(),!e&&i.props.isFolderHistoryVisible&&i.props.hideFolderHistoryPanel()},i.showShareModalForCurrentPath=function(e){var t=i.props.user,r=i.getPathFromProps();W.waitForTTI().then((function(){if(i.mounted){var o=i.props.nsId,n=i.props.nsPath;k.asyncShowPrefilledShareModal({user:t,sharePrefillEmails:e,content:{fqPath:r,isFolder:!0,nsId:o&&n?o:null,targetNsId:o&&!n?o:null},setUrl:i.props.setUrl})}}))},i.handleMaestroNavigationAction=function(e){if(e.method!==p.NavigationMethod.REDIRECT)return!1;var t=Q.URI.parse(e.url);return u.default.push_state(t.getPath(),J(t.getQuery())),!0},i.handleFileLocationChange=function(e,t){e="/"+Q.URI.decode(e),i.ensureFileViewerIsOpenedOrClosedIfNeeded(t),i.toggleRewindIfNecessary(),i.toggleFolderHistoryIfNecessary();var r=!c.paths_are_equal(i.props.path,e);t.share&&!i.props.showShareModal&&i.showShareModalForCurrentPath();var o="1"===t.d!=!!i.props.shouldShowDeletedFiles;if(r||o||t.reload){t.reload&&(delete t.reload,i.props.setUrl({path:i.props.path,qargs:t})),i.props.setPath({path:e}),i.props.setLoadingState({loadingState:M.LoadingState.LOADING_FIRST_PAGE,path:e}),i.props.setShouldShowDeletedFiles({shouldShowDeletedFiles:"1"===t.d}),i.browseLogger&&i.browseLogger.ttiLogged&&i.ensureTimer("browse_ajax","browse_ajax_nav");var n=i.props.currentSort.sortDirection===M.SortDirection.ASCENDING,s="1"===t.d;i.props.viewer.is_team_assume_user_session||i.props.viewer.is_assume_user_session?i.loadPathLegacy({path:e,sortIsAscending:n,includeDeleted:s,hasPathChanged:r}):i.loadPathApi2({path:e,sortIsAscending:n,includeDeleted:s,hasPathChanged:r})}},i.sortLabel=function(){return D.SortIsFilename.includes(i.props.currentSort.sortField)?M.SortLabel.FILENAME:i.props.currentSort.sortField===M.SortField.MODIFIED?M.SortLabel.MODIFIED:M.SortLabel.SIZE},i.sortType=function(){return D.SortIsFilename.includes(i.props.currentSort.sortField)?{".tag":"files_by_name"}:i.props.currentSort.sortField===M.SortField.MODIFIED?{".tag":"files_by_modified"}:{".tag":"files_by_size"}},i.loadPathApi2=function(e){var t=e.path,o=e.sortIsAscending,n=e.includeDeleted,s=e.hasPathChanged;return r.__awaiter(i,void 0,void 0,(function(){var e,i,a;return r.__generator(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,S.loadPath2({userId:this.props.user.id,path:t,sortType:this.sortType(),sortIsAscending:o,includeDeleted:n})];case 1:return e=l.sent(),this.ajaxRequestWebTimer&&this.ajaxRequestWebTimer.end(),this.handleFileLocationChangeSuccess(t,e,s,!0),[3,3];case 2:return i=l.sent(),(a=(function(e){var t="";return void 0!==e.status&&("auth_failed"===e.status[".tag"]?t=K.intl.formatMessage({id:"8nB2Fu",defaultMessage:"Not authorized to browse {path}."},{path:e.path}):"rate_limited"===e.status[".tag"]?t=K.intl.formatMessage({id:"2NDCop",defaultMessage:"Too many attempts. Try again later."}):"invalid_path"===e.status[".tag"]?t=K.intl.formatMessage({id:"o19fmC",defaultMessage:"Unsupported path provided {path}."},{path:e.path}):"folder_not_found"===e.status[".tag"]?t=K.intl.formatMessage({id:"VZE6IM",defaultMessage:"The folder ‘{path}’ doesn’t exist."},{path:e.path}):"folder_is_deleted"===e.status[".tag"]&&(t=K.intl.formatMessage({id:"qZpUNY",defaultMessage:"The folder ‘{path}’ is deleted."},{path:e.path}))),t})(i.error))?R.Snackbar.fail(a,"browse"):(z.reportException({err:i,force:!0,severity:z.SEVERITY.CRITICAL,tags:["browse","component:browse"],exc_extra:r.__assign({},i)}),R.Snackbar.fail(K.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}),"browse")),c.paths_are_equal(t,"/")?this.props.setLoadingState({path:t,loadingState:M.LoadingState.LOAD_ERROR}):this.props.setUrl({path:"/"}),[3,3];case 3:return[2]}}))}))},i.loadPathLegacy=function(e){var t=e.path,r=e.sortIsAscending,o=e.includeDeleted,n=e.hasPathChanged;S.loadPath({sortLabel:i.sortLabel(),sortIsAscending:r,path:t,userId:i.props.user.id,includeDeletedFiles:o,onSuccess:function(e){var r=e.path,o=e.data,s=e.xhr;if(i.ajaxRequestWebTimer){var a=s.getResponseHeader("x-dropbox-request-id");i.ajaxRequestWebTimer.end(a||void 0)}if(c.paths_are_equal(t,r)){var l={folderOverview:o.folder_overview||null,mountPoints:o.ns_id_to_mount_point,context:b.BrowseContext.fromServerObject(o),items:o.file_info||o.first_page.items,hasMore:o.paginated,nextRequestVoucher:void 0!==o.first_page?o.first_page.next_request_voucher:null,paginatedTotalNumFiles:void 0!==o.first_page?o.first_page.total_num_items:o.file_info.length};i.handleFileLocationChangeSuccess(t,l,n,!1)}},onError:function(){c.paths_are_equal(t,"/")||i.props.setUrl({path:"/"})}})},i.handleFileLocationChangeSuccess=function(e,t,o,n){if(i.props.setIsRewindButtonEnabled({path:e,userId:i.props.user.id,userSkuHasRewind:!!i.browseExperiments.folderHistoryRollbacks}),!I.getQueryArgs().query)if(o&&i.props.handleFolderOverviewPrefetch(r.__assign(r.__assign({},t.folderOverview),{path:e,componentNamespace:T.BrowseFolderOverviewComponentNamespace})),i.props.setPath({path:e}),i.props.setMountPoints({mountPoints:t.mountPoints}),t.hasMore){i.props.setPathData({path:e,files:[],context:t.context,paginatedTotalNumFiles:t.paginatedTotalNumFiles});var s=void 0;n&&(s=E.apiV2FetchNextFn),f.PaginationManager.create({firstPage:{items:t.items,has_more_items:!0,next_request_voucher:t.nextRequestVoucher},keyName:"sjid",ajaxURL:"/browse_get_next",userID:i.props.user.id,newDataAvailableCallback:function(t,r){var o=t.areAllItemsReady()?M.LoadingState.LOADED:M.LoadingState.LOADING_REMAINING_PAGES;i.props.appendFiles({path:e,files:r.map((function(e){return"object"==typeof e.type?b.File.fromApiV2Object(e):b.File.fromServerObject(e)}))}),i.props.setLoadingState({path:e,loadingState:o}),t.areAllItemsReady()&&t.stopAutoFetching()},fetchNextFn:s}).startAutoFetching()}else i.props.setPathData({path:e,files:t.items.map((function(e){return"object"==typeof e.type?b.File.fromApiV2Object(e):b.File.fromServerObject(e)})),paginatedTotalNumFiles:t.paginatedTotalNumFiles,context:t.context}),i.props.setLoadingState({loadingState:M.LoadingState.LOADED,path:e})},i.getPathFromProps=function(){return i.props.initFqPath||"/"},i.markTTVIfNeeded=function(){!i.hasTTVBeenLogged&&i.mounted&&i.state.hasPrefetchLoaded&&(W.mark_time_to_view(),i.hasTTVBeenLogged=!0)},i.handleFileListUpdated=function(){X(i.state.fileViewerController)?i.props.files.isEmpty()?i.state.fileViewerController.close():i.state.fileViewerController.updateFiles(i.props.files.toJS()):i.ensureFileViewerIsOpenedOrClosedIfNeeded(I.getQueryArgs()),i.prefetchPreviewData(i.props.files.toArray(),i.props.user)},i.handleOnNavigateToFileOrFolder=function(e,t){void 0===t&&(t={});var r=t.actionSource;i.props.hideRewind();var o=window.pageYOffset;i.completeNavigateToFileOrFolder(e,r,(function(){window.scrollTo({top:o})}))},i.completeNavigateToFileOrFolder=function(e,t,r){var o=i.state,n=o.vaultApi,a=o.vaultLoggingTypes,l=i.props,u=l.user,p=l.viewer,_=l.viewType,f=e.ns_id,m=e.sjid,S=e.file_id,E=e.fq_path,v=e.bytes,w=e.ext,T=e.request_id;h.logOpenRow({uid:u.id,entity_type:e.is_dir?"folder":"file",source:"list_browse",view_type:_,file_nsid:f,file_sjid:m,file_id:S,file_name:c.filename(e.fq_path),file_path:E,file_size:v,file_type:e.type,file_extension:w,request_id:T,action_source:t,vaultApi:n,vaultLoggingTypes:a}),e.type===d.FileTypes.TEAM_SHARED_FOLDER&&(B.UEClient.sendEvent("FileItemRow","TeamFolderClicked"),s.TeamsWebActionsLogger.log("clicked_team_folder_web",{team_id:p.team_id})),g.browseActions.navigateToFileOrFolder({file:e,onFileViewerUnmount:r,fileViewAction:G.FileViewActionType.CLICK})},i.uploadAjaxInterceptor={interceptUploadPrecheck:function(e){return e},interceptUpload:function(e,t){var o=t.ns_id_for_routing;if(!o){var n=i.props.mountPoints,s=i.props.browseContext.rootNSID;z.assert(null!=n,"mountPoints is null"),z.assert(null!=s,"rootNSID is null"),o=P.getNsId(n,s,e.dest)}return r.__assign(r.__assign({},t),{ns_id_for_routing:o,ns_id:o})}},i.fileViewerIsShown=function(){return X(i.state.fileViewerController)},i.ensureFileViewerClosedIfNotPreviewing=function(e){e&&!e.preview&&X(i.state.fileViewerController)&&i.state.fileViewerController.close()},i.prefetchPreviewData=function(e,t){i.state.fileViewerController&&i.state.fileViewerController.prewarmPreviewData(e,t)},i.ensureFileViewerIsOpenedOrClosedIfNeeded=function(e){if(e.preview&&!X(i.state.fileViewerController)){var t=i.getFileByFilename(e.preview);t&&g.browseActions.navigateToFileOrFolder({file:t})}else!e.preview&&X(i.state.fileViewerController)&&i.state.fileViewerController.close()},i.getLearnMoreLinkHandler=function(){window.open("/help/business/unsynced-team-folder","_blank")},A.uploaderStore.add_change_listener(i.receiveStateFromStores),window.addEventListener(F.ALL_UPLOADS_COMPLETE_EVENT,i.onAllUploadsComplete),i.state=r.__assign(r.__assign({},i.getStateFromStores()),{hasPrefetchLoaded:!1}),i}return r.__extends(Z,t),Object.defineProperty(Z.prototype,"browseExperiments",{get:function(){return this.props.browseExperiments},enumerable:!0,configurable:!0}),Z.prototype.UNSAFE_componentWillMount=function(){var e,t,o,n=this,i=this.props,s=i.urlPrefix,a=i.user,l=i.viewer,c=i.isActionBarEnabled,d=this.props.shareLink,f=!!this.props.openPreview,m=this.getPathFromProps();e=c?["FilesViewController"]:["FilesViewController","AppActionsView"],this.browseLogger=new _.PageletLogger("browse",e,!0,{view_type:this.props.viewType.toLowerCase()}),d||f||(t=this.getUrlForFQPath(s,m),o=I.getQueryArgs(),u.default.replace_state(t,J(o)));var h=l.get_users().map((function(e){return e.id}));V.UserLocalStorage.clearOtherUsers(h);var S=this.props.shouldShowDeletedFiles,v=this.props.viewer.is_team_assume_user_session||this.props.viewer.is_assume_user_session,w=!1;S||v||(w=!0);var b=new E.BrowsePrefetchLoader({user:a,path:m,fqPathsToSelect:this.props.selectFqPaths,useApiv2NextPage:w},{onPrefetchComplete:function(e){n.setState({hasPrefetchLoaded:!0}),n.handlePreviewAndShareModalsOnLoad(e.preview_file_info),"folder_overview"in e&&e.folder_overview?n.props.handleFolderOverviewPrefetch(r.__assign(r.__assign({},e.folder_overview),{path:m,componentNamespace:T.BrowseFolderOverviewComponentNamespace})):n.props.addFolderOverviewLoadedComponent({componentNamespace:T.BrowseFolderOverviewComponentNamespace,component:"draftjs"}),W.log_js_modules_fetched_data_required_for_tti(),n.markTTVIfNeeded()},onPrefetchError:function(e){if(x.isInsideVault(m)){var t=void 0===q.get_hash()?"":"#"+q.get_hash();q.redirect(N.VAULT_URL+t)}else n.setState({hasPrefetchLoaded:!0}),z.reportException({err:e||new Error("Failed to prefetch browse data"),severity:"user-error",exc_extra:{path:m}}),n.props.setUrl({path:""}),n.props.setLoadingState({loadingState:M.LoadingState.LOAD_ERROR,path:m}),n.handleFileLocationChange("",{})},onLoadComplete:function(){},onPostTTIPrefetchComplete:this.handlePostTTIPrefetchComplete,onPostTTIPrefetchError:this.handlePostTTIPrefetchError},{onInitializeEverything:g.browseActions.initializeEverything,onAddFilesAndSetLoadingState:g.browseActions.addFilesAndSetLoadingState});if(b.isPrefetching()&&b.handlePrefetch(),this.browseExperiments.sidebarNavigationDelegation)for(var y=0,F=T.browseSidebarNavigationCommandIds;y<F.length;y++){var C=F[y];p.navigationActionDispatcher.handle(this.handleMaestroNavigationAction,{actionId:C})}u.default.add_callback(s,this.handleFileLocationChange,!0)},Z.prototype.componentDidMount=function(){var t=this;this.mounted=!0;var n=this.getPathFromProps(),s=this.props.user,d=this.props.shareLink,u=!!this.props.openPreview,p=this.props.fromSclSyncModal;if(this.props.setIsRewindButtonEnabled({path:n,userId:this.props.user.id,userSkuHasRewind:this.browseExperiments.folderHistoryRollbacks}),p&&(s.is_cdm_member?(function(e){var t=K.intl.formatMessage({id:"7sFPiN",defaultMessage:"Added “{folder_name}” <a>Learn More</a>"},{folder_name:l.Emstring.em_snippet(c.filename(e),i.SNIPPET_SIZES.FILENAME),a:function(e){return'<a href="/help/business/team-space-overview#acceptfolder">'+e+"</a>"}});Y.Notify.success(new j.HTML(t))})(n):(function(e){Y.Notify.success(K.intl.formatMessage({id:"YYLxxv",defaultMessage:"{file_name} added to your Dropbox."},{file_name:c.filename(e)}))})(n)),this.props.showShareSuccessSnackbar){var _=c.filename(n);U.showInBandShareSuccessSnackbar(_)}this.props.shouldOpenAppRecommendationsModal&&y.asyncShowAppRecommendationModal(s.id,"prompt"),this.shouldShowUnsyncNotification()&&this.showUnsyncNotification(),d&&!u&&s.is_cdm_member&&(function(e){var t=c.parent_dir(e);"/"!==t&&Y.Notify.success(K.intl.formatMessage({id:"nZ/TMQ",defaultMessage:"Folder is in {path}"},{path:l.Emstring.em_snippet(t,22)}))})(n),this.toggleRewindIfNecessary(),this.toggleFolderHistoryIfNecessary(),this.markTTVIfNeeded(),Z.mountFileViewerTarget(),W.waitForTTI().then((function(){a.require_css("/static/css/main_browse_post_tti-vflgrYAkb.css");var n=function(e){var r=e[0],n=r[0],i=(r[1],r[2].SharedWithStore),s=r[3],a=s.checkForMissingStarredData,l=s.StarredStore,c=(r[4],r[5],e[1]),d=(c[0],c[1],c[2].BloodhoundContactsV2),u=(c[3],c[4],c[5],e[2]),p=u[0],_=u[1];if(t.mounted){var f=t.props,h=f.user,g=f.path,S=f.files,E=S.toArray();i.initializeWith({path:g,files:E}),a({items:E,user:h});var v=l.addListener((function(){t.setState({starredState:l.getLoadingStates()})}));t.deferredCheckForMissingStarredData=function(){return o.defer((function(){a({items:t.props.files.toArray(),user:h})}))},t.removeStarredStoreListener=function(){v()},d.getOrCreateForUser(h),t.setState({fileViewerController:n,vaultApi:p,vaultLoggingTypes:_}),t.props.setArePostTTIModulesLoaded({arePostTTIModulesLoaded:!0}),t.showEmailVerificationModalsIfNeeded(),t.prefetchPreviewData(S.toArray(),h);var w=t.props.shouldOpenExtensionsEduModal;w&&m.asyncShowExtensionsEduModal(h.id,w)}};n.perfName="browse_post_tti",Promise.all([Promise.all([new Promise((function(t,r){e(["modules/clean/react/file_viewer/controller"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/browse/file_actions/file_actions"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/browse/shared_with"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/starred/browse_exports"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/file_modal_controller"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/sharing/share_modal_util"],t,r)})).then(r.__importStar)]),Promise.all([new Promise((function(t,r){e(["modules/clean/sharing/ui_util"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/sharing/wizard/wizard_modals"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/contacts/bloodhound_contacts_v2"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/unity_browse_interface"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/unity/features"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/unity/check_file_cache"],t,r)})).then(r.__importStar)]),Promise.all([new Promise((function(t,r){e(["modules/clean/react/vault/lib/api"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["vault/common/logging-types"],t,r)})).then(r.__importStar)])]).then(n)}))},Z.prototype.UNSAFE_componentWillUpdate=function(e,t){e.files.equals(this.props.files)||o.defer(this.handleFileListUpdated)},Z.prototype.componentDidUpdate=function(e){e.loadingState===M.LoadingState.LOADING_FIRST_PAGE&&this.props.loadingState!==e.loadingState&&this.markTTVIfNeeded(),e.files!==this.props.files&&this.deferredCheckForMissingStarredData()},Z.prototype.componentWillUnmount=function(){this.removeStarredStoreListener&&this.removeStarredStoreListener(),Z.unmountFileViewerTarget(),A.uploaderStore.remove_change_listener(this.receiveStateFromStores),window.removeEventListener(F.ALL_UPLOADS_COMPLETE_EVENT,this.onAllUploadsComplete),this.mounted=!1},Z.prototype.getStateFromStores=function(){return{isDraggingInternalFiles:C.FileUploaderController.isDraggingInternalFiles(),isDraggingExternalFiles:C.FileUploaderController.isDraggingExternalFiles(),isUploadModalOpen:C.FileUploaderController.isUploadModalOpen()}},Z.prototype.restoreUrlAfterFileViewClose=function(){var e,t=this.props.urlPrefix,r=this.getUrlForFQPath(t,this.props.path);e=this.props.openPreview?o.omit(I.getQueryArgs(),T.BrowseQueryArg.preview,T.BrowseQueryArg.select):{},u.default.replace_state(r,e)},Z.prototype.getUrlForFQPath=function(e,t){return e+("/"===t?"":Q.URI.encode_parts(t))},Z.prototype.ensureTimer=function(e,t){if(this.ajaxRequestWebTimer&&this.ajaxRequestWebTimer.getContextName()!==e&&(this.ajaxRequestWebTimer.abort(),W.delete_timer(this.ajaxRequestWebTimer.getContextName()),this.ajaxRequestWebTimer=void 0),this.ajaxRequestWebTimer)this.ajaxRequestWebTimer.restart();else{W.delete_timer(e),this.ajaxRequestWebTimer=W.get_timer(e);var r={requireTTI:!0,requireTTV:!1};t&&(r.url=t),this.ajaxRequestWebTimer.initialize(r)}},Z.prototype.shouldShowUnsyncNotification=function(){return this.props.shouldShowUnsyncNotification},Z.prototype.showUnsyncNotification=function(){R.Snackbar.show(n.default.createElement(R.Snackbar,{variant:"generic",title:K.intl.formatMessage({id:"pwl1MF",defaultMessage:"Do you also need this on your computer?"}),timeoutDelayMs:1e5,actionButtonText:K.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"}),closeButtonText:K.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),onActionClick:this.getLearnMoreLinkHandler,id:"browse-unsync"}))},Z.prototype.render=function(){var e,t=this.state,r=t.isUploadModalOpen,o=t.starredState,i=t.isDraggingExternalFiles,s=t.isDraggingInternalFiles,a=this.props,l=a.browseContext,c=a.selection,d=a.selectedFiles,u=a.browsePostTTIExperiments,p=a.canDisplayFolderSizes,_=a.clickFolderHistoryTimestamp,f=a.clickRewindTimestamp,m=a.extensionsFeatureFlags,h=a.files,g=a.hideRewind,S=a.hideFolderHistoryPanel,E=a.showFolderHistoryPanel,T=a.isQueryingFolderSizes,b=a.isRewindVisible,I=a.isFolderHistoryVisible,y=a.loadingState,F=a.paginatedTotalNumFiles,C=a.path,A=a.setUrl,P=a.shouldShowDeletedFiles,L=a.showRewind,D=a.user,M=a.viewType,R=a.viewTypeColumns,N=a.sharingServiceInfo,x=a.shouldShowVaultEmptyState,k=a.pinnedItems,U=a.emptyFolder,V=a.isInsideEmptyCollectionFolder,H=a.browsePostTTIData,B=a.setHideFilesAndSidebar,W=a.shouldHideFilesAndSidebar,G=(null===(e=this.props.browseExperiments)||void 0===e?void 0:e.parallelFileUploads)?O.ParallelUploadScheduler:void 0;return n.default.createElement(v.BrowseUploadProvider,{userId:this.props.user.id,mountPoints:this.props.mountPoints,rootNSID:this.props.browseContext.rootNSID,Scheduler:G},n.default.createElement(w.BrowseView,{userVersionHistoryLength:this.props.userVersionHistoryLength,onNavigateToFileOrFolder:this.handleOnNavigateToFileOrFolder,clickRewindTimestamp:f,clickFolderHistoryTimestamp:_,context:l,encryptionOptions:this.props.encryptionOptions,ensureFileViewerClosedIfNotPreviewing:this.ensureFileViewerClosedIfNotPreviewing,files:h,handleComponentTTI:this.handleComponentTTI,isDraggingExternalFiles:i,isDraggingInternalFiles:s,isFileViewerShown:this.fileViewerIsShown,isFolderHistoryVisible:I,isRewindVisible:b,isUploadModalOpen:r,loadingState:y,path:C,selectedFiles:d,selection:c,shouldOpenUploadModal:this.props.shouldOpenUploadModal,shouldShowDeletedFiles:P,starredState:o,totalNumItems:F,uploadAjaxInterceptor:this.uploadAjaxInterceptor,user:D,viewType:M,canDisplayFolderSizes:p,columns:R[M],viewTypeColumns:R,isQueryingFolderSizes:T,nsId:this.props.nsId,browseExperiments:this.browseExperiments,browsePostTTIExperiments:u,browsePostTTIData:H,onShowRewind:L,onCloseRewind:g,onCloseFolderHistoryPanel:S,onShowFolderHistoryPanel:E,extensionsFeatureFlags:m,sharingServiceInfo:N,shouldShowVaultEmptyState:x,pinnedItems:k,onSetUrl:A,emptyFolder:U,setHideFilesAndSidebar:B,shouldHideFilesAndSidebar:W,showPlusPlusSetupModal:this.props.showPlusPlusSetupModal,isSmbPersonalization:this.props.isSmbPersonalization,hasLinkedMobile:this.props.hasLinkedMobile,isInsideEmptyCollectionFolder:V,isActionBarEnabled:this.props.isActionBarEnabled}))},Z.mountFileViewerTarget=function(){var e=document.getElementById(T.BROWSE_FILE_VIEWER_ELEMENT_ID);e||((e=document.createElement("div")).id=T.BROWSE_FILE_VIEWER_ELEMENT_ID,document.body.insertBefore(e,document.body.children[0]))},Z.unmountFileViewerTarget=function(){var e=document.getElementById(T.BROWSE_FILE_VIEWER_ELEMENT_ID);e&&document.body.removeChild(e)},Z})(n.default.Component);t.BrowseController=Z})),define("modules/clean/react/browse/crypto_subtle_digest",["require","exports","tslib"],(function(e,t,r){"use strict";function o(e){if(t.windowHasCryptoSubtleDigest())return new Promise((function(t){window.crypto.subtle.digest("SHA-256",e).then(t)}));throw new Error("window.crypto.subtle.digest not available")}Object.defineProperty(t,"__esModule",{value:!0}),t.windowHasCryptoSubtleDigest=function(){return!!window.crypto&&!!window.crypto.subtle&&!!window.crypto.subtle.digest},t.encryptArrayBuffer=o,t.hashString=function(e){return r.__awaiter(this,void 0,Promise,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:if(!t.windowHasCryptoSubtleDigest()||void 0===window.TextEncoder||void 0===window.TextDecoder)return[2,null];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,o((new TextEncoder).encode(e))];case 2:return n=r.sent(),[2,new TextDecoder("utf-16").decode(n)];case 3:return r.sent(),[2,null];case 4:return[2]}}))}))}})),define("modules/clean/react/browse/data/action_creators/index",["require","exports","tslib","external/lodash","immutable","dropbox/proto/hql_events/browse/web_browse","spectrum-sharing/utils/sharing_constants","modules/clean/file_actions/create-folder","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/hql/index","modules/clean/react/browse/action_logger","modules/clean/react/browse/api","modules/clean/react/browse/async_extensions","modules/clean/react/browse/constants","modules/clean/react/browse/crypto_subtle_digest","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/helpers","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/types","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/file_uploader/constants","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/files_view/types","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/selection","modules/clean/react/snackbar","modules/clean/redux/tests/store","modules/clean/web_user_action_events","modules/core/cookies","modules/core/exception","modules/core/i18n","modules/core/uri"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b,I,y,F,C,O,A,P,L,D,M,R,N,x,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),a=r.__importStar(a),l=r.__importStar(l),d=r.__importDefault(d),_=r.__importStar(_),g=r.__importStar(g),E=r.__importStar(E),w=r.__importStar(w),y=r.__importStar(y),F=r.__importStar(F);t.appInit=function(e){var t=e.props,r=e.user,o=e.viewer;return function(e,n){var i,s;e({type:v.ActionTypes.APP_INIT,payload:{props:t,user:r,viewer:o}});var a=R.Cookies.read(m.BROWSE_SORT_COOKIE_NAME);if(a&&a.indexOf("|")>-1){var l=a.split("|",2);s={sortField:l[0],sortDirection:l[1]};var d=E.sortOrder(n());s.sortDirection===d.sortDirection&&s.sortField===d.sortField||e(H({sortOrder:s}))}"M1"===(null===(i=t.browseExperiments)||void 0===i?void 0:i.browseBetterViewSettings)&&e(y.loadScopedSortOrders({user:r,defaultSort:s||{sortField:O.SortField.FILENAME,sortDirection:O.SortDirection.ASCENDING}})),c.Dispatcher.dispatch({type:I.UploaderActionType.SET_USER,data:{user:r}})}},t.pushBoltIgnore=function(e){return{type:v.ActionTypes.PUSH_BOLT_IGNORE,payload:e}},t.popBoltIgnore=function(e){return{type:v.ActionTypes.POP_BOLT_IGNORE,payload:e}},t.selectFilesByFqPath=function(e){var t=e.fqPathsToSelect;return{type:v.ActionTypes.SELECT_FILES_BY_FQ_PATH,payload:{fqPathsToSelect:t}}},t.setCanDisplayFolderSizes=function(e){var t=e.canDisplayFolderSizes;return{type:v.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES,payload:{canDisplayFolderSizes:t}}};var U=function(e){var t=e.clipboard;return{type:v.ActionTypes.SET_CLIPBOARD_FILES,payload:{clipboard:t}}};t.setFilesToClipboard=function(e){var t=e.clipboard;return function(e){var r=t.files;r.length&&(r.some((function(e){return e.isDeleted}))?L.Snackbar.fail(x.intl.formatMessage({id:"jdnaZR",defaultMessage:"Deleted files cannot be added to the clipboard"}),"browse-clipboard-copy"):r.some(T.File.isTeamSharedFolder)?L.Snackbar.fail(x.intl.formatMessage({id:"yNzLsd",defaultMessage:"Team Folders can’t be copied."}),"browse-clipboard-copy"):(L.Snackbar.complete(x.intl.formatMessage({id:"BvUPS9",defaultMessage:"{count, plural, one{Added {count} item to clipboard.} other{Added {count} items to clipboard.}}"},{count:r.length}),"browse-clipboard-copy"),e(U({clipboard:t}))))}},t.pasteFilesFromClipboard=function(e){var t=e.copyFiles,r=e.moveFiles;return function(e,o){var n=o(),i=E.user(n),s=E.clipboard(o()),a=s.files,c=s.action,d=E.path(o());a.length<=0||("cut"===c?(l.paths_are_equal(l.parent_dir(a[0].fq_path),d)||r({user:i,files:a,newPath:"/"===d?"":d,checkFSWs:!0}),e(U({clipboard:{files:[]}}))):t({user:i,files:a,newPath:d,checkFSWs:!0,dataApi:_,onSuccess:function(e){var t;t=e.length,L.Snackbar.complete(x.intl.formatMessage({id:"8HEFMw",defaultMessage:"{count, plural, one{Pasted {count} item from clipboard} other{Pasted {count} items from clipboard}}"},{count:t}),"browse-clipboard-paste")}}))}},t.setContext=function(e){var t=e.context;return{type:v.ActionTypes.SET_CONTEXT,payload:{context:t}}},t.setBrowsePostTTIExperiments=function(e){var t=e.browsePostTTIExperiments;return{type:v.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS,payload:{browsePostTTIExperiments:t}}},t.setBrowsePostTTIData=function(e){var t=e.browsePostTTIData;return{type:v.ActionTypes.SET_BROWSE_POST_TTI_DATA,payload:{browsePostTTIData:t}}};var V=function(e){var t=e.fileJumpFilter;return{type:v.ActionTypes.SET_FILE_JUMP_FILTER,payload:{fileJumpFilter:t}}};t.addFileJumpKeyCode=function(e){var r=e.keyChar;return function(e,o){var n=E.fileJumpFilter(o())+r.toLowerCase();e(V({fileJumpFilter:n}));for(var i=null,s=0,a=E.fileJumpIndex(o());s<a.length;s++){var l=a[s],c=l.fqPath;if(l.filename>=n){i=c;break}}null!=i&&e(t.selectFilesByFqPath({fqPathsToSelect:[i]}))}},t.resetFileJumpFilter=function(){return function(e,t){p.logKeyboardShortcutUsage({user_id:E.user(t()).id,keyboard_shortcut_type:"jump",view_type:F.selectViewType(t(),{instanceId:m.BROWSE_FILES_VIEW_ID})}),e(V({fileJumpFilter:""}))}},t.setFilePathsToSelectOnNextUpdate=function(e){var t=e.filePathsToSelectOnNextUpdate;return{type:v.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE,payload:{filePathsToSelectOnNextUpdate:t}}},t.setIsRewindButtonEnabled=function(e){return function(t,o){return r.__awaiter(void 0,void 0,void 0,(function(){var o,n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return o=e.path,n=e.userId,e.userSkuHasRewind?[4,_.isRewindButtonEnabled(o,n)]:(t({type:v.ActionTypes.SET_IS_REWIND_ENABLED,payload:{value:!0}}),[2]);case 1:return i=r.sent(),t({type:v.ActionTypes.SET_IS_REWIND_ENABLED,payload:{value:!!i.can_rewind}}),[2]}}))}))}},t.showRewind=function(){return{type:v.ActionTypes.SHOW_TIMELINE,payload:{timestamp:(new Date).getTime()}}},t.hideRewind=function(){return{type:v.ActionTypes.HIDE_TIMELINE,payload:{}}},t.showFolderHistoryPanel=function(){return{type:v.ActionTypes.SHOW_FOLDER_HISTORY_PANEL,payload:{timestamp:(new Date).getTime()}}},t.hideFolderHistoryPanel=function(){return{type:v.ActionTypes.HIDE_FOLDER_HISTORY_PANEL,payload:{}}},t.refreshPinnedItems=function(){return function(e,t){return r.__awaiter(void 0,void 0,void 0,(function(){var o;return r.__generator(this,(function(r){return o=g.folderOverviewFolderFileId(t()),e(A.reloadContentReferences({folderFileId:o,componentNamespace:m.BrowseFolderOverviewComponentNamespace})),[2]}))}))}},t.createFolder=function(e){var o=e.pathName,n=e.folderName,i=e.checkFSWs,l=e.showShareModalOnSuccess,c=e.redirectOnSuccess,d=e.redirectOnCancel,u=e.selectCreatedFolder,p=void 0===u||u,_=e.origin;return function(e,u){return r.__awaiter(void 0,void 0,void 0,(function(){var f,m,h;return r.__generator(this,(function(r){switch(r.label){case 0:return f=E.user(u()),e(t.setNewFolderCreationState({newFolderCreationState:O.NewFolderCreationState.SAVING_INPUT})),[4,a.createFolder({destination:o,name:n,user:f,checkFsw:i,origin:_,surface:"browse"})];case 1:return m=r.sent(),e(t.setNewFolderCreationState({newFolderCreationState:O.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),"success"===m.type?(h=C.folderFromFolderMetadata(m.folder),p&&e(t.selectFilesByFqPath({fqPathsToSelect:[h.fq_path]})),c&&c(h.fq_path),l&&l(h,s.SHARE_ACTION_ORIGIN_TYPE.BROWSE_NEW_FOLDER_MODAL)):d&&d(),[2]}}))}))}},t.setFolderSizes=function(e){var t=e.folderSizes;return{type:v.ActionTypes.SET_FOLDER_SIZES,payload:{folderSizes:t}}},t.setLoadingState=function(e){var t=e.loadingState,r=e.path;return{type:v.ActionTypes.SET_LOADING_STATE,payload:{loadingState:t,path:r}}},t.setMountPoints=function(e){var t=e.mountPoints;return{type:v.ActionTypes.SET_MOUNT_POINTS,payload:{mountPoints:t}}},t.setNewFolderCreationState=function(e){var t=e.newFolderCreationState;return{type:v.ActionTypes.SET_NEW_FOLDER_CREATION_STATE,payload:{newFolderCreationState:t}}},t.setPaginatedTotalNumFiles=function(e){var t=e.paginatedTotalNumFiles;return{type:v.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES,payload:{paginatedTotalNumFiles:t}}},t.setUrl=function(e){var n=e.path,i=void 0===n?"":n,s=e.qargs;return function(e,n){d.default.push_state(E.urlPrefix(n())+k.URI.encode_parts(i),o.omitBy(r.__assign(r.__assign({},o.pick(b.getQueryArgs(),["d"])),s),o.isUndefined)),e(t.clearSelection({skipLogging:!0}))}},t.setPath=function(e){var t=e.path;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){var o;return r.__generator(this,(function(r){switch(r.label){case 0:return e({type:v.ActionTypes.SET_PATH,payload:{path:t}}),[4,h.hashString(t)];case 1:return(o=r.sent())||N.reportException({err:new Error("hashString returned null"),tags:["browse"],severity:N.SEVERITY.NONCRITICAL}),e({type:v.ActionTypes.SET_VIEW_SCOPE,payload:{viewScope:o}}),[2]}}))}))}},t.setPathData=function(e){var r=e.path,o=e.files,i=e.paginatedTotalNumFiles,s=e.context;return function(e,a){if(l.paths_are_equal(r,E.path(a()))){var d=n.Map(o.map((function(e){return[e.fq_path,e]})));e(t.setContext({context:s})),t.setUnsortedFiles({unsortedFiles:d})(e,a,D.mockExtraArguments),e(t.setPaginatedTotalNumFiles({paginatedTotalNumFiles:i})),e(t.clearSelection({skipLogging:!0})),B({unsortedFiles:d})(e,a,D.mockExtraArguments),setTimeout((function(){c.Dispatcher.dispatch({type:m.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:r,files:o}}),c.Dispatcher.dispatch({type:I.UploaderActionType.SET_PATH,data:{path:r,hasPermissionToUploadToFolder:s.isCurrentPathWriteable(),isMovingIntoVault:s.isInsideVaultFolder}})}),1)}}},t.setSelection=function(e){var t=e.selection,r=e.actionSource,o=e.skipLogging;return function(e,n){if(!o){var s=n(),a=w.makeSelectionEvent(E.selection(s),t),l=a.event,c=a.itemId,d=E.selectFileByFullPath(s,{path:c}),_=E.experiments(s).browseWebHqlPilot;if(d){var f=w.countFilesAndFolders(E.selectFilesForSelection(s,{selection:t})),h=f.num_files_selected,g=f.num_folders_selected;_&&l===M.WebUserActionLogEvent.SELECT_ROW&&u.logEvent(i.hql_events.WebBrowseSelectRow.create({actionSource:r})),p.logBrowseAction({uid:E.user(s).id,action:l,action_source:r,num_files_selected:h,num_folders_selected:g,view_type:F.selectViewType(n(),{instanceId:m.BROWSE_FILES_VIEW_ID}),result:d,extra:{entity_type:d.is_dir?"folder":"file"}})}}e({type:v.ActionTypes.SET_SELECTION,payload:{selection:t,actionSource:r}}),W(e,n,t)}},t.clearSelection=function(e){var r=void 0===e?{}:e,o=r.actionSource,n=r.skipLogging;return t.setSelection({actionSource:o,skipLogging:n,selection:P.createSelection()})},t.setShouldShowDeletedFiles=function(e){var t=e.shouldShowDeletedFiles;return{type:v.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES,payload:{shouldShowDeletedFiles:t}}};var H=function(e){var t=e.sortOrder;return{type:v.ActionTypes.SET_SORT_ORDER,payload:{sortOrder:t}}};t.setAndStoreSortOrder=function(e){return function(t,r){var o=r(),n=E.user(o);p.logSortRecords({uid:n.id,sort_by:e.sortField,sort_direction:e.sortDirection,view_type:F.selectViewType(o,{instanceId:m.BROWSE_FILES_VIEW_ID})}),E.shouldUseFilesViewPreferences(o)&&t(y.setSort({user:n,sort:e,viewScope:F.selectViewTypeScope(o,{instanceId:m.BROWSE_FILES_VIEW_ID}),updateGlobalScope:!0})),R.Cookies.delete(m.BROWSE_SORT_COOKIE_NAME);var i=e.sortField+"|"+e.sortDirection;R.Cookies.create(m.BROWSE_SORT_COOKIE_NAME,i,1095),t(H({sortOrder:e}))}},t.setUnsortedFiles=function(e){var t=e.unsortedFiles;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){return n=E.user(o()),e({type:v.ActionTypes.SET_UNSORTED_FILES,payload:{unsortedFiles:t}}),f.asyncExtensions.initializeStore(n,t.toArray()),[2]}))}))}},t.requestFolderSizes=function(e){var t=e.fqPath;return{type:v.ActionTypes.REQUEST_FOLDER_SIZES,payload:{fqPath:t}}},t.setFolderSizesPending=function(e){var t=e.fetchFolderSizesResp;return{type:v.ActionTypes.SET_FOLDER_SIZES_PENDING,payload:{fetchFolderSizesResp:t}}},t.completeFolderSizes=function(e){var t=e.fetchFolderSizeState;return{type:v.ActionTypes.COMPLETE_FOLDER_SIZES,payload:{fetchFolderSizeState:t}}},t.applyBoltUpdates=function(e){var r=e.path,o=e.updates;return function(e,n){var i=o.parent_changes,s=E.user(n());if(l.paths_are_equal(r,E.path(n()))){if(i&&i.change_to_fq_path)return S.showUserNotificationForPathChange(s,i),void t.setUrl({path:i.change_to_fq_path})(e,n,D.mockExtraArguments);(function(e,r,o){var n=o.mount_points,i=E.path(r()),s=S.getMountPointUpdateForCurrentPath(n,i,E.mountPoints(r())),a=s[0],l=s[1];a&&!l&&L.Snackbar.complete(x.intl.formatMessage({id:"QB9ZqK",defaultMessage:"The folder was unshared."}),"browse-unshare");var c=S.getPathForNewMountPoint(a,l,i);if(c)return void e(t.setPath({path:c}));e(t.setMountPoints({mountPoints:n}))})(e,n,o),(function(e,r,o){var n=o.added,i=o.moved,s=o.removed,a=E.path(r()),d=E.unsortedFiles(r()),u=E.folderSizes(r()),p=d.size,_={added:new Set([]),moved:new Set([]),removed:new Set([])};e(t.popBoltIgnore(_)),(d=d.withMutations((function(e){u=u.withMutations((function(t){for(var r=function(t){(function(e){return l.paths_are_equal(l.parent_dir(e.fq_path),a)})(t)&&(e.set(t.fq_path,T.File.fromServerObject(t)),p+=1)},o=function(o,n){var i=e.get(o);if(!(i&&i.sjid>=n.sjid&&o===n.fq_path)){e.remove(o),r(n);var s=t.get(o);s&&(t.remove(o),t.set(n.fq_path,s))}},c=0,d=n;c<d.length;c++){var u=d[c];e.has(u.fq_path)?o(u.fq_path,u):r(u)}for(var _=0,f=i;_<f.length;_++){var m=f[_],h=m[0];u=m[1];e.has(h)?o(h,u):r(u)}for(var g=function(r){var o=e.find((function(e){return e.fq_path.toLowerCase()===r.toLowerCase()}));o&&(function(r){e.remove(r),t.remove(r),p-=1})(o.fq_path)},S=0,E=s;S<E.length;S++){g(h=E[S])}}))}))).size!==p&&N.reportException({err:new Error("applyBoltUpdates ended up with unexpected number of items"),tags:["browse_file_collections_mismatch"],severity:N.SEVERITY.CRITICAL,exc_extra:{expected_unsorted_files_size:p,actual_unsorted_files_size:d.size,is_deleted_files_on:E.shouldShowDeletedFiles(r()),filesAdded:n,filesRemoved:s,filesMove:i}});d!==E.unsortedFiles(r())&&(t.setUnsortedFiles({unsortedFiles:d})(e,r,D.mockExtraArguments),c.Dispatcher.dispatch({type:m.SharedWithActionType.BROWSE_FILES_UPDATED,data:{parentPath:a,files:d.toArray()}}));u!==E.folderSizes(r())&&e(t.setFolderSizes({folderSizes:u}));B({unsortedFiles:d})(e,r,D.mockExtraArguments)})(e,n,o)}}};var B=function(e){var r=e.unsortedFiles;return function(e,o){var i=E.filePathsToSelectOnNextUpdate(o()).toArray(),s=i.filter((function(e){return r.has(e)})),a=i.filter((function(e){return!r.has(e)}));0!==s.length&&(e(t.selectFilesByFqPath({fqPathsToSelect:s})),e(t.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:n.Set(a)})))}};t.appendFiles=function(e){var r=e.path,o=e.files;return function(e,i){if(l.paths_are_equal(r,E.path(i()))){var s=E.unsortedFiles(i()).size,a=E.unsortedFiles(i()).merge(n.Map(o.map((function(e){return[e.fq_path,e]}))));t.setUnsortedFiles({unsortedFiles:a})(e,i,D.mockExtraArguments),B({unsortedFiles:a})(e,i,D.mockExtraArguments),setTimeout((function(){c.Dispatcher.dispatch({type:m.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:r,files:o}})}),1),a.size!==s+o.length&&N.reportException({err:new Error("appendFiles ended up with unexpected number of files."),tags:["browse_file_collections_mismatch"],severity:N.SEVERITY.CRITICAL,exc_extra:{previous_unsorted_files_size:s,incoming_files_size:o.length,updated_unsorted_files_size:a.size,is_deleted_files_on:E.shouldShowDeletedFiles(i())}})}}},t.setIsFileViewerShown=function(e){var t=e.isShown;return{type:v.ActionTypes.SET_IS_FILE_VIEWER_SHOWN,payload:{isShown:t}}},t.setArePostTTIModulesLoaded=function(e){var t=e.arePostTTIModulesLoaded;return{type:v.ActionTypes.SET_ARE_POST_TTI_MODULES_LOADED,payload:{arePostTTIModulesLoaded:t}}};var W=function(e,t,r){if(r&&0!==r.selected.count()){var o=E.unsortedFiles(t()),n=null==o?void 0:o.filter((function(e){return r.selected.has(e.fq_path)&&!e.thumbnail_url_tmpl})),i=[];if(null==n||n.forEach((function(e){i.push({file_id:e.file_id,sj_id:e.sjid,ns_id:e.ns_id})})),i.length>0){var s=E.user(t()).id;e(y.loadPreviewThumbnails(i,s,m.BROWSE_FILES_VIEW_ID))}}};t.showPersonalizationSuggestedFolders=function(e){return{type:v.ActionTypes.SHOW_PERSONALIZATION_SUGGESTED_FOLDERS,payload:{showSuggestedFolders:e}}},t.setViewType=function(e){return function(t,r){var o=r();t(y.setViewType({user:E.user(o),viewType:e,viewTypeScope:E.selectViewTypeScope(o),useViewPreferences:E.shouldUseFilesViewPreferences(o),updateGlobalScope:!0}))}},t.setHideFilesAndSidebar=function(e){var t=e.shouldHideFilesAndSidebar;return{type:v.ActionTypes.SET_HIDE_FILES_AND_SIDEBAR,payload:{shouldHideFilesAndSidebar:t}}}})),define("modules/clean/react/browse/data/action_creators/file_actions",["require","exports","tslib","modules/clean/file_actions/metrics","modules/clean/file_actions/strings","modules/clean/filepath","modules/clean/metrics/index","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators/index","modules/clean/react/browse/data/selectors","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/files_view/file_actions/rollback","modules/clean/react/files_view/file_actions/snackbars","modules/clean/react/files_view/types","modules/clean/react/snackbar","modules/clean/undo","modules/clean/web_user_action_events","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),a=r.__importStar(a),u=r.__importStar(u),p=r.__importStar(p),f=r.__importStar(f),m=r.__importStar(m),h=r.__importStar(h),E=r.__importStar(E);var y=function(e){var t=e.state,r=e.eventName,o=e.num_files_selected,n=e.num_folders_selected,i=e.batch_success_count,s=e.batch_fail_count,a=e.lookup_error_type,d=e.error_summary;l.logBrowseAction({uid:u.user(t).id,action:r,num_files_selected:o,num_folders_selected:n,view_type:m.selectViewType(t,{instanceId:c.BROWSE_FILES_VIEW_ID}),batch_success_count:i,batch_fail_count:s,lookup_error_type:a,error_summary:d})};t.deleteFiles=function(e){var l=e.files,c=e.checkFSWs;return function(e,f){return r.__awaiter(void 0,void 0,void 0,(function(){var m,g,v,F,C,O,A,P,L,D,M,R,N,x,k,U,V,H,B;return r.__generator(this,(function(W){switch(W.label){case 0:return m=u.user(f()),g=u.path(f()),v=u.shouldShowDeletedFiles(f()),F=s.getMetricsReporter(),C={surface:"browse",batchSizeBucket:o.bucketForBatchSize(l.length),contentType:o.batchContentType(l)},O=F.createTimer({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/latency_total_ms"},C),A=Date.now(),P=F.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/latency_average_ms"},C),L=F.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/completed"},C),w.Snackbar.sync(I.intl.formatMessage(n.deleteSnackbarProgressMessage,{count:l.length}),!0,"browse-action"),1!==l.length||v||e(d.pushBoltIgnore({removed:new Set([l[0].fq_path])})),y({state:f(),eventName:b.WebUserActionLogEvent.DELETE_REQUEST_ATTEMPT,num_files_selected:l.length,num_folders_selected:0}),[4,h.deleteFiles(l,m.id,c)];case 1:return(D=W.sent()).isError&&"path"===D.error[".tag"]&&"file_system_warnings"===D.error.path[".tag"]?(e((function(e){var o=e.files,i=e.details;return function(e,s){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){return w.Snackbar.close("browse-action"),a.showFileSystemWarningsModal({fsws:i,onFinalAccept:function(){e(t.deleteFiles({files:o,checkFSWs:!1}))},confirmText:I.intl.formatMessage(n.deleteFswConfirmText)}),[2]}))}))}})({files:l,details:D.error.path.details})),[2]):(O.record(),P.record((Date.now()-A)/l.length),D.isError?(e((function(e){var t=e.files,o=e.result;return function(e,n){return r.__awaiter(void 0,void 0,void 0,(function(){var i,s,a,l,c;return r.__generator(this,(function(r){return i=u.shouldShowDeletedFiles(n()),1!==t.length||i||e(d.popBoltIgnore({removed:new Set([t[0].fq_path])})),w.Snackbar.fail(E.deleteError(t.length,o.error),"browse-action"),s=u.selectedFiles(n()),a=p.countFilesAndFolders(s),l=a.num_files_selected,c=a.num_folders_selected,y({state:n(),eventName:b.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:l,num_folders_selected:c,batch_success_count:0,batch_fail_count:t.length,error_summary:o.error_summary}),[2]}))}))}})({files:l,result:D})),L.record(0),[2]):(M=function(e){return"success"===e[".tag"]},R=D.result.entries.filter(M),e((function(e){var t=e.pathAtRequestTime,o=e.successEntries;return function(e,n){return r.__awaiter(void 0,void 0,void 0,(function(){var s,a,l,c;return r.__generator(this,(function(p){return s=u.shouldShowDeletedFiles(n()),i.paths_are_equal(u.path(n()),t)?(a=o.map((function(e){return e.metadata.path_display})),l=u.unsortedFiles(n()),c=a.reduce((function(e,t){if(void 0===t)return e;var o=l.get(t);return s&&void 0!==o?e.set(t,new _.File(r.__assign(r.__assign({},o),{isDeleted:!0}))):e.delete(t)}),l),e(d.setUnsortedFiles({unsortedFiles:c})),[2]):[2]}))}))}})({pathAtRequestTime:g,successEntries:R})),N=(function(e,t){return function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){return w.Snackbar.close("browse-action"),y({state:e,eventName:b.WebUserActionLogEvent.DELETE_UNDO,num_files_selected:t.result.changeset_data.length,num_folders_selected:0}),S.rollback({changeset_data:t.result.changeset_data,userId:u.user(e).id,onSuccess:function(){w.Snackbar.complete(I.intl.formatMessage(n.deleteUndoSnackbarMessage),"browse-action"),y({state:e,eventName:b.WebUserActionLogEvent.DELETE_UNDO_REQUEST_SUCCESS,num_files_selected:t.result.changeset_data.length,num_folders_selected:0})}}),[2]}))}))}})(f(),D),T.setHandleUndo(N),x=D.result.entries.filter(h.isFailure),void 0!==(k=x[0])&&(H=k.failure,U=H[".tag"],h.isPathLookupFailure(H)&&(V=H.path_lookup[".tag"])),B=D.result.entries.filter((function(e){return h.isFailure(e)&&!h.isPathLookupFailure(e.failure)})).length,L.record(B>0?0:1),o.recordPathLookupErrors(x,"delete",C),x.length===D.result.entries.length?(w.Snackbar.fail(E.deleteCompleteError(x),"browse-action"),y({state:f(),eventName:b.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:D.result.changeset_data.length,num_folders_selected:0,batch_success_count:D.result.entries.length-x.length,batch_fail_count:x.length,error_summary:U,lookup_error_type:V})):(w.Snackbar.completeWithUndo(E.deleteCompleteSuccess(l.length,R.length),N,"browse-action"),y({state:f(),eventName:b.WebUserActionLogEvent.DELETE_REQUEST_SUCCESS,num_files_selected:D.result.changeset_data.length,num_folders_selected:0,batch_success_count:D.result.entries.length,batch_fail_count:0,error_summary:U,lookup_error_type:V})),[2]))}}))}))}};var F=function(e,t,r,o){var n=u.selectedFiles(e),i=p.countFilesAndFolders(n),s=i.num_files_selected,a=i.num_folders_selected;l.logBrowseAction({uid:u.user(e).id,action:t,num_files_selected:s,num_folders_selected:a,view_type:m.selectViewType(e,{instanceId:c.BROWSE_FILES_VIEW_ID}),result:r,error_summary:o})};t.renameUndo=function(e){var t=e.file,a=e.pathAtRequestTime,l=e.result;return function(e,c){return r.__awaiter(void 0,void 0,void 0,(function(){var p,_,f,m,S,E;return r.__generator(this,(function(r){switch(r.label){case 0:return p=u.user(c()),_=g.fileFromMetadata(t,l.result.metadata),f=s.getMetricsReporter(),m={surface:"browse",contentType:t.is_dir?"folders":"files",batchSizeBucket:"single"},S={latency:f.createTimer({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"undo/latency_ms"},m),completed:f.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"undo/completed"},m)},w.Snackbar.sync(I.intl.formatMessage(n.renameUndoSnackbarProgressMessage),!1,"browse-action"),e(d.pushBoltIgnore({added:new Set([t.fq_path]),removed:new Set([_.fq_path])})),F(c(),b.WebUserActionLogEvent.RENAME_UNDO,t),[4,h.undo(l.result.changeset_data,p)];case 1:return(E=r.sent()).isError?(w.Snackbar.fail(I.intl.formatMessage(n.renameUndoSnackbarErrorMessage),"browse-action"),e(d.popBoltIgnore({added:new Set([t.fq_path]),removed:new Set([_.fq_path])})),F(c(),b.WebUserActionLogEvent.RENAME_UNDO_REQUEST_FAIL,t,E.error_summary),S.completed.record(0)):(w.Snackbar.complete(I.intl.formatMessage(n.renameUndoSnackbarSuccessMessage),"browse-action"),i.paths_are_equal(u.path(c()),a)&&(e(d.setUnsortedFiles({unsortedFiles:u.unsortedFiles(c()).remove(_.fq_path).set(t.fq_path,t)})),e(d.refreshPinnedItems())),e(d.selectFilesByFqPath({fqPathsToSelect:[t.fq_path]})),F(c(),b.WebUserActionLogEvent.RENAME_UNDO_REQUEST_SUCCESS,t),S.completed.record(1)),S.latency.record(),[2]}}))}))}},t.renameFile=function(e){var l=e.file,c=e.name,p=e.checkFSWs;return function(e,_){return r.__awaiter(void 0,void 0,void 0,(function(){var m,S,y,C,O,A,P,L;return r.__generator(this,(function(D){switch(D.label){case 0:return m=u.user(_()),S=u.path(_()),y=s.getMetricsReporter(),C={surface:"browse",contentType:l.is_dir?"folders":"files"},O={latency:y.createTimer({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"rename/latency_ms"},C),completed:y.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"rename/completed"},C)},-1!==c.indexOf("/")?(w.Snackbar.fail(I.intl.formatMessage(n.renameErrorInvalidName),"browse-action"),e(f.setFileRename({file:l,renameState:null})),[2]):(e(f.setFileRename({file:l,renameState:v.RenameState.SAVING_INPUT})),w.Snackbar.sync(I.intl.formatMessage(n.renameSnackbarProgressMessage),!1,"browse-action"),[4,h.renameFile(l,c,m,p)]);case 1:return(A=D.sent()).isError&&"to"===A.error[".tag"]&&"file_system_warnings"===A.error.to[".tag"]?(e((function(e){var o=e.file,i=e.name,s=e.details;return function(e){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){return w.Snackbar.close("browse-action"),a.showFileSystemWarningsModal({fsws:s,onFinalAccept:function(){e(t.renameFile({file:o,name:i,checkFSWs:!1}))},onAbortAction:function(){e(f.setFileRename({file:o,renameState:null})),e(d.pushBoltIgnore({moved:new Set([o.fq_path])}))},confirmText:I.intl.formatMessage(n.renameFswConfirmText)}),[2]}))}))}})({file:l,name:c,details:A.error.to.details})),[2]):(O.latency.record(),A.isError?(e((function(e){var t=e.file,o=e.result;return function(e,n){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){return e(d.pushBoltIgnore({moved:new Set([t.fq_path])})),e(f.setFileRename({file:t,renameState:null})),w.Snackbar.fail(E.renameError(o.error,t.fq_path),"browse-action"),F(n(),b.WebUserActionLogEvent.RENAME_REQUEST_FAIL,t,o.error_summary),[2]}))}))}})({file:l,result:A})),O.completed.record(0),y.createStats({ns:o.FILE_ACTIONS_AMP_NAMESPACE,name:"rename/error"},r.__assign(r.__assign({},C),{error:A.error[".tag"]})).record(1),[2]):(P=g.fileFromMetadata(l,A.result.metadata),i.paths_are_equal(u.path(_()),S)&&(e(d.setUnsortedFiles({unsortedFiles:u.unsortedFiles(_()).remove(l.fq_path).set(P.fq_path,P)})),e(d.refreshPinnedItems())),e(d.selectFilesByFqPath({fqPathsToSelect:[P.fq_path]})),e(f.setFileRename({file:l,renameState:null})),O.completed.record(1),L=function(){e(t.renameUndo({file:l,result:A,pathAtRequestTime:S}))},T.setHandleUndo(L),w.Snackbar.completeWithUndo(I.intl.formatMessage(n.renameSnackbarSuccessMessage),L,"browse-action"),F(_(),b.WebUserActionLogEvent.RENAME_REQUEST_SUCCESS,P),[2]))}}))}))}}})),define("modules/clean/react/browse/data/helpers",["require","exports","tslib","external/lodash","modules/clean/filepath","modules/clean/react/browse/data/selectors","modules/clean/react/snackbar","modules/core/i18n"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importStar(i),t.showUserNotificationForPathChange=function(e,t){switch(null!=t.change_type?t.change_type.toLowerCase():null){case"moved":s.Snackbar.complete(a.intl.formatMessage({id:"dte+6z",defaultMessage:"This folder has been moved"}),"browse-notification");break;case"renamed":s.Snackbar.complete(a.intl.formatMessage({id:"y/ubfn",defaultMessage:"This folder has been renamed to “{folder_name}”"},{folder_name:r(t.change_to_fq_path)}),"browse-notification");break;case"deleted":s.Snackbar.fail(a.intl.formatMessage({id:"MK7bBv",defaultMessage:"The folder “{folder_name}” has been deleted"},{folder_name:r(t.old_fq_path)}),"browse-notification")}function r(e){return o.escape(n.filename(e))}},t.getMountPointUpdateForCurrentPath=function(e,t,r){var n,i,s=function(e){return t===e};return r&&r.find(s)?(i=r.find(s)||null,n=e[r.findKey(s)]||null):(i=null,n=o.find(e,s)||null),[i,n]},t.getPathForNewMountPoint=function(e,t,r){return e&&!t?r:e&&t?n.paths_are_equal(e,t)?null:t:!e&&t?r:null},t.getIndexOfFile=function(e,t){return i.sortedFiles(t).findIndex((function(t){return t.sjid===e.sjid&&t.ns_id===e.ns_id}))}})),define("modules/clean/react/browse/data/reducer",["require","exports","tslib","immutable","dropbox/proto/js_init_data/browse_web/browse_web","modules/clean/filepath","modules/clean/react/browse/data/types","modules/clean/react/browse/models","modules/clean/react/files_view/types","modules/clean/react/selection","modules/core/exception"],(function(e,t,r,o,n,i,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),i=r.__importStar(i),t.defaultBrowseState={boltIgnore:{added:new Set,moved:new Set,removed:new Set},canDisplayFolderSizes:!1,clipboard:{files:[]},context:new a.BrowseContext,isRewindButtonEnabled:!1,experiments:n.browse_web.BrowseExperiments.create(),browsePostTTIExperiments:{},browsePostTTIExperimentsOverrides:{},fileJumpFilter:"",filePathsToSelectOnNextUpdate:o.Set(),folderSizes:o.Map(),isRewindVisible:!1,isFolderHistoryVisible:!1,clickRewindTimestamp:void 0,clickFolderHistoryTimestamp:void 0,loadingState:l.LoadingState.LOADING_FIRST_PAGE,mountPoints:null,newFolderCreationState:l.NewFolderCreationState.CREATE_FOLDER_INACTIVE,paginatedTotalNumFiles:0,path:"",selection:c.createSelection(),shouldShowDeletedFiles:!1,sortOrder:{sortField:l.SortField.FILENAME,sortDirection:l.SortDirection.ASCENDING},user:null,unsortedFiles:o.Map(),viewer:null,currentFolderSizesQuery:o.Set(),isQueryingFolderSizes:!1,isSearchMode:!1,hasLinkedMobile:!1,autoTeamGroupId:"",browsePostTTIData:{isOverFreeQuota:!1,hasExcludedNsIds:!1,uploaderPostTTIExperiments:{},preferredEditors:{},firstTaskProps:{is_eligible_team:!1,is_subtitle:!1,member_info:{tiered_admin:!1,users:[],evh_max_days:0},needs_pairing_token:!1,seen_desktop_tooltip:!1}},arePostTTIModulesLoaded:!1,shouldHideFilesAndSidebar:!1,isCreatingSharedLinkMap:o.Map()},t.browseReducer=function(e,n){switch(void 0===e&&(e=t.defaultBrowseState),n.type){case s.ActionTypes.APP_INIT:return(function(e,t){var o=t.payload,n=o.props,i=o.user,s=o.viewer;d.assert(null===e.user,"Cannot reinitialize Browse store; changing invariants such as `user` is untested");var a=n.browseExperiments,l=r.__rest(n,["browseExperiments"]);return r.__assign(r.__assign(r.__assign({},e),{user:i,viewer:s,experiments:a}),l)})(e,n);case s.ActionTypes.PUSH_BOLT_IGNORE:return(function(e,t){var o=e.boltIgnore,n=o.added,i=o.moved,s=o.removed;return t.payload.added&&(n=new Set(n),t.payload.added.forEach((function(e){return n.add(e)}))),t.payload.moved&&(i=new Set(i),t.payload.moved.forEach((function(e){return i.add(e)}))),t.payload.removed&&(s=new Set(s),t.payload.removed.forEach((function(e){return s.add(e)}))),r.__assign(r.__assign({},e),{boltIgnore:{added:n,moved:i,removed:s}})})(e,n);case s.ActionTypes.POP_BOLT_IGNORE:return(function(e,t){var o=e.boltIgnore,n=o.added,i=o.moved,s=o.removed;return t.payload.added&&(n=new Set(n),t.payload.added.forEach((function(e){return n.delete(e)}))),t.payload.moved&&(i=new Set(i),t.payload.moved.forEach((function(e){return i.delete(e)}))),t.payload.removed&&(s=new Set(s),t.payload.removed.forEach((function(e){return s.delete(e)}))),r.__assign(r.__assign({},e),{boltIgnore:{added:n,moved:i,removed:s}})})(e,n);case s.ActionTypes.SELECT_FILES_BY_FQ_PATH:return(function(e,t){var n=t.payload.fqPathsToSelect.map((function(e){return e.toLowerCase()})),i=e.unsortedFiles.toList().filter((function(e){return n.includes(e.fq_path.toLowerCase())})).map((function(e){return e.fq_path})),s=o.OrderedSet(i),a=i.size?i.get(0):null;return r.__assign(r.__assign({},e),{selection:e.selection.set("selected",s).set("anchor",a)})})(e,n);case s.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES:return(function(e,t){var o=t.payload.canDisplayFolderSizes;return r.__assign(r.__assign({},e),{canDisplayFolderSizes:o})})(e,n);case s.ActionTypes.SET_CLIPBOARD_FILES:return(function(e,t){var o=t.payload.clipboard;return r.__assign(r.__assign({},e),{clipboard:o})})(e,n);case s.ActionTypes.SET_CONTEXT:return(function(e,t){var o=t.payload.context;return r.__assign(r.__assign({},e),{context:o})})(e,n);case s.ActionTypes.SET_FILE_JUMP_FILTER:return(function(e,t){var o=t.payload.fileJumpFilter;return r.__assign(r.__assign({},e),{fileJumpFilter:o})})(e,n);case s.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:return(function(e,t){var o=t.payload.filePathsToSelectOnNextUpdate;return r.__assign(r.__assign({},e),{filePathsToSelectOnNextUpdate:o})})(e,n);case s.ActionTypes.SET_FOLDER_SIZES:return(function(e,t){var o=t.payload.folderSizes;return r.__assign(r.__assign({},e),{folderSizes:o})})(e,n);case s.ActionTypes.SET_LOADING_STATE:return(function(e,t){var n=t.payload,s=n.loadingState,a=n.path;return i.paths_are_equal(a,e.path)?s===l.LoadingState.LOADED?r.__assign(r.__assign({},e),{loadingState:s,filePathsToSelectOnNextUpdate:o.Set()}):r.__assign(r.__assign({},e),{loadingState:s}):e})(e,n);case s.ActionTypes.SET_MOUNT_POINTS:return(function(e,t){var n=t.payload.mountPoints;return r.__assign(r.__assign({},e),{mountPoints:o.Map(n)})})(e,n);case s.ActionTypes.SET_NEW_FOLDER_CREATION_STATE:return(function(e,t){var o=t.payload.newFolderCreationState;return r.__assign(r.__assign({},e),{newFolderCreationState:o})})(e,n);case s.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES:return(function(e,t){var o=t.payload.paginatedTotalNumFiles;return r.__assign(r.__assign({},e),{paginatedTotalNumFiles:o})})(e,n);case s.ActionTypes.SET_PATH:return(function(e,t){var o=t.payload.path;return r.__assign(r.__assign({},e),{path:o})})(e,n);case s.ActionTypes.SET_SELECTION:return(function(e,t){var o=t.payload.selection;return r.__assign(r.__assign({},e),{selection:o})})(e,n);case s.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES:return(function(e,t){var o=t.payload.shouldShowDeletedFiles;return r.__assign(r.__assign({},e),{shouldShowDeletedFiles:o})})(e,n);case s.ActionTypes.SET_SORT_ORDER:return(function(e,t){var o=t.payload.sortOrder;return r.__assign(r.__assign({},e),{sortOrder:o})})(e,n);case s.ActionTypes.SET_UNSORTED_FILES:return(function(e,t){var o=t.payload.unsortedFiles;return r.__assign(r.__assign({},e),{unsortedFiles:o})})(e,n);case s.ActionTypes.SHOW_TIMELINE:return(function(e,t){return r.__assign(r.__assign({},e),{isRewindVisible:!0,clickRewindTimestamp:t.payload.timestamp})})(e,n);case s.ActionTypes.HIDE_TIMELINE:return(function(e,t){return r.__assign(r.__assign({},e),{isRewindVisible:!1})})(e);case s.ActionTypes.SHOW_FOLDER_HISTORY_PANEL:return(function(e,t){return r.__assign(r.__assign({},e),{isFolderHistoryVisible:!0,clickFolderHistoryTimestamp:t.payload.timestamp})})(e,n);case s.ActionTypes.HIDE_FOLDER_HISTORY_PANEL:return(function(e,t){return r.__assign(r.__assign({},e),{isFolderHistoryVisible:!1})})(e);case s.ActionTypes.SET_IS_FILE_VIEWER_SHOWN:return(function(e,t){return r.__assign(r.__assign({},e),{isFileViewerShown:t.payload.isShown})})(e,n);case s.ActionTypes.SET_IS_REWIND_ENABLED:return(function(e,t){return r.__assign(r.__assign({},e),{isRewindButtonEnabled:t.payload.value})})(e,n);case s.ActionTypes.REQUEST_FOLDER_SIZES:return(function(e,t){var o=t.payload.fqPath;if(e.isQueryingFolderSizes)return e;var n=e.folderSizes.withMutations((function(e){e.set(o,{size:0,state:l.FetchFolderSizeState.LOADING})}));return r.__assign(r.__assign({},e),{folderSizes:n,isQueryingFolderSizes:!0})})(e,n);case s.ActionTypes.SET_FOLDER_SIZES_PENDING:return(function(e,t){var o=t.payload.fetchFolderSizesResp,n=e.currentFolderSizesQuery,i=e.folderSizes.withMutations((function(e){for(var t=function(t){e.update(t.fq_path,{size:0,state:l.FetchFolderSizeState.LOADING},(function(){return{size:t.size,state:l.FetchFolderSizeState.LOADING}})),n=n.withMutations((function(e){return e.add(t.fq_path)}))},r=0,i=o.sizes_dict;r<i.length;r++){t(i[r])}}));return r.__assign(r.__assign({},e),{currentFolderSizesQuery:n,folderSizes:i})})(e,n);case s.ActionTypes.COMPLETE_FOLDER_SIZES:return(function(e,t){var n=t.payload.fetchFolderSizeState,i=e.folderSizes.withMutations((function(t){e.currentFolderSizesQuery.forEach((function(r){var o=e.folderSizes.get(r);o&&t.update(r,(function(){return{size:o.size,state:n}}))}))}));return r.__assign(r.__assign({},e),{currentFolderSizesQuery:o.Set(),folderSizes:i,isQueryingFolderSizes:!1})})(e,n);case s.ActionTypes.SET_ARE_POST_TTI_MODULES_LOADED:return(function(e,t){return r.__assign(r.__assign({},e),{arePostTTIModulesLoaded:t.payload.arePostTTIModulesLoaded})})(e,n);case s.ActionTypes.SET_VIEW_SCOPE:return(function(e,t){return r.__assign(r.__assign({},e),{viewScope:t.payload.viewScope})})(e,n);case s.ActionTypes.SET_HIDE_FILES_AND_SIDEBAR:return(function(e,t){return r.__assign(r.__assign({},e),{shouldHideFilesAndSidebar:t.payload.shouldHideFilesAndSidebar})})(e,n);case s.ActionTypes.SET_IS_CREATING_SHARED_LINK:return(function(e,t){return r.__assign(r.__assign({},e),{isCreatingSharedLinkMap:e.isCreatingSharedLinkMap.set(t.payload.fileIdOrPath,t.payload.isCreatingSharedLink)})})(e,n);case s.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS:return(function(e,t){var o=t.payload.browsePostTTIExperiments;return r.__assign(r.__assign({},e),{browsePostTTIExperiments:o})})(e,n);case s.ActionTypes.SET_BROWSE_POST_TTI_DATA:return(function(e,t){var o=t.payload.browsePostTTIData;return r.__assign(r.__assign({},e),{browsePostTTIData:o})})(e,n);case s.ActionTypes.SHOW_PERSONALIZATION_SUGGESTED_FOLDERS:return(function(e,t){var o=e.browsePostTTIExperimentsOverrides,n=t.payload.showSuggestedFolders;return r.__assign(r.__assign({},e),{browsePostTTIExperimentsOverrides:r.__assign(r.__assign({},o),{showPersonalizationSuggestedFolders:n})})})(e,n)}return e}})),define("modules/clean/react/browse/data/selectors",["require","exports","tslib","immutable","reselect","modules/clean/filepath","modules/clean/filetypes","modules/clean/pnm/utils","modules/clean/react/browse/constants","modules/clean/react/browse/data/reducer","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/browse/util","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/types","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/core/exception"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),i=r.__importStar(i),t.getBrowseState=function(e){return S.getStateAtNamespace(e,g.BROWSE_NAMESPACE_KEY)||c.defaultBrowseState},t.canDisplayFolderSizes=function(e){return t.getBrowseState(e).canDisplayFolderSizes},t.clipboard=function(e){return t.getBrowseState(e).clipboard},t.context=function(e){return t.getBrowseState(e).context},t.experiments=function(e){return t.getBrowseState(e).experiments},t.postTTIExperiments=function(e){return t.getBrowseState(e).browsePostTTIExperiments},t.fileJumpFilter=function(e){return t.getBrowseState(e).fileJumpFilter},t.filePathsToSelectOnNextUpdate=function(e){return t.getBrowseState(e).filePathsToSelectOnNextUpdate},t.folderSizes=function(e){return t.getBrowseState(e).folderSizes},t.isFileJumping=function(e){return t.getBrowseState(e).fileJumpFilter.length>0},t.isQueryingFolderSizes=function(e){return t.getBrowseState(e).isQueryingFolderSizes},t.browseLoadingState=function(e){return t.getBrowseState(e).loadingState},t.mountPoints=function(e){return t.getBrowseState(e).mountPoints},t.newFolderCreationState=function(e){return t.getBrowseState(e).newFolderCreationState},t.path=function(e){return t.getBrowseState(e).path},t.selection=function(e){return t.getBrowseState(e).selection},t.shouldShowDeletedFiles=function(e){return t.getBrowseState(e).shouldShowDeletedFiles},t.sortOrder=function(e){if(t.shouldUseFilesViewPreferences(e)){var r=m.selectScopedSort(e,{instanceId:l.BROWSE_FILES_VIEW_ID});if(r)return r}return t.getBrowseState(e).sortOrder},t.boltIgnore=function(e){return t.getBrowseState(e).boltIgnore},t.loadingState=function(e){return t.getBrowseState(e).loadingState},t.browsePostTTIData=function(e){return t.getBrowseState(e).browsePostTTIData},t.hasLinkedMobile=function(e){return t.getBrowseState(e).hasLinkedMobile},t.autoTeamGroupId=function(e){return t.getBrowseState(e).autoTeamGroupId},t.shouldHideFilesAndSidebar=function(e){return t.getBrowseState(e).shouldHideFilesAndSidebar},t.isCreatingSharedLinkForFile=function(e,r){return Boolean(t.getBrowseState(e).isCreatingSharedLinkMap.get(r))},t.user=function(e){var r=t.getBrowseState(e).user;return E.assert(null!=r,"Browse store `user` accessed before APP_INIT action"),r},t.viewer=function(e){var r=t.getBrowseState(e).viewer;return E.assert(null!=r,"Browse store `viewer` accessed before APP_INIT action"),r},t.isRewindVisible=function(e){return t.getBrowseState(e).isRewindVisible},t.isFolderHistoryVisible=function(e){return t.getBrowseState(e).isFolderHistoryVisible},t.clickRewindTimestamp=function(e){return t.getBrowseState(e).clickRewindTimestamp},t.clickFolderHistoryTimestamp=function(e){return t.getBrowseState(e).clickFolderHistoryTimestamp},t.isFileViewerShown=function(e){return t.getBrowseState(e).isFileViewerShown},t.isRewindButtonEnabled=function(e){return t.getBrowseState(e).isRewindButtonEnabled},t.browsePostTTIExperiments=function(e){return t.getBrowseState(e).browsePostTTIExperiments||{}},t.browsePostTTIExperimentsOverrides=function(e){return t.getBrowseState(e).browsePostTTIExperimentsOverrides||{}},t.unsortedFiles=function(e){return t.getBrowseState(e).unsortedFiles},t.arePostTTIModulesLoaded=function(e){return t.getBrowseState(e).arePostTTIModulesLoaded},t.isCurrentPathRoot=function(e){return i.paths_are_equal(t.path(e),"/")},t.fileJumpIndex=n.createSelector(t.unsortedFiles,(function(e){return e.keySeq().toArray().map((function(e){return{filename:i.filename(e).toLowerCase(),fqPath:e}})).sort((function(e,t){return e.filename<t.filename?-1:e.filename>t.filename?1:0}))})),t.sortedFiles=n.createSelector(t.unsortedFiles,t.sortOrder,t.folderSizes,t.context,t.experiments,(function(e,t,r,o,n){var i=p.sortFiles(e.toList(),t,r);return i=i.filter((function(e){return!a.isPreSetupLinkNode(e.per_node_metadata)})),o.showPinnedTeamFolder&&"V2"===n.browsePinnedTeamFolders&&(i=i.filter((function(e){return e.type===s.FileTypes.TEAM_SHARED_FOLDER})).concat(i.filter((function(e){return e.type!==s.FileTypes.TEAM_SHARED_FOLDER})))),i})),t.selectedFiles=n.createSelector(t.unsortedFiles,t.selection,(function(e,t){return v(e,t)})),t.selectedFilesForSidebar=n.createSelector(t.selectedFiles,f.previewThumbnails,(function(e,t){return e.count()>0?e.withMutations((function(e){e.forEach((function(o,n){var i;if(!o.thumbnail_url_tmpl&&(null===(i=t[o.file_id])||void 0===i?void 0:i.preview_url)){var s=t[o.file_id].preview_url;e.set(n,new d.File(r.__assign(r.__assign({},o),{thumbnail_url_tmpl:s})))}}))})):e})),t.selectFilesForSelection=function(e,r){return v(t.unsortedFiles(e),r.selection)};var v=function(e,t){return t.selected.isEmpty()||e.isEmpty()?o.OrderedMap():o.OrderedMap(t.selected.map((function(t){var r=e.find((function(e){return e.fq_path===t}));return r?[r.fq_path,r]:void 0})))};t.urlPrefix=n.createSelector(t.user,t.viewer,(function(e,t){return u.browse_root(t,e)})),t.teamFolders=n.createSelector(t.unsortedFiles,t.folderSizes,(function(e,t){var r={sortField:h.SortField.FILENAME,sortDirection:h.SortDirection.ASCENDING};return p.sortFiles(e.toList().filter((function(e){return e.type===s.FileTypes.TEAM_SHARED_FOLDER})),r,t)})),t.sortedFilesWithFolderSizes=n.createSelector(t.sortedFiles,t.folderSizes,(function(e,t){return e.map((function(e){var r=t.get(e.fq_path);return r?e.updateSize(r.size,r.state):e}))})),t.unsortedFilesWithFolderSizes=n.createSelector(t.unsortedFiles,t.folderSizes,(function(e,t){return e.withMutations((function(r){t.forEach((function(t,o){var n=e.get(o);if(n&&t){var i=n.updateSize(t.size,t.state);r.set(o,i)}}))}))})),t.sortedFilesWithFoldersSizesWithoutTeamFolders=n.createSelector(t.sortedFilesWithFolderSizes,(function(e){return e.filter((function(e){return e.type!==s.FileTypes.TEAM_SHARED_FOLDER}))})),t.shouldShowSidebarFolderOverview=n.createSelector(t.selectedFiles,(function(e){return e&&1===e.size&&e.first().is_dir&&!d.File.isNoAccessSharedFolder(e.first())})),t.canEditFolderOverview=n.createSelector(t.user,t.context,(function(e,t){return e.is_cdm_member&&e.is_team_admin&&t.isCurrentlyInRoot||!!t.isCurrentPathWriteable()})),t.selectFileByFullPath=function(e,r){return t.sortedFilesWithFolderSizes(e).find((function(e){return e.fq_path===r.path}))},t.preSetupPlusFeatures=n.createSelector(t.unsortedFiles,t.sortOrder,t.folderSizes,(function(e,t,r){return p.sortFiles(e.toList().filter((function(e){return a.isPreSetupLinkNode(e.per_node_metadata)})),t,r)})),t.isInsideCollectionFolder=n.createSelector(t.context,(function(e){var t;return(null!==(t=e.collectionFolderType)&&void 0!==t?t:s.CollectionFolderType.UNSPECIFIED)!==s.CollectionFolderType.UNSPECIFIED})),t.isInsideEmptyCollectionFolder=n.createSelector(t.isInsideCollectionFolder,t.unsortedFiles,(function(e,t){return e&&0===t.count()})),t.shouldShowTeamSpaceEmptyZone=n.createSelector(t.context,t.browsePostTTIData,t.browsePostTTIExperiments,t.loadingState,(function(e,t,r,o){return!(r.expMobileWebInvites||!r.expPersonalizedFirstPaths&&!t.firstTaskProps.is_eligible_team||!e.isInsideMyTeamFolderTree||!e.isCurrentlyInRoot||o===h.LoadingState.LOADING_FIRST_PAGE)})),t.shouldShowNewFeaturesTable=n.createSelector(t.context,t.preSetupPlusFeatures,t.browseLoadingState,(function(e,t,r){return!!t.count()&&!(!e.isCurrentlyInRoot||r!==h.LoadingState.LOADED&&r!==h.LoadingState.LOADING_REMAINING_PAGES)})),t.shouldUseFilesViewPreferences=function(e){return"M1"===t.experiments(e).browseBetterViewSettings};t.selectViewTypeScope=n.createSelector((function(e){return t.getBrowseState(e).viewScope}),t.shouldUseFilesViewPreferences,(function(e,t){return t&&e?e:void 0})),t.selectionMode=n.createSelector(t.selectedFiles,(function(e){return e.count()>0?"selected":"unselected"})),t.showCondensedListViewOption=n.createSelector(t.experiments,(function(e){return"M1"===e.browseHighDensityListView})),t.selectViewTypes=n.createSelector(t.showCondensedListViewOption,(function(e){return e?_.AllViewTypes:_.AllViewTypes.filter((function(e){return e!==h.ViewType.CondensedList}))})),t.isActionBarEnabled=n.createSelector(t.experiments,(function(e){return"ON"===e.browseActionToolbar||"V1"===e.browseActionToolbar})),t.isDragToSelectEnabled=n.createSelector(t.experiments,(function(e){return"ON"===e.browseDragToSelect})),t.isCutActionEnabled=n.createSelector(t.experiments,(function(e){return Boolean(e.browseCutAndPaste)})),t.isMoreColumnsEnabled=n.createSelector(t.experiments,(function(e){return"ON"===e.browseMoreColumns})),t.isColumnResizingEnabled=n.createSelector(t.experiments,(function(e){return!!e.browseColumnResizing}))})),define("modules/clean/react/browse/data/folder_overview_selectors",["require","exports","tslib","modules/clean/react/browse/constants","modules/clean/react/folder_overview/data/selectors","modules/clean/react/browse/data/selectors","reselect","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/types","modules/clean/filepath"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),c=r.__importStar(c);var d=n.makeHaveAllComponentsLoadedSelector(),u=n.makeHasFailedToLoadSelector(),p=n.makeFolderFileIdSelector(),_=n.makeLoggingFileIdSelector(),f=n.makePinnedItemsSelector();t.haveAllComponentsLoaded=function(e){return d(e,{componentNamespace:o.BrowseFolderOverviewComponentNamespace})},t.hasFailedToLoad=function(e){return u(e,{componentNamespace:o.BrowseFolderOverviewComponentNamespace})},t.folderOverviewFolderFileId=function(e){return p(e,{path:i.path(e)})},t.folderOverviewLoggingFileId=function(e){return _(e,{path:i.path(e)})},t.folderOverviewPinnedItems=function(e){return f(e,{path:i.path(e)})},t.loadingState=s.createSelector(i.browseLoadingState,t.haveAllComponentsLoaded,t.hasFailedToLoad,i.experiments,(function(e,t,r){return r?e:t?e:l.LoadingState.LOADING_FIRST_PAGE})),t.shouldShowPinnedTeamFolders=s.createSelector(i.context,t.loadingState,i.path,i.teamFolders,a.selectIsListView,i.experiments,(function(e,t,r,o,n,i){return!["V1","V2"].includes(i.browsePinnedTeamFolders)&&e.showPinnedTeamFolder&&!o.isEmpty()&&c.paths_are_equal(r,"/")&&n&&(t===l.LoadingState.LOADED||t===l.LoadingState.LOADING_REMAINING_PAGES)})),t.emptyFolder=s.createSelector(i.sortedFilesWithFolderSizes,i.sortedFilesWithFoldersSizesWithoutTeamFolders,t.shouldShowPinnedTeamFolders,(function(e,t,r){return 0===(r?t:e).count()})),t.paginatedTotalNumFiles=function(e){return t.loadingState(e)===l.LoadingState.LOADED?i.sortedFiles(e).count():i.getBrowseState(e).paginatedTotalNumFiles},t.shouldShowVaultEmptyState=s.createSelector(i.context,t.paginatedTotalNumFiles,(function(e,t){return e.isInsideVaultFolder&&null!=e.currentNSPath&&c.paths_are_equal(e.currentNSPath,"")&&0===t}))})),define("modules/clean/react/browse/data/store",["require","exports","modules/clean/redux/namespaces","modules/clean/react/browse/data/reducer","modules/clean/redux/store"],(function(e,t,r,o,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForBrowse=function(){var e;return i||(i=n.getStoreAndRegisterReducers(((e={})[r.BROWSE_NAMESPACE_KEY]=o.browseReducer,e))),i}})),define("modules/clean/react/browse/global_actions/browse_global_actions",["require","exports","tslib","external/lodash","react","dig-components/icons/src","modules/clean/filetypes","modules/clean/react/browse/global_actions/browse_global_actions_handlers","modules/clean/react/browse/global_actions/browse_global_actions_helpers","modules/clean/react/browse/global_actions/browse_global_actions_labels","modules/clean/react/delorean/rewinds_upsell_util","modules/clean/react/extensions/data/types","modules/clean/react/extensions/split_share_button","modules/clean/sharing/gating_util","modules/clean/user_education/user_education_client","modules/clean/viewer","modules/core/browser_detection","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g){"use strict";function S(e,t){var r=[],o=h.is_input_webkitdirectory_supported(),n={className:"action-upload",label:c.getLabel(c.Label.UploadFiles),popoverLabel:c.getLabel(c.Label.Files),iconName:o?"upload-file":"upload",icon:i.UploadFileLine,performAction:function(){return t(!1)},disabled:!e,key:"upload-files"};if(r.push(n),o){var s={className:"action-upload",label:c.getLabel(c.Label.UploadFolder),popoverLabel:c.getLabel(c.Label.Folder),iconName:"upload-folder",icon:i.UploadFolderLine,performAction:function(){return t(!0)},disabled:!e,key:"upload-folder"};r.push(s)}return r}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importDefault(n),a=r.__importStar(a),h=r.__importStar(h),t.getGlobalActions=function(e){var t=e.context,r=e.user,h=e.viewType,g=e.showDeletedFiles,E=e.onUpload,v=void 0===E?o.noop:E,w=e.autoTeamGroupId,T=e.browseExperiments,b=e.isRewindButtonEnabled,I=e.expFolderHistoryRollbacks,y=e.hideRightsideActions,F=void 0!==y&&y,C=t.isCurrentlyInRoot,O=!t.canViewContainingNSMembers,A=t.isCurrentPathWriteable(),P=[],L={label:c.getLabel(c.Label.NewFolder),iconName:"new-folder",icon:i.FolderLine,performAction:function(){a.handleCreateNewFolder(r,h,t,T.goldenGateRaclsEnabled,w)},disabled:!A,className:"action-new-folder",key:"new-folder"},D={action:L,isPrimary:!1},M={label:c.getLabel(C?c.Label.NewSharedFolder:c.Label.ShareFolderAbbreviated),iconName:"new-shared-folder",icon:i.AddFolderLine,performAction:function(){a.handleSharedFolderClick(r,t)},disabled:O,className:"action-share-folder",key:"new-shared-folder"},R={file_id:"ns:"+t.currentNSID+t.currentNSPath,fq_path:t.currentFQPath,is_dir:!0,type:s.FileTypes.FOLDER,icon:"",is_cloud_doc:!1,is_symlink:!1},N={action:function(){return n.default.createElement(p.SplitShareButton,{file:R,user:r,variant:"secondary",triggerType:u.TriggerType.SidebarPrimaryButton,onShowShare:function(){a.handleSharedFolderClick(r,t)},logShareButtonClick:l.getLogSplitShareButtonFunction(r),onDropdownOpen:l.getLogOpenSplitShareFunction(r),context:{surface:"browse"},shareButtonLabel:c.getLabel(c.Label.ShareFolder),useDigButtons:!0})},isPrimary:!0},x={action:M,isPrimary:!1},k={action:{label:c.getLabel(c.Label.NewTeamFolder),iconName:"new-team-folder",icon:i.TeamLine,performAction:function(){a.handleRedirectToContentManager(t)},disabled:!1,className:"action-team-folder",key:"new-team-folder"},isPrimary:!1},U=S(A,v).map((function(e){return{action:e,isPrimary:!1}}));return r.is_cdm_member&&"/"===t.currentFQPath?(f.UEClient.registerBulkCallbackForEducationStep([{moduleName:"trial_admin_setup_team_space",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_v2",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_mobile",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_mobile_v2",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_folder_structure",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_folder_structure_v2",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_free_order",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_free_order_v2",stepName:"team_folder_modal"}],L.performAction),P.push.apply(P,U),P.push(D)):C?(P.push.apply(P,U),!r.is_cdm_member&&_.GoldenGate.hasContentManagerAndSuperAdmin(r.id)&&P.push(k),P.push(D,x)):(t.isInsideSandboxFolder||t.isInsideVaultFolder||t.isInFamilySharedFolder||P.push(N),P.push.apply(P,U),P.push(D)),!A||r.is_cdm_member&&"/"===t.currentFQPath||P.push({action:{label:c.getLabel(c.Label.RequestFiles),iconName:"new-file-request",icon:i.FileRequestLine,performAction:function(){a.handleRequestFiles(r,t)},key:"new-file-request"},isPrimary:!1}),F||P.push({action:{label:c.getLabel(g?c.Label.HideDeletedFiles:c.Label.ShowDeletedFiles),iconName:g?"hide":"show-deleted-files",icon:g?i.HideLine:i.ShowLine,performAction:function(){a.handleTrashCanClick(r,h,g,t.currentFQPath)},disabled:O,className:"action-deleted-files",key:"toggle-deleted",ariaLabel:c.getLabel(c.Label.ShowDeletedFiles),ariaPressed:g},isPrimary:!1}),m.Viewer.get_viewer().is_assume_user_session||!(_.GoldenGate.hasContentManagerAndSuperAdmin(r.id)&&_.GoldenGate.hasNewOwnershipModel(r.id)&&t.isInsideTeamFolderTree||!r.is_cdm_member&&_.GoldenGate.hasContentManagerAndSuperAdmin(r.id)&&t.isCurrentlyInRoot)||F||P.push({action:{label:c.getLabel(c.Label.ManageAsAdmin),iconName:"settings-gear",icon:i.SettingsLine,performAction:function(){a.handleViewInAdminConsoleClick(r,t)},key:"manage-as-admin"},isPrimary:!1}),(I&&!F||d.shouldShowRewindsUpsell(r))&&P.push({action:{label:t.isCurrentlyInRoot?c.getLabel(c.Label.RewindDropbox):c.getLabel(c.Label.RewindFolder),iconName:"revert-folder",icon:i.RewindLine,disabled:!b,performAction:function(){a.handleRewindClick(r)},key:"rewind-folder"},isPrimary:!1}),F||P.push({action:{label:c.getLabel(c.Label.FolderHistory),iconName:"view-folder-history",icon:i.FolderHistoryLine,performAction:function(){a.handleFolderHistoryClick(r)},key:"folder-history"},isPrimary:!1}),t.isInsideVaultFolder?a.getVaultFilteredActions(P):P},t.getUploadActions=S,t.getCreateFolderAction=function(e,t,r,o,n){return{displayName:g.intl.formatMessage({id:"5Z9j+l",defaultMessage:"Create folder"}),className:"action-new-folder",handleClick:function(){a.handleCreateNewFolder(e,t,r,o,n)},key:"new-folder"}}})),define("modules/clean/react/browse/global_actions/browse_global_actions_handlers",["require","exports","tslib","external/lodash","spectrum-sharing/utils/sharing_constants","modules/clean/analytics","modules/clean/file_actions/create-folder","modules/clean/history","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators/index","modules/clean/react/browse/data/store","modules/clean/react/browse/fss_experiment_carousel_util","modules/clean/react/browse/global_actions/browse_global_actions_labels","modules/clean/react/file_uploader/utils","modules/clean/react/growth/teams_web_actions_logger_events","modules/clean/sharing/access_level","modules/clean/sharing/browse_exports","modules/clean/web_user_action_events","modules/clean/web_user_action_logger","modules/core/browser","modules/core/exception","modules/core/i18n","modules/core/notify"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),a=r.__importDefault(a),u=r.__importStar(u),w=r.__importStar(w),t.handleCreateNewFolder=function(e,t,r,o,n){var a=r.currentFQPath;s.logCreateFolder({uid:e.id,view_type:t,origin:d.CREATE_FOLDER_ACTION_ORIGIN_TYPE.BROWSE_NEW_FOLDER_MODAL}),v.WebUserActionLog.log(e.id,E.WebUserActionLogEvent.NEW_FOLDER_CLICK,{}),i.TeamsWebActionsLogger.log(h.TeamSpaceEmptyZoneCTALoggerEvents.CREATE_FOLDER_CLICKED,{empty_state_personalization:!0});var l=e.is_cdm_member&&"/"===a;if(o&&(l=r.isInsideTeamFolderTree&&!!e.is_team),l){o||T.assert(!!n,"All CDM Users should have an auto team group in their team");var _=function(e){var t=e.pathName,r=e.folderName,o=e.checkFSWs;c.browseActions.createFolder({pathName:t,folderName:r,checkFSWs:o,redirectOnSuccess:c.browseActions.handleNewFolderRedirectOnSuccess,origin:d.CREATE_FOLDER_ACTION_ORIGIN_TYPE.BROWSE_CDM_NEW_FOLDER_MODAL})};S.asyncShowAppropriateNewFolderModalForCdmUser({user:e,context:r,autoTeamGroupId:n,showFileSystemWarningsModal:void 0,onPending:c.browseActions.createFolderPending,onComplete:function(e){e.user,e.folderName;var t=e.fqPath;c.browseActions.createFolderComplete(),c.browseActions.selectFilesByFqPath({fqPathsToSelect:[t]}),c.browseActions.handleNewFolderRedirectOnSuccess(t)},onCancel:function(e){I.Notify.error(e||b.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),c.browseActions.cancelCreateFolder()},autoTeamGroupDefaultAccessLevel:g.ACCESS_LEVEL.WRITER,setUrl:function(e){var t=e.path,r=e.qargs;return p.getStoreForBrowse().dispatch(u.setUrl({path:t,qargs:r}))},handleCreateFolder:_})}else{_=function(t){var o=t.folderName,n=t.isConfidential;c.browseActions.createFolderInNewFolderModal({folderName:o,isConfidential:n,user:e,context:r,redirectOnSuccess:c.browseActions.handleNewFolderRedirectOnSuccess,origin:d.CREATE_FOLDER_ACTION_ORIGIN_TYPE.BROWSE_NEW_FOLDER_MODAL})};S.asyncShowCdmNewFolderModal(_,e,r,!1,!1,!0)}},t.handleRewindClick=function(e,t){l.logBrowseAction({uid:e.id,action:E.WebUserActionLogEvent.REWIND_CLICK,num_files_selected:0,num_folders_selected:0,action_surface:(null==t?void 0:t.actionSurface)||E.ActionSurfaceLogValue.RIGHT_SIDEBAR,source:(null==t?void 0:t.actionSource)||l.BrowseLogEventSource.MAESTRO_RIGHT_SIDEBAR}),a.default.update_query_param(d.BrowseQueryArg.rewind,"true"),p.getStoreForBrowse().dispatch(u.showRewind())},t.handleFolderHistoryClick=function(e,t){l.logBrowseAction({uid:e.id,action:E.WebUserActionLogEvent.FOLDER_HISTORY_CLICK,num_files_selected:0,num_folders_selected:0,action_surface:(null==t?void 0:t.actionSurface)||E.ActionSurfaceLogValue.RIGHT_SIDEBAR,source:(null==t?void 0:t.actionSource)||l.BrowseLogEventSource.MAESTRO_RIGHT_SIDEBAR}),a.default.update_query_param(d.BrowseQueryArg.folder_history,"true"),p.getStoreForBrowse().dispatch(u.showFolderHistoryPanel())},t.handleSharedFolderClick=function(e,t){v.WebUserActionLog.log(e.id,E.WebUserActionLogEvent.NEW_SHARED_FOLDER_CLICK,{origin:n.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS}),t.isCurrentlyInRoot?S.asyncShowShareAFolderWizardModal(e):S.asyncShowShareModal(e,t,{origin:n.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS,onCancel:function(){_.asyncShowFssExpr(e,t.currentNSID,t.currentNSPath||"",!0)},onSuccessSharing:function(){_.asyncShowFssExpr(e,t.currentNSID,t.currentNSPath||"",!0)}},(function(e){var t=e.path,r=e.qargs;return p.getStoreForBrowse().dispatch(u.setUrl({path:t,qargs:r}))}))},t.handleTrashCanClick=function(e,t,r,o,n){var i=m.getUploadLocationMetadataToLog(e,o);v.WebUserActionLog.log(e.id,E.WebUserActionLogEvent.SHOW_DELETED_FILES_CLICK,i),l.logToggleDeletedFiles({uid:e.id,show_deleted_files:!r,view_type:t}),c.browseActions.setShouldShowDeletedFiles({shouldShowDeletedFiles:!r})},t.getVaultFilteredActions=function(e){return e.filter((function(e){var t=e.action;return!!o.isFunction(t)||!f.VAULT_BLOCK_LIST.has(t.label)}))},t.handleRedirectToContentManager=function(t){(function(t){r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(o){switch(o.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/sharing/content_manager"],t,r)})).then(r.__importStar)];case 1:return(0,o.sent().goToContentManagerForPath)(t),[2]}}))}))})({containingFolder:t.currentFQPath})},t.handleViewInAdminConsoleClick=function(e,r,o){var n=m.getUploadLocationMetadataToLog(e,r.currentFQPath);v.WebUserActionLog.log(e.id,E.WebUserActionLogEvent.VIEW_IN_ADMIN_CONSOLE_CLICK,n),t.handleRedirectToContentManager(r)},t.handleRequestFiles=function(e,t,r){var o=t.currentNSID,n=t.currentNSPath;l.logBrowseAction({uid:e.id,action:E.WebUserActionLogEvent.REQUEST_FILES_CLICK,num_files_selected:0,num_folders_selected:0,action_surface:(null==r?void 0:r.actionSurface)||E.ActionSurfaceLogValue.RIGHT_SIDEBAR,source:(null==r?void 0:r.actionSource)||l.BrowseLogEventSource.MAESTRO_RIGHT_SIDEBAR}),w.redirect("/requests?ns_id="+o+"&path="+n+"&referrer=web_browse_global_action")},t.handleAddContent=function(t,o,n){new Promise((function(t,r){e(["modules/clean/react/vault/lib/use_handle_add_files"],t,r)})).then(r.__importStar).then((function(e){(0,e.handleAddFiles)(t,o)(n)}))}})),define("modules/clean/react/browse/global_actions/browse_global_actions_helpers",["require","exports","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLogOpenSplitShareFunction=function(e){return function(){r.logBrowseAction({uid:e.id,action:o.WebUserActionLogEvent.OPEN_SPLITSHARE,num_files_selected:0,num_folders_selected:0,action_surface:o.ActionSurfaceLogValue.RIGHT_SIDEBAR,action_source:o.ActionSourceValue.SPLIT_SHARE})}},t.getLogSplitShareButtonFunction=function(e){return function(t){r.logBrowseAction({uid:e.id,action:o.WebUserActionLogEvent.SHARE,num_files_selected:0,num_folders_selected:0,action_surface:o.ActionSurfaceLogValue.RIGHT_SIDEBAR,action_source:o.ActionSourceValue.SPLIT_SHARE,extra:{splitshare_option:null!=t?t:null}})}}})),define("modules/clean/react/browse/global_actions/browse_global_actions_labels",["require","exports","modules/core/i18n"],(function(e,t,r){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.UploadFiles=1]="UploadFiles",e[e.UploadFolder=2]="UploadFolder",e[e.Upload=3]="Upload",e[e.Files=4]="Files",e[e.Folder=5]="Folder",e[e.NewPaperDoc=6]="NewPaperDoc",e[e.NewFolder=7]="NewFolder",e[e.RestoreFolder=8]="RestoreFolder",e[e.ReAddSharedFolder=9]="ReAddSharedFolder",e[e.ShowDeletedFiles=10]="ShowDeletedFiles",e[e.HideDeletedFiles=11]="HideDeletedFiles",e[e.NewSharedFolder=12]="NewSharedFolder",e[e.ShareFolder=13]="ShareFolder",e[e.ShareFolderAbbreviated=14]="ShareFolderAbbreviated",e[e.ManageAsAdmin=15]="ManageAsAdmin",e[e.NewTeamFolder=16]="NewTeamFolder",e[e.RequestFiles=17]="RequestFiles",e[e.FolderHistory=18]="FolderHistory",e[e.RewindFolder=19]="RewindFolder",e[e.RewindDropbox=20]="RewindDropbox"})(o=t.Label||(t.Label={}));var n={};t.getLabel=function(e){return e in n||(n[e]=(function(e){switch(e){case o.UploadFiles:return r.intl.formatMessage({id:"Qayhb5",defaultMessage:"Upload files"});case o.UploadFolder:return r.intl.formatMessage({id:"53oUlv",defaultMessage:"Upload folder"});case o.Upload:return r.intl.formatMessage({id:"i98Ff5",defaultMessage:"Upload"});case o.FolderHistory:return r.intl.formatMessage({id:"BxyH89",defaultMessage:"Folder history"});case o.RewindFolder:return r.intl.formatMessage({id:"4Wq7Cq",defaultMessage:"Rewind this folder"});case o.RewindDropbox:return r.intl.formatMessage({id:"hiHRLr",defaultMessage:"Rewind Dropbox"});case o.Files:return r.intl.formatMessage({id:"bObFEu",defaultMessage:"Files"});case o.Folder:return r.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"});case o.NewPaperDoc:return r.intl.formatMessage({id:"Jfm8Pe",defaultMessage:"New Paper Document"});case o.NewFolder:return r.intl.formatMessage({id:"pxGZm3",defaultMessage:"New folder"});case o.RestoreFolder:return r.intl.formatMessage({id:"gx89em",defaultMessage:"Restore folder"});case o.ReAddSharedFolder:return r.intl.formatMessage({id:"1YhtdU",defaultMessage:"Re-add shared folder"});case o.ShowDeletedFiles:return r.intl.formatMessage({id:"WR5EDI",defaultMessage:"Show deleted files"});case o.HideDeletedFiles:return r.intl.formatMessage({id:"j500HF",defaultMessage:"Hide deleted files"});case o.NewSharedFolder:return r.intl.formatMessage({id:"J9ZdWw",defaultMessage:"New shared folder"});case o.ShareFolder:return r.intl.formatMessage({id:"aHwEwV",defaultMessage:"Share folder"});case o.ShareFolderAbbreviated:return r.intl.formatMessage({id:"CcpVyl",defaultMessage:"Share"});case o.ManageAsAdmin:return r.intl.formatMessage({id:"SrWnn5",defaultMessage:"View in admin console"});case o.NewTeamFolder:return r.intl.formatMessage({id:"dYs+4Q",defaultMessage:"New team folder"});case o.RequestFiles:return r.intl.formatMessage({id:"QeqSyk",defaultMessage:"Request files"})}})(e)),n[e]},t.VAULT_BLOCK_LIST=new Set([t.getLabel(o.UploadFiles),t.getLabel(o.UploadFolder),t.getLabel(o.NewFolder),t.getLabel(o.RequestFiles)])})),define("modules/clean/react/browse/scroll_position",["require","exports","tslib","modules/core/browser"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var n=(function(){function e(){var e=this;this.navigationHistory=[],this.onPopState=function(){var t=e.peekItem(1);t&&t.url===o.get_href()?e.wasLastNavigationBack=!0:(e.wasLastNavigationBack=!1,e.clear())}}return e.prototype.clear=function(){this.navigationHistory=[]},e.prototype.popItem=function(){return this.navigationHistory.pop()},e.prototype.pushItem=function(e){this.navigationHistory.push(e)},e.prototype.peekItem=function(e){if(void 0===e&&(e=0),this.navigationHistory.length>e)return this.navigationHistory[this.navigationHistory.length-1-e]},e.prototype.register=function(){window.addEventListener("popstate",this.onPopState),this.navigationHistory=[]},e.prototype.unregister=function(){window.removeEventListener("popstate",this.onPopState),this.navigationHistory=[]},e.prototype.getLastScrollPosition=function(e){if(this.wasLastNavigationBack||this.pushItem({url:o.get_href(),fq_path:e}),this.wasLastNavigationBack){this.wasLastNavigationBack=!1;var t=this.popItem();return t&&t.fq_path}if(this.wasNavigateUpFolder){this.wasNavigateUpFolder=!1;var r=this.peekItem(1);return r&&r.fq_path}},e.prototype.navigateUpFolder=function(){this.wasNavigateUpFolder=!0},e})();t.ScrollPositionHandler=new n})),define("modules/clean/react/browse/selection_preview/selection_preview_pane",["require","exports","tslib","react","modules/clean/react/async/loadable"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.SelectionPreviewPane=n.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/browse/selection_preview/selection_preview_component"],t,r)})).then(r.__importStar).then((function(e){return e.MemoizedSelectionPreviewComponent}))},loading:function(){return o.default.createElement("div",{className:"selection-preview-pane selection-preview-pane__empty"})}})})),define("modules/clean/react/browse/sidebar_view",["require","exports","tslib","react","react-redux","modules/clean/react/actions_menu/view","modules/clean/react/browse/app_action_util","modules/clean/react/browse/browse_async_modules","modules/clean/react/browse/constants","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/browse/global_actions/browse_global_actions","modules/clean/react/browse/models","modules/clean/react/browse/selection_preview/selection_preview_pane","modules/clean/react/file_task_list/async_file_task_list","modules/clean/react/file_uploader/file_uploader","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/types","modules/clean/react/folder_overview/sidebar_controller","modules/clean/react/folder_overview/utils","modules/clean/react/growth/continuous_onboarding/continuous_onboarding_loader","modules/clean/react/growth/invite_facepile_loader","modules/clean/react/growth/manage_groups_cta","modules/clean/react/upload_kit/uploader/context","modules/clean/web_timing_logger","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b,I,y,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),c=r.__importStar(c),d=r.__importStar(d),g=r.__importStar(g);var C=(function(t){function n(e){var r=t.call(this,e)||this;return r.renderSingleSelectionAudienceBox=function(e,t){var n=e.selectedFiles,i=e.context,s=e.user;if(!t||r.isFirstTaskPage())return null;var a=n.first(),l=t.SharedWithController;return o.default.createElement(l,{file:a,browseContext:i,user:s,isInAudienceBox:!0,key:"single"})},r.shouldShowFacePile=function(){var e=r.props,t=e.showInviteSidePanel,o=e.selectedFiles,n=o&&0!==o.size;return(t||r.isFirstTaskPage()||r.isLetMembersInviteEligible())&&!n},r.shouldShowManageGroups=function(){var e=r.props.selectedFiles&&0!==r.props.selectedFiles.size;return"V1"===r.props.browsePostTTIExperiments.expGrowthActSmbGroupsFirst&&!e&&r.isFirstTaskPage()},r.isLetMembersInviteEligible=function(){return!!r.props.browsePostTTIExperiments.expLetMembersInviteData&&(r.props.browsePostTTIExperiments.expLetMembersInviteData.shouldShowLetMembersInviteCta&&r.props.context.isInsideTeamFolderTree&&r.props.context.isCurrentlyInRoot)},r.isFirstTaskPage=function(){return("V1"===r.props.browsePostTTIExperiments.expGrowthActSmbGroupsFirst||r.props.browsePostTTIData.firstTaskProps.is_eligible_team)&&r.props.context.isInsideTeamFolderTree&&r.props.context.isCurrentlyInRoot},r.getBrowseContext=function(){return r.props.context},r.shouldShowTaskList=function(){var e=r.props.selectedFiles,t=e&&1===e.size;return r.props.user.is_team&&r.props.browsePostTTIExperiments.expGrowthActSmbWorkflowsBaton&&t},r.state={appActionsProps:r.getCurrentAppActionsProps(e)},r}return r.__extends(n,t),n.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(o){switch(o.label){case 0:return[4,y.waitForTTI()];case 1:return o.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/browse/shared_with"],t,r)})).then(r.__importStar)];case 2:return t=o.sent(),this.setState({appActionsProps:this.getCurrentAppActionsProps(this.props,t),sharedWithModule:t}),[2]}}))}))},n.prototype.componentDidUpdate=function(e){e.selectedFiles===this.props.selectedFiles&&e.isRewindButtonEnabled===this.props.isRewindButtonEnabled&&e.context===this.props.context&&e.user===this.props.user&&e.shouldShowDeletedFiles===this.props.shouldShowDeletedFiles&&e.arePostTTIModulesLoaded===this.props.arePostTTIModulesLoaded&&e.viewType===this.props.viewType&&e.starredState===this.props.starredState&&e.canDisplayFolderSizes===this.props.canDisplayFolderSizes&&e.uploadAjaxInterceptor===this.props.uploadAjaxInterceptor&&e.responsive.isMatchedMedium===this.props.responsive.isMatchedMedium&&e.responsive.isMatchedLarge===this.props.responsive.isMatchedLarge&&e.browseExperiments===this.props.browseExperiments&&e.browsePostTTIExperiments===this.props.browsePostTTIExperiments&&e.pinnedItems===this.props.pinnedItems&&e.browsePostTTIData===this.props.browsePostTTIData||this.setState({appActionsProps:this.getCurrentAppActionsProps(this.props,this.state.sharedWithModule)})},n.prototype.getCurrentAppActionsProps=function(e,t){var r,n=e.selectedFiles,i=e.autoTeamGroupId,a=e.context,l=e.canDisplayFolderSizes,c=e.onGetFileActionsForFiles,d=e.user,u=e.isRewindButtonEnabled,_=e.viewType,f=e.shouldShowDeletedFiles,m=e.onUploadButtonClick,h=e.browseExperiments,g=e.handleComponentTTI,S=e.responsive,E=e.scrollableSidebarRef,v=n.count(),w=o.default.createElement("div",null);if(v>0)r=c(n,l,S,!0,!0,E).map((function(e,t){return{action:e,isPrimary:0===t||"function"==typeof e}})),1===v&&(w=this.renderSingleSelectionAudienceBox(e,t));else if(r=p.getGlobalActions({context:a,user:d,isRewindButtonEnabled:u,viewType:_,showDeletedFiles:f,onUpload:m,autoTeamGroupId:i,browseExperiments:h,expFolderHistoryRollbacks:this.props.browseExperiments.folderHistoryRollbacks||!1,hideRightsideActions:this.props.hideRightsideActions}),t&&!this.isFirstTaskPage()&&!this.isLetMembersInviteEligible()){var T=t.SharedWithController;w=o.default.createElement(T,{browseContext:a,user:d,isInAudienceBox:!0,key:"global"})}for(var b=[],I=[],y=0,C=r;y<C.length;y++){var O=C[y];O.isPrimary?b.push(s.browseAppActionToPrimaryMenuItem(O.action)):I.push(s.browseAppActionToSecondaryMenuItem(O.action))}return{popoverTriggerLabel:F.intl.formatMessage({id:"w81jal",defaultMessage:"Actions"}),primaryMenuItems:b,primarySubnode:w,secondaryMenuItems:I,handleComponentTTI:g}},n.prototype.render=function(){var e=this.props,t=e.responsive,n=e.isFileViewerShown,s=e.selectedFiles,l=e.scrollableSidebarRef,c=e.browsePostTTIExperiments,p=e.browsePostTTIData,g=p.firstTaskProps,I=p.uploaderPostTTIExperiments,y=e.showInviteSidePanel,F=e.personalizationLogCtx,C=e.hideSelectionPreviewPane,O=e.isInsideEmptyCollectionFolder,A=e.isActionBarEnabled,P=!(!t||!t.isResponsive||t.isMatchedLarge),L=u.getStoreForBrowse(),D=!P&&!C&&!O,M=!P&&d.shouldShowSidebarFolderOverview(L.getState()),R=s&&0!==s.size,N={uploadItems:this.props.uploadItems,isUploading:this.props.isUploading,setInitialUploadedItems:this.props.setInitialUploadedItems,cancelUploadItem:this.props.cancelUploadItem,chooseFiles:this.props.chooseFiles,chooseFolder:this.props.chooseFolder,chooseDropboxFiles:this.props.chooseDropboxFiles,handleDrop:this.props.handleDrop,makeDirectory:this.props.makeDirectory,moveUploadItem:this.props.moveUploadItem,removeUploadItem:this.props.removeUploadItem,renameUploadItem:this.props.renameUploadItem,startUploading:this.props.startUploading,stopUploading:this.props.stopUploading},x=Object.keys(c).length>0;return o.default.createElement("div",{id:"brws-sidebar-view",className:"brws-sidebar-view"},this.shouldShowFacePile()&&o.default.createElement(T.InviteFacepileLoadable,{isTeamAdmin:this.props.user.is_team_admin,experiments:{growthActSmbGroupsFirst:c.expGrowthActSmbGroupsFirst,growthActSmbWorkflowsPd:c.expGrowthActSmbWorkflowsPd},isFirstTask:g.is_eligible_team,memberInfo:g.member_info,enableInviteSidePanel:y,personalizationLogCtx:F,isLetMembersInviteEligible:this.isLetMembersInviteEligible(),expLetMembersInviteData:this.isLetMembersInviteEligible()?this.props.browsePostTTIExperiments.expLetMembersInviteData:void 0}),this.shouldShowManageGroups()&&o.default.createElement(b.ManageGroupsCTA,{isTeamAdmin:this.props.user.is_team_admin}),null!=this.props.context.currentFQPath&&!n&&!this.props.isActionBarEnabled&&o.default.createElement(h.FileUploaderController,{key:"file-uploader-controller",ref:"fileUploader",autoTeamGroupId:this.props.autoTeamGroupId,loadOnRender:this.props.arePostTTIModulesLoaded,needToSetStoreValues:!1,ajaxInterceptor:this.props.uploadAjaxInterceptor,uploaderPostTTIExperiments:I,uploadConsumerInterface:N,useUploadKit:!!this.props.browsePostTTIExperiments.expUseUploadKit,getBrowseContext:this.getBrowseContext,parallelFileUploads:!!this.props.browseExperiments.parallelFileUploads,shouldInitialize:x,isFirstTask:this.props.browsePostTTIData.firstTaskProps.is_eligible_team}),D&&o.default.createElement(f.SelectionPreviewPane,{selectedFiles:s,isInsideSharedFolder:this.props.context.isInsideSharedFolder,showCurrentFolderPreview:A,user:this.props.user,isActionBarEnabled:A,viewType:this.props.viewType}),!P&&A&&o.default.createElement(a.AsyncSidebarSharingSection,null),!O&&!this.props.isActionBarEnabled&&o.default.createElement(i.ActionsMenu,r.__assign({user:this.props.user},this.state.appActionsProps,{responsive:this.props.responsive,hideHeaderText:!!D,shouldCollapseActions:R,onContextMenuClick:this.props.onContextMenuClick,hideCreateButton:!0,isPrimaryActionSapphire:!0,scrollableSidebarRef:l,shouldUsePortalPopover:!0,hideSidebarCtas:this.props.hideSidebarCtas})),M&&o.default.createElement(E.SidebarFolderOverview,{key:s.first().fq_path,path:s.first().fq_path,componentNamespace:"SIDEBAR",isReadOnly:!v.canEditOverviewForFile(s.first()),browseLoadingState:S.LoadingState.LOADED,canShareFolder:!_.File.isNoAccessSharedFolder(s.first())}),this.shouldShowTaskList()&&o.default.createElement(m.AsyncFileTaskList,{file:s.first()}),o.default.createElement(w.ContinuousOnboardingLoadable,{userId:this.props.user.id,isBackgroundActive:R}))},n})(o.default.PureComponent);t.BrowseSidebarViewComponent=C,t.BrowseSidebarView=I.withUploadConsumer(n.connect((function(e){return{arePostTTIModulesLoaded:d.arePostTTIModulesLoaded(e),isFileViewerShown:d.isFileViewerShown(e),browseExperiments:d.experiments(e),browsePostTTIExperiments:d.postTTIExperiments(e),context:d.context(e),viewType:g.selectViewType(e,{instanceId:l.BROWSE_FILES_VIEW_ID}),isRewindVisible:d.isRewindVisible(e),selectedFiles:d.selectedFilesForSidebar(e),user:d.user(e),pinnedItems:c.folderOverviewPinnedItems(e),shouldShowDeletedFiles:d.shouldShowDeletedFiles(e),isRewindButtonEnabled:d.isRewindButtonEnabled(e),canDisplayFolderSizes:d.canDisplayFolderSizes(e),emptyFolder:c.emptyFolder(e,{instanceId:l.BROWSE_FILES_VIEW_ID}),autoTeamGroupId:d.autoTeamGroupId(e),browsePostTTIData:d.browsePostTTIData(e),isInsideEmptyCollectionFolder:d.isInsideEmptyCollectionFolder(e),isActionBarEnabled:d.isActionBarEnabled(e)}}))(C))})),define("modules/clean/react/browse/title",["require","exports","tslib","react-redux","react","modules/clean/browse_uri_interface","modules/clean/filepath","modules/clean/react/browse/data/action_creators/index","modules/clean/react/browse/data/selectors","modules/clean/react/file_uploader/file_uploader","modules/clean/react/path_breadcrumbs","modules/clean/viewer","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importStar(s),a=r.__importStar(a),l=r.__importStar(l);var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getPath=function(e){return t.props.inTmf&&t.props.splitTmfTsd?e.replace(t.props.user.cdm_tmf_path||"","/"):e},t.handleGetUrlForPath=function(e){return i.browse_uri_for_fq_path(t.props.user,t.getTmfPathIfNeeded(e)).toString()},t}return r.__extends(t,e),t.prototype.getTmfPathIfNeeded=function(e){var t=this.props,r=t.inTmf,o=t.user;return t.splitTmfTsd&&r&&o.cdm_tmf_path?o.cdm_tmf_path+e:e},t.prototype.getFirstBreadcrumbName=function(){var e=this.props,t=e.user,r=e.splitTmfTsd,o=e.inTmf;if(!r)return s.filename("",u.Viewer.get_root_name(t));var n=p.intl.formatMessage({id:"MbSim3",defaultMessage:"Team Files"});return o&&(n=p.intl.formatMessage({id:"BnxoQG",defaultMessage:"My Files"})),n},t.setPageTitle=function(e){e&&(document.title=p.intl.formatMessage({id:"dbYCaa",defaultMessage:"{folder_name} - Dropbox"},{folder_name:s.filename(e,p.intl.formatMessage({id:"bObFEu",defaultMessage:"Files"}))}))},t.prototype.componentDidMount=function(){t.setPageTitle(this.props.path)},t.prototype.componentDidUpdate=function(e){e.path!==this.props.path&&t.setPageTitle(this.props.path)},t.prototype.render=function(){var e=this,t=this.props,r=t.path,o=t.user,i=t.isDraggingInternalFiles,s=t.setUrl,a=t.expMobileWebInvites,l=this.getFirstBreadcrumbName(),u="work"===o.role?p.intl.formatMessage({id:"AAQLq4",defaultMessage:"Work"}):p.intl.formatMessage({id:"QPBzI3",defaultMessage:"Personal"});return n.default.createElement(d.PathBreadcrumbs,{path:this.getPath(r),setFileUploaderPath:c.FileUploaderController.setPathAndPermissions,getUrlForPath:this.handleGetUrlForPath,firstBreadcrumbName:l,firstBreadcrumbAlt:u,shouldHighlightDropTargets:i,enableDragging:i,setUrl:function(t){var r=t.path;s({path:e.getTmfPathIfNeeded(r)})},expMobileWebInvites:a})},t})(n.default.PureComponent);t.BrowseTitleComponent=_;var f={setUrl:a.setUrl},m=o.connect((function(e){var t=l.context(e),r=l.path(e),o=l.user(e),n=t.currentMountPoint===o.cdm_tmf_path;return{path:r,user:o,expMobileWebInvites:l.browsePostTTIExperiments(e).expMobileWebInvites,inTmf:n,splitTmfTsd:l.experiments(e).splitTmfTsd}}),f);t.BrowseTitle=m(_)})),define("modules/clean/react/browse/web_team_sharing_experiment",["require","exports","tslib","react","modules/clean/react/file_uploader/constants","modules/clean/react/async_fileops_modals","modules/clean/analytics","immutable","modules/clean/react/async/loadable","modules/clean/web_timing_logger"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importStar(i),a=r.__importStar(a);var d=l.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,c.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/web_team_sharing_modal"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().WebTeamSharingModal]}}))}))}}),u=(function(t){function l(e){var r=t.call(this,e)||this;return r.removeUploadListener=function(){window.removeEventListener(n.ALL_UPLOADS_COMPLETE_EVENT,r.handleUploadsComplete)},r.closeTeamSharingModal=function(){return r.setState({isWebTeamSharingModalOpen:!1})},r.openFileMoveDialog=function(){r.closeTeamSharingModal(),s.TeamsWebActionsLogger.log("post_m1_sharing_modal_clicked"),i.showMove({files:r.props.selectedFiles.toArray(),path:r.props.context.currentFQPath,user:r.props.user})},r.state={isWebTeamSharingModalOpen:!1,uploadedFiles:[],expWebSharingActive:!1},r}return r.__extends(l,t),l.prototype.UNSAFE_componentWillReceiveProps=function(t){return r.__awaiter(this,void 0,void 0,(function(){var o,i,s,a=this;return r.__generator(this,(function(l){switch(l.label){case 0:return!t.browsePostTTIExperiments.expBizAddFilesTeamFolderRwls||this.handleUploadsComplete?[3,2]:[4,new Promise((function(t,r){e(["modules/clean/growth/experiments/web_sharing_helper"],t,r)})).then(r.__importStar)];case 1:o=l.sent(),i=o.logExposure,s=o.shouldShowModal,this.handleUploadsComplete=function(e){if(s(a.props.user,a.props.path)){i();var t=e.detail.files;a.setState({isWebTeamSharingModalOpen:!0,uploadedFiles:t,expWebSharingActive:!0})}},window.addEventListener(n.ALL_UPLOADS_COMPLETE_EVENT,this.handleUploadsComplete),l.label=2;case 2:return[2]}}))}))},l.prototype.componentWillUnmount=function(){this.handleUploadsComplete&&this.removeUploadListener()},l.prototype.render=function(){return this.state.expWebSharingActive?o.default.createElement(d,{context:this.props.context,files:this.state.uploadedFiles,handleModalClose:this.closeTeamSharingModal,handleAction:this.openFileMoveDialog,open:this.state.isWebTeamSharingModalOpen,user:this.props.user}):null},l.defaultProps={selectedFiles:a.OrderedMap()},l})(o.default.PureComponent);t.WebTeamSharingModalExperiment=u})),define("modules/clean/react/family/family_browse_root_async",["require","exports","tslib","react"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o=r.__importStar(o)).lazy,i=o.Suspense,s=n((function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/family/family_browse_root"],t,r)})).then(r.__importStar)];case 1:return[2,{default:t.sent().FamilyBrowseRoot}]}}))}))}));t.AsyncFamilyRoot=function(e){return o.createElement(i,{fallback:o.createElement("div",null)},o.createElement(s,r.__assign({},e)))}})),define("modules/clean/react/file_uploader/actions_adapter",["require","exports","tslib","eventemitter3","modules/clean/filepath","modules/clean/react/file_uploader/store","modules/clean/react/file_uploader/constants","modules/clean/react/upload_kit/lib/types"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n);var l=new o.default;t.ActionsAdapter={emit:function(e,t){l.emit(e,t)},on:function(e,t){return l.on(e,t)},removeAllListeners:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return l.removeAllListeners.apply(l,e)},eventNames:function(){return l.eventNames()}},t.convertUploadItem=function(e,t){var o,a=e.bytes,l=e.destPath,c=e.id,d=e.parentPath,u=e.bytesUploaded;void 0===t&&(t={});var p=null===(o=i.uploaderStore.user())||void 0===o?void 0:o.id,_=n.parent_dir(l),f=n.normalize(d)+n.normalize(_);return new s.FileUpload(r.__assign({uploadId:c,dest:f,name:n.filename(l),size:a,userId:p,percentUploaded:a>0?Math.ceil(u/a*100):100},t))},t.convertValidationError=function(e){switch(e){case a.UploadValidationError.EmptyFile:return s.UploadErrorType.EMPTY_OR_FOLDER;case a.UploadValidationError.IgnoredFile:return s.UploadErrorType.IGNORED;case a.UploadValidationError.OverMaxFileSize:return s.UploadErrorType.FILE_SIZE_ERROR;case a.UploadValidationError.PointerFile:case a.UploadValidationError.TemporaryFile:return s.UploadErrorType.INVALID_EXTENSION;case a.UploadValidationError.CloudDoc:case a.UploadValidationError.Unknown:return s.UploadErrorType.GENERIC}}})),define("modules/clean/react/file_uploader/action_logger",["require","exports","tslib","modules/clean/filepath","modules/clean/react/file_uploader/constants","modules/clean/web_upload_action_logger","modules/clean/web_user_action_logger","modules/clean/web_upload_action_events","modules/clean/web_user_action_events","modules/core/browser","modules/clean/react/file_uploader/utils"],(function(e,t,r,o,n,i,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),c=r.__importStar(c),t.logUploadAction=function(e){var t=e.action,u=e.upload,p=e.chooser_type,_=e.upload_method,f=e.num_files,m=e.num_dirs,h=e.errorType,g=e.extra,S=e.batchId,E=e.user,v=e.uploadPath,w=e.useUploadKit,T={num_files:f,num_dirs:m,chooser_type:p,upload_method:_,extra:{origin:"/h"===c.get_pathname()?"HOME":"BROWSE",use_upload_kit:w?"true":"false"}};if((function(e){return e&&!!e.uploadId})(u)){var b=u,I=t===a.WebUploadActionEvent.UPLOAD_FAILURE?b.errorType===n.UploadErrorType.GENERIC&&h?h:b.errorType:void 0;T=r.__assign(r.__assign({},T),{upload_id:b.uploadId,file_size:b.size,file_extension:o.file_extension(b.name),failure_reason:I,batch_id:b.batchId,upload_destination:b.dest,current_path:c.get_pathname(),file_name:b.name})}else if((function(e){return e&&!!e.batchId})(u)){b=u;T=r.__assign(r.__assign({},T),{file_size:b.size,file_extension:o.file_extension(b.name),batch_id:b.batchId})}return!T.chooser_type&&u&&"chooserType"in u&&u.chooserType&&(T.chooser_type=u.chooserType),S&&(T.batch_id=S),v&&(T.batch_dest_folder_level=d.getFolderLevel(v),E&&(T.member_folder=d.isInMemberFolder(E,v))),g&&(T.extra=r.__assign(r.__assign({},T.extra),g)),(function(e){return e===l.WebUserActionLogEvent.UPLOAD_BUTTON_CLICK||e===l.WebUserActionLogEvent.ADD_MORE_FILES_CLICK||e===l.WebUserActionLogEvent.VIEW_DETAILS_CLICK||e===l.WebUserActionLogEvent.CLOSE_MODAL_CLICK||e===l.WebUserActionLogEvent.UPLOAD_CLICK||e===l.WebUserActionLogEvent.UPLOAD_FILES_CLICK||e===l.WebUserActionLogEvent.UPLOAD_FOLDER_CLICK||e===l.WebUserActionLogEvent.CANCEL_UPLOAD_CLICK})(t)?s.WebUserActionLog.log(E.id,t,T):(t=t,T.client_timestamp=Math.round(Date.now()/1e3),i.WebUploadActionLog.log(E.id,t,T))}})),define("modules/clean/react/file_uploader/constants",["require","exports","tslib","immutable"],(function(e,t,r,o){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),(function(e){e.ALL_UPLOADS_COMPLETE="ALL_UPLOADS_COMPLETE",e.SET_PATH="UPLOADER_SET_PATH",e.SET_FOLDER_NS_ID="UPLOADER_SET_FOLDER_NS_ID",e.SET_USER="UPLOADER_SET_USER",e.SET_NUM_DRAGGING_FILES="SET_NUM_DRAGGING_FILES",e.READY_UPLOADS="READY_UPLOADS",e.QUEUE_UPLOADS="QUEUE_UPLOADS",e.START_UPLOAD="START_UPLOAD",e.COMPLETE_UPLOAD="COMPLETE_UPLOAD",e.CANCEL_UPLOADS="CANCEL_UPLOADS",e.SET_CURRENT_UPLOAD_PROGRESS="SET_CURRENT_UPLOAD_PROGRESS",e.UPLOAD_ERROR="UPLOAD_ERROR",e.SET_IS_UPLOAD_MODAL_OPEN="SET_IS_UPLOAD_MODAL_OPEN",e.SET_INLINE_STATUS_SHOULD_BE_DISMISSED="SET_INLINE_STATUS_SHOULD_BE_DISMISSED",e.ADD_NEW_FAILED_FILE="ADD_NEW_FAILED_FILE",e.CONFIRM_FSW="CONFIRM_FSW",e.ADD_FILES_TO_PLU="ADD_FILES_TO_PLU",e.ADD_DIRECTORIES_TO_PLU="ADD_DIRECTORIES_TO_PLU",e.REMOVE_FILES="REMOVE_FILES",e.SET_HAS_OVERQUOTA_ERROR="SET_HAS_OVERQUOTA_ERROR",e.SET_IS_PERMISSIONS_AT_UPLOAD_MODAL_OPEN="SET_IS_PERMISSIONS_AT_UPLOAD_MODAL_OPEN",e.ADD_TEAM_ACCESS_LEVEL="ADD_TEAM_ACCESS_LEVEL",e.RESET_TEAM_ACCESS_LEVELS="RESET_TEAM_ACCESS_LEVELS",e.SET_UPLOAD_PROGRESS="SET_UPLOAD_PROGRESS"})(t.UploaderActionType||(t.UploaderActionType={})),(function(e){e.SET_PERMISSIONS="SET_PERMISSIONS",e.PENDING="PENDING",e.UPLOADING="UPLOADING",e.COMPLETE="COMPLETE",e.CANCELLED="CANCELLED",e.FAILED="FAILED"})(n=t.FileStatusType||(t.FileStatusType={})),(function(e){e.WRITER="WRITER",e.READER="READER",e.NO_ACCESS="NO_ACCESS",e.INHERIT="INHERIT"})(t.TeamAccessLevel||(t.TeamAccessLevel={})),(function(e){e.FILE_SIZE_ERROR="FILE_SIZE_ERROR",e.HTTP_ERROR="HTTP_ERROR",e.CONNECTION_ERROR="CONNECTION_ERROR",e.OVER_QUOTA_ERROR="OVER_QUOTA_ERROR",e.LOCKED_TEAM_ERROR="LOCKED_TEAM_ERROR",e.IGNORED="IGNORED",e.INVALID_EXTENSION="INVALID_EXTENSION",e.EMPTY_OR_FOLDER="EMPTY_OR_FOLDER",e.FOLDER_SAFARI="FOLDER_SAFARI",e.PACKAGE_FILE="PACKAGE_FILE",e.GENERIC="GENERIC",e.BLOCKS_MISSING_ERROR="BLOCKS_MISSING_ERROR",e.COMMIT_HTTP_ERROR="COMMIT_HTTP_ERROR",e.UPLOAD_BLOCK_ERROR="UPLOAD_BLOCK_ERROR",e.CHUNKS_NOT_ENABLED_ERROR="CHUNKS_NOT_ENABLED_ERROR",e.SERVER_RESPONSE_ERROR="SERVER_RESPONSE_ERROR",e.SERVER_TOKEN_EMPTY_ERROR="SERVER_TOKEN_EMPTY_ERROR",e.SERVER_TOKENS_MISSING_ERROR="SERVER_TOKENS_MISSING_ERROR",e.SERVER_HASH_RESPONSE_ERROR="SERVER_HASH_RESPONSE_ERROR",e.BLOCK_RUNTIME_ID_MISSING_ERROR="BLOCK_RUNTIME_ID_MISSING",e.CLIENT_HASH_EMPTY_ERROR="CLIENT_HASH_EMPTY_ERROR",e.SERVER_HASH_EMPTY_ERROR="SERVER_HASH_EMPTY_ERROR",e.HASHES_NOT_EQUAL_ERROR="HASHES_NOT_EQUAL_ERROR",e.BLOCK_INDEX_ERROR="BLOCK_INDEX_ERROR",e.BLOCK_EMPTY_ERROR="BLOCK_EMPTY_ERROR",e.BLOB_EMPTY_ERROR="BLOB_EMPTY_ERROR",e.BLOB_MISSING_ERROR="BLOB_MISSING_ERROR",e.CLIENT_HASH_DIGEST_ERROR="CLIENT_HASH_DIGEST_ERROR",e.FILE_READER_NULL_RESULT_ERROR="FILE_READER_NULL_RESULT_ERROR",e.COMMIT_READINESS_ERROR="COMMIT_READINESS_ERROR",e.UPLOAD_PRECHECK_ERROR="UPLOAD_PRECHECK_ERROR",e.UPLOAD_PRECHECK_INVALID_CHAR_ERROR="UPLOAD_PRECHECK_INVALID_CHAR_ERROR",e.PERMISSIONS_AT_UPLOAD_ERROR="PERMISSIONS_AT_UPLOAD_ERROR"})(i=t.UploadErrorType||(t.UploadErrorType={})),(function(e){e.NONE="NONE",e.BASIC_OVER_QUOTA="BASIC_OVER_QUOTA",e.BASIC_NEAR_QUOTA="BASIC_NEAR_QUOTA",e.LIMITED_TEAM_USER_OVER_QUOTA="LIMITED_TEAM_USER_OVER_QUOTA",e.LIMITED_TEAM_TSD_OVER_QUOTA="LIMITED_TEAM_TSD_OVER_QUOTA",e.LOCKED_TEAM_USER_OVER_QUOTA="LOCKED_TEAM_USER_OVER_QUOTA"})(t.OverQuotaStatusType||(t.OverQuotaStatusType={}));var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(o.Record({uploadId:void 0,dest:"",ns_id:null,ns_path:null,userId:null,name:"",size:0,percentUploaded:0,status:n.SET_PERMISSIONS,errorType:i.GENERIC,errorMessage:"",batchId:void 0,chooserType:void 0},"FileUpload"));t.FileUpload=s,t.UPLOAD_BEGIN_EVENT="dbxUploadBegin",t.UPLOAD_COMPLETE_EVENT="dbxUploadComplete",t.ALL_UPLOADS_COMPLETE_EVENT="dbxAllUploadsComplete",t.UPLOAD_ERROR_EVENT="dbxUploadError",(function(e){e[e["4mb"]=0]="4mb",e[e["8mb"]=1]="8mb"})(t.ValidChunkSizeStrings||(t.ValidChunkSizeStrings={}))})),define("modules/clean/react/file_uploader/processors",["require","exports","tslib","modules/clean/react/upload_kit/lib/processors","modules/clean/filepath","modules/clean/react/file_uploader/utils","modules/clean/react/upload_kit/lib/types"],(function(e,t,r,o,n,i,s){"use strict";function a(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return e.length?[4,i.showInvalidFileWarning(e.map((function(e){var t=e.item,r=e.error;return{name:n.filename(t.destPath),validationError:r}})),t,!0)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.processFiles=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return e=o.resolveDuplicates(e),[4,a(t,0===e.length)];case 1:return n.sent(),(function(e){r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return e.forEach((function(e){e.file instanceof File&&!s.isChooserFile(e.file)&&!s.isWebkitFile(e.file)&&(e.file.webkitRelativePath="/")})),[2]}))}))})(e),[2,e]}}))}))}})),define("modules/clean/react/file_uploader/store",["require","exports","tslib","immutable","modules/clean/flux/base_store","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/team_access_levels_definition","modules/clean/react/file_uploader/utils","modules/core/exception"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype._init=function(){this._path="/",this._hasPermissionToUploadToFolder=!0,this._folderNsId=null,this._user=null,this._fileList=o.OrderedMap(),this._currentUploadId=null,this._numDraggingFiles=0,this._isInternalTransfer=!1,this._isUploadModalOpen=!1,this._inlineStatusShouldBeDismissed=!1,this._isMovingIntoVault=!1,this._isPermissionsAtUploadModalOpen=!1,this._numSecondsLeft=0,this._confirmedFSWs=[],this._confirmedFSWBatchIds=[],this._hasOverquotaError=!1,this._allUploadsComplete=!1,this._teamAccessLevelsDefinition=new s.TeamAccessLevelsDefinition,this._targetSurface="files_view"},t.prototype.fileList=function(){return this._fileList},t.prototype.currentUpload=function(){var e=this._currentUploadId;if(!e)return null;var t=this._fileList.get(e);return t||null},t.prototype.uploadById=function(e){var t;return e&&(t=this._fileList.get(e)),t||void 0},t.prototype.numSecondsLeft=function(){return this._numSecondsLeft},t.prototype.isUploadCancelled=function(e){var t=this._fileList.get(e);return!!t&&t.status===i.FileStatusType.CANCELLED},t.prototype.inlineStatusShouldBeDismissed=function(){return this._inlineStatusShouldBeDismissed},t.prototype.isMovingIntoVault=function(){return this._isMovingIntoVault},t.prototype.isPermissionsAtUploadModalOpen=function(){return this._isPermissionsAtUploadModalOpen},t.prototype.path=function(){return this._path},t.prototype.folderNsId=function(){return this._folderNsId},t.prototype.hasPermissionToUploadToFolder=function(){return this._hasPermissionToUploadToFolder},t.prototype.user=function(){return this._user},t.prototype.nextUpload=function(){return this._fileList.find((function(e){return e.status===i.FileStatusType.PENDING}))},t.prototype.numDraggingFiles=function(){return this._numDraggingFiles},t.prototype.isInternalTransfer=function(){return this._isInternalTransfer},t.prototype.isUploadInProgress=function(){return this._fileList.some((function(e){return e.status===i.FileStatusType.UPLOADING||e.status===i.FileStatusType.PENDING}))},t.prototype.isUploadModalOpen=function(){return this._isUploadModalOpen},t.prototype.confirmedFSWs=function(){return this._confirmedFSWs},t.prototype.confirmedFSWBatchIds=function(){return this._confirmedFSWBatchIds},t.prototype.hasOverquotaError=function(){return this._hasOverquotaError},t.prototype.allUploadsComplete=function(){return this._allUploadsComplete},t.prototype.getTeamAccessLevelsDefinition=function(){return this._teamAccessLevelsDefinition},t.prototype.getTeamAccessLevel=function(e){return this._teamAccessLevelsDefinition.getTeamAccessLevel(e)},t.prototype.targetSurface=function(){return this._targetSurface},t.prototype.setUser=function(e){var t=e.user;this._user=t,this.emit_change()},t.prototype.setPath=function(e){var t=e.path,r=e.hasPermissionToUploadToFolder,o=void 0===r||r,n=e.isMovingIntoVault,i=void 0!==n&&n,s=e.targetSurface,a=void 0===s?"files_view":s;this._path=t,this._hasPermissionToUploadToFolder=o,this._confirmedFSWs=[],this._isMovingIntoVault=i,this._targetSurface=a,this.emit_change()},t.prototype.setFolderNsId=function(e){var t=e.folderNsId;this._folderNsId=t},t.prototype.setHasOverquotaError=function(e){var t=e.hasOverquotaError;this._hasOverquotaError=t,this.emit_change()},t.prototype.addTeamAccessLevel=function(e){var t=e.path,r=e.accessLevel;this._teamAccessLevelsDefinition=this._teamAccessLevelsDefinition.addTeamAccessLevel(t,r),this.emit_change()},t.prototype.resetTeamAccessLevels=function(){this._teamAccessLevelsDefinition=new s.TeamAccessLevelsDefinition,this.emit_change()},t.prototype.queueUploads=function(e){for(var t={},r=0,o=e.files;r<o.length;r++){var n=o[r];t[n.uploadId]=n}this._fileList=this._fileList.merge(t),this.emit_change()},t.prototype.readyUploads=function(e){for(var t=0,r=e.files;t<r.length;t++){var o=r[t];this._fileList=this._fileList.update(o.uploadId,(function(e){return e.set("status",i.FileStatusType.PENDING)}))}this.emit_change()},t.prototype.handleAllUploadsComplete=function(){this._allUploadsComplete=!0,this.emit_change()},t.prototype.startUpload=function(e){var t=e.file,r=e.parallelFileUploads;r||l.assert(null==this.currentUpload(),"can't start an unload while one is ongoing"),l.assert(null!=t,"missing file to upload"),l.assert(this._fileList.get(t.uploadId)===t,"failed to find file in file list"),this._fileList.get(t.uploadId)&&(this._fileList=this._fileList.update(t.uploadId,(function(e){return e.set("status",i.FileStatusType.UPLOADING)})),this._currentUploadId=r?null:t.uploadId,this._allUploadsComplete=!1),this.emit_change()},t.prototype.completeUpload=function(e){var t=e.uploadId,r=e.parallelFileUploads,o=this._fileList.get(t);o&&((t!==this._currentUploadId&&!r||o.status!==i.FileStatusType.UPLOADING)&&l.reportStack("Tried to mark a file upload that is not currently uploading as complete",{exc_extra:{file:o.toString(),fileListLength:this._fileList.count(),uploadId:t,currentUploadId:this._currentUploadId}}),this._fileList=this._fileList.update(t,(function(e){return e.set("status",i.FileStatusType.COMPLETE)}))),this._currentUploadId=null,this.emit_change()},t.prototype.cancelUploads=function(e){for(var t=0,r=e.files;t<r.length;t++){var o=r[t];this._fileList=this._fileList.update(o.uploadId,(function(e){return e.status===i.FileStatusType.SET_PERMISSIONS||e.status===i.FileStatusType.PENDING||e.status===i.FileStatusType.UPLOADING?e.set("status",i.FileStatusType.CANCELLED):e})),o.uploadId===this._currentUploadId&&(this._currentUploadId=null)}this.emit_change()},t.prototype.setCurrentUploadProgress=function(e){var t=e.percentComplete,r=e.numSecondsLeft,o=this._currentUploadId;o&&(this._fileList=this._fileList.update(o,(function(e){return e.set("percentUploaded",t)})),void 0!==r&&(this._numSecondsLeft=r)),this.emit_change()},t.prototype.handleUploadError=function(e){var t=e.uploadId,r=e.errorType,o=e.errorMessage,n=e.parallelFileUploads,s=this._fileList.get(t);s&&(s.uploadId===this._currentUploadId||n||l.reportStack("Error reported for file upload that is not the current upload",{exc_extra:{file:s.toString(),fileListLength:this._fileList.count(),uploadId:t,currentUploadId:this._currentUploadId,errorType:r,errorMessage:o}}),this._fileList=this._fileList.update(s.uploadId,(function(e){return e.set("status",i.FileStatusType.FAILED).set("errorType",r).set("errorMessage",o)}))),this._currentUploadId=null,this.emit_change()},t.prototype.setNumDraggingFiles=function(e){var t=e.numDraggingFiles,r=e.isInternalTransfer,o=void 0!==r&&r;this._numDraggingFiles=t,this._isInternalTransfer=o,this.emit_change()},t.prototype.setIsUploadModalOpen=function(e){var t=e.isUploadModalOpen;this._isUploadModalOpen=t,this.emit_change()},t.prototype.setInlineStatusShouldBeDismissed=function(e){var t=e.inlineStatusShouldBeDismissed;this._inlineStatusShouldBeDismissed=t,this.emit_change()},t.prototype.setIsPermissionsAtUploadModalOpen=function(e){var t=e.isPermissionsAtUploadModalOpen;this._isPermissionsAtUploadModalOpen=t,this.emit_change()},t.prototype.addNewFailedFile=function(e){var t=e.file,r=e.errorType,o=e.errorMessage;null==t.uploadId&&(t=t.set("uploadId",a.generateUploadId())),t=t.set("status",i.FileStatusType.FAILED).set("errorType",r).set("errorMessage",o),this._fileList=this._fileList.set(t.uploadId,t),this.emit_change()},t.prototype.confirmFSW=function(e){var t=this,r=e.fswIds,o=e.batchId;r.forEach((function(e){t._confirmedFSWs.includes(e)||t._confirmedFSWs.push(e)})),this._confirmedFSWBatchIds.includes(o)||this._confirmedFSWBatchIds.push(o)},t.prototype.setUploadProgress=function(e){var t=e.uploadId,r=e.percentComplete,o=e.numSecondsLeft;t&&(this._fileList=this._fileList.update(t,(function(e){return e.set("percentUploaded",r)})),void 0!==o&&(this._numSecondsLeft=o),r>0&&r<100&&this._fileList.get(t)&&(this._fileList=this._fileList.update(t,(function(e){return e.set("status",i.FileStatusType.UPLOADING)}))));this.emit_change()},t.prototype._new_payload=function(e){var t=e.action;switch(t.type){case i.UploaderActionType.SET_USER:this.setUser(t.data);break;case i.UploaderActionType.SET_PATH:this.setPath(t.data);break;case i.UploaderActionType.SET_FOLDER_NS_ID:this.setFolderNsId(t.data);break;case i.UploaderActionType.QUEUE_UPLOADS:this.queueUploads(t.data);break;case i.UploaderActionType.READY_UPLOADS:this.readyUploads(t.data);break;case i.UploaderActionType.START_UPLOAD:this.startUpload(t.data);break;case i.UploaderActionType.COMPLETE_UPLOAD:this.completeUpload(t.data);break;case i.UploaderActionType.ALL_UPLOADS_COMPLETE:this.handleAllUploadsComplete();break;case i.UploaderActionType.CANCEL_UPLOADS:this.cancelUploads(t.data);break;case i.UploaderActionType.SET_CURRENT_UPLOAD_PROGRESS:this.setCurrentUploadProgress(t.data);break;case i.UploaderActionType.UPLOAD_ERROR:this.handleUploadError(t.data);break;case i.UploaderActionType.SET_NUM_DRAGGING_FILES:this.setNumDraggingFiles(t.data);break;case i.UploaderActionType.SET_IS_UPLOAD_MODAL_OPEN:this.setIsUploadModalOpen(t.data);break;case i.UploaderActionType.SET_INLINE_STATUS_SHOULD_BE_DISMISSED:this.setInlineStatusShouldBeDismissed(t.data);break;case i.UploaderActionType.ADD_NEW_FAILED_FILE:this.addNewFailedFile(t.data);break;case i.UploaderActionType.CONFIRM_FSW:this.confirmFSW(t.data);break;case i.UploaderActionType.SET_HAS_OVERQUOTA_ERROR:this.setHasOverquotaError(t.data);break;case i.UploaderActionType.SET_IS_PERMISSIONS_AT_UPLOAD_MODAL_OPEN:this.setIsPermissionsAtUploadModalOpen(t.data);break;case i.UploaderActionType.ADD_TEAM_ACCESS_LEVEL:this.addTeamAccessLevel(t.data);break;case i.UploaderActionType.RESET_TEAM_ACCESS_LEVELS:this.resetTeamAccessLevels();break;case i.UploaderActionType.SET_UPLOAD_PROGRESS:this.setUploadProgress(t.data)}},t})(n.Store);t.UploaderStoreClass=c,t.uploaderStore=new c})),define("modules/clean/react/file_uploader/team_access_levels_definition",["require","exports","tslib","modules/clean/filepath"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this.teamAccessLevelsDefinition=e||[]}return e.prototype.hasDefinitions=function(){return!!this.teamAccessLevelsDefinition.length},e.prototype.addTeamAccessLevel=function(t,o){var n=this.teamAccessLevelsDefinition.filter((function(e){return e.path!==t}));return new e(r.__spreadArrays(n,[{path:t,accessLevel:o}]))},e.prototype.getTeamAccessLevel=function(e){if(!this.teamAccessLevelsDefinition.length)return null;var t=this.teamAccessLevelsDefinition.reduce((function(t,r){var n=o.inSubDirectory(r.path,e)||o.paths_are_equal(r.path,e);if(!t)return n?r:null;var i=o.normalize(t.path),s=o.normalize(r.path),a=i.length<s.length;return n&&a?r:t}),null);return t?t.accessLevel:null},e})();t.TeamAccessLevelsDefinition=n})),define("modules/clean/react/file_uploader/utils",["require","exports","tslib","modules/clean/base64","modules/clean/filepath","modules/clean/react/async_file_modal_controller","modules/clean/react/file_uploader/constants","modules/clean/react/upload_kit/lib/types","modules/core/browser","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";function d(){for(var e="",t=0;t<16;++t)e+=String.fromCharCode(Math.floor(256*Math.random()));var r=o.encode(e);return r=(r=(r=r.replace(/\+/g,"-")).replace(/\//g,"_")).replace(/\=*$/,"")}function u(e,t){return!e.is_team||!e.is_cdm_member||""!==n.normalize(t)&&(n.paths_are_equal(e.cdm_tmf_path,t)||n.inSubDirectory(e.cdm_tmf_path,t))}function p(e,t){for(var r=e.dest,o=f(t);f(r)-1>o;)r=n.parent_dir(r);return r}function _(e,t){var r=e.toArray().map((function(e){return p(e,t)}));return Array.from(new Set(r))}function f(e){return(n.normalize(e).match(/\//g)||[]).length+1}function m(e){switch(e){case a.UploadValidationError.EmptyFile:return c.intl.formatMessage({id:"KZETkM",defaultMessage:"Empty files cannot be uploaded."});case a.UploadValidationError.OverMaxFileSize:return c.intl.formatMessage({id:"Hg3ZgC",defaultMessage:"File is too large to be uploaded."});default:return c.intl.formatMessage({id:"WQDOGQ",defaultMessage:"This file is not supported by Dropbox and cannot be uploaded."})}}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importStar(i),l=r.__importStar(l),t.generateUploadId=function(){return d()},t.generateBatchId=function(){return"batch-"+d()},t.calculateSizeOfUploads=function(e,t){var r=0;return e.forEach((function(e){-1!==t.indexOf(e.status)&&(r+=e.size)})),r},t.getNsId=function(e,t,r){var o=t,n=0;return e.forEach((function(e,t){for(var i=0,s=e.split("/"),a=r.split("/");i<s.length&&i<a.length&&s[i]===a[i];)i++;i===s.length&&i>1&&i>n&&(n=i,o=Number(t))})),o},t.getOQmodalOQALocationCode=function(e){return"/h"===(e||l.get_uri().path)?"ho":"fb"},t.isInMemberFolder=u,t.getUploadLocationMetadataToLog=function(e,t){return{root_folder:""===n.normalize(t),member_folder:u(e,t),folder_level:n.normalize(t).split("/").length}},t.PERMISSION_FSW_IDS=["action_commit_to_tsd_root","action_missing_parent"],t.getFSWMetadataToLog=function(e){return{has_permissions:e.includes("action_commit_to_tsd_root"),has_permissions_nonroot:e.includes("action_missing_parent"),has_other:e.some((function(e){return!t.PERMISSION_FSW_IDS.includes(e)}))}},t.getRootDest=p,t.getRootDests=_,t.isMultifolderUpload=function(e,t){var r=_(e.filter((function(e){return s.FileStatusType.SET_PERMISSIONS===e.status})),t);return!r.every((function(e){return e===r[0]}))},t.uploadContainsFolder=function(e,t){var r=e.filter((function(e){return s.FileStatusType.SET_PERMISSIONS===e.status})),o=f(t);return _(r,t).some((function(e){return f(e)>o}))},t.isUploadInTmf=function(e,t){if(!t.cdm_tmf_path)return!1;var r=e.filter((function(e){return s.FileStatusType.SET_PERMISSIONS===e.status})),o=n.normalize(t.cdm_tmf_path);return r.some((function(e){return e.dest===o||n.inSubDirectory(o,e.dest)}))},t.getFileUploadsWithStatus=function(e,t){return e.valueSeq().toArray().filter((function(e){return t.includes(e.status)}))},t.getFolderLevel=f,t.showInvalidFileWarning=function(e,t,r){return new Promise((function(o,n){if(e.length){var s=(function(e){if(1===e.length){var t=e[0],r=t.name,o=t.validationError;return{title:c.intl.formatMessage({id:"uQF0D4",defaultMessage:"Unable to upload {file}"},{file:r}),text:m(o)}}var n=c.intl.formatMessage({id:"Chf30m",defaultMessage:"Unable to upload one or more files"}),i=e.map((function(e){return e.name}));if(e.length<=3)return{title:n,text:c.intl.formatMessage({id:"fKAsp7",defaultMessage:"The following files are not supported by Dropbox and cannot be uploaded: {files}"},{files:i.join(", ")})};var s=i.length-3;return{title:n,text:c.intl.formatMessage({id:"z9swUK",defaultMessage:"{count, plural, one{The following files are not supported by Dropbox and cannot be uploaded: {files} and {count} more} other{The following files are not supported by Dropbox and cannot be uploaded: {files} and {count} more}}"},{files:i.slice(0,3).join(", "),count:s})}})(e),a=s.title,l=s.text;i.showFileSystemWarningsModal({confirmText:c.intl.formatMessage({id:"Bmo28B",defaultMessage:"{count, plural, one{Skip this file} other{Skip these files}}"},{count:e.length}),fsws:[{id:"action_upload_invalid_extension",blocking:t,title:a,text:l,learn_more:"https://www.dropbox.com/help/syncing-uploads/web-based-files"}],onFinalAccept:o,onAbortAction:r?n:void 0})}else o()}))}})),define("modules/clean/react/fileops_actions",["require","exports","tslib","react","spectrum-sharing/utils/sharing_constants","modules/clean/em_string","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/api","modules/clean/react/browse/data/action_creators/index","modules/clean/react/browse/data/store","modules/clean/react/browse/models","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/files_view/file_actions/rollback","modules/clean/react/snackbar","modules/clean/sharing/browse_exports","modules/clean/undo","modules/clean/viewer","modules/clean/web_user_action_events","modules/core/i18n","modules/core/notify"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),s=r.__importStar(s),a=r.__importStar(a),l=r.__importStar(l),d=r.__importStar(d),u=r.__importStar(u),f=r.__importStar(f);var I="view_only_access_error",y="off_team_owner_error",F="owner_only_manage_membership_error",C="team_space_owner_only_manage_membership_error",O="team_space_only_on_team_sharing_error",A="ns_have_mounted_children_ns_error";t.copyFiles=function(e){return e.useApiV2?L(e):P(e)};var P=function(e){var o=e.files,n=e.newPath,i=e.checkFSWs,a=e.onSuccess,c=e.onRequestNotSent,u=e.onUndo,p=e.user,_=e.dataApi;!(void 0===_?d:_).copyFiles({files:o,newPath:n,checkFSWs:i,userId:p.id,onSuccess:function(i){var c=i.newFiles,d=i.changesets,_=i.failureDetails;if(_){l.showFileSystemWarningsModal({fsws:_,onFinalAccept:function(){t.copyFiles(r.__assign(r.__assign({},e),{checkFSWs:!1}))},confirmText:T.intl.formatMessage({id:"r3T3xT",defaultMessage:"Copy"})})}else a&&a(c),s.notifyCopySuccess(o.length,p,d,n,(function(){u&&u()}))}})&&c&&c()};function L(t){return r.__awaiter(this,void 0,void 0,(function(){var o,n,i,s,a,l,c;return r.__generator(this,(function(d){switch(d.label){case 0:return o=t.files,n=t.newPath,i=t.onUndo,s=t.onSuccess,a=t.user,t.isLockedVaultFolder?(Promise.all([new Promise((function(t,r){e(["modules/clean/react/vault/lib/api"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["vault/common/logging-types"],t,r)})).then(r.__importStar)]).then((function(e){var t=e[0].logProductAnalyticsEvent,r=e[1],o=r.AnalyticsEventActionSurface,n=r.AnalyticsEventAction,i=r.AnalyticsEventObject;return t({actionSurface:o.BROWSE,eventAction:n.SELECT,eventObject:i.COPY_INTO_LOCKED_VAULT})})),g.Snackbar.fail(T.intl.formatMessage({id:"MAy8Kw",defaultMessage:"Please unlock your Vault before attempting to add to this folder."}),"browse-action"),[2]):(g.Snackbar.sync(T.intl.formatMessage({id:"tL3kkO",defaultMessage:"{count, plural, one{Copying {count} item...} other{Copying {count} items...}}"},{count:o.length}),!0,"browse-action"),[4,f.copyFiles(o,n,a.id,!1)]);case 1:return l=d.sent(),c={successLogAction:w.WebUserActionLogEvent.COPY_REQUEST_SUCCESS,failedLogAction:w.WebUserActionLogEvent.COPY_REQUEST_FAIL,undoingLogAction:w.WebUserActionLogEvent.COPY_UNDO,undoFailedLogAction:w.WebUserActionLogEvent.COPY_UNDO_REQUEST_FAIL,undoSuccessLogAction:w.WebUserActionLogEvent.COPY_UNDO_REQUEST_SUCCESS,undoingSnackbarText:T.intl.formatMessage({id:"/M5Btv",defaultMessage:"Undoing copy..."}),undoFailedSnackbarText:T.intl.formatMessage({id:"zHeX5Y",defaultMessage:"Couldn’t undo copy."}),undoSuccessSnackbarText:T.intl.formatMessage({id:"hvAv6t",defaultMessage:"Copy undone."}),getFailureSnackbarText:function(e){return T.intl.formatMessage({id:"G2jO1n",defaultMessage:"{count, plural, one{Couldn’t copy {count} item.} other{Couldn’t copy {count} items.}}"},{count:e})},getPartialSuccessSnackbarText:function(e,t){return T.intl.formatMessage({id:"hR2/Hh",defaultMessage:"{count, plural, one{Copied {succesfully_copied_files} out of {count} item.} other{Copied {succesfully_copied_files} out of {count} items.}}"},{count:t,succesfully_copied_files:e})},getSuccessSnackbarText:function(e){return T.intl.formatMessage({id:"BDtFp+",defaultMessage:"{count, plural, one{Copied {count} item.} other{Copied {count} items.}}"},{count:e})}},R(l,a,o,n,c,s,i),[2]}}))}))}function D(t){return r.__awaiter(this,void 0,void 0,(function(){var o,n,i,s,l,c,d,u,p,_,m,h,S,E,v,b;return r.__generator(this,(function(I){switch(I.label){case 0:return o=t.path,n=t.files,i=t.newPath,s=t.onUndo,l=t.onSuccess,c=t.user,d=t.dataApiV2,u=void 0===d?f:d,p=t.expMoveToRestrictiveFolder,_=void 0!==p&&p,m=t.checkFSWs,h=t.isLockedVaultFolder,S=t.extra,h?(Promise.all([new Promise((function(t,r){e(["modules/clean/react/vault/lib/api"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["vault/common/logging-types"],t,r)})).then(r.__importStar)]).then((function(e){var t=e[0].logProductAnalyticsEvent,r=e[1],o=r.AnalyticsEventActionSurface,n=r.AnalyticsEventAction,i=r.AnalyticsEventObject;return t({actionSurface:o.BROWSE,eventAction:n.SELECT,eventObject:i.MOVE_INTO_LOCKED_VAULT})})),g.Snackbar.fail(T.intl.formatMessage({id:"fDvKfJ",defaultMessage:"Please unlock your Vault before attempting to add to this folder."}),"browse-action"),[2]):void 0!==o&&a.paths_are_equal(o,i)?(g.Snackbar.fail(T.intl.formatMessage({id:"V6/bVk",defaultMessage:"Those files already exist in that folder."}),"browse-action"),[2]):(g.Snackbar.sync(T.intl.formatMessage({id:"ENlS4s",defaultMessage:"{count, plural, one{Moving {count} item...} other{Moving {count} items...}}"},{count:n.length}),!0,"browse-action"),[4,u.moveFiles(n,i,c.id,!1,_&&m)]);case 1:return E=I.sent(),v=a.filename(i),b={successLogAction:w.WebUserActionLogEvent.MOVE_REQUEST_SUCCESS,failedLogAction:w.WebUserActionLogEvent.MOVE_REQUEST_FAIL,undoingLogAction:w.WebUserActionLogEvent.MOVE_UNDO,undoFailedLogAction:w.WebUserActionLogEvent.MOVE_UNDO_REQUEST_FAIL,undoSuccessLogAction:w.WebUserActionLogEvent.MOVE_UNDO_REQUEST_SUCCESS,undoingSnackbarText:T.intl.formatMessage({id:"BDPPA/",defaultMessage:"Undoing move..."}),undoFailedSnackbarText:T.intl.formatMessage({id:"ENMVb1",defaultMessage:"Couldn’t undo move."}),undoSuccessSnackbarText:T.intl.formatMessage({id:"O7CH0I",defaultMessage:"Move undone."}),getFailureSnackbarText:function(e){return T.intl.formatMessage({id:"Se5SXB",defaultMessage:"{count, plural, one{Couldn’t move {count} item to {folderName}.} other{Couldn’t move {count} items to {folderName}.}}"},{count:e,folderName:v})},getPartialSuccessSnackbarText:function(e,t){return T.intl.formatMessage({id:"lfdYKG",defaultMessage:"{count, plural, one{Moved {succesfully_moved_files} out of {count} item to {folderName}.} other{Moved {succesfully_moved_files} out of {count} items to {folderName}.}}"},{count:t,succesfully_moved_files:e,folderName:v})},getSuccessSnackbarText:function(e){return T.intl.formatMessage({id:"hMyik4",defaultMessage:"{count, plural, one{Moved {count} item to {folderName}.} other{Moved {count} items to {folderName}.}}"},{count:e,folderName:v})},extra:S},R(E,c,n,i,b,l,s,t),[2]}}))}))}function M(e,t,r,s,c){var d=v.Viewer.get_viewer().team_name,m=!1;"is_cdm_member"in e&&e.is_cdm_member&&a.inSubDirectory(e.cdm_tmf_path,s)&&(m=!0);var h=(function(e,t,r,s,a){var l=T.intl.formatMessage({id:"gVzSq7",defaultMessage:"You don’t have permission to move some of these items. Try moving items individually."}),c=null,d=(function(e){return 0===e.length?"":f.getFilenameFromActionInfo(e[0])})(s);t===y?c=1===s.length?null==r?T.intl.formatMessage({id:"eqzXgU",defaultMessage:"The owner of <strong>{file_name}</strong> is a member of another team."},{file_name:i.Emstring.em_snippet(d,n.SNIPPET_SIZES.FILENAME),strong:function(e){return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):T.intl.formatMessage({id:"F7A+9f",defaultMessage:"The owner of <strong>{file_name}</strong> isn’t a member of {team_name}."},{team_name:r,file_name:i.Emstring.em_snippet(d,n.SNIPPET_SIZES.FILENAME),strong:function(e){return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):null==r?T.intl.formatMessage({id:"1mkOQ2",defaultMessage:"The owner of some of these shared folders is a member of another team."}):T.intl.formatMessage({id:"kXptr+",defaultMessage:"The owner of some of these shared folders isn’t a member of {team_name}."},{team_name:r}):t===F?c=1===s.length?"is_cdm_member"in e&&e.is_cdm_member&&!a?T.intl.formatMessage({id:"rLKsQF",defaultMessage:"Only the owner of <strong>{file_name}</strong> can move it to the {team_name} team space."},{team_name:r,file_name:i.Emstring.em_snippet(d,n.SNIPPET_SIZES.FILENAME),strong:function(e){return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):T.intl.formatMessage({id:"Xkb8gG",defaultMessage:"Only the owner of <strong>{file_name}</strong> can move it to a team folder."},{file_name:i.Emstring.em_snippet(d,n.SNIPPET_SIZES.FILENAME),strong:function(e){return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):"is_cdm_member"in e&&e.is_cdm_member&&!a?T.intl.formatMessage({id:"Ic3QpQ",defaultMessage:"Only the owner can move some of these folders to the {team_name} team space."},{team_name:r}):T.intl.formatMessage({id:"AGXz3U",defaultMessage:"Only the owner can move some of these folders to a team folder."}):t===I?c=1===s.length?T.intl.formatMessage({id:"4nfaRz",defaultMessage:"You can only view <strong>{file_name}</strong>. Ask an owner or editor of the folder for access to edit it."},{file_name:i.Emstring.em_snippet(d,n.SNIPPET_SIZES.FILENAME),strong:function(e){return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):T.intl.formatMessage({id:"vSscn6",defaultMessage:"You can’t edit some of these folders. Ask an owner or editor of the folders for access to edit them."}):t===C||t===O?c=1===s.length?T.intl.formatMessage({id:"xYXgy4",defaultMessage:"If you need to move <strong>{file_name}</strong>, ask your admin to move it for you."},{file_name:i.Emstring.em_snippet(d,n.SNIPPET_SIZES.FILENAME),strong:function(e){return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):l:t===A&&(c=1===s.length?T.intl.formatMessage({id:"sFivS0",defaultMessage:"<strong>{file_name}</strong> has other shared folders inside it. Try moving each shared folder individually."},{file_name:i.Emstring.em_snippet(d,n.SNIPPET_SIZES.FILENAME),strong:function(e){return o.default.createElement("strong",{style:{fontWeight:500}},e)}}):l);return c})(e,t,d,r,m);if(null!=h){b.Notify.clear();var g=t===C||t===O||t===A,E=(function(e,t,r,o,s){if(t)return 1===o?T.intl.formatMessage({id:"MHxxzk",defaultMessage:"Can’t move out of the team space"}):T.intl.formatMessage({id:"XJI7dZ",defaultMessage:"Can’t move {num_of_files} items"},{num_of_files:o});return"is_cdm_member"in e&&e.is_cdm_member&&!s?T.intl.formatMessage({id:"S+fFwb",defaultMessage:"{count, plural, one{Can’t move shared folder to the {team_name} team space} other{Can’t move shared folders to the {team_name} team space}}"},{count:o,team_name:i.Emstring.em_snippet(r,n.SNIPPET_SIZES.DISPLAY_NAME)}):T.intl.formatMessage({id:"thmzHN",defaultMessage:"{count, plural, one{Can’t move shared folder to a team folder} other{Can’t move shared folders to a team folder}}"},{count:o})})(e,g,d,r.length,m),w="";w=g?"/help/business/team-space-overview#out":"/help/business/team-space-overview#move";var P=1===r.length,L=r[0]instanceof _.File&&P&&!g?T.intl.formatMessage({id:"tHNeW4",defaultMessage:"See owner"}):void 0;l.showMoveErrorModal({title:E,content:h,learnMoreLink:w,buttonString:L,onClick:function(){r[0]instanceof _.File&&S.asyncShowShareModal(e.id,r[0],{origin:n.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS},(function(e){var t=e.path,r=e.qargs;return p.getStoreForBrowse().dispatch(u.setUrl({path:t,qargs:r}))}))}})}else c&&c()}function R(e,o,n,i,s,a,d,u){if(e.isError){if(g.Snackbar.close("browse-action"),u&&"to"===e.error[".tag"]&&"file_system_warnings"===e.error.to[".tag"]){return void l.showFileSystemWarningsModal({fsws:e.error.to.details,onFinalAccept:function(){return D(r.__assign(r.__assign({},u),{checkFSWs:!1}))},confirmText:T.intl.formatMessage({id:"ds25UH",defaultMessage:"Move"})})}return M(o,e.error[".tag"],n,i,(function(){g.Snackbar.fail(s.getFailureSnackbarText(n.length),"browse-action")})),void c.logFileAction({uid:o.id,action:s.failedLogAction,num_files_selected:n.length,num_folders_selected:0,error_summary:e.error_summary,error:e.error[".tag"],jobId:e&&e.jobId,extra:s.extra})}var p=e.result.entries.filter((function(e){return"success"===e[".tag"]})),_=p.length,f=n.length-_,h=N(e,o,s,d);if(t.showBatchCompletedSnackbar(n.length,_,f,s,h),a){var S=[];p.forEach((function(e){if("file"===e.success[".tag"]||"folder"===e.success[".tag"]){var t=e.success,r=n.find((function(e){return e.file_id===t.id}));if(r){var o=m.fileFromMetadata(r,t);S.push(o)}}})),a([],S)}(function(e,t,r,o,n,i){var s=n,a=0,l=void 0,d=t.entries.filter((function(e){return"success"===e[".tag"]}));d&&(s=d.filter((function(e){return"file"===e.success[".tag"]})).length,a=d.filter((function(e){return"folder"===e.success[".tag"]})).length);var u=t.entries.filter((function(e){return"failure"===e[".tag"]}));u&&u.length>0&&(l=u[0].failure[".tag"]);c.logFileAction({uid:r,action:e,num_files_selected:s,num_folders_selected:a,jobId:o,error_summary:l,extra:i})})(s.successLogAction,e.result,o.id,e.jobId,n.length,s.extra)}function N(e,t,o,n){var i=this;return!e.isError&&e.result.changeset_data&&e.result.changeset_data.length>0?function(){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(r){return g.Snackbar.close("browse-action"),c.logFileAction({uid:t.id,action:o.undoingLogAction,num_files_selected:e.result.entries.length,num_folders_selected:0,extra:o.extra}),h.rollback({changeset_data:e.result.changeset_data,userId:t.id,onSuccess:function(){g.Snackbar.complete(o.undoSuccessSnackbarText,"browse-action"),c.logFileAction({uid:t.id,action:o.undoSuccessLogAction,num_files_selected:e.result.entries.length,num_folders_selected:0}),n&&n(!0)}}),[2]}))}))}:void 0}t.copyFiles_v2=L,t.moveFiles_LEGACY=function(e){var o=e.path,n=e.files,i=e.newPath,a=e.checkFSWs,c=e.onSuccess,u=e.onRequestNotSent,p=e.onUndo,_=e.user,f=e.dataApi,m=void 0===f?d:f,h=function(o){var a=o.newFiles,d=o.changesets,u=o.failureDetails;if(u){l.showFileSystemWarningsModal({fsws:u,onFinalAccept:function(){t.moveFiles_LEGACY(r.__assign(r.__assign({},e),{checkFSWs:!1}))},confirmText:T.intl.formatMessage({id:"ds25UH",defaultMessage:"Move"})})}else s.notifyMoveSuccess(n.length,_,d,i,(function(){p&&p()})),c&&c(a)};!m.moveFiles({path:o,files:n,newPath:i,checkFSWs:a,userId:_.id,onSuccess:h,onError:function(e){"This will result in losing ownership of these folders."===e?(b.Notify.clear(),l.showConfirmOwnershipTransferModal((function(){m.moveFiles({path:o,files:n,newPath:i,userId:_.id,onSuccess:h,allowOwnershipTransfer:!0})}))):M(_,e,n,i)},allowOwnershipTransfer:!1})&&u&&u()},t.moveFiles=D,t.getBatchUndoHandler=N,t.showBatchCompletedSnackbar=function(e,t,r,o,n){if(t>0&&r>0){var i=o.getPartialSuccessSnackbarText(t,e);n?(E.setHandleUndo(n),g.Snackbar.completeWithUndo(i,n,"browse-action")):g.Snackbar.complete(i,"browse-action")}else if(t>0){i=o.getSuccessSnackbarText(t);n?(E.setHandleUndo(n),g.Snackbar.completeWithUndo(i,n,"browse-action")):g.Snackbar.complete(i,"browse-action")}else g.Snackbar.fail(o.getFailureSnackbarText(r),"browse-action")}})),define("modules/clean/react/files_view/column_header_menu",["require","exports","tslib","classnames","spectrum/icon_form","spectrum/popover","react","modules/clean/react/files_view/constants","modules/clean/react/files_view/types","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePopoverSelection=function(e){var r=t.props,o=r.onSort,n=r.onSelection,i=r.column,s=r.sortDirection;if(e===l.SortDirection.ASCENDING||e===l.SortDirection.DESCENDING)o(i.sortField,e);else{if(n(e,i),t.props.isSearchMode)return void o(e.sortField,l.SortDirection.DESCENDING);void 0!==s&&o(e.sortField,t.props.sortDirection||l.SortDirection.ASCENDING)}},t}return r.__extends(t,e),t.prototype._columnMenuTitle=function(){switch(this.props.viewType){case l.ViewType.Grid:case l.ViewType.LargeGrid:return c.intl.formatMessage({id:"jw2Ng0",defaultMessage:"Group by"});case l.ViewType.List:default:return this.props.isSearchMode?c.intl.formatMessage({id:"oqW97K",defaultMessage:"Sort by"}):c.intl.formatMessage({id:"2X0e4z",defaultMessage:"Show"})}},t.prototype.render=function(){var e=this,t=this.props,r=t.column,d=t.columns,u=t.visibleColumns,p=t.sortDirection,_=t.isSearchMode;if(r.isSortDisabled)return s.default.createElement("div",{className:"normal brws-column-header-menu"},s.default.createElement("span",{className:"brws-column-header-menu-trigger-disabled"},r.label));var f,m=!(r.sortField!==l.SortField.RELEVANCE||!_),h=p!==l.SortDirection.ASCENDING||m?p!==l.SortDirection.DESCENDING||m?"caret-down":"sort-arrow-down":"sort-arrow-up",g=m?null:s.default.createElement(i.PopoverItemGroupSeparator,{key:"show-separator"}),S=_?a.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS:d;!r.isLocked&&d&&d.length&&(f=[g,s.default.createElement(i.PopoverItemGroup,{key:"show-item-group"},s.default.createElement(i.PopoverItemGroupTitle,{className:"brws-column-header-menu-title",key:"show-title"},this._columnMenuTitle()),S.filter((function(e){return!e.isLocked})).map((function(e){return s.default.createElement(i.PopoverSelectableItem,{key:e.sortField,disabled:u.map((function(e){return e.sortField})).includes(e.sortField)&&e.sortField!==r.sortField,selected:e.sortField===r.sortField,value:e},e.label)})))]);return s.default.createElement(i.Popover,{className:"brws-column-header-menu",onSelection:this.handlePopoverSelection,onMenuToggle:function(t){t.isOpen&&e.props.onMenuOpen()}},s.default.createElement(i.PopoverTrigger,{className:o.default("brws-column-header-menu-trigger",{"brws-column-header-menu-trigger-active":!!p&&!m}),title:r.popoverTriggerLabel,"aria-label":c.intl.formatMessage({id:"Tsg7+6",defaultMessage:"Sort by {sort_by}"},{sort_by:r.label})},s.default.createElement("span",null,r.label),s.default.createElement("span",{className:"brws-column-header-menu-label-icon-wrapper"},s.default.createElement(n.IconForm,{className:"brws-column-header-menu-label-icon",name:h}))),s.default.createElement(i.PopoverContent,null,!m&&s.default.createElement(i.PopoverItemGroup,null,s.default.createElement(i.PopoverItemGroupTitle,{className:"brws-column-header-menu-title"},c.intl.formatMessage({id:"HXV3TA",defaultMessage:"Order"})),s.default.createElement(i.PopoverSelectableItem,{selected:p===l.SortDirection.ASCENDING,value:l.SortDirection.ASCENDING,disabled:r.isSortOrderOptionDisabled},c.intl.formatMessage({id:"KyJseU",defaultMessage:"Ascending"})),s.default.createElement(i.PopoverSelectableItem,{selected:p===l.SortDirection.DESCENDING,value:l.SortDirection.DESCENDING,disabled:r.isSortOrderOptionDisabled},c.intl.formatMessage({id:"Njd630",defaultMessage:"Descending"}))),f))},t})((s=r.__importDefault(s)).default.PureComponent);t.ColumnHeaderMenu=d})),define("modules/clean/react/files_view/column_header",["require","exports","tslib","classnames","react","spectrum/checkbox","spectrum/table","modules/clean/react/files_view/column_header_menu","modules/clean/react/files_view/fixed_table_head","modules/clean/react/files_view/sticky_table_head","modules/clean/react/files_view/types","modules/clean/react/files_view/view_type_column_header_menu","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isHovered:!1},t.handleChangeSelectAllCheckbox=function(e){"unchecked"===e?t.props.onDeselectAll():t.props.onSelectAll()},t.handleMouseEnter=function(){t.setState({isHovered:!0})},t.handleMouseLeave=function(){t.setState({isHovered:!1})},t}return r.__extends(t,e),t.prototype.getAriaSortValue=function(e){return e===d.SortDirection.ASCENDING?"ascending":e===d.SortDirection.DESCENDING?"descending":"none"},t.prototype.render=function(){var e=this,t=this.state.isHovered,d=this.props,_=d.columnFlex,f=d.isCompactMode,m=d.isSelectMode,h=d.currentSort,g=d.onSelection,S=d.onSort,E=d.onMenuOpen,v=d.onSwitchViewType,w=d.selectAllCheckboxState,T=void 0===w?"unchecked":w,b=d.showSelectAllCheckbox,I=void 0===b||b,y=d.stickyOffsetHeight,F=d.stickyOffsetTop,C=d.columns,O=d.visibleColumns,A=d.viewType,P=d.viewTypes,L=d.viewTypeLabels,D=d.onTTI,M=d.isSearchMode,R=d.presentationOnly,N=d.variant,x=d.shouldHideViewTypeColumnHeader,k=!m&&!t&&!f,U=function(e){return function(t,r){g(t,r,e)}},V=r.__spreadArrays([n.default.createElement(s.TableHeadCell,{className:"brws-column-header-table-cell brws-checkbox-cell",key:"checkbox-cell",role:R?"presentation":"columnheader",scope:"col"},n.default.createElement("div",{className:"brws-vertically-center"},I?n.default.createElement(i.Checkbox,{className:o.default("brws-checkbox",{"brws-checkbox-checked":"checked"===T}),checked:T,onChange:this.handleChangeSelectAllCheckbox,variant:k?"invisible":"default",ariaLabel:p.intl.formatMessage({id:"kTr/8f",defaultMessage:"Select all"})}):null))],O.map((function(t,r){var o=h&&h.sortField===t.sortField?h.sortDirection:void 0;return n.default.createElement(s.TableHeadCell,{key:r,role:R?"presentation":"columnheader",scope:"col","aria-sort":e.getAriaSortValue(o),className:"brws-column-header-table-cell"},n.default.createElement(a.ColumnHeaderMenu,{column:t,sortDirection:o,columns:C,visibleColumns:O,onSelection:U(r),onSort:S,onMenuOpen:function(){return E(r)},viewType:A,isSearchMode:M}),r===O.length-1&&n.default.createElement(u.ViewTypeColumnHeaderMenu,{onTTI:D,viewType:A,viewTypes:P,viewTypeLabels:L,onSwitchViewType:v,shouldHideViewTypeColumnHeader:x}))}))),H={onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave};return"default"===N?n.default.createElement(s.TableHead,r.__assign({className:"brws-column-header"},H),V):"fixed"===N?n.default.createElement(l.FixedTableHead,r.__assign({offsetHeight:y},H),V):"sticky-native"===N?n.default.createElement(s.TableHead,r.__assign({className:"brws-column-header brws-column-header--sticky",style:{position:"sticky",top:F,zIndex:1}},H),V):n.default.createElement(c.StickyTableHead,r.__assign({columnFlex:_,offsetHeight:y,offsetTop:F,className:"brws-column-header"},H),V)},t.defaultProps={variant:"fixed"},t})((n=r.__importDefault(n)).default.PureComponent);t.ColumnHeader=_})),define("modules/clean/react/files_view/column_helpers",["require","exports","modules/clean/immutability_helper"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.swapColumns=function(e,t,o){var n=e.map((function(e){return e.sortField})).indexOf(t),i=e.map((function(e){return e.sortField})).indexOf(o);if(n===i||-1===n||-1===i)return e;var s=e[n],a=e[i];return r.splice(r.splice(e,n,1,a),i,1,s)}})),define("modules/clean/react/files_view/column_manager",["require","exports","tslib","external/lodash","react","spectrum/dimensions","modules/clean/immutability_helper","modules/clean/react/files_view/column_helpers","modules/clean/react/files_view/types"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importDefault(n),t.ColumnManager=function(e){var t=e.responsiveContainer,o=r.__rest(e,["responsiveContainer"]);return(o.isMatchedLarge||o.isMatchedMedium)&&t?n.default.createElement(i.Dimensions,null,(function(e){var t=e.width,i=r.__assign({},o);return t&&(i.isMatchedLarge=t>824,i.isMatchedMedium=!i.isMatchedLarge&&t>588),n.default.createElement(c,r.__assign({},i,{containerWidth:t}))})):n.default.createElement(c,r.__assign({},o))};var c=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleSelection=function(e,t){var o=r.props,n=o.isMoreColumnsEnabled,i=o.preferredColumns,s=o.viewType;n&&i&&(s===l.ViewType.List||s===l.ViewType.CondensedList)?r.handleVariableColumnSelection(e,t,i):r.handleFixedColumnSelection(e,t)},r}return r.__extends(t,e),t.prototype.UNSAFE_componentWillMount=function(){var e=this.props.preferredColumns?this.getVisibleFromPreferredColumns(this.props):this.computeVisibleColumns(this.props);this.changeVisibleColumns(e,!0)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.props.viewTypeColumns,n=this.state.visibleColumns,i=this.getNumVisibleColumns(this.props),s=this.getNumVisibleColumns(e);if(e.preferredColumns){var c=this.getVisibleFromPreferredColumns(e);o.isEqual(c,this.state.visibleColumns)||this.changeVisibleColumns(c,!0)}else if(o.isEqual(this.props.columns,e.columns)&&this.props.viewType===e.viewType){if(s<i)this.changeVisibleColumns(n.slice(0,s),!0);else if(s>i){p=this.props.columns;var d=s-n.length,u=o.filter(p,(function(e){return!o.find(n,(function(t){return t.sortField===e.sortField}))})).slice(0,d);this.changeVisibleColumns(r.__spreadArrays(n,u),!0)}}else if(1===s&&e.columns.length&&e.currentSort){var p=e.columns,_=e.viewType,f=t?t[l.ViewType.Grid]:void 0;switch(_){case l.ViewType.List:case l.ViewType.CondensedList:this.changeVisibleColumns([p[0]],!0);break;case l.ViewType.Grid:case l.ViewType.LargeGrid:if(f){var m=e.currentSort,h=p.find((function(e){return e.sortField===m.sortField}))||p[0];this.deferredOnColumnsChangedHandler([h],a.swapColumns(f,f[0].sortField,h.sortField),_)}}}else this.changeVisibleColumns(e.columns.slice(0,s),!0)},t.prototype.getVisibleFromPreferredColumns=function(e){var t=e.currentSort,r=e.viewType,o=e.preferredColumns;if(r===l.ViewType.Grid||r===l.ViewType.LargeGrid){var n=o.find((function(e){return e.sortField===t.sortField}));o=[n||o[0]]}else o=o.slice(0,this.getNumVisibleColumns(e));return o},t.prototype.changeVisibleColumns=function(e,t){var r=this;void 0===t&&(t=!1),this.resetChangeVisibleColumnsTimeout();var o=this.isSizeColumnPresent(e);this.setState({visibleColumns:e,canDisplayFolderSizes:o}),t?this.changeVisibleColumnsTimeout=setTimeout((function(){r.resetChangeVisibleColumnsTimeout(),r.props.onCanDisplayFolderSizesChanged(o)})):this.props.onCanDisplayFolderSizesChanged(o)},t.prototype.resetChangeVisibleColumnsTimeout=function(){this.changeVisibleColumnsTimeout&&(clearTimeout(this.changeVisibleColumnsTimeout),this.changeVisibleColumnsTimeout=void 0)},t.prototype.deferredOnColumnsChangedHandler=function(e,t,r){var o=this;this.resetDeferredOnColumnsChangedHandler();var n=this.isSizeColumnPresent(e);this.setState({visibleColumns:e,canDisplayFolderSizes:n}),this.onColumnsChangesTimeout=setTimeout((function(){o.resetDeferredOnColumnsChangedHandler(),o.props.onColumnsChanged(t,r,n)}))},t.prototype.resetDeferredOnColumnsChangedHandler=function(){this.onColumnsChangesTimeout&&(clearTimeout(this.onColumnsChangesTimeout),this.onColumnsChangesTimeout=void 0)},t.prototype.handleVariableColumnSelection=function(e,t,o){var n=this.props,i=n.onColumnsChanged,a=n.viewType,l=this.state.visibleColumns,c=l.indexOf(e),d=l.includes(t)?l.indexOf(t):l.length-1,u=c>=0?s.splice(l,c,1):s.splice(l,d+1,0,e);this.changeVisibleColumns(u),i(r.__spreadArrays(u,o.filter((function(e){return!u.includes(e)}))),a,this.isSizeColumnPresent(u),!0,u.length)},t.prototype.handleFixedColumnSelection=function(e,t){var r=this.props,o=r.viewType,n=r.onColumnsChanged,i=r.viewTypeColumns,c=r.preferredColumns,d=this.state.visibleColumns,u=c||(i?i[l.ViewType.List]:void 0),p=i?i[l.ViewType.Grid]:void 0;if(u&&p){var _=d.indexOf(t);if(-1===_||d.includes(e))this.changeVisibleColumns(d);else{var f=s.splice(d,_,1,e);this.changeVisibleColumns(f);var m=this.isSizeColumnPresent(f);o===l.ViewType.List||o===l.ViewType.CondensedList?n(a.swapColumns(u,t.sortField,e.sortField),l.ViewType.List,m,Boolean(c)):(c||n(a.swapColumns(p,t.sortField,e.sortField),o,m),e.sortField!==l.SortField.FILENAME&&n(a.swapColumns(u,u[1].sortField,e.sortField),l.ViewType.List,m,Boolean(c)))}}},t.prototype.computeVisibleColumns=function(e){return e.columns.slice(0,this.getNumVisibleColumns(e))},t.prototype.getNumVisibleColumns=function(e){var t=e.isMatchedLarge,r=e.isMatchedMedium,o=e.viewType,n=e.numVisibleColumns,i=e.isMoreColumnsEnabled;switch(o){case l.ViewType.Grid:case l.ViewType.LargeGrid:return 1;case l.ViewType.List:case l.ViewType.CondensedList:default:return i&&n&&n>1?n:t?3:r?2:1}},t.prototype.isSizeColumnPresent=function(e){return e.some((function(e){return e.sortField===l.SortField.SIZE}))},t.prototype.render=function(){var e=this.props,t=e.children,r=e.containerWidth,o=this.state,n=o.visibleColumns,i=o.canDisplayFolderSizes;return t?"function"==typeof t?t({visibleColumns:n,canDisplayFolderSizes:i,handleSelection:this.handleSelection,containerWidth:r}):t:null},t})(n.default.PureComponent);t.ColumnManagerComponent=c})),define("modules/clean/react/files_view/column_headers/column_header_cell",["require","exports","tslib","react","modules/clean/react/files_view/resizing/column_size_context","dig-components/icons","dig-components/icons/src","dig-components/buttons","dig-components/typography","modules/clean/react/files_view/types","spectrum/table"],(function(e,t,r,o,n,i,s,a,l,c,d){"use strict";function u(e){return e===c.SortDirection.ASCENDING?"ascending":e===c.SortDirection.DESCENDING?"descending":"none"}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),s=r.__importStar(s),t.ColumnHeaderCell=function(e){var t,r=e.children,p=e.column,_=e.index,f=e.role,m=e.setSort,h=e.sortDirection,g=e.isColumnResizingEnabled,S=o.default.useContext(n.ColumnResizingContext);g&&(t=S.columnSizes[p.sortField]);var E=void 0===t?{}:{width:t,minWidth:t,maxWidth:t};return o.default.createElement(d.TableHeadCell,{key:_,role:f,scope:"col","aria-sort":u(h),className:"files-view-column-header-table-cell",style:E},p.isSortDisabled||p.isSortOrderOptionDisabled?o.default.createElement(l.Text,{variant:"label",isBold:void 0!==h,className:"files-view-column-header-text"},p.label):o.default.createElement(a.Button,{variant:"transparent",hasNoUnderline:!0,onClick:function(){return m(p.sortField,(function(e){switch(e){case c.SortDirection.ASCENDING:return c.SortDirection.DESCENDING;default:return c.SortDirection.ASCENDING}})(h))},className:"files-view-column-header-text"},o.default.createElement(l.Text,{variant:"label",isBold:void 0!==h},p.label),h&&o.default.createElement(i.UIIcon,{src:h===c.SortDirection.ASCENDING?s.ArrowUpLine:s.ArrowDownLine,size:"small",className:"files-view-column-header-sort-button"})),r)},t.ColumnHeaderCell.displayName="ColumnHeaderCell"})),define("modules/clean/react/files_view/column_headers/column_header_menu",["require","exports","tslib","react","classnames","dig-components/menu","dig-components/buttons","dig-components/icons","dig-components/icons/src"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),t.ColumnHeaderMenu=function(e){var t=e.buttonDescription,c=e.columns,d=e.index,u=e.onSelection,p=e.onMenuOpen,_=e.selectedColumns,f=e.title,m=e.allowUnchecking;return o.default.createElement(i.Menu.Wrapper,{onSelection:function(e){return u(d,e)},onToggle:function(e){return e.isOpen&&p(d)}},(function(e){var d=e.getContentProps,u=e.getTriggerProps;return o.default.createElement(o.default.Fragment,null,o.default.createElement(s.IconButton,r.__assign({},u(),{variant:"transparent",size:"small","aria-label":t,className:n.default("files-view-column-header-menu-button",{"files-view-column-header-menu-open":d().open}),"data-testid":"files-view-column-header-menu-trigger"}),o.default.createElement(a.UIIcon,{src:l.ChevronDownLine,size:"small"})),o.default.createElement(i.Menu.Content,r.__assign({},d(),{placement:"bottom-end"}),o.default.createElement(i.Menu.Segment,{withLabel:f},c.map((function(e){return o.default.createElement(i.Menu.SelectItem,{"aria-label":e.popoverTriggerLabel,key:e.popoverTriggerLabel,value:e,selected:_.includes(e),disabled:!m&&_.includes(e)},e.label)})))))}))}})),define("modules/clean/react/files_view/column_headers/dig_column_header",["require","exports","tslib","classnames","react","spectrum/table","dig-components/controls","modules/clean/react/files_view/constants","modules/clean/react/files_view/fixed_table_head","modules/clean/react/files_view/sticky_table_head","modules/clean/react/files_view/types","modules/clean/react/files_view/view_type_column_header_menu","modules/core/i18n","modules/clean/react/files_view/column_headers/column_header_menu","modules/clean/react/files_view/column_headers/column_header_cell"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n);var m=function(e,t){switch(e){case d.ViewType.Grid:case d.ViewType.LargeGrid:return p.intl.formatMessage({id:"iWzO4p",defaultMessage:"Group by"});case d.ViewType.List:default:return t?p.intl.formatMessage({id:"t3Jo9w",defaultMessage:"Sort by"}):p.intl.formatMessage({id:"IUsgJf",defaultMessage:"Show"})}};t.ColumnHeader=function(e){var t=e.columnFlex,h=e.isCompactMode,g=e.isSelectMode,S=e.currentSort,E=e.onSwitchViewType,v=e.selectAllCheckboxState,w=void 0===v?"unchecked":v,T=e.showSelectAllCheckbox,b=void 0===T||T,I=e.stickyOffsetHeight,y=e.stickyOffsetTop,F=e.columns,C=e.visibleColumns,O=e.viewType,A=e.viewTypes,P=e.viewTypeLabels,L=e.onTTI,D=e.isSearchMode,M=e.presentationOnly,R=e.variant,N=void 0===R?"fixed":R,x=e.onMenuOpen,k=e.onSelectAll,U=e.onDeselectAll,V=e.onSort,H=e.onSelection,B=e.allowUnchecking,W=e.isColumnResizingEnabled,G=n.default.useState(!1),q=G[0],z=G[1],j={onMouseEnter:function(){return z(!0)},onMouseLeave:function(){return z(!1)}},K=(D?a.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS:F).filter((function(e){return!e.isLocked})),Y=!g&&!q&&!h,Q=function(e,t){var r=C[e];(function(e){return"string"==typeof(null==e?void 0:e.popoverTriggerLabel)})(t)&&(H(t,r,e),D?V(t.sortField,d.SortDirection.DESCENDING):(null==S?void 0:S.sortField)===r.sortField&&V(t.sortField,S.sortDirection||d.SortDirection.ASCENDING))},X=n.default.createElement(u.ViewTypeColumnHeaderMenu,{onTTI:L,viewType:O,viewTypes:A,viewTypeLabels:P,onSwitchViewType:E,shouldHideViewTypeColumnHeader:!0}),J=C.map((function(e,t){return n.default.createElement(f.ColumnHeaderCell,{key:e.popoverTriggerLabel,column:e,index:t,setSort:V,role:M?"presentation":"columnheader",sortDirection:(null==S?void 0:S.sortField)===e.sortField?S.sortDirection:void 0,isColumnResizingEnabled:W},!e.isLocked&&!e.isSortDisabled&&n.default.createElement(_.ColumnHeaderMenu,{columns:K,index:t,onMenuOpen:x,onSelection:Q,selectedColumns:C,title:m(O,!!D),allowUnchecking:B}),t===C.length-1&&X)})),Z=r.__spreadArrays([n.default.createElement(i.TableHeadCell,{className:"files-view-column-header-table-cell brws-checkbox-cell",key:"checkbox-cell",role:M?"presentation":"columnheader",scope:"col"},n.default.createElement("div",{className:"brws-vertically-center"},b&&!Y?n.default.createElement(s.Checkbox,{className:o.default("brws-checkbox",{"brws-checkbox-checked":"checked"===w}),checked:"checked"===w,isIndeterminate:"mixed"===w,onChange:function(e){e.currentTarget.checked?k():U()},"aria-label":p.intl.formatMessage({id:"YzMs/g",defaultMessage:"Select all"})}):null))],J);return"default"===N?n.default.createElement(i.TableHead,r.__assign({className:"brws-column-header"},j,{"data-testid":"table-head"}),Z):"fixed"===N?n.default.createElement(l.FixedTableHead,r.__assign({offsetHeight:I},j,{"data-testid":"fixed-table-head"}),Z):"sticky-native"===N?n.default.createElement(i.TableHead,r.__assign({className:"brws-column-header brws-column-header--sticky",style:{position:"sticky",top:y,zIndex:1}},j,{"data-testid":"sticky-native-table-head"}),Z):n.default.createElement(c.StickyTableHead,r.__assign({columnFlex:t,offsetHeight:I,offsetTop:y,className:"brws-column-header"},j,{"data-testid":"sticky-table-head"}),Z)}})),define("modules/clean/react/files_view/resizing/column_size_context",["require","exports","tslib","react","external/lodash"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var i={FILENAME:150,MODIFIED:150,CATEGORY:150,EXTENSION:150,SIZE:150,SHARED_WITH:150,SYNC_SETTING:150,FILE_COUNTS:150,RELEVANCE:150,LOCKED_FILES:150,POLICY:150},s={columnSizes:i,resizeColumn:function(e,t){}};t.ColumnResizingContext=o.default.createContext(s);var a=n.debounce((function(e,t){window.localStorage.setItem(e,JSON.stringify(t))}));t.ColumnResizingProvider=function(e){var n=e.children,s=e.localStorageKey,l=o.default.useState((function(){return(function(e){var t=window.localStorage.getItem(e);if(!t)return i;for(var r=JSON.parse(t),o=0,n=r;o<n.length;o++){if("number"!=typeof n[o])return i}return r})(s)})),c=l[0],d=l[1],u=(function(e){var t=o.default.useRef(e);return t.current=e,t})(c),p=o.default.useCallback((function(e,t){var o;if(u.current[e]!==t){var n=r.__assign(r.__assign({},u.current),((o={})[e]=t,o));d(n),a(s,n)}}),[s,u]),_=o.default.useMemo((function(){return{columnSizes:c,resizeColumn:p}}),[c,p]);return o.default.createElement(t.ColumnResizingContext.Provider,{value:_},n)}})),define("modules/clean/react/files_view/controller",["require","exports","tslib","react-redux","react","modules/clean/react/files_view/data/store","modules/clean/react/files_view/files_view","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/legacy_types"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),r.__exportStar(l,t);var c={arePostTTIModulesLoaded:!0,context:!0,createNewFolderState:!0,items:!0,selection:!0,user:!0,responsive:!0,clipboard:!0,currentSort:!0,disabledMultiselect:!0,dropTargetHighlightMode:!0,enableUnity:!0,expBizFoldersEmptyStateAdmin:!0,expBizFoldersEmptyStateUser:!0,extensionsFeatureFlags:!0,fileRename:!0,filteredContactName:!0,renderFilenameSubtitleAsLink:!0,hideViewFileButton:!0,highDensity:!0,isOverFreeQuota:!0,isSearchMode:!0,loadingState:!0,sharingServiceInfo:!0,starredState:!0,teamFolders:!0,viewTypeScope:!0,viewTypes:!0,eligibleForFirstTaskSubtitle:!0,expVaultEnableViewOnlySharing:!0,isActionBarEnabled:!0,inlineActionBar:!0,isDragToSelectEnabled:!0,isCutActionEnabled:!0,isMoreColumnsEnabled:!0},d=function(e,t,r){t[r]=e[r]};t.splitProps=function(e){for(var t={},r={},o=0,n=Object.keys(e);o<n.length;o++){var i=n[o];if(c.hasOwnProperty(i)){var s=i;void 0!==e[s]&&d(e,r,s)}else d(e,t,i)}return{ownProps:t,upsertedProps:r}};var u=0,p=function(e){var i=e.id,l=e.isActive,c=o.useDispatch(),d=t.splitProps(e),p=d.ownProps,_=d.upsertedProps,f=n.default.useMemo((function(){return i||"files-view:"+u++}),[i]),m=f!==i;return c(a.upsertInstance(f,_)),n.default.useEffect((function(){return function(){m&&c(a.deleteInstance(f))}}),[m,c,f]),n.default.useEffect((function(){l&&i&&c(a.markActiveInstance(i))}),[l,i]),n.default.createElement(s.FilesView,r.__assign({},p,{id:f}))};p.defaultProps={isActive:!0},t.FilesViewWithUpserter=o.connect()(p);var _=i.getStoreForFilesView();t.FilesViewController=function(e){return n.default.createElement(o.Provider,{store:_},n.default.createElement(t.FilesViewWithUpserter,r.__assign({},e)))}})),define("modules/clean/react/files_view/culled_table_body",["require","exports","tslib","spectrum/table","modules/clean/react/files_view/util","react"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.CulledTableBodyWithScrollContainer=function(e){var t=e.scrollContainer,o=r.__rest(e,["scrollContainer"]);if(t){var a=t.current;if(!a)return null;var l=i.default.useMemo((function(){return n.createFakeWindow(a)}),[a]);return i.default.createElement(s,r.__assign({},o,{shouldUseWindowAsScrollContainer:!0,window:l}))}return i.default.createElement(s,r.__assign({},o))};var s=(function(e){function n(t){var r=e.call(this,t)||this;return r.updateOffsetCache(),r}return r.__extends(n,e),n.prototype.componentDidMount=function(){this.updateScroll(!0)},n.prototype.componentDidUpdate=function(e){e.listItemHeight!==this.props.listItemHeight&&this.updateOffsetCache(),e.scrollToRow!==this.props.scrollToRow&&this.updateScroll(void 0===e.scrollToRow||e.scrollToRow<0)},n.prototype.updateOffsetCache=function(e){var r=(void 0===e?this.props:e).listItemHeight;this.offsetCache=Array.isArray(r)?t.computeOffsetCache(r):void 0},n.prototype.updateScroll=function(e){var r=this.props,o=r.scrollToRow,n=r.listItemHeight,i=r.viewportTopOffset,s=void 0===i?0:i,a=r.scrollPositionOffset,l=void 0===a?0:a,c=r.window;if(void 0!==o&&o>=0){var d=(Array.isArray(n)?this.offsetCache[o]:(o+1)*n)+l,u=d-(Array.isArray(n)?n[o]:n);t.scrollTo([u,d],s,c,e)}},n.prototype.render=function(){var e=this.props,t=e.viewportTopOffset,n=(e.scrollToRow,r.__rest(e,["viewportTopOffset","scrollToRow"]));return i.default.createElement(o.CulledTableBody,r.__assign({viewportHeight:window.innerHeight-t},n))},n.defaultProps={viewportTopOffset:0},n})(i.default.PureComponent);t.CulledTableBodyWithScrollToRow=s;t.scrollTo=function(e,t,r,o){var n=e[0],i=e[1];void 0===t&&(t=0),void 0===r&&(r=window);var s=r.innerHeight-t,a=(function(e){return void 0===e&&(e=window),"scrollingElement"in e.document&&e.document.scrollingElement?e.document.scrollingElement.scrollTop:e.document.documentElement.scrollTop})(r),l=a+s;n<a?r.scrollTo(0,n):i>l&&(o&&i-n<s/2?r.scrollTo(0,i-s/2):r.scrollTo(0,i-s))},t.computeOffsetCache=function(e){return e.reduce((function(e,t){return e.push(t+(e[e.length-1]||0)),e}),[])}})),define("modules/clean/react/files_view/data/action_creators",["require","exports","tslib","external/lodash","modules/clean/api_v2/user_client","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/types","modules/clean/react/files_view/types","modules/clean/storage","external/lodash","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events","modules/clean/react/files_view/view_preferences"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s),a=r.__importStar(a),u=r.__importStar(u),f=r.__importStar(f),t.setViewType=function(e){var t=e.user,r=e.viewType,o=e.viewTypeScope,n=void 0===o?i.VIEW_TYPE_GLOBAL_SCOPE:o,a=e.updateGlobalScope,c=void 0!==a&&a,u=e.useViewPreferences;return function(e,o){var a=[n];c&&n!==i.VIEW_TYPE_GLOBAL_SCOPE&&a.push(i.VIEW_TYPE_GLOBAL_SCOPE),e({type:l.ActionTypes.SET_VIEW_TYPE,payload:{viewType:r,viewScopes:a}}),u?f.setViewType(t.id,a,r):d.UserLocalStorage.set(t.id,i.VIEW_TYPE_STORAGE_KEY,s.viewTypes(o()))}};t.loadViewTypes=function(e){var t=e.user,r=e.useViewPreferences,o=e.defaultViewType;return function(e){var n=(function(e,t,r){var o;void 0===t&&(t=!1);var n=t?f.getViewTypes(e):d.UserLocalStorage.get(e,i.VIEW_TYPE_STORAGE_KEY);return n||(r?((o={})[i.VIEW_TYPE_GLOBAL_SCOPE]=r,o):null)})(t.id,r,o);n&&e({type:l.ActionTypes.SET_VIEW_TYPES,payload:{viewTypes:n}})}},t.setViewTypeColumns=function(e){var t=e.columns,o=e.viewType,n=e.user,a=e.useViewPreferences,c=e.viewTypeScope,u=void 0===c?i.VIEW_TYPE_GLOBAL_SCOPE:c,p=e.updateGlobalScope,_=void 0!==p&&p,m=e.numVisibleColumns;return function(e,c){var p,h=c();if(a){var g={};t.forEach((function(e,t){g[t]=e.sortField}));var S=[u];_&&u!==i.VIEW_TYPE_GLOBAL_SCOPE&&S.push(i.VIEW_TYPE_GLOBAL_SCOPE),e({type:l.ActionTypes.SET_COLUMNS_INDEX,payload:{viewScopes:S,columnsIndex:g,numVisibleColumns:m}}),f.setColumnsIndex(n.id,S,g),void 0!==m&&f.setNumVisibleColumns(n.id,S,m)}else{d.UserLocalStorage.set(n.id,i.COLUMNS_STORAGE_KEY+"_"+o,t);var E=r.__assign(r.__assign({},s.viewTypeColumns(h)),((p={})[o]=t,p));e({type:l.ActionTypes.SET_VIEW_TYPE_COLUMNS,payload:{viewTypeColumns:E}})}}},t.loadViewTypeColumns=function(e){var t=e.user,o=e.useViewPreferences;return function(e,n){if(o){var a=f.getScopedColumnsIndex(t.id),u=f.getScopedNumVisibleColumns(t.id);if(!a[i.VIEW_TYPE_GLOBAL_SCOPE]){var p={},_=d.UserLocalStorage.get(t.id,i.COLUMNS_STORAGE_KEY+"_"+c.ViewType.List);_&&(_.forEach((function(e,t){var r=e.sortField;p[t]=r})),a[i.VIEW_TYPE_GLOBAL_SCOPE]=p)}e({type:l.ActionTypes.SET_SCOPED_COLUMNS_INDEX,payload:{scopedColumnsIndex:a,scopedNumVisibleColumns:u}})}else{var m=s.viewTypeColumns(n());i.AllViewTypes.forEach((function(e){var o,n=d.UserLocalStorage.get(t.id,i.COLUMNS_STORAGE_KEY+"_"+e);n&&(m=r.__assign(r.__assign({},m),((o={})[e]=n,o)))})),e({type:l.ActionTypes.SET_VIEW_TYPE_COLUMNS,payload:{viewTypeColumns:m}})}}},t.setFileRename=function(e){var t=e.file,r=e.renameState;return{type:l.ActionTypes.SET_FILE_RENAME,payload:{file:t,renameState:r}}},t.resetScroll=function(){return{type:l.ActionTypes.SET_SCROLL,payload:{scrollTop:0}}};t.upsertInstance=function(e,t){return function(r,n){var i,a;i=t,(!(a=s.selectInstances(n()).get(e))||Object.keys(i).some((function(e){return!o.isEqual(i[e],a[e])})))&&r({type:l.ActionTypes.UPSERT_INSTANCE,payload:{id:e,instance:t}})}},t.deleteInstance=function(e){return{type:l.ActionTypes.DELETE_INSTANCE,payload:{id:e}}},t.markActiveInstance=function(e){return{type:l.ActionTypes.MARK_ACTIVE_INSTANCE,payload:{id:e}}},t.openKeyboardShortcutsModal=function(t){return function(o,n){(function(t,o){r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/files_view/keyboard_shortcuts_modal"],t,r)})).then(r.__importStar)];case 1:return(0,n.sent().showKeyboardShortcutsModal)(t,o),[2]}}))}))})(a.selectIsListView(n(),t),a.selectIsCutActionEnabled(n(),t))}};t.batchLoadPreviewThumbnails=function(e,t,o,i,c){return r.__awaiter(void 0,void 0,void 0,(function(){var d,u,f,m,h;return r.__generator(this,(function(r){switch(r.label){case 0:d=s.previewThumbnailsToLoad(t()),u=a.selectViewType(t(),{instanceId:c}),r.label=1;case 1:return r.trys.push([1,4,,5]),d.length>0?[4,(new n.UserApiV2Client).ns("previews").rpc("get_preview_data_batch",{files:d},{subjectUserId:o})]:[3,3];case 2:f=r.sent(),m=[],f.results.forEach((function(e){var t,r=null===(t=e.preview)||void 0===t?void 0:t.content,o=e.file.file_id;o&&r&&(r.hasOwnProperty("thumbnail_url_tmpl")?m.push({file_id:o,preview_url:r.thumbnail_url_tmpl}):r.hasOwnProperty("placeholder_image_url")&&m.push({file_id:o,preview_url:r.placeholder_image_url}))})),m.length>0&&(e((function(e){var t=e.preview_thumbnails;return{type:l.ActionTypes.PREVIEW_THUMBNAILS_LOADED,payload:{preview_thumbnails:t}}})({preview_thumbnails:m})),g={view_type:u,userId:o,num_files_requested:d.length,num_files_retrieved:m.length,elapsed_ms:Date.now()-i},p.logWebUserAction({user_id:g.userId,event_name:_.WebUserActionLogEvent.PREVIEW_THUMBNAIL_SUCCESS,extra:{view_type:g.view_type,num_files_requested:g.num_files_requested.toString(),num_files_retrieved:g.num_files_retrieved.toString(),elapsed_ms:g.elapsed_ms.toString()}})),r.label=3;case 3:return[3,5];case 4:return h=r.sent(),e((function(e){var t=e.files;return{type:l.ActionTypes.PREVIEW_THUMBNAILS_REMOVED,payload:{files:t}}})({files:d})),(function(e){p.logWebUserAction({user_id:e.userId,event_name:_.WebUserActionLogEvent.PREVIEW_THUMBNAIL_ERROR,extra:{view_type:e.view_type,error_summary:e.error_summary||"unknown"}})})({view_type:u,userId:o,error_summary:null==h?void 0:h.toString()}),[3,5];case 5:return[2]}var g}))}))};var m=u.debounce((function(e,r,o,n,i){t.batchLoadPreviewThumbnails(e,r,o,n,i)}),300);t.loadPreviewThumbnails=function(e,t,r){return function(o,n){var i=s.previewThumbnails(n()),a=e.filter((function(e){return e.file_id&&!i.hasOwnProperty(e.file_id)}));a.length>0&&(o((function(e){var t=e.files;return{type:l.ActionTypes.PREVIEW_THUMBNAILS_LOADING,payload:{files:t}}})({files:a})),m(o,n,t,Date.now(),r))}},t.setSort=function(e){var t=e.user,r=e.sort,o=e.viewScope,n=void 0===o?i.VIEW_TYPE_GLOBAL_SCOPE:o,s=e.updateGlobalScope,a=void 0!==s&&s;return function(e){var o=[n];a&&n!==i.VIEW_TYPE_GLOBAL_SCOPE&&o.push(i.VIEW_TYPE_GLOBAL_SCOPE),e({type:l.ActionTypes.SET_SORT,payload:{sort:r,viewScopes:o}}),f.setSort(t.id,o,r)}},t.loadScopedSortOrders=function(e){var t,o=e.user,n=e.defaultSort;return{type:l.ActionTypes.SET_SCOPED_SORTS,payload:{scopedSorts:r.__assign((t={},t[i.VIEW_TYPE_GLOBAL_SCOPE]=n,t),f.getScopedSorts(o.id))}}}})),define("modules/clean/react/files_view/data/reducer",["require","exports","tslib","immutable","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/types","modules/clean/react/files_view/types"],(function(e,t,r,o,n,i,s){"use strict";var a,l;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.defaultFilesViewState={viewTypes:(a={},a[n.VIEW_TYPE_GLOBAL_SCOPE]=s.ViewType.List,a),scopedColumnsIndex:void 0,scopedSorts:void 0,viewTypeColumns:(l={},l[s.ViewType.List]=n.LIST_VIEW_COLUMNS,l[s.ViewType.CondensedList]=n.LIST_VIEW_COLUMNS,l[s.ViewType.Grid]=n.GRID_VIEW_COLUMNS,l[s.ViewType.LargeGrid]=n.GRID_VIEW_COLUMNS,l),fileRename:null,instances:o.Map(),previewThumbnails:{},activeInstance:void 0};t.defaultFilesViewInstance={dropTargetHighlightMode:s.DropTargetHighlightMode.NONE,enableUnity:!0,loadingState:s.LoadingState.LOADING_FIRST_PAGE,fileRename:null,renderFilenameSubtitleAsLink:!0,eligibleForFirstTaskSubtitle:!1,viewTypeScope:n.VIEW_TYPE_GLOBAL_SCOPE,hideViewFileButton:!1,isDragToSelectEnabled:!1,isCutActionEnabled:!1};t.filesViewReducer=function(e,o){switch(void 0===e&&(e=t.defaultFilesViewState),o.type){case i.ActionTypes.SET_VIEW_TYPE:return(function(e,t){for(var o=t.viewType,n=t.viewScopes,i=r.__assign({},e.viewTypes),s=0,a=n;s<a.length;s++){i[a[s]]=o}return r.__assign(r.__assign({},e),{viewTypes:i})})(e,o.payload);case i.ActionTypes.SET_VIEW_TYPES:return(function(e,t){var o=t.viewTypes;return r.__assign(r.__assign({},e),{viewTypes:r.__assign(r.__assign({},e.viewTypes),o)})})(e,o.payload);case i.ActionTypes.SET_VIEW_TYPE_COLUMNS:return(function(e,t){var o=t.viewTypeColumns;return r.__assign(r.__assign({},e),{viewTypeColumns:o})})(e,o.payload);case i.ActionTypes.SET_FILE_RENAME:return(function(e,t){var o=t.payload,n=o.file,i=o.renameState;return i?r.__assign(r.__assign({},e),{fileRename:{file:n,state:i}}):r.__assign(r.__assign({},e),{fileRename:null})})(e,o);case i.ActionTypes.SET_COLUMNS_INDEX:return(function(e,t){for(var o=t.payload,n=o.columnsIndex,i=o.viewScopes,s=o.numVisibleColumns,a=r.__assign({},e.scopedColumnsIndex),l=r.__assign({},e.scopedNumVisibleColumns),c=0,d=i;c<d.length;c++){var u=d[c];a[u]=n,void 0!==s&&(l[u]=s)}return r.__assign(r.__assign({},e),{scopedColumnsIndex:a,scopedNumVisibleColumns:l})})(e,o);case i.ActionTypes.SET_SCOPED_COLUMNS_INDEX:return(function(e,t){var o=t.payload,n=o.scopedColumnsIndex,i=o.scopedNumVisibleColumns;return r.__assign(r.__assign({},e),{scopedColumnsIndex:n,scopedNumVisibleColumns:i})})(e,o);case i.ActionTypes.SET_SCOPED_SORTS:return(function(e,t){var o=t.payload.scopedSorts;return r.__assign(r.__assign({},e),{scopedSorts:o})})(e,o);case i.ActionTypes.SET_SORT:return(function(e,t){for(var o=t.payload,n=o.sort,i=o.viewScopes,s=r.__assign({},e.scopedSorts),a=0,l=i;a<l.length;a++){s[l[a]]=n}return r.__assign(r.__assign({},e),{scopedSorts:s})})(e,o);case i.ActionTypes.SET_SCROLL:return(function(e,t){return r.__assign(r.__assign({},e),{currentScroll:{scrollTop:t.scrollTop}})})(e,o.payload);case i.ActionTypes.UPSERT_INSTANCE:return(function(e,o){var n=o.payload,i=n.instance,s=n.id,a=e.instances.get(s);return r.__assign(r.__assign({},e),{activeInstance:s,instances:e.instances.set(s,r.__assign(r.__assign({},a||t.defaultFilesViewInstance),i))})})(e,o);case i.ActionTypes.DELETE_INSTANCE:return(function(e,t){var o=t.payload.id;return r.__assign(r.__assign({},e),{instances:e.instances.delete(o)})})(e,o);case i.ActionTypes.PREVIEW_THUMBNAILS_LOADING:return(function(e,t){var o=t.payload.files,n=r.__assign({},e.previewThumbnails);return o.forEach((function(e){var t;e.file_id&&!(null===(t=n[e.file_id])||void 0===t?void 0:t.isLoading)&&(n[e.file_id]={isLoading:!0,file_info:e})})),r.__assign(r.__assign({},e),{previewThumbnails:n})})(e,o);case i.ActionTypes.PREVIEW_THUMBNAILS_LOADED:return(function(e,t){var o=t.payload.preview_thumbnails,n=r.__assign({},e.previewThumbnails);return o.forEach((function(e){e.file_id&&(n[e.file_id]={isLoading:!1,preview_url:e.preview_url})})),r.__assign(r.__assign({},e),{previewThumbnails:n})})(e,o);case i.ActionTypes.PREVIEW_THUMBNAILS_REMOVED:return(function(e,t){var o=t.payload.files,n=r.__assign({},e.previewThumbnails);return o.forEach((function(e){e.file_id&&delete n[e.file_id]})),r.__assign(r.__assign({},e),{previewThumbnails:n})})(e,o);case i.ActionTypes.MARK_ACTIVE_INSTANCE:return(function(e,t){var o=t.payload.id;return e.activeInstance!==o?r.__assign(r.__assign({},e),{activeInstance:o}):e})(e,o)}return e}})),define("modules/clean/react/files_view/data/selectors/files_view_selectors",["require","exports","modules/clean/react/files_view/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/selectors"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return n.getStateAtNamespace(e,o.FILES_VIEW_NAMESPACE_KEY)||r.defaultFilesViewState};t.viewTypes=function(e){return i(e).viewTypes},t.scopedColumnsIndex=function(e){return i(e).scopedColumnsIndex},t.viewTypeColumns=function(e){return i(e).viewTypeColumns},t.scopedSorts=function(e){return i(e).scopedSorts},t.scopedNumVisibleColumns=function(e){return i(e).scopedNumVisibleColumns},t.fileRename=function(e){return i(e).fileRename},t.currentScroll=function(e){return i(e).currentScroll},t.isActiveFilesView=function(e,t){return i(e).activeInstance===t},t.selectInstances=function(e){return i(e).instances},t.previewThumbnails=function(e){return i(e).previewThumbnails},t.previewThumbnailsToLoad=function(e){var r=[],o=t.previewThumbnails(e);for(var n in o)!0===o[n].isLoading&&o[n].file_info&&r.push(o[n].file_info);return r}})),define("modules/clean/react/files_view/data/selectors/instance_selectors",["require","exports","tslib","reselect","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/file_grouper","modules/clean/react/files_view/types","modules/core/exception"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),l=r.__importStar(l);var d=function(e,t){return s.selectInstances(e).get(t.instanceId)};t.selectInstance=function(e,t){var r=d(e,t);return c.assert(!!r,"[FilesView] Instance '"+t.instanceId+"' must be defined in redux store before mounting"),r};var u=function(e){return function(r,o){return e(t.selectInstance(r,o))}},p=function(e){return function(t,r){return e(d(t,r))}};t.selectDropTargetHighlightMode=u((function(e){return e.dropTargetHighlightMode})),t.selectMainItems=u((function(e){return e.items})),t.selectTeamFolders=u((function(e){return e.teamFolders})),t.selectContext=u((function(e){return e.context})),t.selectUser=u((function(e){return e.user})),t.selectArePostTTIModulesLoaded=u((function(e){return e.arePostTTIModulesLoaded})),t.selectIsGridView=function(e,r){return[l.ViewType.Grid,l.ViewType.LargeGrid].includes(t.selectViewType(e,r))},t.selectIsListView=function(e,r){return[l.ViewType.List,l.ViewType.CondensedList].includes(t.selectViewType(e,r))},t.selectCurrentSort=u((function(e){return e.currentSort})),t.selectIsSearchMode=u((function(e){return e.isSearchMode})),t.selectDisabledMultiselect=u((function(e){return!!e.disabledMultiselect})),t.selectSelection=u((function(e){return e.selection})),t.selectResponsive=u((function(e){return e.responsive})),t.selectFileRename=u((function(e){return e.fileRename})),t.selectHighDensity=u((function(e){return e.highDensity})),t.selectRenderFilenameSubtitleAsLink=u((function(e){return e.renderFilenameSubtitleAsLink})),t.selectEligibleForFirstTaskSubtitle=u((function(e){return e.eligibleForFirstTaskSubtitle})),t.selectIsActionBarEnabled=u((function(e){return e.isActionBarEnabled})),t.selectInlineActionBar=u((function(e){return e.inlineActionBar})),t.selectIsCompactMode=function(e,r){return!t.selectResponsive(e,r).isMatchedLarge},t.selectIsMobileMode=function(e,r){var o=t.selectResponsive(e,r);return!o.isMatchedLarge&&!o.isMatchedMedium},t.selectIsCutActionEnabled=u((function(e){return e.isCutActionEnabled})),t.selectClipboard=u((function(e){return e.clipboard})),t.selectCutItems=function(e,r){var o=t.selectClipboard(e,r);return o&&"cut"===o.action?new Map(o.files.map((function(e){return[e.fq_path,e]}))):new Map},t.selectShouldShowFileNameHighlights=function(e,r){return t.selectIsSearchMode(e,r)},t.selectShouldShowFileNameLocation=function(e,r){return t.selectIsSearchMode(e,r)},t.selectNumItemsSelected=function(e,r){return t.selectSelection(e,r).selected.size},t.selectHasItemsSelected=function(e,r){return t.selectNumItemsSelected(e,r)>0},t.selectSections=o.createSelector(t.selectIsGridView,t.selectCurrentSort,t.selectMainItems,t.selectIsSearchMode,(function(e,t,r,o){return e&&t?a.getSections(r,t.sortField,t.sortDirection,o):a.EMPTY_SECTIONS})),t.selectItemIds=o.createSelector(t.selectMainItems,(function(e){return e.toArray().map((function(e){return e instanceof n.File?e.fq_path:e instanceof n.FileSharedWithMe?e.file_id:""}))})),t.selectViewTypeScope=p((function(e){return(null==e?void 0:e.viewTypeScope)||i.VIEW_TYPE_GLOBAL_SCOPE})),t.selectViewTypes=p((function(e){return(null==e?void 0:e.viewTypes)||[]})),t.selectViewType=o.createSelector(s.viewTypes,t.selectViewTypes,t.selectViewTypeScope,(function(e,t,r){var o;return o=r in e?e[r]:r in i.defaultViewTypes?i.defaultViewTypes[r]:e[i.VIEW_TYPE_GLOBAL_SCOPE],t.includes(o)?o:l.ViewType.List})),t.selectColumnsIndex=o.createSelector(s.scopedColumnsIndex,t.selectViewTypeScope,t.selectIsSearchMode,(function(e,t,r){if(e&&!r)return t in e?e[t]:e[i.VIEW_TYPE_GLOBAL_SCOPE]||{}})),t.selectPreferredColumns=o.createSelector(t.selectColumnsIndex,t.selectViewType,s.viewTypeColumns,(function(e,t,r){if(e){for(var o=r[t],n=o[0],i=o.slice(1),s=Object.keys(e).reduce((function(t,r){var o=parseInt(r,10);return t[e[o]]=o,t}),{}),a=[],l={},c=0,d=i;c<d.length;c++){var u=s[(f=d[c]).sortField];void 0===u||0===u?a.push(f):l[u]=f}for(var p=[n],_=1;_<=i.length;_++){var f;(f=l[_]||a.shift())&&p.push(f)}return p}})),t.selectScopedSort=o.createSelector(s.scopedSorts,t.selectViewTypeScope,(function(e,t){if(e)return t in e?e[t]:e[i.VIEW_TYPE_GLOBAL_SCOPE]})),t.selectNumVisibleColumns=o.createSelector(s.scopedNumVisibleColumns,t.selectViewTypeScope,(function(e,t){if(e)return t in e?e[t]:e[i.VIEW_TYPE_GLOBAL_SCOPE]}))})),define("modules/clean/react/files_view/data/selectors/item_selectors",["require","exports","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/list_selectors","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/core/exception"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectItem=function(e,t){var r=i.selectItemList(e,t),o=r&&r.get(t.itemIndex);return l.assert(!!o,"Item undefined at index: "+t.itemIndex),o},t.selectItemAssertFileOrFileSharedWithMe=function(e,o){var n=t.selectItem(e,o);return l.assert(n instanceof r.File||n instanceof r.FileSharedWithMe,"item must be File or FileSharedWithMe at index: "+o.itemIndex),n},t.selectItemSelectionId=function(e,o){var n=t.selectItemAssertFileOrFileSharedWithMe(e,o);return n instanceof r.File?o.fileToId(n):n.file_id},t.selectIsItemSelected=function(e,r){return n.selectSelection(e,r).selected.has(t.selectItemSelectionId(e,r))},t.selectIsCheckboxVisible=function(e,t){return t.isHovered||n.selectHasItemsSelected(e,t)||n.selectIsCompactMode(e,t)},t.selectShouldShowUserEducationEffects=function(e,t){var r=t.listId;return 0===t.rowIndex||"main"===r&&n.selectUser(e,t).is_cdm_member&&(2===t.rowIndex||1===t.rowIndex)},t.selectUserEducationEffectName=function(e,r){return t.selectShouldShowUserEducationEffects(e,r)?"FileNameLabel-"+r.rowIndex:void 0},t.selectRenameState=function(e,o){var i=n.selectFileRename(e,o),s=t.selectItem(e,o);if(i&&s instanceof r.File)return i.file.fq_path===s.fq_path?i.state:void 0},t.selectShouldShowSubtitle=function(e,r){return!t.selectRenameState(e,r)&&n.selectViewType(e,r)!==s.ViewType.CondensedList},t.selectIsNoAccessSharedFolder=function(e,o){var n=t.selectItem(e,o);return n instanceof r.File&&r.File.isNoAccessSharedFolder(n)},t.selectShouldShowStar=function(e,r){return n.selectArePostTTIModulesLoaded(e,r)&&!t.selectIsNoAccessSharedFolder(e,r)&&!n.selectContext(e,r).isInsideVaultFolder&&!n.selectIsActionBarEnabled(e,r)},t.selectShowCDMUserEducationEffects=function(e,o){var n=t.selectItem(e,o);return n instanceof r.File&&r.File.isTeamMemberFolder(n)},t.selectIsTooltipEnabled=function(e,t){return n.selectArePostTTIModulesLoaded(e,t)},t.selectSnippets=function(e,o){var n=t.selectItem(e,o);if(n instanceof r.Paper||n instanceof r.File||n instanceof r.FileSharedWithMe)return n.snippets},t.selectFirstValidSnippet=function(e,r){var o=t.selectSnippets(e,r);return o&&o.find((function(e){var t=e.highlight_spans;return!!t&&t.length>0}))},t.selectShouldShowSnippets=function(e,r){return Boolean(!n.selectIsMobileMode(e,r)&&t.selectFirstValidSnippet(e,r))},t.selectRowHeight=function(e,r){var i=t.selectShouldShowSnippets(e,r),a=n.selectHighDensity(e,r),l=n.selectViewType(e,r);if(i){var c=t.selectSnippetRows(e,r);return c?o.ROW_VERTICAL_PADDING+o.ROW_TITLE_HEIGHT+o.ROW_SUBTITLE_HEIGHT+o.ROW_SNIPPET_VERTICAL_MARGIN+o.SNIPPET_HEIGHT_PER_ROW*c:o.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS}return l===s.ViewType.CondensedList?o.DEFAULT_ROW_HEIGHT_CONDENSED_LIST:a?o.DEFAULT_ROW_HEIGHT_DENSE:o.DEFAULT_ROW_HEIGHT};t.selectSnippetRows=function(e,r){var n=t.selectFirstValidSnippet(e,r);if(!n||!n.highlight_spans)return 0;var i=r.containerWidth,s=r.numVisibleColumns,a=i?i*o.FILE_NAME_CELL_SEARCH_FLEX_BASIS[s]/100:void 0;if(!a)return 3;var l=n.highlight_spans.map((function(e){return e.highlight_str})).join().length,c=Math.max(a-o.MEDIA_CELL_ICON_WIDTH-o.SNIPPET_HORIZONTAL_PADDING,1),d=6*l;return Math.min(Math.ceil(d/c),3)},t.selectShouldShowFirstTaskSubtitle=function(e,t){return Boolean(n.selectEligibleForFirstTaskSubtitle(e,t)&&c(e,t))};var c=function(e,o){var i=n.selectContext(e,o),s=t.selectItem(e,o),a=n.selectUser(e,o);return s instanceof r.File&&(i.isInsideMyTeamFolderTree&&i.isCurrentlyInRoot&&s.fq_path===a.cdm_tmf_path)};t.selectIconSize=function(e,t){return n.selectViewType(e,t)===s.ViewType.CondensedList?32:void 0},t.selectIsCutToClipboard=function(e,r){var o=n.selectCutItems(e,r),i=t.selectItem(e,r);return a.isCutToClipboard(i,o)}})),define("modules/clean/react/files_view/data/selectors/list_selectors",["require","exports","tslib","reselect","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_list_utils","modules/clean/react/files_view/types"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectItemList=function(e,t){return"main"===t.listId?s.selectMainItems(e,t):s.selectTeamFolders(e,t)},t.selectShouldRenderCheckboxes=function(e,t){return"team_folders"!==t.listId},t.selectListItems=function(e,o){var n=s.selectMainItems(e,o),i=!!s.selectDisabledMultiselect(e,o),a=s.selectViewType(e,o)===l.ViewType.CondensedList,c=s.selectIsActionBarEnabled(e,o);return t.getFilesViewListRowItems(r.__assign(r.__assign({},o),{isCheckboxDisabled:i,isCondensedListView:a,items:n,isActionBarEnabled:c}))},t.selectListItemHeights=o.createSelector(t.selectListItems,(function(e){return e.map((function(e){return e.height}))})),t.selectListItemBuffer=function(e,t){return s.selectViewType(e,t)===l.ViewType.CondensedList?20:void 0};var c=o.createSelectorCreator(o.defaultMemoize,(function(e,t){return Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every((function(r){return t.hasOwnProperty(r)&&e[r]===t[r]}))}));t.getFilesViewListRowItems=c((function(e){return{activeDropTarget:e.activeDropTarget,arePostTTIModulesLoaded:e.arePostTTIModulesLoaded,canDisplayFolderSizes:e.canDisplayFolderSizes,context:e.context,createNewFolderState:e.createNewFolderState,dropTargetHighlightMode:e.dropTargetHighlightMode,extensionsFeatureFlags:e.extensionsFeatureFlags,fileRename:e.fileRename,focusedFileIndex:e.focusedFileIndex,isCheckboxDisabled:e.isCheckboxDisabled,isCompactMode:e.isCompactMode,isSearchMode:e.isSearchMode,isSelectMode:e.isSelectMode,items:e.items,selection:e.selection,sharingServiceInfo:e.sharingServiceInfo,starredState:e.starredState,user:e.user,visibleColumns:e.visibleColumns,responsive:e.responsive,containerWidth:e.containerWidth,highDensity:e.highDensity,isCondensedListView:e.isCondensedListView,fileToId:e.fileToId,renderSharedWithController:e.renderSharedWithController,expVaultEnableViewOnlySharing:e.expVaultEnableViewOnlySharing,isActionBarEnabled:e.isActionBarEnabled}}),(function(e){var o=e.activeDropTarget,s=e.context,l=e.createNewFolderState,c=e.dropTargetHighlightMode,d=e.items,u=e.fileRename,p=e.focusedFileIndex,_=e.selection,f=e.user,m=e.visibleColumns,h=e.responsive,g=e.containerWidth,S=e.highDensity,E=e.fileToId,v=e.isCondensedListView,w=e.isActionBarEnabled,T=r.__rest(e,["activeDropTarget","context","createNewFolderState","dropTargetHighlightMode","items","fileRename","focusedFileIndex","selection","user","visibleColumns","responsive","containerWidth","highDensity","fileToId","isCondensedListView","isActionBarEnabled"]),b=!!e.expVaultEnableViewOnlySharing,I=v?i.DEFAULT_ROW_HEIGHT_CONDENSED_LIST:S?i.DEFAULT_ROW_HEIGHT_DENSE:i.DEFAULT_ROW_HEIGHT,y=v?32:void 0,F=d.toArray().map((function(e,l){if(e instanceof n.UserDefinedItem)return{type:"UserDefinedItemRow",props:{userDefinedItem:e},height:I};var d=g?g*i.FILE_NAME_CELL_SEARCH_FLEX_BASIS[m.length]/100:void 0,F=t.shouldShowSnippets({file:e,responsive:h}),C=t.estimateSnippetRowsNeeded({snippets:e.snippets,fileNameCellWidth:d}),O=t.getFileRowHeight({file:e,showSnippets:F,snippetRows:C,highDensity:S,isCondensedListView:v});if(e instanceof n.Paper)return{type:"PaperRow",props:{isSearchMode:T.isSearchMode,paper:e,visibleColumns:m,arePostTTIModulesLoaded:T.arePostTTIModulesLoaded,showSnippets:F,snippetRows:C,height:O},height:O};var A="fq_path"in e?E(e):e.file_id,P=_.selected.has(A);if(e instanceof n.FileSharedWithMe)return{type:"FileSharedWithMeRow",props:{file:e,visibleColumns:m,showSnippets:F,snippetRows:C,height:O,isSelected:P,arePostTTIModulesLoaded:T.arePostTTIModulesLoaded,isSelectMode:T.isSelectMode,isFocused:l===p,iconSize:y},height:O};var L=a.shouldFileBeHighlightedDropTarget({file:e,isSelected:P,dropTargetHighlightMode:c});return{type:"FileRow",key:"file:"+encodeURIComponent(e.file_id)+":"+encodeURIComponent(e.fq_path),itemIndex:l,props:r.__assign(r.__assign({},T),{file:e,isActionBarEnabled:w,isActiveDropTarget:L&&o===e,isAvailableDropTarget:L,isFocused:l===p,isSelected:P,isExtensionsMenuDisabled:Boolean(a.isExtensionsMenuDisabledForContext({context:s})||w),isSharingDisabled:a.isSharingDisabledForFile({context:s,file:e,user:f,expVaultEnableViewOnlySharing:b}),renameState:u&&u.file.fq_path===e.fq_path?u.state:void 0,visibleColumns:m,height:O,containerWidth:g,isCondensedListView:v}),height:O}}));return l&&"CREATE_FOLDER_INACTIVE"!==l&&F.unshift({type:"NewFolderRow",props:{createNewFolderState:l,isInsideMyTeamFolderTree:s.isInsideTeamFolderTree,iconSize:y},height:I}),F})),t.getFirstValidSnippet=function(e){return e.find((function(e){var t=e.highlight_spans;return!!t&&t.length>0}))},t.shouldShowSnippets=function(e){var r=e.file.snippets,o=e.responsive;return!!r&&!!t.getFirstValidSnippet(r)&&(o.isMatchedLarge||o.isMatchedMedium)},t.getFileRowHeight=function(e){var t=e.file,r=e.showSnippets,o=e.snippetRows,n=e.highDensity,s=e.isCondensedListView;return t.snippets&&r?o?i.ROW_VERTICAL_PADDING+i.ROW_TITLE_HEIGHT+i.ROW_SUBTITLE_HEIGHT+i.ROW_SNIPPET_VERTICAL_MARGIN+i.SNIPPET_HEIGHT_PER_ROW*o:i.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS:s?i.DEFAULT_ROW_HEIGHT_CONDENSED_LIST:n?i.DEFAULT_ROW_HEIGHT_DENSE:i.DEFAULT_ROW_HEIGHT};t.estimateSnippetRowsNeeded=function(e){var r=e.snippets,o=e.fileNameCellWidth;if(!r)return 0;var n=t.getFirstValidSnippet(r);if(!n||!n.highlight_spans)return 0;if(!o)return 3;var s=n.highlight_spans.map((function(e){return e.highlight_str})).join().length,a=Math.max(o-i.MEDIA_CELL_ICON_WIDTH-i.SNIPPET_HORIZONTAL_PADDING,1),l=6*s;return Math.min(Math.ceil(l/a),3)}})),define("modules/clean/react/files_view/data/store",["require","exports","modules/clean/react/files_view/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/store"],(function(e,t,r,o,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForFilesView=function(){var e;return i||(i=n.getStoreAndRegisterReducers(((e={})[o.FILES_VIEW_NAMESPACE_KEY]=r.filesViewReducer,e))),i}})),define("modules/clean/react/files_view/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.SET_VIEW_TYPE="FILES_VIEW/SET_VIEW_TYPE",e.SET_VIEW_TYPES="FILES_VIEW/SET_VIEW_TYPES",e.SET_VIEW_TYPE_COLUMNS="FILES_VIEW/SET_VIEW_TYPE_COLUMNS",e.SET_VIEW_TYPE_SCOPE="FILES_VIEW/SET_VIEW_TYPE_SCOPE",e.SET_FILE_RENAME="FILES_VIEW/SET_FILE_RENAME",e.SET_COLUMNS_INDEX="FILES_VIEW/SET_COLUMNS_INDEX",e.SET_SCOPED_COLUMNS_INDEX="FILES_VIEW/SET_SCOPED_COLUMNS_INDEX",e.SET_SORT="FILES_VIEW/SET_SORT",e.SET_SCOPED_SORTS="FILES_VIEW/SET_SCOPED_SORTS",e.SET_SCROLL="FILES_VIEW/SET_SCROLL",e.UPDATE_INSTANCE="FILES_VIEW/UPDATE_INSTANCE",e.UPSERT_INSTANCE="FILES_VIEW/UPSERT_INSTANCE",e.DELETE_INSTANCE="FILES_VIEW/DELETE_INSTANCE",e.PREVIEW_THUMBNAILS_LOADING="FILES_VIEW/PREVIEW_THUMBNAILS_LOADING",e.PREVIEW_THUMBNAILS_LOADED="FILES_VIEW/PREVIEW_THUMBNAILS_LOADED",e.PREVIEW_THUMBNAILS_REMOVED="FILES_VIEW/PREVIEW_THUMBNAILS_REMOVED",e.MARK_ACTIVE_INSTANCE="FILES_VIEW/MARK_ACTIVE_INSTANCE"})(t.ActionTypes||(t.ActionTypes={}))})),define("modules/clean/react/files_view/file_actions/api_v2",["require","exports","tslib","modules/clean/api_v2/user_client","modules/clean/filepath","modules/core/exception"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n);function s(e){return null!=e.fq_path}function a(e){return s(e)?n.filename(e.fq_path):e.name}function l(e,t){return r.__awaiter(this,void 0,Promise,(function(){var o,n,i,s,a,l,c;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,9,,10]),[4,e()];case 1:return"complete"!==(o=r.sent())[".tag"]?[3,2]:[2,{isError:!1,result:o}];case 2:n=void 0,r.label=3;case 3:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 4:return r.sent(),[4,t(o.async_job_id)];case 5:n=r.sent(),r.label=6;case 6:if(n&&"in_progress"===n[".tag"])return[3,3];r.label=7;case 7:if("complete"===n[".tag"]){for(s=0,a=(i=n).entries;s<a.length;s++)if("failure"===(l=a[s])[".tag"]&&"relocation_error"===l.failure[".tag"]&&"to"===l.failure.relocation_error[".tag"]&&"file_system_warnings"===l.failure.relocation_error.to[".tag"])return[2,{isError:!0,error:l.failure.relocation_error,error_summary:"file_system_warnings",jobId:o.async_job_id}];return[2,{isError:!1,result:i,jobId:o.async_job_id}]}return[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error",jobId:o.async_job_id}];case 8:return[3,10];case 9:return(c=r.sent())&&c.error&&c.error[".tag"]?[2,{isError:!0,error:c.error,error_summary:c.error[".tag"]}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 10:return[2]}}))}))}function c(e,t){return r.__awaiter(this,void 0,Promise,(function(){var o,n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,10,,11]),[4,e()];case 1:return"complete"!==(o=r.sent())[".tag"]?[3,2]:[2,{isError:!1,result:o}];case 2:return"other"!==o[".tag"]?[3,3]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 3:n=void 0,r.label=4;case 4:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 5:return r.sent(),[4,t(o.async_job_id)];case 6:n=r.sent(),r.label=7;case 7:if(n&&"in_progress"===n[".tag"])return[3,4];r.label=8;case 8:return"complete"===n[".tag"]?[2,{isError:!1,result:n,jobId:o.async_job_id}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error",jobId:o.async_job_id}];case 9:return[3,11];case 10:return(i=r.sent())&&i.error&&i.error[".tag"]?[2,{isError:!0,error:i.error,error_summary:i.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 11:return[2]}}))}))}t.fileInfoIsFqPathBased=s,t.getFilenameFromActionInfo=a,t.renameFile=function(e,t,s,a){return r.__awaiter(this,void 0,Promise,(function(){var l,c,d,u;return r.__generator(this,(function(r){switch(r.label){case 0:l=n.parent_dir(e.fq_path),c=n.normalize(l)+"/"+t,d=new o.UserApiV2Client,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,d.ns("files").rpc("move_v2",{from_path:e.fq_path,to_path:c,allow_shared_folder:!0,autorename:!0,allow_ownership_transfer:!1,fsw_request:a?{".tag":"confirm",confirm:["action_commit_to_tsd_root"]}:void 0},{subjectUserId:s.id})];case 2:return[2,{isError:!1,result:r.sent()}];case 3:return(u=r.sent())&&u.error&&u.error[".tag"]?[2,{isError:!0,error:u.error,error_summary:u.summary}]:(i.reportException({err:u,severity:"non-critical",tags:["rename-error"]}),[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}]);case 4:return[2]}}))}))},t.undo=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:n=new o.UserApiV2Client,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.ns("files").rpc("undo_batch",{entries:e},{subjectUserId:t.id})];case 2:return[2,{isError:!1,result:r.sent()}];case 3:return(i=r.sent())&&i.error&&i.error[".tag"]?[2,{isError:!0,error:i.error,error_summary:i.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 4:return[2]}}))}))},t.moveFiles=function(e,t,n,i,c){return r.__awaiter(this,void 0,Promise,(function(){var d,u;return r.__generator(this,(function(r){switch(r.label){case 0:return d=new o.UserApiV2Client,u=function(e){var r=t+"/"+a(e);return s(e)?{from_path:e.fq_path,to_path:r}:{from_path:e.id,to_path:r}},[4,l((function(){return d.ns("files").rpc("move_batch_v2",{entries:e.map(u),autorename:!0,allow_ownership_transfer:!!i,fsw_request:c?{".tag":"check"}:void 0},{subjectUserId:n})}),(function(e){return d.ns("files").rpc("move_batch/check_v2",{async_job_id:e},{subjectUserId:n})}))];case 1:return[2,r.sent()]}}))}))},t.copyFiles=function(e,t,i,s){return r.__awaiter(this,void 0,Promise,(function(){var a;return r.__generator(this,(function(r){switch(r.label){case 0:return a=new o.UserApiV2Client,[4,l((function(){return a.ns("files").rpc("copy_batch_v2",{entries:e.map((function(e){return{from_path:e.fq_path,to_path:t+"/"+n.filename(e.fq_path)}})),autorename:!0,fsw_request:s?{".tag":"check"}:void 0},{subjectUserId:i})}),(function(e){return a.ns("files").rpc("copy_batch/check_v2",{async_job_id:e},{subjectUserId:i})}))];case 1:return[2,r.sent()]}}))}))},t.deleteFiles=function(e,t,n){var i;return r.__awaiter(this,void 0,Promise,(function(){var s,a,l;return r.__generator(this,(function(r){switch(r.label){case 0:if(s=new o.UserApiV2Client,1!==e.length||e[0].is_dir)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.ns("files").rpc("delete_v2",{path:e[0].fq_path,fsw_request:n?{".tag":"check"}:void 0},{subjectUserId:t})];case 2:return[2,{isError:!1,result:{changeset_data:(a=r.sent()).changeset_data,entries:[{".tag":"success",metadata:a.metadata}]}}];case 3:return l=r.sent(),(null===(i=null==l?void 0:l.error)||void 0===i?void 0:i[".tag"])?[2,{isError:!1,result:{changeset_data:[],entries:[{".tag":"failure",failure:l.error}]}}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 4:return[4,c((function(){return s.ns("files").rpc("delete_batch",{entries:e.map((function(e){return{path:e.fq_path}})),fsw_request:n?{".tag":"check"}:void 0},{subjectUserId:t})}),(function(e){return s.ns("files").rpc("delete_batch/check",{async_job_id:e},{subjectUserId:t})}))];case 5:return[2,r.sent()]}}))}))},t.createFolder=function(e,t,i,s){return r.__awaiter(this,void 0,Promise,(function(){var a,l;return r.__generator(this,(function(r){switch(r.label){case 0:a=new o.UserApiV2Client,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.ns("files").rpc("create_folder_v2",{path:n.normalize(e)+"/"+t,autorename:!0,fsw_request:s?{".tag":"check"}:void 0},{subjectUserId:i.id})];case 2:return[2,{isError:!1,result:r.sent()}];case 3:return(l=r.sent())&&l.error&&l.error[".tag"]?[2,{isError:!0,error:l.error,error_summary:l.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 4:return[2]}}))}))},t.isFailure=function(e){return"failure"===e[".tag"]},t.isPathLookupFailure=function(e){return"path_lookup"===e[".tag"]}})),define("modules/clean/react/files_view/file_actions/file_from_metadata",["require","exports","tslib","modules/clean/react/browse/models"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fileFromMetadata=function(e,t){if("file"===t[".tag"]){var n=t,i=r.__assign(r.__assign({},e),{fq_path:n.path_display||e.fq_path,icon:n.icon+"_32",revision_id:n.rev,file_id:n.id});return new o.File(i)}return"folder"===t[".tag"]?new o.File(r.__assign(r.__assign({},e),{fq_path:t.path_display||e.fq_path})):e},t.folderFromFolderMetadata=function(e){return new o.File({file_id:e.id,fq_path:e.path_display||"",icon:e.icon,is_dir:!0})}})),define("modules/clean/react/files_view/file_actions/rollback",["require","exports","tslib","modules/clean/react/browse/api","modules/core/i18n"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.rollback=function(e){for(var t=e.changeset_data,r=e.userId,i=e.onSuccess,s={},a=0,l=t;a<l.length;a++){var c=l[a],d=c.ns_id,u=c.op_id,p=parseInt(u.slice(6),10);s.hasOwnProperty(d)?s[d].push(p):s[d]=[p]}o.rollbackChangeSets({changesets:s,onSuccess:i,userId:r,progressText:n.intl.formatMessage({id:"wKzr7W",defaultMessage:"Undoing…"})})}})),define("modules/clean/react/files_view/file_actions/snackbars",["require","exports","modules/core/i18n"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renameError=function(e,t){return"to"===e[".tag"]&&"malformed_path"===e.to[".tag"]?r.intl.formatMessage({id:"rBgywO",defaultMessage:"Name was invalid."}):"from_write"===e[".tag"]&&"team_folder"===e.from_write[".tag"]?r.intl.formatMessage({id:"zqiuDZ",defaultMessage:"Team folders can’t be renamed."}):"from_lookup"===e[".tag"]&&"not_found"===e.from_lookup[".tag"]?r.intl.formatMessage({id:"kdizeA",defaultMessage:"Couldn’t find the file."}):r.intl.formatMessage({id:"pUBm7w",defaultMessage:"Rename failed."})},t.deleteError=function(e,t){return r.intl.formatMessage({id:"pjyJun",defaultMessage:"{count, plural, one{Couldn’t delete {count} item.} other{Couldn’t delete {count} items.}}"},{count:e})},t.deleteCompleteSuccess=function(e,t){return t<e?r.intl.formatMessage({id:"QGz6Gm",defaultMessage:"{count, plural, one{Deleted {succesfully_deleted_files} out of {count} item.} other{Deleted {succesfully_deleted_files} out of {count} items.}}"},{count:e,succesfully_deleted_files:t}):r.intl.formatMessage({id:"THAbub",defaultMessage:"{count, plural, one{Deleted {count} item.} other{Deleted {count} items.}}"},{count:t})},t.deleteCompleteError=function(e){if(1===e.length){var t=e[0].failure;if("too_many_files"===t[".tag"]||"too_many_write_operations"===t[".tag"])return r.intl.formatMessage({id:"ane1pD",defaultMessage:"There are too many files in one request. Please retry with fewer files."});if("path_lookup"===t[".tag"]&&"not_found"===t.path_lookup[".tag"])return r.intl.formatMessage({id:"9suezP",defaultMessage:"File does not exist."})}return r.intl.formatMessage({id:"pjyJun",defaultMessage:"{count, plural, one{Couldn’t delete {count} item.} other{Couldn’t delete {count} items.}}"},{count:e.length})}})),define("modules/clean/react/files_view/file_grouper",["require","exports","modules/core/i18n","modules/clean/datetime","modules/clean/react/browse/constants","modules/clean/react/files_view/types","modules/clean/react/browse/models"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r.intl.formatMessage({id:"RzhnRl",defaultMessage:"Extensionless"}),l=r.intl.formatMessage({id:"DcKHEo",defaultMessage:"Missing dates"}),c=r.intl.formatMessage({id:"GYhJ5f",defaultMessage:"Deleted content isn’t sorted by last modified"});t.EMPTY_SECTIONS={sectionLabels:[],sectionStartIndices:[]},t.getSections=function(e,t,d,u){void 0===u&&(u=!1);var p=[],_=[],f=null;if(t===i.SortField.CATEGORY)e.forEach((function(e,t){if(e){var r=(function(e){return e instanceof s.File?s.File.getCategoryDescription(e,!0):n.ExtensionCategories.DOCUMENT})(e);r!==f&&(p.push(r),_.push(t),f=r)}}));else if(t===i.SortField.EXTENSION)e.forEach((function(e,t){if(e){var r=(function(e){return e instanceof s.File?e.is_dir?n.FileTypeCapitalizedCategoryTranslations.FOLDER:s.File.getExtension(e).toUpperCase():a})(e);if(r!==f){var o=r;""===r&&(o=a),p.push(o),_.push(t),f=r}}}));else if(t===i.SortField.MODIFIED)if(d===i.SortDirection.DESCENDING){var m=o.getTimeBands(Date.now());e.forEach((function(e,t){if(e){var o;if(u&&e instanceof s.File&&e.isDeleted)o=c;else{var n=s.itemTimestampInMs(e);o=n>=m.today?r.intl.formatMessage({id:"JDRaFD",defaultMessage:"Today"}):n>=m.yesterday?r.intl.formatMessage({id:"2iSDDx",defaultMessage:"Yesterday"}):n>=m.thisWeek?r.intl.formatMessage({id:"e3KIPg",defaultMessage:"This week"}):n>=m.lastWeek?r.intl.formatMessage({id:"dsHtkw",defaultMessage:"Last week"}):n>=m.thisMonth?r.intl.formatMessage({id:"G0eFMx",defaultMessage:"This month"}):n>=m.lastMonth?r.intl.formatMessage({id:"nM5Fv4",defaultMessage:"Last month"}):n>=m.lastThreeMonths?r.intl.formatMessage({id:"U7dFRR",defaultMessage:"Three months ago"}):r.intl.formatMessage({id:"Y/NN0h",defaultMessage:"Older"})}o!==f&&(p.push(o),_.push(t),f=o)}}))}else e.forEach((function(e,t){var o;e&&((o=u&&e instanceof s.File&&e.isDeleted?c:s.itemTimestampInMs(e)?r.intl.formatDate(s.itemTimestampInMs(e),{year:"numeric",month:"long"}):l)!==f&&(p.push(o),_.push(t),f=o))}));return{sectionLabels:p,sectionStartIndices:_}}})),define("modules/clean/react/files_view/file_media_actions",["require","exports","tslib","react","classnames","spectrum/media_table","modules/clean/react/app_actions/app_actions_menu","modules/clean/react/extensions/data/types","modules/clean/react/extensions/split_share_button","modules/clean/react/browse/browse_async_modules","modules/clean/react/files_view/files_view_logging","modules/clean/react/files_view/overflow_menu","modules/clean/react/files_view/util","modules/clean/react/files_view/view_file_button","modules/clean/react/vault/lib/browse_utils","modules/clean/web_user_action_events"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n);var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isActionDropdownOpen:!1},t.onSplitShareDropdownOpen=function(){t.logEvent(m.WebUserActionLogEvent.OPEN_SPLITSHARE,m.ActionSourceValue.SPLIT_SHARE),t.onActionDropdownOpen()},t.onExtensionsDropdownOpen=function(){t.logEvent(m.WebUserActionLogEvent.OPEN_EXTENSIONS),t.onActionDropdownOpen()},t.onExtensionClick=function(e){t.logEvent(m.WebUserActionLogEvent.EXTENSIONS_SELECTED,void 0,{extensions_option:e||"unknown"})},t.onActionDropdownOpen=function(){t.setState({isActionDropdownOpen:!0})},t.onActionDropdownClose=function(){t.setState({isActionDropdownOpen:!1})},t.logSplitShareButton=function(e){t.logEvent(m.WebUserActionLogEvent.SHARE,m.ActionSourceValue.SPLIT_SHARE,{splitshare_option:null!=e?e:null}),t.logVaultShareIfInsideVault()},t.logVaultShareIfInsideVault=function(){p.isFile(t.props.file)&&t.props.file.is_in_vault_folder&&f.logShareFromInsideVault(t.props.file.is_dir)},t.logEvent=function(e,r,o){var n=t.props,i=n.isSearchMode,s=n.file,a=n.user;d.logEventWithNumberOfFiles({isSearchMode:i,file:s,user:a,action_surface:m.ActionSurfaceLogValue.CENTER_PANE,action_source:r,extra:o,action:e})},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.arePostTTIModulesLoaded,r=e.canDisplayFolderSizes,d=e.file,f=e.getOverflowMenuActions,m=e.hideViewFileButton,h=e.isCompactMode,g=e.isExtensionsMenuDisabled,S=e.isHovered,E=e.isSearchMode,v=e.isSelectMode,w=e.isSelected,T=e.isSharingDisabled,b=e.onPresentInZoom,I=e.shareButtonLabel,y=e.showShareButton,F=e.showBorders,C=e.thumbStore,O=e.user,A=e.viewportTopOffset,P=e.expEntryPointCopyLink,L=this.props.onOpenFileClick||function(){},D=this.props.onShowShare||function(){},M=(w||h||S)&&!m,R=o.default.createElement(_.ViewFileButton,{isVisible:M,onClick:L,className:n.default({"brws-file-row-view-file-button":!0,"brws-file-row-view-file-button-visible":!!M})}),N=E?"search":"browse";return p.isFswm(d)?o.default.createElement(o.default.Fragment,null,v?o.default.createElement(i.MediaActions,null,R):o.default.createElement(i.MediaActions,null,o.default.createElement(u.FilesViewOverflowMenu,{canDisplayFolderSizes:r,file:d,getOverflowMenuActions:f,showBorders:S||!!F,thumbStore:C,viewportTopOffset:A,onMenuOpen:this.props.logOverflowMenuOpen,ariaHidden:!0}))):v?o.default.createElement(i.MediaActions,null,!T&&!1!==y&&o.default.createElement(l.SplitShareButton,{shareButtonLabel:I,context:{surface:N},file:d,isVisible:!h&&(w||S),onDropdownClose:this.onActionDropdownClose,onDropdownOpen:this.onSplitShareDropdownOpen,onPresentInZoom:b,onShowShare:D,logShareButtonClick:this.logSplitShareButton,user:O,variant:"secondary",useDigButtons:!0,shouldUsePortalPopover:!0}),t&&!T&&o.default.createElement(c.AsyncCopyLinkButton,{visible:!h&&(w||S),user:O,file:d,variant:P}),h||g||!S&&!w?null:o.default.createElement(s.ExtensionsMenu,{file:d,onDropdownClose:this.onActionDropdownClose,onDropdownOpen:this.onExtensionsDropdownOpen,onExtensionClick:this.onExtensionClick,onPresentInZoom:b,telemetryContext:{surface:N},user:this.props.user,triggerType:a.TriggerType.OpacityButton}),R):o.default.createElement(i.MediaActions,null,!T&&!1!==y&&o.default.createElement(l.SplitShareButton,{shareButtonLabel:I,onShowShare:D,logShareButtonClick:this.logSplitShareButton,isVisible:S&&!h||this.state.isActionDropdownOpen,user:O,file:d,onDropdownOpen:this.onSplitShareDropdownOpen,onDropdownClose:this.onActionDropdownClose,onPresentInZoom:b,context:{surface:N},variant:"secondary",useDigButtons:!0,shouldUsePortalPopover:!0}),t&&!T&&o.default.createElement(c.AsyncCopyLinkButton,{visible:S&&!h,user:O,file:d,variant:P}),!g&&(S&&!h||this.state.isActionDropdownOpen)?o.default.createElement(s.ExtensionsMenu,{file:d,onDropdownClose:this.onActionDropdownClose,onDropdownOpen:this.onExtensionsDropdownOpen,onExtensionClick:this.onExtensionClick,onPresentInZoom:b,telemetryContext:{surface:N},user:this.props.user,triggerType:a.TriggerType.OpacityButton}):null,t&&o.default.createElement(u.FilesViewOverflowMenu,{canDisplayFolderSizes:r,file:d,getOverflowMenuActions:f,showBorders:S||!!F,thumbStore:C,viewportTopOffset:A,onMenuOpen:this.props.logOverflowMenuOpen,ariaHidden:!0}))},t})(o.default.PureComponent);t.FileMediaActions=h})),define("modules/clean/react/files_view/file_media_actions_v2",["require","exports","tslib","classnames","react","react-redux","modules/clean/react/files_view/data/selectors/instance_selectors","modules/core/browser_detection"],(function(e,t,r,o,n,i,s,a){"use strict";function l(e){e.stopPropagation()}function c(e){var t,r=e.FilesViewInlineActionBar,i=e.file,s=e.highlighted,c=e.onOverflowMenuToggle,d=o.default("brws-file-row-inline-action-bar",((t={})["brws-file-row-inline-action-bar--safari"]=a.safari,t));return r?n.default.createElement("div",{onClick:l},n.default.createElement(r,{className:d,file:i,highlighted:s,onOverflowMenuToggle:c})):null}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),a=r.__importStar(a),t.FileMediaActionsV2Element=c;t.FileMediaActionsV2=i.connect((function(e,t){return{FilesViewInlineActionBar:s.selectInlineActionBar(e,t)}}))(c)})),define("modules/clean/react/files_view/file_name_cell",["require","exports","tslib","classnames","react","react-redux","spectrum/dimensions","spectrum/media_table","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filename_highlights","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/item_selectors","modules/clean/react/files_view/file_snippets","modules/clean/react/files_view/name_input","modules/clean/react/files_view/star","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/title_bubble","modules/clean/user_education/react/user_education_effect","modules/clean/react/sticky_position","modules/core/i18n","retrieval-components/highlighted-truncated-string","modules/clean/react/selectable_list"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b,I,y,F,C){"use strict";function O(e,t,r,o){if(o&&o>L){var n=(o-L)/t,i=Math.max(r,n-r);return c.Emstring.em_snippet(e,Math.floor(i),.5)}return e}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),u=r.__importStar(u),t.FileSubtitle=function(e){var t=e.file,r=e.renderAsLink,o=void 0===r||r,i=e.showLocation,s=e.user,a=e.containerWidth,c=e.onClick,d=e.focusable,p=e.showFirstTaskSubtitle;if(!w.isFile(t))return n.default.createElement(n.default.Fragment,null,y.intl.formatMessage({id:"cvKw36",defaultMessage:"Shared with you"}));if(p)return n.default.createElement("span",{className:"first-task-content-subtitle"},y.intl.formatMessage({id:"mlMhoU",defaultMessage:"Your existing files moved here."}));if(!i)return null;var _=u.parent_dir(t.fq_path),f="/"===_?l.get_browse_root_name(s):_.slice(1);if(t.is_unmounted)return n.default.createElement(n.default.Fragment,null,y.intl.formatMessage({id:"hY0d5Z",defaultMessage:"not added yet, in {location}"},{location:f}));var m=O(y.intl.formatMessage({id:"yR1l4z",defaultMessage:"in {location}"},{location:f}),P,A,a);if(!o||t.isDeleted)return n.default.createElement(n.default.Fragment,null,m);var h=l.browse_uri_for_fq_path(s,_);return n.default.createElement("a",{className:"brws-file-name-cell-location",href:h.toString(),onClick:c,tabIndex:d?0:-1},m)};var A=6,P=12,L=32,D=function(e){return e instanceof _.FileSharedWithMe},M=(function(e){function i(t){var r=e.call(this,t)||this;return r.handleNameInputSubmit=function(e){r.props.onRenameSubmit&&w.isFile(r.props.file)&&r.props.onRenameSubmit(r.props.file,e)},r.handleNameInputCancel=function(){r.props.onRenameCancel&&w.isFile(r.props.file)&&r.props.onRenameCancel(r.props.file)},r.handleOnClickNameInput=function(e){null==e||e.stopPropagation()},r.handleOnClickName=function(e){r.props.onNameClick(e)},r.handleOnClickLocationLink=function(e){var t=r.props,o=t.file,n=t.onLocationLinkClick,i=!w.shouldHandleClick(e);i||(e.preventDefault(),e.stopPropagation()),n&&w.isFile(o)&&n(o,i)},r.onDragStart=function(e){var t=r.props,o=t.isSelected,n=t.onSelect,i=t.onDragStart;!o&&n&&i&&(n(C.SelectOptions.DEFAULT,v.FilesViewActionSource.ROW_SINGLE_CLICK),i(e))},r._setFilenameRef=function(e){return r._filenameDiv=e},r.onStarClick=function(e){var t=r.props,o=t.file,n=t.onStarClick;n&&w.isFile(o)&&n(o,e)},r.state={shouldShowTooltip:r.shouldShowTooltip(t)},r}return r.__extends(i,e),i.prototype.componentDidUpdate=function(e,t){var r=this.shouldShowTooltip(this.props);r!==t.shouldShowTooltip&&this.setState({shouldShowTooltip:r})},i.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.shouldShowTooltip(e);t!==this.state.shouldShowTooltip&&this.setState({shouldShowTooltip:t})},i.prototype.shouldShowTooltip=function(e){if(D(e.file))return!1;var t=this._filenameDiv,r=u.filename(e.file.fq_path);return!!(e.isTooltipEnabled&&t&&(t.offsetWidth<t.scrollWidth||t.textContent!==r))},i.prototype.renderScreenReaderExtraInfo=function(){var e=[],t=this.props,r=t.file,o=t.isSelected;if(w.isFile(r)&&r.isDeleted&&e.push(y.intl.formatMessage({id:"RBvabN",defaultMessage:"Deleted"})),o&&e.push(y.intl.formatMessage({id:"mpdvwi",defaultMessage:"Selected"})),w.isFile(r)&&r.is_dir&&(r.type===p.FileTypes.SHARED_FOLDER?_.File.isReadOnlySharedFolder(r)?e.push(y.intl.formatMessage({id:"513aYe",defaultMessage:"Read-only shared folder"})):e.push(y.intl.formatMessage({id:"r6q13e",defaultMessage:"Shared folder"})):r.type===p.FileTypes.TEAM_SHARED_FOLDER?_.File.isReadOnlySharedFolder(r)?e.push(y.intl.formatMessage({id:"dNfvWF",defaultMessage:"Read-only team shared folder"})):e.push(y.intl.formatMessage({id:"8zuxGM",defaultMessage:"Team shared folder"})):e.push(y.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"}))),e.length>0)return n.default.createElement("span",{className:"ax-visually-hidden"},""+e.join(" "))},i.prototype.splitTruncatedParts=function(e,t){for(var r=0;r<e.length&&e.charAt(r)===t.charAt(r);)++r;return r===e.length||"…"!==e.charAt(r)?[e]:[e.substring(0,r),e.substring(r+1)]},i.prototype.getHighlightedSpan=function(e,t){var r,o,i=w.getFilename(t),s=this.splitTruncatedParts(e,i);return 1===s.length?w.isFile(t)&&!t.highlight_spans?d.highlightMatchReact(e,t.filename_highlights):d.highlightReactFromHighlightSpans(e,t.highlight_spans):(w.isFile(t)&&!t.highlight_spans?(r=d.highlightMatchReact(i,t.filename_highlights,0,s[0].length),o=d.highlightMatchReact(i,t.filename_highlights,i.lastIndexOf(s[1]))):(r=d.highlightReactFromHighlightSpans(i,t.highlight_spans,0,s[0].length),o=d.highlightReactFromHighlightSpans(i,t.highlight_spans,i.lastIndexOf(s[1]))),n.default.createElement("span",null,r,"…",o))},i.prototype.getHighlightedSpansForHighlightedTruncatedString=function(e,t){if(w.isFile(t)||D(t))return t.highlight_spans?t.highlight_spans.map((function(e){return{string:e.highlight_str,isHighlighted:e.is_highlighted}})):w.isFile(t)&&t.filename_highlights?d.highlightMatchSections(e,t.filename_highlights).map((function(e){return{string:e.text,isHighlighted:e.isHighlighted}})):void 0},i.prototype.renderTitle=function(e){var t=this.props,r=t.file,o=t.renameState,i=t.user,s=t.hrefForFile;if(o===v.RenameState.SAVING_INPUT)return n.default.createElement("span",{role:"status"},y.intl.formatMessage({id:"OefYpa",defaultMessage:"Renaming…"}));var a,l=w.getFilename(r);if(e)a=n.default.createElement(F.HighlightedTruncatedString,{text:l,className:"brws-file-name-element",fontSize:14,availableWidth:e,highlightSpans:this.getHighlightedSpansForHighlightedTruncatedString(l,r),cellBuffer:3});else{var c=O(l,14,3,e);if(a=this.props.showHighlights&&(r.highlight_spans||w.isFile(r)&&r.filename_highlights)?this.getHighlightedSpan(c,r):n.default.createElement("span",null,c),a=n.default.createElement("div",{className:"brws-file-name-element",ref:this._setFilenameRef},a),this.state.shouldShowTooltip){var d=l.length<=f.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH?l:n.default.createElement("div",{className:"brws-file-name-cell-tooltip"},l);a=n.default.createElement(T.TitleBubble,{content:d,position:I.StickyPosition.BOTTOM,className:"list-label__title-bubble"},a)}}if(w.isFile(r)&&s&&!(r.is_unmounted||r.isDeleted)||D(r)){var u=D(r)?r.href:s(i,r);a=n.default.createElement("a",{className:"brws-file-name-cell-filename",href:u,onClick:this.handleOnClickName,tabIndex:this.props.isSelected?0:-1},a)}return this.props.showUserEducationEffects?n.default.createElement(b.UserEducationEffect,{containerName:"FileItemRow",name:this.props.userEducationEffectName||"FileNameLabel",useSpan:!0},a):a},i.prototype.renderContent=function(e){var r,o=void 0===e?{}:e,i=o.width,s=o.hasMediaActions,l=this.props,c=l.file,d=l.renameState,p=l.showLocation,_=l.showSnippets,f=l.shouldShowSubtitle,m=l.snippetRows,h=l.user;if(w.isFile(c)&&d===v.RenameState.PENDING_INPUT){var E=c.is_dir?y.intl.formatMessage({id:"NvVKD7",defaultMessage:"Rename directory…"}):y.intl.formatMessage({id:"NZdYzd",defaultMessage:"Rename file…"});r=n.default.createElement(S.NameInput,{defaultValue:u.filename(c.fq_path),label:E,onClick:this.handleOnClickNameInput,onSubmit:this.handleNameInputSubmit,onCancel:this.handleNameInputCancel,isDir:c.is_dir})}else if(r=[n.default.createElement(a.MediaCellText,{key:"title",highlight:this.props.isHovered},n.default.createElement("div",{className:"brws-file-name-cell-title-container"},this.renderTitle(i),this.renderScreenReaderExtraInfo(),this.renderStar()))],f&&r.push(n.default.createElement(a.MediaCellText,{key:"subtitle",variant:"subtitle"},n.default.createElement(t.FileSubtitle,{containerWidth:i,file:c,onClick:this.handleOnClickLocationLink,renderAsLink:this.props.renderFilenameSubtitleAsLink,showLocation:p,user:h,focusable:this.props.isSelected,showFirstTaskSubtitle:this.props.showFirstTaskSubtitle}))),_){var T=i?{width:s?i-48:i}:void 0;r.push(n.default.createElement(a.MediaCellText,{key:"snippets",variant:"subtitle",style:T},n.default.createElement(g.FileSnippets,{snippets:c.snippets,lineClamp:m})))}return r},i.prototype.renderStar=function(){var e=this.props,t=e.file,r=e.renameState,o=e.user,i=e.showStar,s=e.isMobileMode;return i&&!r?n.default.createElement(E.StarContainer,{item:t,user:o,className:"brws-file-name-cell-star",onStarClick:this.onStarClick,isReadOnly:s,tabIndex:this.props.isSelected?0:-1}):null},i.prototype.render=function(){var e=this,t=this.props,i=t.mediaActions,a=t.file,l=t.fileNameCellWidth,c=t.draggable,d=o.default("brws-file-name-cell-text","brws-vertically-center",{"brws-file-name-cell-text-rename":!!this.props.renameState}),u={className:d,draggable:c,onDragStart:this.onDragStart};return this.props.shouldTruncateMiddleFilename?D(a)&&l?n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"brws-file-name-container"},n.default.createElement("div",r.__assign({},u),this.renderContent({width:l,hasMediaActions:!!i}))),i):n.default.createElement(n.default.Fragment,null,n.default.createElement(s.Dimensions,{className:"brws-file-name-container"},(function(t){var o=t.width;return n.default.createElement("div",{className:"brws-file-name-container"},n.default.createElement("div",r.__assign({},u),e.renderContent({width:l||o,hasMediaActions:!!i})))})),i):n.default.createElement(n.default.Fragment,null,n.default.createElement("div",r.__assign({},u),this.renderContent()),i)},i})(n.default.Component);t.FileNameCellComponent=M;t.FileNameCell=i.connect((function(e,t){return{file:h.selectItemAssertFileOrFileSharedWithMe(e,t),isSelectMode:m.selectHasItemsSelected(e,t),isSelected:h.selectIsItemSelected(e,t),renameState:h.selectRenameState(e,t),renderFilenameSubtitleAsLink:m.selectRenderFilenameSubtitleAsLink(e,t),isMobileMode:m.selectIsMobileMode(e,t),showHighlights:m.selectShouldShowFileNameHighlights(e,t),showLocation:m.selectShouldShowFileNameLocation(e,t),showStar:h.selectShouldShowStar(e,t),showUserEducationEffects:h.selectShouldShowUserEducationEffects(e,t),userEducationEffectName:h.selectUserEducationEffectName(e,t),isTooltipEnabled:h.selectIsTooltipEnabled(e,t),user:m.selectUser(e,t),shouldTruncateMiddleFilename:m.selectArePostTTIModulesLoaded(e,t),showSnippets:h.selectShouldShowSnippets(e,t),snippetRows:h.selectSnippetRows(e,r.__assign(r.__assign({},t),{numVisibleColumns:t.visibleColumns.length})),showFirstTaskSubtitle:h.selectShouldShowFirstTaskSubtitle(e,t),shouldShowSubtitle:h.selectShouldShowSubtitle(e,t)}}))((function(e){return n.default.createElement(M,r.__assign({},e))}))})),define("modules/clean/react/files_view/file_row",["require","exports","tslib","classnames","modules/clean/react/files_view/file_media_actions_v2","react","spectrum/media_table","modules/clean/cloud_docs/constants","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/react/files_view/file_media_actions","modules/clean/react/files_view/file_name_cell","modules/clean/react/files_view/file_row_checkbox","modules/clean/react/files_view/row","modules/clean/react/files_view/thumbnail_media_cell","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/selectable_list","modules/clean/react/sticky_position","modules/clean/react/title_bubble","modules/core/browser","modules/core/exception","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importDefault(i),l=r.__importStar(l),v=r.__importStar(v),w=r.__importStar(w);var b=function(){return i.default.createElement("span",{"aria-hidden":!0},"--")};function I(e){switch(h.isFile(e)?l.split_filename(e.fq_path).ext:e.ext.slice(1)){case a.PaperFileTypes.PAPER:case a.PaperFileTypes.PAPER_TEMPLATE:return!0;default:return!1}}t.isCloudDocProviderStored=I;var y=i.default.lazy((function(){return r.__awaiter(void 0,void 0,void 0,(function(){var t;return r.__generator(this,(function(o){switch(o.label){case 0:return t={},[4,new Promise((function(t,r){e(["modules/clean/react/files_view/folder_size"],t,r)})).then(r.__importStar)];case 1:return[2,(t.default=o.sent().FolderSizeCell,t)]}}))}))})),F=function(e){var t=e.file;return t.is_dir?i.default.createElement(i.default.Suspense,{fallback:i.default.createElement(b,null)},i.default.createElement(y,{file:t},i.default.createElement(b,null))):t.is_cloud_doc&&I(t)?i.default.createElement(b,null):i.default.createElement("span",null,t.size)},C=function(e){return void 0===e?{}:{width:e,minWidth:e,maxWidth:e}},O=function(e){var t=e.file,r=e.mediaActions,o=e.filteredContactName,n=e.isSearchMode,a=e.shouldBubbleSubtitle,l=e.shouldShowModifiedByYou,c=e.width,d=o&&t.agoFromLastActionByUserTs,u=t.is_dir&&!n?void 0:d?t.agoFromLastActionByUserTs:t.ago,p=d?o:t.last_modified_name||void 0,_=p?T.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:p}):!t.is_dir&&l?T.intl.formatMessage({id:"5794tP",defaultMessage:"by you"}):void 0,f=u||i.default.createElement(b,null);return i.default.createElement(s.MediaCell,{className:"brws-file-modified-at-cell",subtitle:a?void 0:_,title:a&&_?i.default.createElement(E.TitleBubble,{content:_,position:S.StickyPosition.BOTTOM},i.default.createElement("span",null,f)):f,style:C(c)},r)},A={topOffset:0,controlsFocusable:!1,logOverflowMenuOpen:function(){},fileToId:function(e){return e.fq_path}},P=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isHoverLocked:!1},t.checkboxTargetRef=i.default.createRef(),t.handleOpenFileClick=function(e){return t.handleOpenNewTabOrNavigate(e,m.FilesViewActionSource.ROW_PREVIEW_ICON)},t.handleTitleClick=function(e){return t.handleOpenNewTabOrNavigate(e,m.FilesViewActionSource.ROW_TITLE)},t.handleOpenNewTabOrNavigate=function(e,r){if(0===e.button){var o=h.hasModifierKey(e);if(o&&"A"===e.currentTarget.tagName)return void e.stopPropagation();e.preventDefault(),e.stopPropagation(),t.onNavigateToItem({openInNewTab:o,actionSource:r})}},t.handleCheckboxTouchTargetClick=function(e){if(!e.defaultPrevented&&!t.props.isCheckboxDisabled&&t.props.onDeselect&&t.props.onSelect){e.preventDefault();var r=t.props.fileToId(t.props.file);t.props.isSelected?t.props.onDeselect(r,e.shiftKey,m.FilesViewActionSource.SINGLE_CHECKBOX):t.props.onSelect(r,e.shiftKey?g.SelectOptions.EXTEND:g.SelectOptions.DEFAULT,m.FilesViewActionSource.SINGLE_CHECKBOX)}},t.onSelect=function(e,r){t.props.onSelect&&t.props.onSelect(t.props.fileToId(t.props.file),e,r)},t.onDeselect=function(e,r){t.props.onDeselect&&t.props.onDeselect(t.props.fileToId(t.props.file),e,r)},t.onNavigateToItem=function(e){var r=e.openInNewTab,o=e.actionSource;if(r){var n=t.props,i=n.file,s=n.user,a=n.hrefForFile;v.open_tab(a(s,i))}else t.props.onNavigateToFileOrFolder(t.props.file,{actionSource:o})},t.onDragEnter=function(e){var r=t.props,o=r.file,n=r.isSelected,i=r.isActiveDropTarget;t.props.onDragEnter(e,o,!!n,!!i)},t.onDragStart=function(e){var r=t.props,o=r.file,n=r.isSelected,i=r.onDragStart;i&&(n?i(e):i(e,[o]))},t.getCheckboxNode=function(){return t.checkboxTargetRef.current&&t.checkboxTargetRef.current.querySelector("input")},t.onShowShare=function(){t.props.onShowShare(t.props.file,"BROWSE_FILE_ROW")},t.onPresentInZoom=function(){t.props.onPresentInZoom&&t.props.onPresentInZoom(t.props.file)},t.handleOverflowMenuToggle=function(e){var r=e.isOpen;t.setState({isHoverLocked:r})},t.getAriaLabelForColumn=function(e,t){switch(e.sortField){case m.SortField.FILENAME:return e.label+" "+l.filename(t.fq_path);case m.SortField.MODIFIED:return e.label+" "+t.ago;case m.SortField.CATEGORY:return e.label+" "+c.File.getCategoryDescription(t);case m.SortField.EXTENSION:return e.label+" "+c.File.getExtension(t);case m.SortField.SIZE:return e.label+" "+t.size;case m.SortField.SHARED_WITH:default:return}},t}return r.__extends(t,e),t.prototype.componentDidUpdate=function(e){if(this.props.isFocused&&!e.isFocused||this.props.isFocused&&this.props.isSelected&&!e.isSelected){var t=this.getCheckboxNode();t&&t.focus()}},t.prototype.renderCell=function(e){var t=e.isHovered,r=e.isLastCell,o=e.sortField,a=e.renderCell,l=e.isKeyboardFocused,p=this.props,_=p.instanceId,h=p.listId,g=p.itemIndex,S=p.rowIndex,E=p.fileToId,v=p.visibleColumns,T=p.containerWidth,I=p.height,y=p.arePostTTIModulesLoaded,A=p.canDisplayFolderSizes,P=p.extensionsFeatureFlags,L=p.file,D=p.getOverflowMenuActions,M=p.hideViewFileButton,R=p.hrefForFile,N=p.isCompactMode,x=p.isExtensionsMenuDisabled,k=p.isSearchMode,U=p.isSelectMode,V=p.isSelected,H=p.isSharingDisabled,B=p.onLocationLinkClick,W=p.onRenameCancel,G=p.onRenameSubmit,q=p.onStarClick,z=p.renameState,j=p.shareButtonLabel,K=p.sharingServiceInfo,Y=p.showShareButton,Q=p.thumbStore,X=p.user,J=p.viewportTopOffset,Z=p.filteredContactName,$=p.logOverflowMenuOpen,ee=p.showCDMUserEducationEffects,te=p.expEntryPointCopyLink,re=p.iconSize,oe=p.isCondensedListView,ne=p.isActionBarEnabled,ie=p.columnSizes,se=r&&!(N&&z)?ne?t&&!N?i.default.createElement(n.FileMediaActionsV2,{instanceId:_,file:L,highlighted:V,onOverflowMenuToggle:this.handleOverflowMenuToggle}):void 0:i.default.createElement(d.FileMediaActions,{arePostTTIModulesLoaded:y,canDisplayFolderSizes:A,extensionsFeatureFlags:P,file:L,getOverflowMenuActions:D,hideViewFileButton:M,isCompactMode:!!N,isExtensionsMenuDisabled:!!x,isHovered:t,isSearchMode:!!k,isSelectMode:!!U,isSelected:!!V,isSharingDisabled:!!H,onOpenFileClick:this.handleOpenFileClick,onPresentInZoom:this.onPresentInZoom,onShowShare:this.onShowShare,shareButtonLabel:j,sharingServiceInfo:K,showShareButton:Y,showBorders:l,thumbStore:Q,user:X,viewportTopOffset:J,logOverflowMenuOpen:$,expEntryPointCopyLink:te}):void 0;if(a)return a({file:L,mediaActions:se});var ae=null==ie?void 0:ie[o];switch(o){case m.SortField.FILENAME:return i.default.createElement(f.ThumbnailMediaCell,{file:L,thumbStore:Q,height:I,width:ae,showCDMUserEducationEffects:ee,iconSize:re},i.default.createElement(u.FileNameCell,{key:"fileName",instanceId:_,listId:h,itemIndex:g,rowIndex:S,isHovered:t,fileToId:E,visibleColumns:v,containerWidth:T,mediaActions:se,onLocationLinkClick:B,onRenameCancel:W,onRenameSubmit:G,onStarClick:q,hrefForFile:R,onNameClick:this.handleTitleClick,onSelect:this.onSelect,onDragStart:this.onDragStart,draggable:!U}));case m.SortField.RELEVANCE:case m.SortField.MODIFIED:return i.default.createElement(O,{key:"modified",file:L,mediaActions:se,filteredContactName:Z,isSearchMode:Boolean(k),shouldBubbleSubtitle:oe,shouldShowModifiedByYou:Boolean(oe||k),width:ae});case m.SortField.SHARED_WITH:return i.default.createElement(s.MediaCell,{className:"brws-file-shared-with-cell",key:"sharedWith",style:C(ae)},this.props.renderSharedWithController(L,this.props.isSelected?0:void 0),se);case m.SortField.CATEGORY:return i.default.createElement(s.MediaCell,{className:"brws-file-category-cell",key:"category",title:c.File.getCategoryDescription(L),style:C(ae)},se);case m.SortField.EXTENSION:return i.default.createElement(s.MediaCell,{className:"brws-file-extension-cell",key:"extension",title:c.File.getExtension(L),style:C(ae)},se);case m.SortField.SIZE:return i.default.createElement(s.MediaCell,{className:"brws-file-size-cell",key:"size",title:i.default.createElement(F,{file:L}),style:C(ae)},se);case m.SortField.LOCKED_FILES:return i.default.createElement(s.MediaCell,{className:"brws-file-size-cell",key:"locked_files",title:"",style:C(ae)},se);default:return w.reportException({err:new Error("renderCell function for "+o+"is not implemented"),severity:w.SEVERITY.NONCRITICAL,tags:["js:browse"]}),i.default.createElement(b,null)}},t.prototype.render=function(){var e=this,t=this.props,n=t.file,a=t.fileToId,l=t.instanceId,d=t.isActiveDropTarget,u=t.isPinned,f=t.isSearchMode,m=t.isSelectMode,h=t.isSelected,g=t.itemIndex,S=t.listId,E=t.onDeselect,v=t.onSelect,w=t.renameState,T=t.rowIndex,b=t.topOffset,I=t.visibleColumns,y=t.isCutToClipboard,F=this.state.isHoverLocked,C="";return I.forEach((function(t){var r=e.getAriaLabelForColumn(t,n);r&&(C+=r+", ")})),i.default.createElement(_.FilesViewRow,{componentType:u?"MediaRow":"CulledMediaRow",className:o.default({"brws-file-row-no-access":c.File.isNoAccessSharedFolder(n),"brws-file-row-pinned":u,"brws-file-row-hover-forced":F,"brws-file-row-cut":y}),isActiveDropTarget:d,isSelected:h,isDeleted:n.isDeleted,isDraggable:!w&&!f&&!c.File.isTeamMemberFolder(n)&&!c.File.isReadOnlySharedFolder(n)&&!c.File.isNoAccessSharedFolder(n)&&h,topOffset:b,rowIndex:T,isSelectMode:m,filename:String(n.fq_path.split("/").slice(-1)),ariaLabel:C,onSelect:this.onSelect,onDeselect:this.onDeselect,onNavigateToItem:this.onNavigateToItem,onDragEnter:this.onDragEnter,onDragStart:this.onDragStart},(function(t){var o=t.isHovered,n=t.isKeyboardFocused;return o=o||F,r.__spreadArrays([i.default.createElement(s.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},i.default.createElement("div",{ref:e.checkboxTargetRef,className:"brws-vertically-center brws-file-row-checkbox-target",onClick:e.handleCheckboxTouchTargetClick,"aria-controls":"brws-sidebar-view"},i.default.createElement(p.FileRowCheckbox,{instanceId:l,listId:S,itemIndex:g,rowIndex:T,isHovered:o,fileToId:a,onSelect:v,onDeselect:E})))],I.map((function(t,r){return e.renderCell({isHovered:o,isLastCell:r===I.length-1,sortField:t.sortField,renderCell:t.renderCell,isKeyboardFocused:n})})))}))},t.defaultProps=A,t})(i.default.PureComponent);t.FileRow=P})),define("modules/clean/react/files_view/file_row_checkbox",["require","exports","tslib","react","react-redux","dig-components/controls","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/item_selectors","modules/clean/react/files_view/data/selectors/list_selectors","modules/clean/react/files_view/types","modules/clean/react/selectable_list","modules/clean/user_education/react/user_education_effect","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.FileRowCheckboxComponent=function(e){var t=e.shouldRenderCheckboxes,r=e.isSelected,n=e.isDisabled,s=e.shouldShowUserEducationEffects,a=e.isCheckboxVisible;if(!t)return null;var l=a?o.default.createElement(i.Checkbox,{disabled:n,checked:r,onClick:function(t){t.stopPropagation();var r=e.onSelect,o=e.onDeselect,n=e.selectionId;r&&o&&(t.currentTarget.checked?r(n,t.shiftKey?d.SelectOptions.EXTEND:d.SelectOptions.DEFAULT,c.FilesViewActionSource.SINGLE_CHECKBOX):o(n,t.shiftKey,c.FilesViewActionSource.SINGLE_CHECKBOX))},onChange:function(e){},"aria-label":p.intl.formatMessage({id:"sJRsRx",defaultMessage:"Select item"}),tabIndex:r?0:-1}):null;return s?o.default.createElement(u.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox",useSpan:!0},l||o.default.createElement("div",{style:{width:20,height:20}})):l};t.FileRowCheckbox=n.connect((function(e,t){return{isCheckboxDisabled:s.selectDisabledMultiselect(e,t),isCheckboxVisible:a.selectIsCheckboxVisible(e,t),isSelected:a.selectIsItemSelected(e,t),shouldRenderCheckboxes:l.selectShouldRenderCheckboxes(e,t),shouldShowUserEducationEffects:a.selectShouldShowUserEducationEffects(e,t),isDisabled:s.selectDisabledMultiselect(e,t),selectionId:a.selectItemSelectionId(e,t)}}))(t.FileRowCheckboxComponent)})),define("modules/clean/react/files_view/file_shared_with_me_row",["require","exports","tslib","classnames","react","react-dom","dig-components/controls","spectrum/media_table","spectrum/util/raf_throttle","modules/clean/react/files_view/file_media_actions","modules/clean/react/files_view/file_name_cell","modules/clean/react/files_view/file_row","modules/clean/react/files_view/row","modules/clean/react/files_view/thumbnail_media_cell","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/selectable_list","modules/clean/user_education/react/user_education_effect","modules/core/browser","modules/core/exception","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),i=r.__importStar(i),S=r.__importStar(S),E=r.__importStar(E);var w=function(){return n.default.createElement("span",{"aria-hidden":!0},"--")},T=function(e){var t=e.file;return t.is_cloud_doc&&u.isCloudDocProviderStored(t)?n.default.createElement(w,null):n.default.createElement("span",null,t.size)},b=(function(e){function t(t){var r=e.call(this,t)||this;return r.setRef=function(e){r.brwsFilenameContainerDiv=e},r.checkboxRef=null,r.handleWindowResize=function(){r.throttledWindowResize.request()},r.handleResize=function(){if(r.brwsFilenameContainerDiv){var e=r.state.brwsFilenameContainerDivWidth,t=r.brwsFilenameContainerDiv.getBoundingClientRect().width;t&&t!==e&&r.setState({brwsFilenameContainerDivWidth:t})}},r.handleOpenFileClick=function(e){return r.handleOpenNewTabOrNavigate(e,f.FilesViewActionSource.ROW_PREVIEW_ICON)},r.handleTitleClick=function(e){return r.handleOpenNewTabOrNavigate(e,f.FilesViewActionSource.ROW_TITLE)},r.handleOpenNewTabOrNavigate=function(e,t){0===e.button&&(e.preventDefault(),e.stopPropagation(),r.onNavigateToItem({openInNewTab:m.hasModifierKey(e),actionSource:t}))},r.onSelect=function(e,t){r.props.onSelect&&r.props.onSelect(r.props.file.file_id,e,t)},r.onDeselect=function(e,t){r.props.onDeselect&&r.props.onDeselect(r.props.file.file_id,e,t)},r.onNavigateToItem=function(e){var t=e.openInNewTab,o=e.actionSource;t?S.open_tab(r.props.file.href):r.props.onOpenFileSharedWithMe(r.props.file,{actionSource:o})},r.getCheckboxNode=function(){return r.checkboxRef&&i.findDOMNode(r.checkboxRef)},r.isCheckboxNode=function(e){var t=r.getCheckboxNode();return!!t&&t.contains(e)},r.handleCheckboxChange=function(e){},r.handleCheckboxClick=function(e){e.stopPropagation();var t=r.props,o=t.onSelect,n=t.onDeselect,i=t.file;o&&n&&(e.currentTarget.checked?o(i.file_id,e.shiftKey?h.SelectOptions.EXTEND:h.SelectOptions.DEFAULT,f.FilesViewActionSource.SINGLE_CHECKBOX):n(i.file_id,e.shiftKey,f.FilesViewActionSource.SINGLE_CHECKBOX))},r.setCheckboxRef=function(e){r.checkboxRef=e},r.handleCheckboxTouchTargetClick=function(e){if(r.shouldHandleClick(e)){if(!r.props.isCheckboxDisabled&&r.props.onDeselect&&r.props.onSelect){e.preventDefault();var t=r.props.file.file_id;r.props.isSelected?r.props.onDeselect(t,e.shiftKey,f.FilesViewActionSource.SINGLE_CHECKBOX):r.props.onSelect(t,e.shiftKey?h.SelectOptions.EXTEND:h.SelectOptions.DEFAULT,f.FilesViewActionSource.SINGLE_CHECKBOX)}}else e.preventDefault()},r.renderCheckbox=function(e){var t=r.props,i=t.isCompactMode,a=t.isSelectMode,l=t.isSelected,c=t.showUserEducationEffects,d=null;return d=!(e||l||a||i)?null:n.default.createElement(s.Checkbox,{disabled:r.props.isCheckboxDisabled,checked:!!l,className:o.default("brws-checkbox",{"brws-checkbox-checked":l}),onChange:r.handleCheckboxChange,onClick:r.handleCheckboxClick,ref:r.setCheckboxRef,"aria-label":v.intl.formatMessage({id:"sJRsRx",defaultMessage:"Select item"}),tabIndex:l?0:-1}),c&&(d=n.default.createElement(g.UserEducationEffect,{containerName:"FileSharedWithMeRow",name:"FirstFileSelectCheckbox",useSpan:!0},d||n.default.createElement("div",{style:{width:20,height:20}}))),d},r.state={brwsFilenameContainerDivWidth:void 0},r.throttledWindowResize=new l.RafThrottle((function(){return r.handleResize()})),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.handleResize(),window.addEventListener("resize",this.handleWindowResize)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.handleWindowResize)},t.prototype.componentDidUpdate=function(e){var t=this;(this.props.isFocused&&!e.isFocused||this.props.isFocused&&this.props.isSelected&&!e.isSelected)&&this.checkboxRef&&Promise.resolve().then((function(){var e=t.getCheckboxNode();e&&e.focus()}))},t.prototype.renderModifiedCell=function(e,t,r){var o=r&&e.agoFromLastActionByUserTs,i=o?e.agoFromLastActionByUserTs:e.ago,s=o?r:e.last_modified_name||void 0,l=s?v.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:s}):v.intl.formatMessage({id:"5794tP",defaultMessage:"by you"});return n.default.createElement(a.MediaCell,{className:"brws-file-modified-at-cell",key:"modifiedAt",subtitle:l,title:i||n.default.createElement(w,null)},t)},t.prototype.renderCell=function(e){var t=e.isHovered,o=e.isKeyboardFocused,i=e.sortField,s=e.isLastCell,l=this.props,u=l.arePostTTIModulesLoaded,p=l.file,m=l.getOverflowMenuActions,h=l.thumbStore,g=l.isCompactMode,S=l.isSelectMode,v=l.isSelected,b=l.responsive,I=l.user,y=l.showSnippets,F=l.snippetRows,C=l.height,O=l.filteredContactName,A=l.logOverflowMenuOpen,P=l.iconSize,L=m(p,!1).some((function(e){return e.length>0})),D=s&&!g&&u&&L?n.default.createElement(c.FileMediaActions,{arePostTTIModulesLoaded:u,canDisplayFolderSizes:!1,file:p,getOverflowMenuActions:m,isCompactMode:!!g,isHovered:t,isSearchMode:!0,isSelectMode:!!S,isSelected:!!v,isSharingDisabled:!0,showBorders:o,thumbStore:h,user:I,onOpenFileClick:this.handleOpenFileClick,logOverflowMenuOpen:A}):void 0;switch(i){case f.SortField.FILENAME:var M={file:p,isHovered:t,isSelectMode:!!S,isSelected:!!v,isMobileMode:!b.isMatchedLarge&&!b.isMatchedMedium,user:I,mediaActions:D,shouldTruncateMiddleFilename:u,showHighlights:!0,showLocation:!0,showStar:!1,showSnippets:!!y,snippetRows:F,onNameClick:this.handleTitleClick,renameState:void 0,renderFilenameSubtitleAsLink:!1,showUserEducationEffects:!1,userEducationEffectName:"",isTooltipEnabled:!1,showFirstTaskSubtitle:!1,shouldShowSubtitle:!0,draggable:!1},R=this.state.brwsFilenameContainerDivWidth;return n.default.createElement("div",{className:"brws-file-name-container",ref:this.setRef},n.default.createElement(_.ThumbnailMediaCell,{file:p,thumbStore:h,height:C,iconSize:P},n.default.createElement(d.FileNameCellComponent,r.__assign({},M,{fileNameCellWidth:R?R-64:void 0}))));case f.SortField.RELEVANCE:case f.SortField.MODIFIED:return this.renderModifiedCell(p,D,O);case f.SortField.SIZE:return n.default.createElement(a.MediaCell,{className:"brws-file-size-cell",key:"size",title:n.default.createElement(T,{file:p})},D);default:case f.SortField.CATEGORY:case f.SortField.EXTENSION:case f.SortField.SHARED_WITH:return E.reportException({err:new Error("FileSharedWithMe.renderCell is not implemented for "+i),severity:E.SEVERITY.NONCRITICAL,tags:["js:search"]}),n.default.createElement(a.MediaCell,{key:i,title:n.default.createElement(w,null)})}},t.prototype.shouldHandleClick=function(e){return!e.defaultPrevented&&!this.isCheckboxNode(e.target)},t.prototype.render=function(){var e=this,t=this.props,o=t.rowIndex,i=t.topOffset,s=t.isSelected,l=t.isSelectMode,c=t.visibleColumns;return n.default.createElement(p.FilesViewRow,{componentType:"CulledMediaRow",className:"brws-filesharedwithme-row",isSelected:s,topOffset:i,rowIndex:o,isSelectMode:l,onSelect:this.onSelect,onDeselect:this.onDeselect,onNavigateToItem:this.onNavigateToItem},(function(t){var o=t.isHovered,i=t.isKeyboardFocused;return r.__spreadArrays([n.default.createElement(a.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},n.default.createElement("div",{className:"brws-vertically-center brws-file-row-checkbox-target",onClick:e.handleCheckboxTouchTargetClick},e.renderCheckbox(o)))],c.map((function(t,r){return e.renderCell({isHovered:o,isKeyboardFocused:i,sortField:t.sortField,isLastCell:r===c.length-1})})))}))},t})(n.default.PureComponent);t.FileSharedWithMeRow=b})),define("modules/clean/react/files_view/file_snippets",["require","exports","tslib","react","modules/clean/filename_highlights","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/list_selectors"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n);var a=(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(n,e),n.prototype.render=function(){var e=this.props,r=e.snippets,n=e.lineClamp,a={maxHeight:i.SNIPPET_HEIGHT_PER_ROW*n,WebkitLineClamp:n},l=s.getFirstValidSnippet(r);return l?o.default.createElement("span",{className:"brws-file-snippets",style:a},o.default.createElement(t.FileSnippet,{snippet:l})):null},n.defaultProps={lineClamp:3},n})(o.default.PureComponent);t.FileSnippets=a,t.FileSnippet=function(e){var t=e.snippet;return n.highlightReactFromAllHighlightSpans(t.highlight_spans||[])}})),define("modules/clean/react/files_view/files_view",["require","exports","tslib","classnames","external/lodash","immutable","react","react-dom","react-redux","spectrum/media_table_skeleton","spectrum/table","modules/clean/photos/thumb_loading/buffered_thumb_store","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react/browse/action_logger","modules/clean/react/browse/models","modules/clean/react/files_view/column_header","modules/clean/react/files_view/column_manager","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/column_headers/dig_column_header","modules/clean/react/files_view/drag_drop/drag_and_drop","modules/clean/react/files_view/drag_drop/internal_drag_status","modules/clean/react/files_view/file_list_empty_folder_table","modules/clean/react/files_view/files_view_logging","modules/clean/react/files_view/list","modules/clean/react/files_view/pinned_team_folder_view","modules/clean/react/files_view/scroll_updater","modules/clean/react/files_view/tile_grid","modules/clean/react/files_view/types","modules/clean/react/icon/file_folder_icon","modules/clean/react/selectable_list","modules/clean/sharing/access_level","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/browser_detection","modules/core/i18n","modules/core/notify","modules/clean/react/files_view/drag_drop/drag_to_select","modules/clean/react/files_view/data/selectors/files_view_selectors"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w,T,b,I,y,F,C,O,A,P,L,D,M,R,N,x,k,U,V,H){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),i=r.__importStar(i),s=r.__importDefault(s),a=r.__importStar(a),R=r.__importStar(R);var B=function(){},W=[D.NameSpaceAccess.ACCESS_NO_ACCESS,D.NameSpaceAccess.ACCESS_READER,D.NameSpaceAccess.ACCESS_READER_NO_COMMENT],G={keyboard:A.FilesViewActionSource.KEYBOARD,drag_to_select:A.FilesViewActionSource.DRAG_TO_SELECT};function q(e){return e.some(z)}function z(e){return e instanceof f.File||e instanceof f.FileSharedWithMe}t.getShouldShowSelectAllCheckbox=q;function j(e,t){return e&&t&&e.currentFQPath!==t.currentFQPath}function K(e,t){return e!==t}var Y=(function(t){function l(){var e=null!==t&&t.apply(this,arguments)||this;return e.internalDragStatusRef=s.default.createRef(),e.gridViewPrewarmedThumbnailRequestIds=[],e.state={thumbStore:new u.BufferedThumbStore,dropTarget:null,tilesPerRow:1},e.handleCopyToClipboard=function(){var t=e.props,r=t.selectedFiles,o=t.onSetClipboard;r.size&&o({files:r.toArray(),action:"copy"})},e.handleCutToClipboard=function(){var t=e.props,r=t.selectedFiles,o=t.onSetClipboard,n=t.isCutActionEnabled,i=r.filter((function(e){return!e.read_only}));n&&i.size&&o({files:i.toArray(),action:"cut"})},e.handleNewFolderSubmit=function(t){""===t?(e.props.onNewFolderCancel(),e.handleNewFolderCancel({source:A.NameInputActionSource.SUBMIT})):e.props.onNewFolderSubmit(t)},e.handleNewFolderCancel=function(t){t.source!==A.NameInputActionSource.ESC&&U.Notify.error(k.intl.formatMessage({id:"9xXIAi",defaultMessage:"Please provide a name for the new folder."})),e.props.onNewFolderCancel()},e.handleSetFileUploaderPath=function(t){var r=t?t.path:e.props.path,o=e.props.context.isCurrentPathWriteable();t&&t.hasOwnProperty("hasPermissionToUploadToFolder")&&(o=!!t.hasPermissionToUploadToFolder);var n=!!(null==t?void 0:t.isMovingIntoVault);e.props.setFileUploaderPath({path:r,hasPermissionToUploadToFolder:o,isMovingIntoVault:n})},e.handleDragStart=function(t,o){var i;void 0===o&&(o=[]);var s=e.props,l=s.path,c=s.selectedFiles,d=s.user,u=n.keyBy(o,"fq_path");u=r.__assign(r.__assign({},u),c.toJS());var p=n.values(u);if(p.some((function(e){return f.File.isTeamSharedFolder(e)})))U.Notify.error(k.intl.formatMessage({id:"1cIg3V",defaultMessage:"Team folders can’t be moved."}));else if(p.some((function(e){return f.File.isTeamMemberFolder(e)})))U.Notify.error(k.intl.formatMessage({id:"ZxTpZJ",defaultMessage:"Your member folder can’t be moved."}));else{var _=t.dataTransfer;if(_){if(_.setDragImage&&(null===(i=e.internalDragStatusRef)||void 0===i?void 0:i.current)){var m=a.findDOMNode(e.internalDragStatusRef.current);m&&_.setDragImage(m,-10,-10)}_.setData(x.INTERNAL_FILE_DATA_TRANSFER_TYPE,JSON.stringify({userId:d.id,fromPath:l,filePaths:p.map((function(e){return e.fq_path}))})),_.effectAllowed="copyMove"}}},e.handleDragEnter=function(t,r,o,n){w.onFileDragEnterItem(r,!!e.props.isDraggingExternalFiles,!!e.props.isDraggingInternalFiles,o,n,e.props.context,e.handleSetDropTarget,e.handleSetFileUploaderPath)},e.handleSetDropTarget=function(t){e.setState({dropTarget:t}),e.props.updateDropTarget&&e.props.updateDropTarget(t)},e.handleSelectionChange=function(t,r){M.UEClient.sendEvent("FileItemRow","CheckboxToggled");var o=r?r in L.SelectableListActionSource?G[r]:r:void 0;e.props.onSelectionChange(t,o)},e.onAllCheckboxDeselectAll=function(){var t=e.props,r=t.selection;(0,t.onSelectionChange)(r.set("selected",i.OrderedSet()),A.FilesViewActionSource.ALL_CHECKBOX)},e.onAllCheckboxSelectAll=function(){var t=e.props,r=t.items,o=t.selection;(0,t.onSelectionChange)(o.set("selected",i.OrderedSet(r.filter(z).map((function(t){return"fq_path"in t?e.props.fileToId(t):t.file_id})))),A.FilesViewActionSource.ALL_CHECKBOX)},e._handleGetOverflowMenuActions=function(t,r){var o=e.props;return(0,o.getOverflowMenuActions)(t,r,o.responsive)},e.handleTTI=function(){e.props.onComponentTTI("FilesViewController")},e.getIsCurrentPathWriteable=function(){return e.props.context.isCurrentPathWriteable()},e.onTilesPerRowChange=function(t){e.setState({tilesPerRow:t})},e.onDeselectAll=function(){e.props.isSearchMode&&e.props.onFocusSearchBar()},e.logRightClick=function(t){var r=e.props,o=r.selectedFiles,n=r.user,i=r.viewType,s=o?o.count((function(e){return e.is_dir})):0,a=o?o.count()-s:0;_.logRightClickItems({uid:n.id,viewType:i,action_surface:N.ActionSurfaceLogValue.CENTER_PANE,numFilesSelected:a,numFoldersSelected:s})},e}return r.__extends(l,t),l.prototype.componentDidMount=function(){var e=this;this.setupUnity(),M.UEClient.registerForAllEducationSteps((function(t){t.step&&t.step.effect&&["FileItemRow","PinnedTeamFolder","PathBreadcrumbs"].includes(t.step.effect.containerName)&&e.props.onSwitchViewType(A.ViewType.List)})),R.waitForTTI().then((function(){e.prewarmGridViewThumbStore()}))},l.prototype.UNSAFE_componentWillReceiveProps=function(e){if(j(e.context,this.props.context)){this.undoPrewarmGridViewThumbStore();var t=this.props.arePostTTIModulesLoaded?new p.GenericThumbStore:new u.BufferedThumbStore;this.setState({thumbStore:t})}},l.prototype.shouldComponentUpdate=function(e){return e.loadingState!==this.props.loadingState||e.loadingState!==A.LoadingState.LOADING_FIRST_PAGE||!(!j(e.context,this.props.context)&&!K(e.items,this.props.items))},l.prototype.componentDidUpdate=function(e){j(this.props.context,e.context)&&this.prewarmGridViewThumbStore(),this.props.enableUnity&&this.triggerUnityChangeCallback&&K(this.props.items,e.items)&&this.triggerUnityChangeCallback()},l.prototype.componentWillUnmount=function(){this.triggerUnityChangeCallback=void 0},l.prototype.setupUnity=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,o=this;return r.__generator(this,(function(n){switch(n.label){case 0:return[4,R.waitForTTI()];case 1:return n.sent(),[4,new Promise((function(t,r){e(["modules/clean/unity_browse_interface"],t,r)})).then(r.__importStar)];case 2:return t=n.sent().default,this.triggerUnityChangeCallback=function(){null==t||t.browse_visible_change_callback(o.props.items.toArray(),o.props.user.id,0,o.props.items.size-1)},[2]}}))}))},l.prototype.prewarmGridViewThumbStore=function(){var e=this;if(this.props.viewType!==A.ViewType.Grid){var t=this.state.thumbStore;this.props.items.slice(0,100).forEach((function(r){if(r instanceof f.File||r instanceof f.FileSharedWithMe){var o=P.getThumbnailUrlForItem(r.thumbnail_url_tmpl,g.ViewTypeThumbnailSizes[A.ViewType.Grid]);if(o){var n=t.bind_url(o,{onSuccess:B});n&&e.gridViewPrewarmedThumbnailRequestIds.push(n)}}}))}},l.prototype.undoPrewarmGridViewThumbStore=function(){var e=this;this.gridViewPrewarmedThumbnailRequestIds.length&&(this.gridViewPrewarmedThumbnailRequestIds.forEach((function(t){e.state.thumbStore.unbind_url(t)})),this.gridViewPrewarmedThumbnailRequestIds=[])},l.prototype.renderEmptyFolderView=function(){var e=this.props,t=e.context,r=e.customEmptyFolderView,o=e.responsive,n=e.onFocusSearchBar,i=e.onPasteFromClipboard,a=e.onNavigateToParentFolder;if(r)return r(o);var l=t.isInsideSharedFolder,c=t.currentSharedFolderPermissionRole,d=l&&W.includes(c)?void 0:k.intl.formatMessage({id:"jXqkXG",defaultMessage:"Drag and drop files onto this window to upload."});return s.default.createElement(b.EmptyFolderTable,{title:k.intl.formatMessage({id:"YLBqRL",defaultMessage:"This folder is empty"}),subtitle:d,onTTI:this.handleTTI,onFocusSearchBar:n,onPasteFromClipboard:i,onNavigateToParentFolder:a,onOpenKeyboardShortcutModal:this.props.openKeyboardShortcutsModal})},l.prototype.getSelectAllCheckboxCheckedVariant=function(){var e=this.props,t=e.selectedFiles,r=e.items,o="unchecked";return t.size===r.filter(z).size?o="checked":t.size&&(o="mixed"),o},l.prototype.isCreateFolderUIActive=function(){var e=this.props.createNewFolderState;return e&&"CREATE_FOLDER_INACTIVE"!==e},l.prototype.shouldShowEmptyFolderView=function(){return this.props.loadingState===A.LoadingState.LOADED&&!this.props.items.size&&!this.isCreateFolderUIActive()},l.prototype.render=function(){var e=this,t=this.props,n=t.id,i=t.onDelete,a=t.onShowRename,l=t.onRenameSubmit,u=t.onRenameCancel,p=t.onSwitchViewType,_=t.onPasteFromClipboard,f=t.onColumnsChanged,S=t.onCanDisplayFolderSizesChanged,E=t.onFocusSearchBar,w=t.currentSort,b=t.createNewFolderState,P=t.context,D=t.columns,M=t.dropTargetHighlightMode,R=t.fileRename,x=t.getIsFileJumping,k=t.onAddFileJumpKeyCode,U=t.onResetFileJump,H=t.hideViewFileButton,B=t.items,W=t.itemIds,G=t.isCompactMode,z=t.isSearchMode,j=t.isDraggingExternalFiles,K=t.isDraggingInternalFiles,Y=t.isQueryingFolderSizes,Q=t.isFileViewerShown,X=t.loadingState,J=t.onSortChange,Z=t.path,$=t.responsive,ee=t.selectedFiles,te=t.selection,re=t.shouldShowPinnedTeamFolders,oe=t.renderSharedWithController,ne=t.onShowShare,ie=t.onPresentInZoom,se=t.teamFolders,ae=t.totalNumFiles,le=t.user,ce=t.viewType,de=t.viewTypes,ue=t.viewTypeLabels,pe=t.viewTypeColumns,_e=t.onLocationLinkClick,fe=t.onNavigateToFileOrFolder,me=t.onNavigateToParentFolder,he=t.onOpenFileSharedWithMe,ge=t.onOpenPaper,Se=t.arePostTTIModulesLoaded,Ee=t.onStarClick,ve=t.extensionsFeatureFlags,we=t.scrollContainer,Te=t.sharingServiceInfo,be=t.stickyOffsetTop,Ie=t.disabledMultiselect,ye=t.isStickyColumnHeader,Fe=t.onRangeInView,Ce=t.highDensity,Oe=t.filteredContactName,Ae=t.sections,Pe=t.preferredColumns,Le=t.isActionBarEnabled,De=t.isDragToSelectEnabled,Me=t.cutItems,Re=t.isMoreColumnsEnabled,Ne=t.numVisibleColumns,xe=t.isListView,ke=t.isActive,Ue=t.isColumnResizingEnabled,Ve=$.isMatchedLarge,He=$.isMatchedMedium,Be=this.state,We=Be.dropTarget,Ge=Be.thumbStore,qe=Be.tilesPerRow;if(X===A.LoadingState.LOADING_FIRST_PAGE)return Se?s.default.createElement(c.MediaTableSkeleton,{numRows:15}):null;var ze=!!ee.size,je=re&&s.default.createElement(F.PinnedTeamFolderView,{instanceId:n,activeDropTarget:We,columnFlex:g.LIST_VIEW_COLUMN_FLEX[1],getOverflowMenuActions:this._handleGetOverflowMenuActions,onDragEnter:this.handleDragEnter,onNavigateToFileOrFolder:this.props.onNavigateToFileOrFolder,onRenameCancel:u,onRenameSubmit:l,thumbStore:Ge,onShowShare:ne,renderSharedWithController:oe,isColumnResizingEnabled:!1});if(this.shouldShowEmptyFolderView())return s.default.createElement("div",{className:"brws-files-view"},je,this.renderEmptyFolderView());var Ke=Ve?g.DEFAULT_COLUMN_HEADER_HEIGHT:g.COMPACT_COLUMN_HEADER_HEIGHT,Ye=Ke+be,Qe=this.props.scrollPositionOffset||0;return re&&(Qe+=Ke+Ke+g.PINNED_TEAM_FOLDER_SECONDARY_HEADER_PADDING_TOP+se.size*g.DEFAULT_ROW_HEIGHT),s.default.createElement("div",{className:o.default("brws-files-view","brws-files-view--"+ce.toLowerCase(),{"brws-files-view-condensed-list":ce===A.ViewType.CondensedList}),onContextMenu:this.logRightClick},je,s.default.createElement(h.ColumnManager,{columns:D,viewTypeColumns:pe,currentSort:w,onCanDisplayFolderSizesChanged:S,onColumnsChanged:f,isMatchedLarge:Ve,isMatchedMedium:He,isSearchMode:z,viewType:ce,responsiveContainer:z,preferredColumns:Pe,isMoreColumnsEnabled:Re,numVisibleColumns:Ne},(function(t){var c=t.visibleColumns,f=t.handleSelection,h=t.canDisplayFolderSizes,S=t.containerWidth,T=(z?g.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX:g.LIST_VIEW_COLUMN_FLEX)[c.length],F={columnFlex:T,currentSort:w,isCompactMode:G,isSelectMode:ze,shouldHideViewTypeColumnHeader:Le,onDeselectAll:e.onAllCheckboxDeselectAll,onSelectAll:e.onAllCheckboxSelectAll,onSelection:function(e,t,r){e.popoverTriggerLabel!==t.popoverTriggerLabel&&I.logEvent({user:le,action:N.WebUserActionLogEvent.SWITCH_COLUMN_TYPE,extra:{column_position:(r+1).toString(),column_header:e.popoverTriggerLabel}}),f(e,t)},onSort:J,onMenuOpen:function(e){I.logEvent({user:le,action:N.WebUserActionLogEvent.SELECT_COLUMN_MENU,extra:{column_position:(e+1).toString()}})},onSwitchViewType:p,selectAllCheckboxState:e.getSelectAllCheckboxCheckedVariant(),showSelectAllCheckbox:q(e.props.items),stickyOffsetHeight:Ke,stickyOffsetTop:be,columns:D,visibleColumns:c,viewType:ce,viewTypes:de,viewTypeLabels:ue,onTTI:e.handleTTI,isSearchMode:z,presentationOnly:xe,allowUnchecking:xe&&Re,isColumnResizingEnabled:xe&&Boolean(Ue)},C=e.props.columnHeaderImprovements?v.ColumnHeader:m.ColumnHeader;return xe?s.default.createElement(L.SelectableList,{itemIds:W,keyScope:L.SELECTABLE_LIST_KEY_SCOPE,onSelectionChange:e.handleSelectionChange,selection:te,tilesPerRow:qe,onDeselectAll:e.onDeselectAll,isActive:ke},(function(t){var p=t.focusedFileId,f=t.handleDeselect,m=t.handleFocusFile,g=t.handleSelect,v=t.isSelectableListEvent,w=t.updateSelection;return s.default.createElement(V.DragToSelectController,{handleSelect:g,handleDeselect:f,updateSelection:w,selection:te,isDragToSelectEnabled:De},(function(t){var w=t.registerSelectableItem;return s.default.createElement(d.Table,{"aria-rowcount":ae,className:o.default("brws-files-view-list",{"brws-files-view-list-compact":G,"brws-files-view-list-high-density":Ce}),columnFlex:T},s.default.createElement(C,r.__assign({},F,{variant:we?"sticky-native":ye?"sticky":"fixed"})),s.default.createElement(y.FilesViewList,{registerListItem:w,instanceId:n,onDelete:i,onShowRename:a,activeDropTarget:We,context:P,createNewFolderState:b,dropTargetHighlightMode:M,extensionsFeatureFlags:ve,fileRename:R,focusedFileIndex:p?W.indexOf(p):void 0,getOverflowMenuActions:e._handleGetOverflowMenuActions,getIsCurrentPathWriteable:e.getIsCurrentPathWriteable,getIsFileJumping:x,onAddFileJumpKeyCode:k,onResetFileJump:U,isCompactMode:G,hideViewFileButton:!!H,isDraggingExternalFiles:j,isDraggingInternalFiles:K,isFileViewerShown:Q,isSearchMode:z,isSelectMode:ze,isSelectableListEvent:v,arePostTTIModulesLoaded:Se,keyScope:L.SELECTABLE_LIST_KEY_SCOPE,onCopyToClipboard:e.handleCopyToClipboard,onCutToClipboard:e.handleCutToClipboard,onDragStart:e.handleDragStart,onDragEnter:e.handleDragEnter,onDeselectFile:f,onFocusFile:m,onFocusSearchBar:E,onOpenKeyboardShortcutModal:e.props.openKeyboardShortcutsModal,onLocationLinkClick:_e,onNavigateToFileOrFolder:fe,onNavigateToParentFolder:me,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onOpenFileSharedWithMe:he,onOpenPaper:ge,onPasteFromClipboard:_,onRenameCancel:u,onRenameSubmit:l,onSelectFile:g,onSetDropTarget:e.handleSetDropTarget,onSetFileUploaderPath:e.handleSetFileUploaderPath,onStarClick:Ee,responsive:$,scrollPositionOffset:Qe,selectedFiles:ee,selection:te,renderSharedWithController:oe,hrefForFile:e.props.hrefForFile,onShowShare:ne,onPresentInZoom:ie,user:le,viewportTopOffset:Ye,visibleColumns:c,canDisplayFolderSizes:h,thumbStore:Ge,scrollContainer:we,shareButtonLabel:e.props.shareButtonLabel,sharingServiceInfo:Te,showShareButton:e.props.showShareButton,starredState:e.props.starredState,onRangeInView:Fe,containerWidth:S,highDensity:Ce,filteredContactName:Oe,fileToId:e.props.fileToId,eligibleForFirstTaskSubtitle:e.props.eligibleForFirstTaskSubtitle,expVaultEnableViewOnlySharing:e.props.expVaultEnableViewOnlySharing,isFirstTaskEmptyState:e.props.isFirstTaskEmptyState,expEntryPointCopyLink:e.props.expEntryPointCopyLink,isColumnResizingEnabled:Boolean(e.props.isColumnResizingEnabled)}))}))})):s.default.createElement(L.SelectableList,{itemIds:W,keyScope:L.SELECTABLE_TILE_GRID_KEY_SCOPE,onSelectionChange:e.handleSelectionChange,selection:te,tilesPerRow:qe,sectionStartIndices:Ae.sectionStartIndices,isActive:ke},(function(t){var o=t.handleDeselect,n=t.handleDeselectAll,c=t.handleFocusFile,p=t.handleSelect,f=t.handleSelectAll,m=t.updateSelection,h=t.focusedFileId;return s.default.createElement(V.DragToSelectController,{handleSelect:p,handleDeselect:o,updateSelection:m,selection:te,isDragToSelectEnabled:De},(function(t){var m=t.registerSelectableItem;return s.default.createElement(s.default.Fragment,null,s.default.createElement(d.Table,{columnFlex:g.GRID_VIEW_COLUMN_FLEX,role:"presentation",style:we?{position:"sticky",top:be,zIndex:1}:void 0},s.default.createElement(C,r.__assign({},F,{variant:we?"default":ye?"sticky":"fixed"}))),s.default.createElement(O.FilesViewTileGrid,{onDelete:i,disabledMultiselect:Ie||!1,onShowRename:a,activeDropTarget:We,arePostTTIModulesLoaded:Se,createNewFolderState:b,context:P,deselectAll:n,dropTargetHighlightMode:M,fileRename:R,getOverflowMenuActions:e._handleGetOverflowMenuActions,getIsCurrentPathWriteable:e.getIsCurrentPathWriteable,getIsFileJumping:x,onAddFileJumpKeyCode:k,onResetFileJump:U,onTTI:e.handleTTI,items:B,isCreateFolderUIActive:e.isCreateFolderUIActive(),isDraggingExternalFiles:j,isDraggingInternalFiles:K,isQueryingFolderSizes:Y,isSearchMode:z,onCopyToClipboard:e.handleCopyToClipboard,onCutToClipboard:e.handleCutToClipboard,onDeselectFile:o,onDragEnter:e.handleDragEnter,onDragStart:e.handleDragStart,onFocusFile:c,onFocusSearchBar:E,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onNavigateToFileOrFolder:fe,onOpenFileSharedWithMe:he,onOpenPaper:ge,onOpenKeyboardShortcutModal:e.props.openKeyboardShortcutsModal,onPasteFromClipboard:_,onRangeInView:Fe,onRenameCancel:u,onRenameSubmit:l,onSelectFile:p,onSetDropTarget:e.handleSetDropTarget,onSortChange:J,onStarClick:Ee,onTilesPerRowChange:e.onTilesPerRowChange,path:Z,sections:Ae,selectAll:f,selectedFiles:ee,selection:te,onSetFileUploaderPath:e.handleSetFileUploaderPath,thumbStore:Ge,tilesPerRow:qe,totalNumItems:ae,user:le,viewportTopOffset:Ye,viewType:ce,starredState:e.props.starredState,hrefForFile:e.props.hrefForFile,focusedFileIndex:h?W.indexOf(h):void 0,scrollContainer:we,scrollPositionOffset:Qe,isActionBarEnabled:Le,registerSelectableTile:m,cutItems:Me,isActive:ke}))}))}))})),s.default.createElement(C.ScrollUpdater,{scrollContainer:we,path:Z}),s.default.createElement(T.InternalDragStatus,{className:"offscreen-drag-icon",files:ee.toArray(),ref:this.internalDragStatusRef}))},l.defaultProps={fileToId:function(e){return e.fq_path}},l})(s.default.Component);t.FilesViewComponent=Y;t.FilesView=l.connect((function(e,t){var o=t.id;return r.__assign(r.__assign({},E.selectInstance(e,{instanceId:o})),{itemIds:E.selectItemIds(e,{instanceId:o}),sections:E.selectSections(e,{instanceId:o}),responsive:E.selectResponsive(e,{instanceId:o}),isCompactMode:E.selectIsCompactMode(e,{instanceId:o}),viewType:E.selectViewType(e,{instanceId:o}),preferredColumns:E.selectPreferredColumns(e,{instanceId:o}),isCutActionEnabled:E.selectIsCutActionEnabled(e,{instanceId:o}),cutItems:E.selectCutItems(e,{instanceId:o}),numVisibleColumns:E.selectNumVisibleColumns(e,{instanceId:o}),isListView:E.selectIsListView(e,{instanceId:o}),isActive:H.isActiveFilesView(e,o)})}),(function(e,t){var r=t.id;return{openKeyboardShortcutsModal:function(){return e(S.openKeyboardShortcutsModal({instanceId:r}))}}}))(Y)})),define("modules/clean/react/files_view/files_view_logging",["require","exports","tslib","modules/clean/react/browse/logger_util"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logEventWithNumberOfFiles=function(t){var n=t.isSearchMode,i=t.file,s=t.extra,a=t.action,l=t.action_source,c=t.action_surface,d=t.user;if(n){var u=new Promise((function(t,r){e(["modules/clean/search/single_page/logger"],t,r)})).then(r.__importStar),p=new Promise((function(t,r){e(["modules/clean/search/single_page/data/selectors/index"],t,r)})).then(r.__importStar),_=new Promise((function(t,r){e(["modules/clean/search/single_page/data/store"],t,r)})).then(r.__importStar);Promise.all([u,p,_]).then((function(e){var t=e[0],n=e[1],d=e[2].getStoreForSearch().getState(),u=n.selectedFiles(d),p=o.countFilesAndFolders(u),_=p.num_files_selected,f=p.num_folders_selected,m=r.__assign(r.__assign({},s),{num_files_selected:_.toString(),num_folders_selected:f.toString()});t.logResultAction(a,n.resultsList(d),i,c,l,m)}))}else{var f=new Promise((function(t,r){e(["modules/clean/react/browse/action_logger"],t,r)})).then(r.__importStar),m=new Promise((function(t,r){e(["modules/clean/react/browse/data/store"],t,r)})).then(r.__importStar),h=new Promise((function(t,r){e(["modules/clean/react/browse/data/selectors"],t,r)})).then(r.__importStar);Promise.all([f,m,h]).then((function(e){var t=e[0].logBrowseAction,r=e[1].getStoreForBrowse,n=e[2].selectedFiles(r().getState()),u=o.countFilesAndFolders(n),p=u.num_files_selected,_=u.num_folders_selected;t({uid:d.id,action:a,result:i,num_files_selected:p,num_folders_selected:_,action_surface:c,action_source:l,extra:s})}))}},t.logEvent=function(t){var o=t.user,n=t.action,i=t.extra;return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/browse/action_logger"],t,r)})).then(r.__importStar)];case 1:return t.sent().logWebUserAction({user_id:o.id,event_name:n,extra:i}),[2]}}))}))}})),define("modules/clean/react/files_view/fixed_table_head",["require","exports","tslib","spectrum/vertically_fixed","spectrum/table","react"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.FixedTableHead=function(e){var t=e.children,s=e.offsetHeight,a=e.style,l=void 0===a?{}:a,c=r.__rest(e,["children","offsetHeight","style"]),d=void 0===s?l:r.__assign({flexBasis:s},l);return i.default.createElement("thead",r.__assign({className:"mc-table-head mc-table-head-fixed brws-column-header",style:d},c),i.default.createElement(o.VerticallyFixed,{tag:function(e){var o=e.style;return i.default.createElement(n.TableRow,{className:"mc-table-head-row mc-table-head-row-fixed",style:r.__assign({height:s},o),role:"presentation"},t)}}))}})),define("modules/clean/react/files_view/drag_drop/internal_drag_status",["require","exports","tslib","classnames","react","react-dom","dig-components/badges","modules/clean/react/icon/file_folder_icon"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),i=r.__importStar(i),t.InternalDragStatus=n.default.forwardRef((function(e,t){var r=e.className,l=e.files,c=o.default("active",r);return i.createPortal(n.default.createElement("div",{id:"drag-status",ref:t,className:c,"aria-hidden":"true"},n.default.createElement("div",{id:"drag-selection-status"},l.slice(0,4).map((function(e,t){return e.thumbnail_url_tmpl?n.default.createElement("img",{key:t,src:e.thumbnail_url_tmpl,className:"icon icon"+t,alt:""}):n.default.createElement(a.FileOrFolderIcon,{key:t,file:e,className:"icon icon"+t})})),n.default.createElement(s.NotificationBadge,{className:"drag-status__badge"},l.length))),document.body,"drag-status")}))})),define("modules/clean/react/files_view/legacy_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("modules/clean/react/files_view/list",["require","exports","tslib","react","react-redux","modules/clean/react/browse/action_logger","modules/clean/react/browse/models","modules/clean/react/files_view/culled_table_body","modules/clean/react/files_view/data/selectors/list_selectors","modules/clean/react/files_view/drag_drop/drag_and_drop","modules/clean/react/files_view/file_shared_with_me_row","modules/clean/react/files_view/keyboard_shortcuts","modules/clean/react/files_view/new_folder_row","modules/clean/react/files_view/paper_row","modules/clean/react/files_view/row_container","modules/clean/react/files_view/types","modules/clean/react/files_view/user_defined_item_row","modules/clean/web_user_action_events","modules/clean/react/files_view/data/selectors/files_view_selectors"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var E=function(){};t.isGlobalEvent=function(e){switch(e.key){case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":return!(e.target instanceof Element&&"menuitem"===e.target.getAttribute("role"));default:return!0}};var v=(function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.getIsListEvent=function(e){return t.props.isSelectableListEvent()&&(!(e.target instanceof Element)||"BUTTON"!==e.target.tagName)},t.getSelectedFiles=function(){return t.props.selectedFiles},t.getActiveDropTarget=function(){return t.props.activeDropTarget},t.getIsDraggingInternalFiles=function(){return!!t.props.isDraggingInternalFiles},t.getIsDraggingExternalFiles=function(){return!!t.props.isDraggingExternalFiles},t.logOverflowMenuOpen=function(){var e=t.props,r=e.selectedFiles,o=e.user,n=r?r.count((function(e){return e.is_dir})):0,s=r?r.count()-n:0;i.logContextMenuClick({uid:o.id,viewType:m.ViewType.List,action_surface:g.ActionSurfaceLogValue.CENTER_PANE,numFilesSelected:s,numFoldersSelected:n})},t.renderRow=function(e,r,n){var i,a,l,c;if("NewFolderRow"===e.type)return o.default.createElement(p.NewFolderRow,{createNewFolderState:e.props.createNewFolderState,isInsideMyTeamFolderTree:e.props.isInsideMyTeamFolderTree,onCancel:t.props.onNewFolderCancel,onSubmit:t.props.onNewFolderSubmit,rowIndex:r,topOffset:n,iconSize:e.props.iconSize});if("PaperRow"===e.type)return o.default.createElement(_.PaperRow,{paper:e.props.paper,rowIndex:r,topOffset:n,user:t.props.user,visibleColumns:e.props.visibleColumns,onOpenPaper:t.props.onOpenPaper,arePostTTIModulesLoaded:e.props.arePostTTIModulesLoaded,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height});if("UserDefinedItemRow"===e.type)return o.default.createElement(h.UserDefinedItemRow,{userDefinedItem:e.props.userDefinedItem,rowIndex:r,topOffset:n});var u=t.props.selection,m=e.props.file instanceof s.File?u.selected.last()===t.props.fileToId(e.props.file):u.selected.last()===e.props.file.file_id;return"FileSharedWithMeRow"===e.type?(null===(a=(i=t.props).registerListItem)||void 0===a||a.call(i,e.props.file.file_id,{top:n,height:e.props.height,left:0}),o.default.createElement(d.FileSharedWithMeRow,{arePostTTIModulesLoaded:t.props.arePostTTIModulesLoaded,file:e.props.file,visibleColumns:t.props.visibleColumns,isCompactMode:e.props.isCompactMode,getOverflowMenuActions:t.props.getOverflowMenuActions,onOpenFileSharedWithMe:t.props.onOpenFileSharedWithMe,rowIndex:r,controlsFocusable:m,topOffset:n,thumbStore:t.props.thumbStore,user:t.props.user,responsive:t.props.responsive,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,onSelect:t.props.onSelectFile,onDeselect:t.props.onDeselectFile,isFocused:e.props.isFocused,filteredContactName:t.props.filteredContactName,logOverflowMenuOpen:t.logOverflowMenuOpen,iconSize:e.props.iconSize})):(null===(c=(l=t.props).registerListItem)||void 0===c||c.call(l,t.props.fileToId(e.props.file),{top:n,height:e.props.height,left:0}),o.default.createElement(f.RowContainer,{key:e.key,instanceId:t.props.instanceId,listId:"main",itemIndex:e.itemIndex,containerWidth:e.props.containerWidth,extensionsFeatureFlags:e.props.extensionsFeatureFlags,sharingServiceInfo:e.props.sharingServiceInfo,getOverflowMenuActions:t.props.getOverflowMenuActions,hideViewFileButton:t.props.hideViewFileButton,isActiveDropTarget:e.props.isActiveDropTarget,isAvailableDropTarget:e.props.isAvailableDropTarget,isCompactMode:e.props.isCompactMode,isExtensionsMenuDisabled:e.props.isExtensionsMenuDisabled,isFocused:e.props.isFocused,isSearchMode:e.props.isSearchMode,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,isSharingDisabled:e.props.isSharingDisabled,onDeselect:t.props.onDeselectFile,onDragStart:t.props.onDragStart,onDragEnter:t.props.onDragEnter,onLocationLinkClick:t.props.onLocationLinkClick,onNavigateToFileOrFolder:t.props.onNavigateToFileOrFolder,onRenameCancel:t.props.onRenameCancel,onRenameSubmit:t.props.onRenameSubmit,onSelect:t.props.onSelectFile,onStarClick:t.props.onStarClick,renameState:e.props.renameState,rowIndex:r,controlsFocusable:m,topOffset:n,user:t.props.user,visibleColumns:t.props.visibleColumns,canDisplayFolderSizes:t.props.canDisplayFolderSizes,thumbStore:t.props.thumbStore,renderSharedWithController:t.props.renderSharedWithController,hrefForFile:t.props.hrefForFile,onShowShare:t.props.onShowShare,onPresentInZoom:t.props.onPresentInZoom,shareButtonLabel:t.props.shareButtonLabel,showShareButton:t.props.showShareButton,filteredContactName:t.props.filteredContactName,logOverflowMenuOpen:t.logOverflowMenuOpen,fileToId:t.props.fileToId,isFirstTaskEmptyState:t.props.isFirstTaskEmptyState,expEntryPointCopyLink:t.props.expEntryPointCopyLink,isCondensedListView:e.props.isCondensedListView,isActionBarEnabled:e.props.isActionBarEnabled,isColumnResizingEnabled:t.props.isColumnResizingEnabled}))},t}return r.__extends(n,e),n.prototype.componentDidMount=function(){var e=this.props.onTTI;e&&e(),this.setupKeyboardShortcuts(),this.setupExternalDragHandler()},n.prototype.componentWillUnmount=function(){this.cleanupKeyboardShortcuts(),c.cleanupExternalDragHandler(this.props.keyScope)},n.prototype.componentDidUpdate=function(e){e.isActive!==this.props.isActive&&(this.props.isActive?this.setupKeyboardShortcuts():this.cleanupKeyboardShortcuts())},n.prototype.cleanupKeyboardShortcuts=function(){u.resetFilesViewKeyboardShortcuts(this.props.keyScope),u.resetFileJumpKeyboardShortcuts(this.props.keyScope)},n.prototype.setupKeyboardShortcuts=function(){var e=this,t=this.props,r=t.user,o=t.onDelete,n=t.onShowRename,i=t.getIsFileJumping,s=t.onAddFileJumpKeyCode,a=t.onResetFileJump,l=t.keyScope,c=t.onCopyToClipboard,d=t.onCutToClipboard,p=t.onNavigateToParentFolder,_=t.onPasteFromClipboard;u.setupFileJumpKeyboardShortcuts({scope:l,getIsFileJumping:i,onAddFileJumpKeyCode:s,onResetFileJump:a}),u.setupFilesViewKeyboardShortcuts({user:r,viewType:m.ViewType.List,getIsGlobalEvent:this.getIsGlobalEvent(),getIsItemEvent:this.getIsListEvent,getSelectedFiles:this.getSelectedFiles,isCurrentPathWriteable:this.props.getIsCurrentPathWriteable,selectAllAction:E,deselectAllAction:E,onCopyToClipboard:c,onCutToClipboard:d,onDelete:o,onFocusSearchBar:this.props.onFocusSearchBar,onNavigateToFileOrFolder:function(t){return e.props.onNavigateToFileOrFolder(t,{actionSource:m.FilesViewActionSource.KEYBOARD})},onNavigateToParentFolder:p,onPasteFromClipboard:_,onShowRename:n,scope:l,onShowHelpMenu:function(){return e.props.onOpenKeyboardShortcutModal()}})},n.prototype.setupExternalDragHandler=function(){c.setupExternalDragHandler(this.props.keyScope,this.getIsDraggingInternalFiles,this.getIsDraggingExternalFiles,this.props.onSetFileUploaderPath,".brws-file-row",this.getActiveDropTarget,this.props.onSetDropTarget)},n.prototype.getIsGlobalEvent=function(){return t.isGlobalEvent},n.prototype.render=function(){var e=this.props,t=e.scrollPositionOffset,r=e.viewportTopOffset,n=e.focusedFileIndex,i=e.onRangeInView,s=e.scrollContainer,l=e.listItems,c=e.heights,d=e.itemBuffer;return o.default.createElement(a.CulledTableBodyWithScrollContainer,{items:l,listItemHeight:c,renderRow:this.renderRow,scrollPositionOffset:t,scrollToRow:n,shouldUseWindowAsScrollContainer:!0,viewportTopOffset:r,onRangeInView:i,scrollContainer:s,itemBuffer:d})},n.defaultProps={isFileViewerShown:function(){return!1}},n})(o.default.Component);t.FilesViewListComponent=v;t.FilesViewList=n.connect((function(e,t){return{listItems:l.selectListItems(e,t),heights:l.selectListItemHeights(e,t),itemBuffer:l.selectListItemBuffer(e,t),isActive:S.isActiveFilesView(e,t.instanceId)}}))(v)})),define("modules/clean/react/files_view/new_folder_row",["require","exports","tslib","spectrum/media_table","spectrum/table","react","spectrum/icon_content","modules/clean/react/files_view/name_input","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.NewFolderRow=function(e){var r,s=e.createNewFolderState,c=e.isInsideMyTeamFolderTree,d=void 0!==c&&c,u=e.onCancel,p=e.onSubmit,_=e.rowIndex,f=e.topOffset,m=e.iconSize;r="SAVING_INPUT"===s?i.default.createElement("p",{className:"brws-new-folder-row-status",role:"status","aria-live":"polite"},l.intl.formatMessage({id:"p58M12",defaultMessage:"Creating new folder…"})):i.default.createElement(a.NameInput,{defaultValue:"",label:l.intl.formatMessage({id:"ss4CO0",defaultMessage:"Folder name"}),onSubmit:p,onCancel:u});var h=i.default.createElement(t.NewFolderIcon,{isInsideMyTeamFolderTree:d,iconSize:m});return i.default.createElement(o.CulledMediaRow,{"aria-rowindex":void 0!==_?_+1:void 0,className:"brws-new-folder-row",topOffset:f},i.default.createElement(n.TableCell,{className:"brws-checkbox-cell"}),i.default.createElement(o.MediaCell,{icon:h},i.default.createElement("div",{className:"brws-new-folder-row-content brws-vertically-center"},r)),i.default.createElement(n.TableCell,null),i.default.createElement(n.TableCell,null))},t.NewFolderIcon=function(e){var t=e.isInsideMyTeamFolderTree,o=e.iconSize,n=e.className||"",a=o?{width:o,height:o}:{};return i.default.createElement(s.IconContent,r.__assign({className:n,name:t?"folder_team-small":"folder-small"},a))}})),define("modules/clean/react/files_view/paper_row",["require","exports","tslib","react","retrieval-components/highlighted-truncated-string","spectrum/media_table","spectrum/util/raf_throttle","modules/clean/emoji_utils","modules/clean/filename_highlights","modules/clean/paper_formatting_utils","modules/clean/react/files_view/double_click","modules/clean/react/files_view/file_snippets","modules/clean/react/files_view/star","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/core/browser","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),a=r.__importStar(a),c=r.__importStar(c),m=r.__importStar(m);var g=(function(e){function t(t){var r=e.call(this,t)||this;return r.setRef=function(e){r.brwsFilenameContainerDiv=e},r.handleWindowResize=function(){r.throttledWindowResize.request()},r.handleResize=function(){if(r.brwsFilenameContainerDiv){var e=r.state.brwsFilenameContainerDivWidth,t=r.brwsFilenameContainerDiv.getBoundingClientRect().width;t&&t!==e&&r.setState({brwsFilenameContainerDivWidth:t})}},r.handleOpenNewTabOrNavigate=function(e){if(0===e.button){e.preventDefault(),e.stopPropagation();var t=r.props.paper;if(f.hasModifierKey(e))return void m.open_tab(t.url);r.props.onOpenPaper(t)}},r.throttledWindowResize=new s.RafThrottle((function(){return r.handleResize()})),r.state=r.calcState(t),r}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){if(this.props.paper.title!==e.paper.title||this.props.paper.highlight_spans!==e.paper.highlight_spans){var t=this.calcState(e);this.setState(t)}},t.prototype.componentDidMount=function(){this.handleResize(),window.addEventListener("resize",this.handleWindowResize)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.handleWindowResize)},t.prototype.calcState=function(e){return{titleParts:c.getPaperDocTitleParts(e.paper,"brws-file-name-cell-icon","brws-file-name-cell-icon-emoji")}},t.prototype.getHighlightedSpansForHighlightedTruncatedString=function(e){var t=e.title,o=e.highlight_spans,n=e.title_highlights,i=o&&o.length>0,s=a.getFirstEmojiFromTitle(t);if(i){if(s){var c={highlight_str:o[0].highlight_str.substr(s.length),is_highlighted:o[0].is_highlighted};o=r.__spreadArrays([c],o.slice(1))}return o.map((function(e){return{string:e.highlight_str,isHighlighted:e.is_highlighted}}))}if(n){if(s){t=t.substr(s.length);var d=s.length/2;n=n.slice().map((function(e){return{pos:e.pos-d,len:e.string.length,string:e.string}}))}return l.highlightMatchSections(t,n).map((function(e){return{string:e.text,isHighlighted:e.isHighlighted}}))}},t.prototype.renderTitleElement=function(e){var t=this.props,r=t.paper,i=t.showHighlights,s=this.state.titleParts,a=s.title,l=s.highlightedTitle;if(e){var c=o.default.createElement(n.HighlightedTruncatedString,{text:a,className:"brws-file-name-element",fontSize:14,highlightSpans:this.getHighlightedSpansForHighlightedTruncatedString(r),cellBuffer:3,availableWidth:e});return o.default.createElement("a",{className:"brws-paper-doc-name-cell-title",href:r.url,onClick:this.handleOpenNewTabOrNavigate},i?c:o.default.createElement("span",null,a))}return o.default.createElement("a",{className:"brws-paper-doc-name-cell-title",href:r.url,onClick:this.handleOpenNewTabOrNavigate},i?l:o.default.createElement("span",null,a))},t.prototype.renderPaperCellContent=function(e,t){var r=this.props,n=r.paper,s=r.user,a=r.arePostTTIModulesLoaded,l=r.showSnippets,c=r.snippetRows,d=a?o.default.createElement(p.StarContainer,{item:n,user:s,key:"paperStar",className:"brws-file-name-cell-star"}):null;return o.default.createElement("div",{className:"brws-paper-doc-name-cell-content brws-vertically-center"},o.default.createElement("div",{className:"brws-paper-doc-name-cell-title-container"},o.default.createElement(i.MediaCellText,{highlight:e},this.renderTitleElement(t)),d),o.default.createElement(i.MediaCellText,{variant:"subtitle"},h.intl.formatMessage({id:"mvOTrD",defaultMessage:"in Paper"})),l&&o.default.createElement(i.MediaCellText,{key:"snippets",variant:"subtitle"},o.default.createElement(u.FileSnippets,{snippets:n.snippets,lineClamp:c})))},t.prototype.renderDocName=function(e){var t=this.props.height,n={highlight:e,icon:this.state.titleParts.icon,style:{minHeight:t-1}},s=this.state.brwsFilenameContainerDivWidth;return o.default.createElement(i.MediaCell,r.__assign({key:"docName"},n),o.default.createElement("div",{className:"brws-file-name-container",ref:this.setRef},this.renderPaperCellContent(e,s)))},t.prototype.renderDocInfo=function(){var e=this.props.paper,t=e.last_modified_date||"",r=e.last_editor_name?h.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:e.last_editor_name}):h.intl.formatMessage({id:"5794tP",defaultMessage:"by you"});return o.default.createElement(i.MediaCell,{key:"docInfo",subtitle:r,title:t})},t.prototype.renderCell=function(e){var t=e.isHovered,r=e.sortField;switch(r){case _.SortField.FILENAME:return this.renderDocName(t);case _.SortField.RELEVANCE:case _.SortField.MODIFIED:return this.renderDocInfo();default:return o.default.createElement(i.MediaCell,{key:r,title:o.default.createElement("span",{"aria-hidden":!0},"--")})}},t.prototype.render=function(){var e=this,t=this.props,n=t.rowIndex,s=t.topOffset,a=t.visibleColumns,l=this.handleOpenNewTabOrNavigate;return o.default.createElement(d.WithDoubleClick,{onClick:function(e){e.preventDefault()},onDoubleClick:l},(function(t){var l=t.onClick;return o.default.createElement(i.CulledMediaRow,{"aria-rowindex":void 0!==n?n+1:void 0,className:"brws-paper-row brws-row-click-selection-method",draggable:!1,onClick:l,topOffset:s,variant:"default"},(function(t){var n=t.isHovered;return r.__spreadArrays([o.default.createElement(i.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"})],a.map((function(t){return e.renderCell({isHovered:n,sortField:t.sortField})})))}))}))},t.defaultProps={showHighlights:!0},t})(o.default.PureComponent);t.PaperRow=g})),define("modules/clean/react/files_view/pinned_team_folder_view",["require","exports","tslib","classnames","react","react-redux","dig-components/icons","dig-components/icons/src","spectrum/table","modules/clean/browse_uri_interface","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_list_utils","modules/clean/react/files_view/row_container","modules/clean/react/tooltip","modules/clean/user_education/react/user_education_effect","modules/clean/user_education/user_education_client","modules/constants/trademark","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var E=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.displayName="PinnedTeamFolderView",t.renderTeamFolderRow=function(e,r){var o=t.props,i=o.activeDropTarget,s=o.dropTargetHighlightMode,a=o.getOverflowMenuActions,l=o.onDragEnter,u=o.onNavigateToFileOrFolder,f=o.onRenameCancel,h=o.onRenameSubmit,g=o.user,S=o.thumbStore,E=o.onShowShare,v=o.renderSharedWithController,w=o.instanceId,T=o.isColumnResizingEnabled,b=p.shouldFileBeHighlightedDropTarget({dropTargetHighlightMode:s,file:e,isSelected:!1}),I=n.default.createElement(_.RowContainer,{instanceId:w,listId:"team_folders",itemIndex:r,rowIndex:r,getOverflowMenuActions:a,key:encodeURI(e.fq_path),isAvailableDropTarget:b,isActiveDropTarget:e===i,isPinned:!0,onDragEnter:l,onNavigateToFileOrFolder:u,onRenameCancel:f,onRenameSubmit:h,user:g,visibleColumns:d.LIST_VIEW_COLUMNS.slice(0,1),canDisplayFolderSizes:!1,thumbStore:S,onShowShare:E,renderSharedWithController:v,hrefForFile:c.href_for_file,isColumnResizingEnabled:T});return r>0?I:n.default.createElement(m.UserEducationEffect,{containerName:"PinnedTeamFolder",name:"TeamFolder",key:encodeURI(e.fq_path)+"-UserEducationEffect"},I)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){h.UEClient.sendEvent(this.displayName,"componentDidMount",JSON.stringify(this.props.context))},t.prototype.renderHeaderTitle=function(e,t){var r=t?n.default.createElement("div",{className:"brws-pinned-team-folder-info-button"},n.default.createElement(f.Tooltip,{position:f.TooltipPosition.RIGHT,tooltip_contents:n.default.createElement("div",null,t),tooltip_classname:"brws-pinned-team-folder-tooltip"},n.default.createElement(s.UIIcon,{src:a.InfoLine}))):null;return n.default.createElement("div",{className:"brws-pinned-team-folder-header-title-button-group"},n.default.createElement("h2",{className:"brws-pinned-team-folder-header-title"},e),r)},t.prototype.render=function(){var e=this.props,t=e.columnFlex,r=e.isCompactMode,i=e.teamFolders;if(!i)return null;var s=S.intl.formatMessage({id:"gjVAYF",defaultMessage:"{count, plural, one{Team folder} other{Team folders}}"},{count:i.size});return n.default.createElement("div",{className:"brws-pinned-team-folder-view"},n.default.createElement(l.Table,{columnFlex:t},n.default.createElement(l.TableHead,{className:o.default("brws-column-header","brws-pinned-team-folder-header",{"brws-column-header-compact brws-pinned-team-folder-header-compact ":r})},n.default.createElement(l.TableHeadCell,{className:"brws-checkbox-cell"}),n.default.createElement(l.TableHeadCell,{className:"brws-vertically-center"},this.renderHeaderTitle(s,S.intl.formatMessage({id:"h5GI+v",defaultMessage:"Team folders are the hub of content for a team and contents are automatically shared with team folder members. {trademark_business} team admins own and manage team folders."},{trademark_business:g.TRADEMARK_BUSINESS})))),n.default.createElement(l.TableBody,null,i.map(this.renderTeamFolderRow))),n.default.createElement(l.Table,{columnFlex:t},n.default.createElement(l.TableHead,{className:o.default("brws-column-header","brws-pinned-team-folder-header","brws-pinned-team-folder-header-secondary",{"brws-column-header-compact brws-pinned-team-folder-header-compact ":r})},n.default.createElement(l.TableHeadCell,{className:"brws-checkbox-cell"}),n.default.createElement(l.TableHeadCell,{className:"brws-vertically-center"},this.renderHeaderTitle(S.intl.formatMessage({id:"sxqZnj",defaultMessage:"Everything else"}))))))},t})((n=r.__importDefault(n)).default.Component);t.PinnedTeamFolderView=i.connect((function(e,t){return{teamFolders:u.selectTeamFolders(e,t),context:u.selectContext(e,t),dropTargetHighlightMode:u.selectDropTargetHighlightMode(e,t),user:u.selectUser(e,t),isCompactMode:u.selectIsCompactMode(e,t)}}))(E)})),define("modules/clean/react/files_view/row",["require","exports","tslib","classnames","react","spectrum/media_table","modules/clean/keycode","modules/clean/react/files_view/double_click","modules/clean/react/files_view/keyboard_focus","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/selectable_list"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isKeyboardFocused:!1},t.handleClick=function(e){t.shouldHandleClick(e)?(e.preventDefault(),e.shiftKey?t.props.onSelect(u.SelectOptions.EXTEND,c.FilesViewActionSource.ROW_SINGLE_CLICK):e.ctrlKey||e.metaKey?t.props.isSelected?t.props.onDeselect(!1,c.FilesViewActionSource.ROW_SINGLE_CLICK):t.props.onSelect(u.SelectOptions.DEFAULT,c.FilesViewActionSource.ROW_SINGLE_CLICK):t.props.onSelect(u.SelectOptions.ONLY,c.FilesViewActionSource.ROW_SINGLE_CLICK)):e.preventDefault()},t.handleDoubleClick=function(e){t.shouldHandleClick(e)?t.handleOpenNewTabOrNavigate(e,c.FilesViewActionSource.ROW_DOUBLE_CLICK):e.preventDefault()},t.handleOpenNewTabOrNavigate=function(e,r){0===e.button&&(e.preventDefault(),e.stopPropagation(),t.props.onNavigateToItem({openInNewTab:Boolean(d.hasModifierKey(e)),actionSource:r}))},t.handleDragStart=function(e){var r=t.props,o=r.isSelected,n=r.onDragStart;n&&o&&n(e)},t.onRowFocus=function(){t.setState({isKeyboardFocused:!0})},t.onRowBlur=function(){t.setState({isKeyboardFocused:!1})},t.handleKeyPress=function(e){if(t.shouldHandleClick(e)){if(e.which===s.KeyCode.SPACE||e.which===s.KeyCode.ENTER){var r=t.props,o=r.isSelectMode,n=r.onSelect;t.state.isKeyboardFocused&&!o&&(e.preventDefault(),e.stopPropagation(),n(u.SelectOptions.DEFAULT,c.FilesViewActionSource.KEYBOARD))}}else e.preventDefault()},t}return r.__extends(t,e),t.prototype.shouldHandleClick=function(e){return!e.defaultPrevented},t.prototype.render=function(){var e=this,t=this.props,r=t.className,s=t.isSelected,c=t.isDeleted,d=t.isDraggable,u=t.isActiveDropTarget,p=t.componentType,_=t.topOffset,f=t.rowIndex,m=t.ariaLabel,h=t.filename,g=t.children,S=t.onDragEnter,E="CulledMediaRow"===p?i.CulledMediaRow:i.MediaRow,v=this.props.isSelectMode?-1:0===f?0:-1;return n.default.createElement(a.WithDoubleClick,{onClick:this.handleClick,onDoubleClick:this.handleDoubleClick},(function(t){var i=t.onClick;return n.default.createElement(l.WithKeyboardFocus,{onKeyboardFocus:e.onRowFocus},(function(t){var a=t.onMouseDown,l=t.onFocus;return n.default.createElement(E,{className:o.default(r,"brws-file-row",{"brws-file-row-selected":s,"brws-file-row-deleted":c,"brws-file-row-dragover":u,"brws-row-click-selection-method":!0}),variant:(u?"dragover":s&&"selected")||"default",onClick:i,onMouseDown:a,draggable:d,topOffset:_,onDragEnter:S,onDragStart:e.handleDragStart,onFocus:l,"aria-rowindex":void 0!==f?f+1:void 0,"aria-controls":"brws-sidebar-view","aria-label":m,"data-filename":h,tabIndex:v},g)}))}))},t.defaultProps={componentType:"MediaRow",topOffset:0},t})((n=r.__importDefault(n)).default.PureComponent);t.FilesViewRow=p})),define("modules/clean/react/files_view/row_container",["require","exports","tslib","react","react-redux","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/browse/models","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/item_selectors","modules/clean/react/files_view/file_row"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.item,a=t.isColumnResizingEnabled;return n instanceof s.File?o.default.createElement(i.ColumnResizingContext.Consumer,null,(function(t){var i=t.columnSizes;return o.default.createElement(c.FileRow,r.__assign({},e.props,{file:n,columnSizes:a?i:void 0}))})):null},t})((o=r.__importDefault(o)).default.Component);t.RowContainer=n.connect((function(e,t){return{arePostTTIModulesLoaded:a.selectArePostTTIModulesLoaded(e,t),context:a.selectContext(e,t),isCheckboxDisabled:a.selectDisabledMultiselect(e,t),item:l.selectItem(e,t),responsive:a.selectResponsive(e,t),showCDMUserEducationEffects:l.selectShowCDMUserEducationEffects(e,t),height:l.selectRowHeight(e,r.__assign(r.__assign({},t),{numVisibleColumns:t.visibleColumns.length})),iconSize:l.selectIconSize(e,t),isCutToClipboard:l.selectIsCutToClipboard(e,t)}}))(d)})),define("modules/clean/react/files_view/scroll_updater",["require","exports","tslib","react-redux","react","modules/clean/react/files_view/data/selectors/files_view_selectors"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),i=r.__importStar(i);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.updateScroll()},t.prototype.componentDidUpdate=function(e){var t=e.currentScroll,r=e.path;t!==this.props.currentScroll?this.updateScroll():r!==this.props.path&&this.scrollTo(0)},t.prototype.updateScroll=function(){var e=this.props.currentScroll;if(e){var t=e.scrollTop;this.scrollTo(t)}},t.prototype.scrollTo=function(e){var t=this.props.scrollContainer;t&&t.current?t.current.scrollTop=e:window.scrollTo(0,e)},t.prototype.render=function(){return null},t})(n.default.Component);t.ScrollUpdater=o.connect((function(e){return{currentScroll:i.currentScroll(e)}}))(s)})),define("modules/clean/react/files_view/sticky_table_head",["require","exports","tslib","spectrum/dimensions","spectrum/table","react","modules/clean/react/sticky/sticky","modules/clean/react/sticky/container"],(function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.StickyTableHead=function(e){var t=e.children,l=e.columnFlex,c=(e.offsetHeight,e.offsetTop),d=r.__rest(e,["children","columnFlex","offsetHeight","offsetTop"]),u=i.default.createElement(o.Dimensions,{tagName:"tr"},(function(e){var o=e.width;return i.default.createElement("td",{className:"brws-sticky-table-cell"},i.default.createElement(a.StickyContainer,{offsetTop:c},i.default.createElement(s.Sticky,null,i.default.createElement(n.Table,{columnFlex:l,style:{width:o}},i.default.createElement(n.TableHead,r.__assign({},d),t)))))}));return i.default.createElement("thead",{className:"brws-sticky-table-head"},u)}})),define("modules/clean/react/files_view/thumbnail_media_cell",["require","exports","tslib","react","spectrum/media_table","modules/clean/react/files_view/file_thumbnail"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.ThumbnailMediaCell=function(e){var t=e.height,s=e.width,a=e.children,l=r.__rest(e,["height","width","children"]),c=void 0===s?{}:{width:s,minWidth:s,maxWidth:s};return o.default.createElement(n.MediaCell,{icon:o.default.createElement(i.FileThumbnail,r.__assign({},l)),style:r.__assign({minHeight:t-1},c),children:a})}})),define("modules/clean/react/files_view/user_defined_item_row",["require","exports","tslib","react"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(t){return e.call(this,t)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.rowIndex,r=e.topOffset;return e.userDefinedItem.renderUserDefinedItemRow({rowIndex:t,topOffset:r})},t})((o=r.__importDefault(o)).default.PureComponent);t.UserDefinedItemRow=n})),define("modules/clean/react/files_view/view_preferences",["require","exports","tslib","modules/clean/react/files_view/constants","modules/clean/storage"],(function(e,t,r,o,n){"use strict";function i(e){var i={},s=n.UserLocalStorage.get(e,o.VIEW_TYPE_STORAGE_KEY);return s&&Object.keys(s).forEach((function(e){i[e]={file_view_mode:s[e],last_updated_ts:Date.now()}})),r.__assign(r.__assign({},i),n.UserLocalStorage.get(e,t.VIEW_PREFERENCES_STORAGE_KEY))}function s(e,o,s){for(var a=i(e),l=r.__assign(r.__assign({},s),{last_updated_ts:Date.now()}),c=0,d=o;c<d.length;c++){var u=d[c];a[u]=r.__assign(r.__assign({},a[u]),l)}for(;Object.keys(a).length>t.VIEW_PREFERENCES_STORAGE_LIMIT;){var p=Object.keys(a).reduce((function(e,t){return!e||a[t].last_updated_ts<a[e].last_updated_ts?t:e}));delete a[p]}n.UserLocalStorage.set(e,t.VIEW_PREFERENCES_STORAGE_KEY,a)}function a(e,t){var r={},o=i(e);return Object.keys(o).forEach((function(e){var n=o[e][t];void 0!==n&&(r[e]=n)})),r}Object.defineProperty(t,"__esModule",{value:!0}),t.VIEW_PREFERENCES_STORAGE_KEY="files_view_preferences",t.VIEW_PREFERENCES_STORAGE_LIMIT=500,t.getPreferences=i,t.getViewTypes=function(e){var t=i(e);if(!t||0===Object.keys(t).length)return null;var r={};return Object.keys(t).forEach((function(e){var o=t[e].file_view_mode;o&&(r[e]=o)})),r},t.setViewType=function(e,t,r){s(e,t,{file_view_mode:r})},t.getScopedColumnsIndex=function(e){return a(e,"columns_index")},t.setColumnsIndex=function(e,t,r){s(e,t,{columns_index:r})},t.getScopedSorts=function(e){return a(e,"sort_state")},t.setSort=function(e,t,r){s(e,t,{sort_state:r})},t.getScopedNumVisibleColumns=function(e){return a(e,"num_visible_columns")},t.setNumVisibleColumns=function(e,t,r){s(e,t,{num_visible_columns:r})}})),define("modules/clean/react/files_view/view_type_column_header_menu",["require","exports","tslib","react","spectrum/icon_form","spectrum/icon_mode","spectrum/popover","modules/clean/react/files_view/types","modules/core/i18n"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSelection=function(e){e!==t.props.viewType&&t.props.onSwitchViewType(e)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onTTI()},t.prototype.viewTypeIcon=function(e){switch(e){case a.ViewType.List:return"list";case a.ViewType.Grid:return"grid";case a.ViewType.LargeGrid:return"tiles"}return"list"},t.prototype.viewTypeLabel=function(e){switch(e){case a.ViewType.List:return l.intl.formatMessage({id:"B5HGiK",defaultMessage:"Layout: List"});case a.ViewType.Grid:return l.intl.formatMessage({id:"IuTWMX",defaultMessage:"Layout: Grid"});case a.ViewType.LargeGrid:return l.intl.formatMessage({id:"hYH0ds",defaultMessage:"Layout: Large Grid"})}return l.intl.formatMessage({id:"B5HGiK",defaultMessage:"Layout: List"})},t.prototype.render=function(){var e=this,t=this.props,r=t.viewType,a=t.viewTypes,c=t.viewTypeLabels,d=t.shouldHideViewTypeColumnHeader;return 1===a.length?null:d?null:o.default.createElement(s.Popover,{className:"brws-view-type-column-header-menu",onSelection:this.handleSelection,closeOnSelection:!0},o.default.createElement(s.PopoverTrigger,{className:"brws-view-type-column-header-menu-trigger","aria-label":l.intl.formatMessage({id:"NtfviE",defaultMessage:"Select view type"})},o.default.createElement(i.IconMode,{name:this.viewTypeIcon(r)}),o.default.createElement(n.IconForm,{name:"caret-down"})),o.default.createElement(s.PopoverContent,{attachment:"right",className:"brws-view-type-column-header-menu-content"},o.default.createElement(s.PopoverItemGroup,null,o.default.createElement(s.PopoverItemGroupTitle,null,l.intl.formatMessage({id:"S31+EG",defaultMessage:"View As"})),a.map((function(t){return o.default.createElement(s.PopoverSelectableItem,{"data-viewtype":t,key:t,icon:o.default.createElement(i.IconMode,{name:e.viewTypeIcon(t)}),selected:r===t,value:t,"aria-label":e.viewTypeLabel(t)},c[t])})))))},t})((o=r.__importDefault(o)).default.PureComponent);t.ViewTypeColumnHeaderMenu=c}));__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/folder_dialog/async",["require","exports","modules/clean/css"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showFolderDialog=function(t){new Promise((function(t,r){e(["modules/clean/react/folder_dialog/folder_dialog"],t,r)})).then(__importStar).then((function(e){return e.FolderDialog.show(t)}))},t.prewarmFolderDialog=function(){new Promise((function(t,r){e(["modules/clean/react/folder_dialog/folder_dialog"],t,r)})).then(__importStar).then((function(){r.require_css("/static/css/react/folder_picker-vflDebzXD.css")}))}})),define("modules/clean/react/growth/personalization/collection_folder/collection_folder",["require","exports","tslib","react","modules/clean/react/css","modules/clean/react/image","modules/clean/static_urls","dig-components/typography","dig-components/buttons","modules/clean/react/growth/personalization/collection_folder/constants","modules/clean/react/growth/personalization/collection_folder/actions","modules/clean/paper/template_library/constants","modules/clean/dropbox_form","modules/clean/react/growth/personalization/collection_folder/logger","modules/clean/growth/smb_funnel/smb_funnel_logger","modules/clean/react/admin/teams/onboarding/web/constants"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),d=r.__importStar(d),_=r.__importStar(_);var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getActionCallback=function(e,t,r,o,n,i){switch(o){case c.ActionCallbackType.CREATE_GOOGLE_SHEETS:return function(){return d.createGoogleSheets(e,t.currentFQPath)};case c.ActionCallbackType.DOWNLOAD:return function(){return d.downloadDesktop(e)};case c.ActionCallbackType.OPEN_SHARE_MODAL:return function(){return d.asyncOpenShareFolderSetting(e,t,i)};case c.ActionCallbackType.UPLOAD:return function(){return d.uploadFile(r)};case c.ActionCallbackType.REDIRECT:return function(){return d.redirectToLink(n)};default:return function(){}}},t.logOnActionClicked=function(e,t,r){_.userClickedCollectionsFolderAction(e,t),r?r():f.SMBFunnelLogger.log(m.AMPMetrics.ACTIVATION_COLLECTIONS_ACTION_PAPER,{collectionFolderType:String(e),templateName:t})},t.getActionButton=function(e){var r=t.props,n=r.user,i=r.context,s=r.handleUploadButtonClick;if(e.actionCallbackType===c.ActionCallbackType.CREATE_PAPER_TEMPLATE)return o.default.createElement(p.DropboxForm,{method:"post",action:u.REDIRECT_URL+"?slugId="+e.paperTemplateSlugId,target:"_blank"},o.default.createElement(l.Button,{type:"submit",variant:"outline",onClick:function(){return t.logOnActionClicked(i.collectionFolderType,e.loggingTitle)}},e.buttonText));var a=t.getActionCallback(n,i,s,e.actionCallbackType,e.redirectLink,e.shareModalSettingsTab);return o.default.createElement(l.Button,{type:"button",variant:"outline",onClick:function(){return t.logOnActionClicked(i.collectionFolderType,e.loggingTitle,a)}},e.buttonText)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.context,n=t.role,l=c.collectionPanelConfig(n,r.collectionFolderType);if(void 0===l)return null;_.userViewCollectionsFolder(r.collectionFolderType,n,l.actions);var d=l.actions.map((function(t,r){return o.default.createElement("div",{className:"collection-action-item",key:r},o.default.createElement(i.Image,{alt:c.imageAltString,src:s.static_url(t.imageUrl),srcHiRes:s.static_url(t.imageHiResUrl)}),o.default.createElement("div",{className:"collection-action-item__rc"},o.default.createElement("div",{className:"collection-action-item__rc__title"},o.default.createElement(a.Title,{size:"small",isBold:!0},t.title)),o.default.createElement("div",{className:"collection-action-item__rc__desc"},o.default.createElement(a.Text,null,t.desc)),o.default.createElement("div",{className:"collection-action-item__rc__button"},e.getActionButton(t))))}));return o.default.createElement("div",{className:"collection-panel"},o.default.createElement("div",{className:"collection-overview-title"},o.default.createElement(a.Title,{size:"small",isBold:!0},c.overviewTitle)),o.default.createElement("div",{className:"collection-overview-desc"},o.default.createElement("div",{className:"collection-overview-desc__text"},o.default.createElement(a.Text,null,l.overviewDesc))),o.default.createElement("div",{className:"collection-action-title"},o.default.createElement("div",{className:"collection-action-title__text"},o.default.createElement(a.Title,{size:"small",isBold:!0},l.actionsTitle))),o.default.createElement("div",{className:"collection-action-panel"},d))},t})(o.default.PureComponent);t.CollectionFolderView=h,t.CollectionFolder=n.requireCssWithComponent(h,["/static/css/dig-components/index.web-vflrectwC.css","/static/css/growth/experiments/collection_folder-vflpSIfgG.css"])})),define("modules/clean/react/growth/personalization/collection_folder/constants",["require","exports","modules/core/i18n","modules/clean/filetypes"],(function(e,t,r,o){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FILE_REQUEST_LINK="/requests",t.PAPER_TEMPLATES_LINK="/paper/templates",t.WATERMARK_LINK="/features/share/watermark",(function(e){e.DOWNLOAD="download",e.CREATE_GOOGLE_SHEETS="create_google_sheets",e.CREATE_PAPER_TEMPLATE="create_paper_template",e.OPEN_SHARE_MODAL="open_share_modal",e.UPLOAD="upload",e.REDIRECT="redirect"})(n=t.ActionCallbackType||(t.ActionCallbackType={})),t.imageAltString=r.intl.formatMessage({id:"G0BGYo",defaultMessage:"Image loading"});var i={imageUrl:"/static/images/growth/personalization/collections_exp/Get_Smart_Sync_on_desktop-vfllGWHCs.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Get_Smart_Sync_on_desktop@2x-vflXfvyBS.png",title:r.intl.formatMessage({id:"cBBY+o",defaultMessage:"Get Smart Sync on desktop"}),loggingTitle:"smart_sync",desc:r.intl.formatMessage({id:"4PtkZL",defaultMessage:"Store all your computer files in the cloud to save computer space and keep everything backed up."}),buttonText:r.intl.formatMessage({id:"8cyvqx",defaultMessage:"Open the desktop app"}),actionCallbackType:n.DOWNLOAD},s={imageUrl:"/static/images/growth/personalization/collections_exp/Lock_files_when_you_edit_them-vflNkx0x7.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Lock_files_when_you_edit_them@2x-vflEgd1S9.png",title:r.intl.formatMessage({id:"XVzKiX",defaultMessage:"Lock files when you edit them"}),loggingTitle:"lock_files",desc:r.intl.formatMessage({id:"LhuHW+",defaultMessage:"In the desktop app, right click a file in any shared folder to keep others from editing it at the same time."}),buttonText:r.intl.formatMessage({id:"8m53T6",defaultMessage:"Upload file and try"}),actionCallbackType:n.UPLOAD},a={imageUrl:"/static/images/growth/personalization/collections_exp/Work_off_Google_Sheets-vflnZKx1s.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Work_off_Google_Sheets@2x-vflY3NFJm.png",title:r.intl.formatMessage({id:"ZWTwJC",defaultMessage:"Work off Google Sheets"}),loggingTitle:"google_sheet",desc:r.intl.formatMessage({id:"HdzKjx",defaultMessage:"Create and use Google files from within Dropbox to have all your spreadsheets stored in one place."}),buttonText:r.intl.formatMessage({id:"vlzkco",defaultMessage:"Create Google Sheet"}),actionCallbackType:n.CREATE_GOOGLE_SHEETS},l={imageUrl:"/static/images/growth/personalization/collections_exp/Decide_who_can_edit_folders-vfl3MUfmT.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Decide_who_can_edit_folders@2x-vflzQOJeG.png",title:r.intl.formatMessage({id:"vhvaO9",defaultMessage:"Decide who can edit folders"}),loggingTitle:"folder_settings",desc:r.intl.formatMessage({id:"jSmn2k",defaultMessage:"Give specific people permission to edit or view-only access for individual folders."}),buttonText:r.intl.formatMessage({id:"+pTjXN",defaultMessage:"Open folder settings"}),actionCallbackType:n.OPEN_SHARE_MODAL,shareModalSettingsTab:"folder_settings"},c={imageUrl:"/static/images/growth/personalization/collections_exp/Have_total_control_of_shared_links-vflyAyrmd.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Have_total_control_of_shared_links@2x-vflfnAKvn.png",title:r.intl.formatMessage({id:"6oKVMW",defaultMessage:"Have total control of shared links"}),loggingTitle:"link_settings",desc:r.intl.formatMessage({id:"z4ud8c",defaultMessage:"Set passwords, disable downloads, and set expirations dates on anything you share with a link."}),buttonText:r.intl.formatMessage({id:"Q9UABZ",defaultMessage:"Open link settings"}),actionCallbackType:n.OPEN_SHARE_MODAL,shareModalSettingsTab:"view_link_settings"},d={imageUrl:"/static/images/growth/personalization/collections_exp/Watermark_your_PDFs_and_photos-vflkjxZpk.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Watermark_your_PDFs_and_photos@2x-vfl4utj4c.png",title:r.intl.formatMessage({id:"0ZcoHO",defaultMessage:"Watermark your PDFs and photos"}),loggingTitle:"watermark",desc:r.intl.formatMessage({id:"UYiZrN",defaultMessage:"When you preview a file in Dropbox, you can watermark it with your logos or text."}),buttonText:r.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"}),actionCallbackType:n.REDIRECT,redirectLink:t.WATERMARK_LINK},u={imageUrl:"/static/images/growth/personalization/collections_exp/Comment_and_annotate_on_files-vfl-sZwtU.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Comment_and_annotate_on_files@2x-vflg-KF4w.png",title:r.intl.formatMessage({id:"6uwoJY",defaultMessage:"Comment and annotate on files"}),loggingTitle:"comment_files",desc:r.intl.formatMessage({id:"xqj2eW",defaultMessage:"Mention teammates on specific areas of files for targeted feedback."}),buttonText:r.intl.formatMessage({id:"8m53T6",defaultMessage:"Upload file and try"}),actionCallbackType:n.UPLOAD},p={imageUrl:"/static/images/growth/personalization/collections_exp/Request_files_from_others-vflvy4CGu.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Request_files_from_others@2x-vflms8zVt.png",title:r.intl.formatMessage({id:"bgGX06",defaultMessage:"Request files from others"}),loggingTitle:"request_files",desc:r.intl.formatMessage({id:"BqqQJn",defaultMessage:"Collect and receive large files from anyone-right in your Dropbox account."}),buttonText:r.intl.formatMessage({id:"34LFfx",defaultMessage:"Try file request"}),actionCallbackType:n.REDIRECT,redirectLink:t.FILE_REQUEST_LINK},_={imageUrl:"/static/images/growth/personalization/collections_exp/Brainstorming-vflzwizf3.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Brainstorming@2x-vfljrvaTs.png",title:r.intl.formatMessage({id:"mIVTjA",defaultMessage:"Brainstorming"}),loggingTitle:"brainstorming",desc:r.intl.formatMessage({id:"8yBNxI",defaultMessage:"Collect inspiration, exchange ideas in real-time, and get feedback."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:n.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"brainstorm"},f={imageUrl:"/static/images/growth/personalization/collections_exp/Brand_guidelines-vfl73kagH.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Brand_guidelines@2x-vflWEdsrX.png",title:r.intl.formatMessage({id:"qpwvDp",defaultMessage:"Brand guidelines"}),loggingTitle:"brand_guidelines",desc:r.intl.formatMessage({id:"PhOzXb",defaultMessage:"Craft guidelines that help everyone create written and visual materials."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:n.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"brand-guidelines"},m={imageUrl:"/static/images/growth/personalization/collections_exp/Creative_brief-vflzoR7nu.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Creative_brief@2x-vflfJwHyd.png",title:r.intl.formatMessage({id:"4HhApp",defaultMessage:"Creative brief"}),loggingTitle:"creative_brief",desc:r.intl.formatMessage({id:"+2jNKl",defaultMessage:"Capture project information, share deliverables, and collect targeted feedback in a single doc."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:n.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"creative-brief"},h={imageUrl:"/static/images/growth/personalization/collections_exp/Hiring_doc-vfl7-KGxC.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Hiring_doc@2x-vfltl18DZ.png",title:r.intl.formatMessage({id:"Ob69jI",defaultMessage:"Hiring doc"}),loggingTitle:"hiring_doc",desc:r.intl.formatMessage({id:"/MXP6f",defaultMessage:"Consolidate candidate data, manage interview schedules, and co-edit interview questions."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:n.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"hiring-doc"},g={imageUrl:"/static/images/growth/personalization/collections_exp/Launch_plan-vflUr4YEg.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Launch_plan@2x-vflBHVqHw.png",title:r.intl.formatMessage({id:"eJBiUX",defaultMessage:"Launch plan"}),loggingTitle:"launch_plan",desc:r.intl.formatMessage({id:"Dnp+hz",defaultMessage:"Coordinate teams by setting milestones, assigning to-dos, and managing approvals."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:n.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"launch-plan"},S={imageUrl:"/static/images/growth/personalization/collections_exp/More_templates-vflPM9mUx.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/More_templates@2x-vflu1bMcB.png",title:r.intl.formatMessage({id:"o6Oqk/",defaultMessage:"More templates"}),loggingTitle:"more_templates",desc:"",buttonText:r.intl.formatMessage({id:"SJ7MeI",defaultMessage:"See all templates"}),actionCallbackType:n.REDIRECT,redirectLink:t.PAPER_TEMPLATES_LINK},E={imageUrl:"/static/images/growth/personalization/collections_exp/New_hire_onboarding-vflhJapds.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/New_hire_onboarding@2x-vfl6PxFtO.png",title:r.intl.formatMessage({id:"ZTukLA",defaultMessage:"New hire onboarding"}),loggingTitle:"new_hire_onboarding",desc:r.intl.formatMessage({id:"eHWzWM",defaultMessage:"Centralize information to help new employees get started during their first few days."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:n.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"new-hire-onboarding"},v={imageUrl:"/static/images/growth/personalization/collections_exp/Project_plan-vfleFZaG-.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Project_plan@2x-vfl7tdW9j.png",title:r.intl.formatMessage({id:"WAEQqE",defaultMessage:"Project plan"}),loggingTitle:"project_plan",desc:r.intl.formatMessage({id:"7kQoXu",defaultMessage:"Organize and track work from start to finish. Help your team stay updated on who's doing what."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:n.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"project-plan"},w={accounting:[v,{imageUrl:"/static/images/growth/personalization/collections_exp/Team_checklist-vflYtWkbF.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Team_checklist@2x-vfl-cPX_9.png",title:r.intl.formatMessage({id:"FAZpqt",defaultMessage:"Team checklist"}),loggingTitle:"team_checklist",desc:r.intl.formatMessage({id:"k9LVWK",defaultMessage:"Manage team to-dos with task assignments, due dates, and reminder notifications."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:n.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"team-checklist"},S],human_resources:[E,h,S],self_employed:[v,_,S],marketing:[g,f,S],art:[m,{imageUrl:"/static/images/growth/personalization/collections_exp/Video_production_plan-vfltPey9e.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Video_production_plan@2x-vflnUV7G8.png",title:r.intl.formatMessage({id:"qLearS",defaultMessage:"Video production plan"}),loggingTitle:"video_production_plan",desc:r.intl.formatMessage({id:"w4SaFl",defaultMessage:"Stay organized and on track from pre- to post-production. Add scripts, music, video, timelines, and budgets."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:n.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"video-production-plan"},S]};t.collectionPanelConfig=function(e,t){switch(t){case o.CollectionFolderType.SHARING:return{overviewDesc:r.intl.formatMessage({id:"8i5CD2",defaultMessage:"We've got ways to make sure files stay protected—however you decide to share them."}),actionsTitle:r.intl.formatMessage({id:"0Pf729",defaultMessage:"Things to try"}),actions:[l,c,d]};case o.CollectionFolderType.SPREADSHEET:return{overviewDesc:r.intl.formatMessage({id:"rKBrhz",defaultMessage:"If you work on files with other people, here’s how to prevent unwanted changes."}),actionsTitle:r.intl.formatMessage({id:"0Pf729",defaultMessage:"Things to try"}),actions:[i,s,a]};case o.CollectionFolderType.PAPER:return{overviewDesc:r.intl.formatMessage({id:"deyLLm",defaultMessage:"Here are some Dropbox Paper templates we think would be most helpful for your role."}),actionsTitle:r.intl.formatMessage({id:"JI9VaJ",defaultMessage:"Try these templates"}),actions:w[e]};case o.CollectionFolderType.FEEDBACK:return{overviewDesc:r.intl.formatMessage({id:"rwgI/k",defaultMessage:"Whether you prefer comments, requesting docs, or private feedback—these tools can help."}),actionsTitle:r.intl.formatMessage({id:"0Pf729",defaultMessage:"Things to try"}),actions:[p,c,u]};default:return}},t.overviewTitle=r.intl.formatMessage({id:"Dvwua+",defaultMessage:"Overview"})})),define("modules/clean/react/growth/personalization/team_space_empty_zone/team_space_empty_zone",["require","exports","tslib","react","react-redux","modules/clean/react/browse/data/selectors","modules/clean/react/async/loadable","modules/clean/web_timing_logger","modules/clean/react/growth/personalization/util","modules/clean/react/growth/personalization/team_space_empty_zone/logger"],(function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importStar(i),c=r.__importStar(c),t.AsyncEmptyStateDropTarget=s.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,a.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/empty_state_drop_target"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().EmptyStateDropTarget]}}))}))}}),t.AsyncSuggestedFolders=s.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,a.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/personalization/suggested_folders/suggested_folders"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().SuggestedFolders]}}))}))}}),t.AsyncInviteEmptyZone=s.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,a.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/personalization/invite_empty_zone"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().InviteEmptyZone]}}))}))}}),t.AsyncDownloadAppZone=s.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,a.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/growth/personalization/download_app_zone/download_app_zone"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().DownloadAppZone]}}))}))}});var d=(function(e){function n(t){var r=e.call(this,t)||this;return r.onToggleSuggestedFolders=function(e){r.setState({curSuggestedFoldersType:e})},r.onToggleSuggestedFolders=r.onToggleSuggestedFolders.bind(r),r.state={curSuggestedFoldersType:l.getSuggestedFoldersType(r.props.personalizedConfigs)},r}return r.__extends(n,e),n.prototype.isEmpty=function(){return 1===this.props.numItems},n.prototype.notInvited=function(){return this.props.numMembers<=1},n.prototype.canShowInviteEmptyZone=function(){return l.enableInvitePanel(this.props.personalizedConfigs)&&this.notInvited()&&this.isEmpty()},n.prototype.canShowSuggestedFolders=function(){return l.getSuggestedFoldersType(this.props.personalizedConfigs)!==l.SuggestedFoldersType.None&&this.props.numInitialItems<=4},n.prototype.canShowSuggestionBarAndDropTarget=function(){return this.state.curSuggestedFoldersType===l.SuggestedFoldersType.SuggestedFoldersAsBar&&this.isEmpty()},n.prototype.getPersonalizationCtx=function(e,t){var r=this.props.personalizedConfigs,o=l.getRole(r),n=l.getFirstPath(r);if(r)return{firstPath:n,role:o,dropTargetBgColor:t,slimMode:e}},n.prototype.getDropTargetViewHelper=function(e,n){if(void 0===e&&(e=l.SlimMode.None),this.isEmpty()){var i=this.getPersonalizationCtx(e,n);return o.default.createElement(t.AsyncEmptyStateDropTarget,r.__assign({},this.props.dropTargetProps,{personalizationCtx:i}))}return null},n.prototype.canShowDownloadAppZone=function(){var e=this.props,t=e.numItems,r=e.personalizedConfigs;return l.enableDownloadAppPanel(t,r)},n.prototype.getSuggestedFoldersView=function(e){var n=this.props,i=n.personalizedConfigs,s=n.suggestedFoldersContext,a=n.numInitialItems,c=l.getRole(i),d=e||l.getSuggestedFoldersType(i),u={userRole:c,numInitialItems:a,activeFirstPath:l.getFirstPath(i)};return o.default.createElement(t.AsyncSuggestedFolders,r.__assign({},s,{logCtx:u,suggestedFoldersExpType:d,onToggle:this.onToggleSuggestedFolders,withDismissAll:!1}))},n.prototype.getSuggestionBarAndDropTargetView=function(){return o.default.createElement(o.default.Fragment,null,this.getSuggestedFoldersView(l.SuggestedFoldersType.SuggestedFoldersAsBar),this.getDropTargetViewHelper())},n.prototype.getInviteViewHelper=function(){var e=this.props.personalizedConfigs,r=l.getRole(e),n=l.getFirstPath(e);return this.props.dropTargetProps.isDraggingFiles?this.getDropTargetViewHelper(l.SlimMode.Slim):this.canShowInviteEmptyZone()?o.default.createElement(t.AsyncInviteEmptyZone,{role:r,path:n}):!this.isEmpty()&&this.notInvited()?null:(c.userViewExploreContentState(r,n,this.props.numItems),this.getSuggestedFoldersViewHelper())},n.prototype.getSuggestedFoldersViewHelper=function(){return this.props.dropTargetProps.isDraggingFiles?this.getDropTargetViewHelper(l.SlimMode.Slim):this.canShowSuggestedFolders()?this.getSuggestedFoldersView():null},n.prototype.getUploadViewHelper=function(){return this.getDropTargetViewHelper(l.SlimMode.None,l.DropTargetBgColorType.Blue)},n.prototype.getExploreViewHelper=function(){var e=this.props.personalizedConfigs;return this.props.dropTargetProps.isDraggingFiles?this.getDropTargetViewHelper():this.canShowSuggestionBarAndDropTarget()?(c.userViewExploreEmptyState(l.getRole(e),this.props.numItems),this.getSuggestionBarAndDropTargetView()):this.canShowSuggestedFolders()?(c.userViewExploreContentState(l.getRole(e),l.getFirstPath(e),this.props.numItems),this.getSuggestedFoldersView()):this.getDropTargetViewHelper()},n.prototype.getDownloadAppViewHelper=function(){var e=this.props,r=e.dropTargetProps.isDraggingFiles,n=e.personalizedConfigs,i=e.numInitialItems;return r?this.getDropTargetViewHelper():this.canShowDownloadAppZone()?o.default.createElement(t.AsyncDownloadAppZone,{userRole:l.getRole(n),path:l.getFirstPath(n),numInitialItems:i}):i>1?this.getSuggestedFoldersView(l.SuggestedFoldersType.SuggestedFoldersAsBar):this.getDropTargetViewHelper()},n.prototype.getCollectionsViewHelper=function(){var e=this.props,t=e.dropTargetProps.isDraggingFiles,r=e.configOverrides;return t?this.getDropTargetViewHelper(l.SlimMode.Slim):r.showSuggestedFolders||l.getSuggestedFoldersType(this.props.personalizedConfigs)===l.SuggestedFoldersType.SuggestedFoldersWithDismissAll?this.getSuggestedFoldersView(l.SuggestedFoldersType.SuggestedFoldersWithDismissAll):this.getDropTargetViewHelper()},n.prototype.getSuggestedFoldersIterationViewHelper=function(){return this.canShowSuggestedFolders()?this.getSuggestedFoldersView():this.getDropTargetViewHelper()},n.prototype.getSplitTmfTsdViewHelper=function(){var e=l.getSuggestedFoldersType(this.props.personalizedConfigs)!==l.SuggestedFoldersType.None,t=e?l.SlimMode.SplitTmfTsdSlim:l.SlimMode.None;return o.default.createElement(o.default.Fragment,null,this.getDropTargetViewHelper(t),e&&this.getSuggestedFoldersView())},n.prototype.render=function(){var e=this.props.personalizedConfigs;if(!e)return this.getDropTargetViewHelper();var t=l.getFirstPath(e);return t===l.FirstPathId.INVITE_MEMBER.valueOf()?this.getInviteViewHelper():t===l.FirstPathId.SUGGESTED_FOLDERS.valueOf()?this.getSuggestedFoldersViewHelper():t===l.FirstPathId.UPLOAD_FOLDERS.valueOf()?this.getUploadViewHelper():t===l.FirstPathId.EXPLORE.valueOf()?this.getExploreViewHelper():t===l.FirstPathId.DOWNLOAD_APP.valueOf()?this.getDownloadAppViewHelper():t===l.FirstPathId.COLLECTIONS.valueOf()?this.getCollectionsViewHelper():t===l.FirstPathId.SUGGESTED_FOLDERS_ITERATION.valueOf()?this.getSuggestedFoldersIterationViewHelper():t===l.FirstPathId.SPLIT_TMF_TSD.valueOf()?this.getSplitTmfTsdViewHelper():this.getDropTargetViewHelper()},n})(o.default.PureComponent),u=n.connect((function(e,t){var r=i.browsePostTTIExperimentsOverrides(e).showPersonalizationSuggestedFolders;return{configOverrides:{showSuggestedFolders:void 0!==typeof r&&r}}}));t.TeamSpaceEmptyZone=u(d)})),define("modules/clean/react/growth/personalization/team_space_empty_zone/logger",["require","exports","tslib","modules/clean/analytics","modules/clean/react/growth/teams_web_actions_logger_events"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){void 0===t&&(t={}),o.TeamsWebActionsLogger.log(e,r.__assign({},t))};t.userViewExploreContentState=function(e,t,r){var o={};o.role=e,o.path=t,o.items_in_team_space=r,i(n.TeamSpaceEmptyZoneLoggerEvents.VIEW_EXPLORE_CONTENT_STATE,o)},t.userViewExploreEmptyState=function(e,t){var r={};r.role=e,r.items_in_team_space=t,i(n.TeamSpaceEmptyZoneLoggerEvents.VIEW_EXPLORE_EMPTY_STATE,r)}})),define("modules/clean/react/growth/personalization/util",["require","exports"],(function(e,t){"use strict";var r,o,n;function i(e){return(null==e?void 0:e.firstPath)||r.NONE}function s(e,t){var n=null==t?void 0:t.desktopCtaType;return n?i(t)===r.DOWNLOAD_APP.valueOf()?a(e,t)?n:o.ShowWithText:n:null}function a(e,t){return!!(null==t?void 0:t.enableDownloadAppPanel)&&e<=1}Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.INVITE_MEMBER="invite",e.UPLOAD_FOLDERS="upload",e.SUGGESTED_FOLDERS="folder",e.DOWNLOAD_APP="download",e.EXPLORE="explore",e.COLLECTIONS="collections",e.SUGGESTED_FOLDERS_ITERATION="suggested_folders_iteration",e.SPLIT_TMF_TSD="split_tmf_tsd",e.NONE=""})(r=t.FirstPathId||(t.FirstPathId={})),(function(e){e[e.ShowWithoutText=1]="ShowWithoutText",e[e.ShowWithText=2]="ShowWithText",e[e.ShowWithTextAsPrimary=3]="ShowWithTextAsPrimary"})(o=t.DesktopCtaType||(t.DesktopCtaType={})),(function(e){e[e.None=0]="None",e[e.SuggestedFoldersAsBar=1]="SuggestedFoldersAsBar",e[e.SuggestedFolders=2]="SuggestedFolders",e[e.SuggestedFoldersWithDismissAll=3]="SuggestedFoldersWithDismissAll"})(n=t.SuggestedFoldersType||(t.SuggestedFoldersType={})),(function(e){e[e.Blue=1]="Blue"})(t.DropTargetBgColorType||(t.DropTargetBgColorType={})),(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.ADMIN_SUPPORT=1]="ADMIN_SUPPORT",e[e.ACCOUNTING_FINANCE=2]="ACCOUNTING_FINANCE",e[e.LEGAL=3]="LEGAL",e[e.IT_INFOSEC=4]="IT_INFOSEC",e[e.ART_DESIGN_CREATIVE=5]="ART_DESIGN_CREATIVE",e[e.MARKETING=6]="MARKETING",e[e.SELF_EMPLOYED_FREELANCE=7]="SELF_EMPLOYED_FREELANCE",e[e.HR=8]="HR"})(t.CollectionsQuickActionsRoleGroup||(t.CollectionsQuickActionsRoleGroup={})),(function(e){e.DROP_TARGET_VIEW="drop_target_view",e.INVITE_VIEW="invite_view",e.SUGGESTED_FOLDERS_VIEW="suggested_folders_view",e.SUGGESTED_FOLDERS_TOGGLE_VIEW="suggested_folders_toggle_view",e.DOWNLOAD_APP_VIEW="download_app_view"})(t.emptyStateType||(t.emptyStateType={})),(function(e){e[e.None=0]="None",e[e.Slim=1]="Slim",e[e.SplitTmfTsdSlim=2]="SplitTmfTsdSlim"})(t.SlimMode||(t.SlimMode={})),t.getFirstPath=i,t.getRole=function(e){return(null==e?void 0:e.role)||""},t.getDesktopCtaType=s,t.getSuggestedFoldersType=function(e){return(null==e?void 0:e.suggestedFoldersType)||n.None},t.enableHideFolderOverview=function(e,t){var r;return!!(null===(r=null==t?void 0:t.hiddenState)||void 0===r?void 0:r.hideFolderOverview)&&e<=4},t.enableHideRightsideActions=function(e){var t;return!!(null===(t=null==e?void 0:e.hiddenState)||void 0===t?void 0:t.hideRightsideActions)},t.enableInvitePanel=function(e){return!!(null==e?void 0:e.enableInvitePanel)},t.enableDesktopCta=function(e,t,o){if(!s(t,o))return!1;var n=i(o);return n===r.UPLOAD_FOLDERS.valueOf()||n===r.SUGGESTED_FOLDERS.valueOf()?t>1:n!==r.INVITE_MEMBER.valueOf()||(e>1||t>1)},t.enableDownloadAppPanel=a,t.enableCollectionsQuickActions=function(e){return!!(null==e?void 0:e.enableCollectionsQuickActions)},t.enableCreateFolderCta=function(e,t){if(void 0===t)return e;var o=t.firstPath;return-1!==[r.SUGGESTED_FOLDERS_ITERATION.valueOf(),r.SPLIT_TMF_TSD.valueOf()].indexOf(o)&&e},t.shouldFirstPathHaveDropTargetIcon=function(e){return void 0!==e&&-1!==[r.COLLECTIONS.valueOf(),r.SUGGESTED_FOLDERS_ITERATION.valueOf(),r.SPLIT_TMF_TSD.valueOf()].indexOf(e)},t.shouldHideFilesPerSplitTmfTsd=function(e,t,o,n,i,s){return!!e||void 0!==s&&(s.firstPath===r.SPLIT_TMF_TSD&&(t&&o&&1===i||n))},t.shouldFilterItemsPerSplitTmfTsd=function(e,t,o,n){return!!e||void 0!==n&&(n.firstPath===r.SPLIT_TMF_TSD&&t&&o)},t.filterOutNonTeamFoldersPerSplitTmfTsd=function(e){return function(t){return t.fq_path!==e}}})),define("modules/clean/react/growth/manage_groups_cta",["require","exports","tslib","react","modules/core/i18n","modules/clean/analytics"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.ManageGroupsCTA=function(e){var t=e.isTeamAdmin;return o.default.createElement("div",{className:"brws-manage-groups-btn"},o.default.createElement("a",{href:t?"/team/admin/groups":"/team",onClick:function(){return i.TeamsWebActionsLogger.log("view_groups_cta_click",{team_admin:t})}},n.intl.formatMessage({id:"jO/Gk0",defaultMessage:"View groups"})))}})),define("modules/clean/react/maestro_nav/folder_explorer/data/reducer",["require","exports","tslib","immutable","modules/clean/react/maestro_nav/folder_explorer/data/types","modules/clean/react/tree_view","modules/core/i18n"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.FILE_EXPLORER_ROOT_PATH="",t.defaultFileExplorerState={tree:i.Tree.createWithRootItem(new i.TreeItem({key:t.FILE_EXPLORER_ROOT_PATH,label:s.intl.formatMessage({id:"iqMtOi",defaultMessage:"Dropbox"}),canExpand:!0})),selectedItemKey:void 0,expandedItemKeys:o.Set([]),user:void 0},t.fileExplorerReducer=function(e,o){switch(void 0===e&&(e=t.defaultFileExplorerState),o.type){case n.ActionTypes.APP_INIT:return(function(e,o){var n=o.payload,s=n.user,a=n.rootFolderName;return r.__assign(r.__assign({},e),{user:s,tree:i.Tree.createWithRootItem(new i.TreeItem({key:t.FILE_EXPLORER_ROOT_PATH,label:a,canExpand:!0}))})})(e,o);case n.ActionTypes.SET_TMF_PATH:return(function(e,t){var o=t.payload.path;return r.__assign(r.__assign({},e),{tmfPath:o})})(e,o);case n.ActionTypes.SELECT_FOLDER:return(function(e,t){var o=t.payload.folder;return r.__assign(r.__assign({},e),{selectedItemKey:o.key})})(e,o);case n.ActionTypes.EXPAND_FOLDER:return(function(e,t){var o=t.payload.folder;return r.__assign(r.__assign({},e),{expandedItemKeys:e.expandedItemKeys.add(o.key)})})(e,o);case n.ActionTypes.COLLAPSE_FOLDER:return(function(e,t){var o=t.payload.folder;return r.__assign(r.__assign({},e),{expandedItemKeys:e.expandedItemKeys.delete(o.key)})})(e,o);case n.ActionTypes.ADD_SUB_FOLDERS:return(function(e,t){var o=t.payload,n=o.folder,i=o.subFolders,s=e.tree;return r.__assign(r.__assign({},e),{tree:s.setChildItems(n,i)})})(e,o)}return e}})),define("modules/clean/react/maestro_nav/folder_explorer/data/store",["require","exports","modules/clean/redux/namespaces","modules/clean/react/maestro_nav/folder_explorer/data/reducer","modules/clean/redux/store"],(function(e,t,r,o,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForFileExplorer=function(){var e;return i||(i=n.getStoreAndRegisterReducers(((e={})[r.FILE_EXPLORER_NAMESPACE_KEY]=o.fileExplorerReducer,e))),i}})),define("modules/clean/react/maestro_nav/folder_explorer/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.APP_INIT="FILE_EXPLORER/APP_INIT",e.SET_TMF_PATH="FILE_EXPLORER/SET_TMF_PATH",e.SELECT_FOLDER="FILE_EXPLORER/SELECT_FOLDER",e.EXPAND_FOLDER="FILE_EXPLORER/EXPAND_FOLDER",e.COLLAPSE_FOLDER="FILE_EXPLORER/COLLAPSE_FOLDER",e.GET_SUB_FOLDERS="FILE_EXPLORER/GET_SUB_FOLDERS",e.ADD_SUB_FOLDERS="FILE_EXPLORER/ADD_SUB_FOLDERS",e.OPEN_TO_PATH="FILE_EXPLORER/OPEN_TO_PATH",e.APPLY_BOLT_UPDATES="FILE_EXPLORER/APPLY_BOLT_UPDATES"})(t.ActionTypes||(t.ActionTypes={}))})),define("modules/clean/react/new_file_menu/new_file_icon",["require","exports","tslib","react","spectrum/icon_partners","modules/clean/static_urls"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var s={dropbox_form:i.static_url("/static/images/dropbox_form-vfl1f-v2W.svg"),microsoft_docx:i.static_url("/static/images/cloud_docs/docx_icon-vfl0tYCBy.svg"),microsoft_xlsx:i.static_url("/static/images/cloud_docs/xlsx_icon-vflnPbWkI.svg"),microsoft_pptx:i.static_url("/static/images/cloud_docs/pptx_icon-vflRYqDYS.svg")};t.NewFileIcon=function(e){var t=e.iconName,r=e.displayName,i=s[t];return i?o.default.createElement("img",{alt:r,src:i,width:"24px",height:"24px"}):o.default.createElement(n.IconPartners,{name:t,width:"24px",height:"24px"})}})),define("modules/clean/react/new_file_menu/new_file_menu",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/typography","dig-components/menu","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/create_api","modules/clean/react/browse/action_logger","modules/clean/react/css","modules/clean/web_user_action_events","modules/constants/page_load","modules/clean/react/new_file_menu/new_file_icon","modules/clean/react/new_file_menu/new_file_util"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),_=r.__importStar(_),t.handleNewFileSelection=function(e){e.handleClick()};var h=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.default.createElement(a.Menu.ActionItem,{key:this.props.item.displayName,value:this.props.item,className:this.props.item.className,withLeftAccessory:n.default.createElement(f.NewFileIcon,{displayName:this.props.item.displayName,iconName:this.props.item.iconName})},n.default.createElement(s.Text,null,this.props.item.displayName))},t})(n.default.Component);t.NewFileTypeRow=h;var g=(function(e){function s(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCreateNewFile=function(e){return function(){var r=t.props,o=r.selection_mode,n=r.empty_folder,i=function(r){c.showAsyncFolderDialog({user:t.props.user,source:t.props.source,documentType:e,selection_mode:o,empty_folder:n,handleClickNewFolder:t.props.handleClickNewFolder?t.props.handleClickNewFolder(t.props.user,i):void 0,initialPath:r})};d.logFileCreateClick({uid:t.props.user.id,source:t.props.source,action:m.newFileTypeToLogEvent(e),depth_folder_selected:t.props.path?c.getDepthFromPath(t.props.path):void 0,selection_mode:o,empty_folder:n}),t.props.path?c.createNewFile({user:t.props.user,path:t.props.path,documentType:e,source:t.props.source,selection_mode:o,empty_folder:n,enableShortcutExtensionFeedback:t.props.enableShortcutExtensionFeedback}):i()}},t.logTriggerClick=function(){var e=t.props,r=e.empty_folder,o=e.selection_mode,n=e.path,i=e.user,s=e.source;d.logFileCreateClick({uid:i.id,source:s,action:p.WebUserActionLogEvent.FILE_CREATE_OPEN_MENU,depth_folder_selected:n?c.getDepthFromPath(n):void 0,selection_mode:o,empty_folder:r})},t}return r.__extends(s,e),s.prototype.getNewFileTypeSections=function(){var e=[],t=[];this.props.showPaper&&(t.push({displayName:m.NewPaperDocLabel,iconName:"dropbox_paper",className:"action-create-file-paper-doc",handleClick:this.handleCreateNewFile(l.PaperNewFileTypes.PAPER)}),t.push({displayName:m.NewPaperTemplateLabel,iconName:"dropbox_paper_template",className:"action-create-file-paper-template",handleClick:this.handleCreateNewFile(l.PaperNewFileTypes.PAPER_TEMPLATE)})),this.props.showBinder&&t.push({displayName:m.NewPaperBinderDocLabel,iconName:"dropbox_paper_binder",className:"action-create-file-paper-binder",handleClick:this.handleCreateNewFile(l.PaperNewFileTypes.PAPER_BINDER)}),t.push({displayName:m.NewSimplePointerLabel,iconName:"shortcut",className:"action-create-simple-pointer",handleClick:this.handleCreateNewFile(l.PointerFileTypes.SIMPLE_POINTER)}),t.length>0&&e.push(t);var r=[];if(r.push({displayName:m.NewMicrosoftWordDocLabel,iconName:"microsoft_docx",className:"action-create-file-word",handleClick:this.handleCreateNewFile(l.MicrosoftFileTypes.WORD)}),r.push({displayName:m.NewMicrosoftExcelWorkbookLabel,iconName:"microsoft_xlsx",className:"action-create-file-excel",handleClick:this.handleCreateNewFile(l.MicrosoftFileTypes.EXCEL)}),r.push({displayName:m.NewMicrosoftPowerPointPresentationLabel,iconName:"microsoft_pptx",className:"action-create-file-powerpoint",handleClick:this.handleCreateNewFile(l.MicrosoftFileTypes.POWERPOINT)}),e.push(r),this.props.showGdd){var o=[];o.push({displayName:m.NewGoogleDocsLabel,iconName:"google_gdoc",className:"action-create-file-google-doc",handleClick:this.handleCreateNewFile(l.GoogleFileTypes.GOOGLE_DSS_DOC)}),o.push({displayName:m.NewGoogleSheetsLabel,iconName:"google_gsheet",className:"action-create-file-google-sheet",handleClick:this.handleCreateNewFile(l.GoogleFileTypes.GOOGLE_DSS_SHEET)}),o.push({displayName:m.NewGoogleSlidesLabel,iconName:"google_gslides",className:"action-create-file-google-slides",handleClick:this.handleCreateNewFile(l.GoogleFileTypes.GOOGLE_DSS_SLIDES)}),e.push(o)}return e},s.prototype.renderTrigger=function(e){var t=0===_.USER_LOCALE.indexOf("en")||this.props.forceLongLabel?m.LongNewFileCreateLabel:m.ShortNewFileCreateLabel,s=r.__assign(r.__assign({},e),{disabled:this.props.disabled,className:o.default("primary-action-menu__button","action-create-file"),variant:this.props.enableSecondary?"outline":"primary"});return n.default.createElement(i.Button,r.__assign({key:m.LongNewFileCreateLabel,withDropdownIcon:!0},s),t)},s.prototype.renderSection=function(e,t){return n.default.createElement(a.Menu.Segment,{key:t},e.map((function(e){return n.default.createElement(h,{item:e,key:e.displayName})})))},s.prototype.render=function(){var e=this,o=this.getNewFileTypeSections();return n.default.createElement(a.Menu.Wrapper,{onToggle:this.logTriggerClick,onSelection:t.handleNewFileSelection},(function(t){var i=t.getContentProps,s=t.getTriggerProps;return n.default.createElement(n.default.Fragment,null,e.renderTrigger(s()),n.default.createElement(a.Menu.Content,r.__assign({},i()),o.map(e.renderSection)))}))},s.defaultProps={},s})(n.default.Component),S=u.requireCssWithComponent(g,["/static/css/dig-components/index.web-vflrectwC.css","/static/css/cloud_docs/create_pointer_modal-vflATc8Dt.css"]);t.NewFileMenu=S})),define("modules/clean/react/new_file_menu/new_file_util",["require","exports","modules/clean/cloud_docs/constants","modules/clean/web_user_action_events","modules/core/i18n"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LongNewFileCreateLabel=n.intl.formatMessage({id:"8/w9ir",defaultMessage:"Create new file"}),t.ShortNewFileCreateLabel=n.intl.formatMessage({id:"o96TiK",defaultMessage:"Create"}),t.NewGoogleDocsLabel=n.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),t.NewGoogleSheetsLabel=n.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),t.NewGoogleSlidesLabel=n.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"}),t.NewMicrosoftExcelWorkbookLabel=n.intl.formatMessage({id:"0rYKaW",defaultMessage:"Excel Workbook"}),t.NewMicrosoftPowerPointPresentationLabel=n.intl.formatMessage({id:"e9uLbL",defaultMessage:"PowerPoint Presentation"}),t.NewMicrosoftWordDocLabel=n.intl.formatMessage({id:"yY5byF",defaultMessage:"Word Document"}),t.NewPaperDocLabel=n.intl.formatMessage({id:"neBk7u",defaultMessage:"Dropbox Paper"}),t.NewPaperTemplateLabel=n.intl.formatMessage({id:"Rvv7NR",defaultMessage:"Dropbox Paper Template"}),t.NewPaperBinderDocLabel=n.intl.formatMessage({id:"sbO30Y",defaultMessage:"Dropbox Binder (Beta)"}),t.NewSimplePointerLabel=n.intl.formatMessage({id:"4gEt6j",defaultMessage:"Shortcut"}),t.newFileTypeToLogEvent=function(e){switch(e){case r.MicrosoftFileTypes.WORD:return o.WebUserActionLogEvent.FILE_CREATE_WORD;case r.MicrosoftFileTypes.EXCEL:return o.WebUserActionLogEvent.FILE_CREATE_EXCEL;case r.MicrosoftFileTypes.POWERPOINT:return o.WebUserActionLogEvent.FILE_CREATE_POWERPOINT;case r.GoogleFileTypes.GOOGLE_DSS_DOC:return o.WebUserActionLogEvent.FILE_CREATE_GOOGLE_DOC;case r.GoogleFileTypes.GOOGLE_DSS_SHEET:return o.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SHEET;case r.GoogleFileTypes.GOOGLE_DSS_SLIDES:return o.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SLIDES;case r.PaperNewFileTypes.PAPER:return o.WebUserActionLogEvent.FILE_CREATE_PAPER;case r.PaperNewFileTypes.PAPER_TEMPLATE:return o.WebUserActionLogEvent.FILE_CREATE_PAPER_TEMPLATE;case r.PaperNewFileTypes.PAPER_BINDER:return o.WebUserActionLogEvent.FILE_CREATE_BINDER;case r.PointerFileTypes.SIMPLE_POINTER:return o.WebUserActionLogEvent.FILE_CREATE_SIMPLE_POINTER}}})),define("modules/clean/react/path_breadcrumbs",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","dig-components/typography","spectrum/icon_content","modules/clean/em_string","modules/clean/filepath","modules/clean/react/icon/icon_helper","modules/clean/react/title_bubble","modules/clean/user_education/react/user_education_effect","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/core/i18n","modules/clean/react/sticky_position"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),a=r.__importStar(a),p=r.__importStar(p);var v;function w(e,t,r){return void 0===r&&(r=20),r-(t?2.625:new u.Emstring(e).length)}function T(e,t,r,o,n){void 0===n&&(n=20);for(var i=e.split("/").filter(Boolean),s=[{path:"",icon:"folder_dropbox-small",folderName:t,alt:r}],a=_.spectrumFolderIcon({size:_.SpectrumIconSize.Small}),l=0;l<i.length;l++)e="/"+i.slice(0,l+1).join("/"),s.push({path:e,folderName:p.filename(e),icon:a,alt:S.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"})});if(s.length<3)return{dropdownCrumbs:[],inlineCrumbs:s,root:s[0]};var c=w(s[0]&&s[0].folderName||"",!1,n),d=s.map((function(e){return new u.Emstring(e.folderName||"").length})),f=1,m=d[s.length-1];for(l=s.length-2;l>=1&&(m+=1.64,!((m+=d[l])>c));l--)f+=1;s.length===f+1&&(f+=1),1===f&&o===v.SMALL&&f++;var h=s.length-f;return{dropdownCrumbs:s.slice(0,h),inlineCrumbs:s.slice(h),root:s[0]}}t.generateBreadcrumbData=T,(function(e){e.LARGE="LARGE",e.SMALL="SMALL"})(v=t.PathBreadcrumbsSize||(t.PathBreadcrumbsSize={}));var b=(function(e){function t(t){var r=e.call(this,t)||this;r._breadcrumbContainerElement=null,r.resizeListener=function(){var e=r.getBreadcrumbsContainerSpan();if(e){var t=e.getBoundingClientRect().width;r.props.expMobileWebInvites&&(t-=20);var o=Math.max(0,r.getMaxWidthInEm(t));o!==r.state.maxWidthInEm&&o>0&&r.setState({maxWidthInEm:o})}},r.handleTitleClick=function(e){return function(t){var o=e.path;if(0===t.button){if(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)return void t.stopPropagation();t.preventDefault(),t.stopPropagation(),h.UEClient.sendEvent("BreadcrumbSegment","linkClicked",{path:o}),r.props.setUrl({path:o})}}};var o=r.getBreadcrumbsContainerSpan();return r.state={maxWidthInEm:o?r.getMaxWidthInEm(o.getBoundingClientRect().width):20},r}return r.__extends(t,e),t.prototype.getBreadcrumbsContainerSpan=function(){if(!this._breadcrumbContainerElement){var e=document.getElementsByClassName("maestro-app-content");e&&1===e.length&&(this._breadcrumbContainerElement=e[0])}return this._breadcrumbContainerElement},t.prototype.getMaxWidthInEm=function(e){return(e-100)/22},t.prototype.componentDidMount=function(){var e=this;window.addEventListener("resize",this.resizeListener),g.waitForTTI().then((function(){return e.resizeListener()}))},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.resizeListener)},t.prototype.componentDidUpdate=function(e){e.expMobileWebInvites!==this.props.expMobileWebInvites&&this.resizeListener()},t.prototype.render=function(){var e=this,t=this.props.path,i=this.props,s=i.firstBreadcrumbName,a=i.firstBreadcrumbAlt,l=i.shouldHighlightDropTargets,d=i.setFileUploaderPath,u=i.getUrlForPath,_=i.setUrl,f=i.size,h=i.enableDragging,g=this.state.maxWidthInEm?this.state.maxWidthInEm:20,E=T(t,s,a,f,g),b=E.dropdownCrumbs,y=E.inlineCrumbs,C=E.root,O=w(C&&C.folderName||"",b.length>0,g),A=o.default({"brws-path-breadcrumbs":!0,"brws-path-breadcrumbs--small":this.props.size===v.SMALL});if(y.length>1||b.length>0)return n.default.createElement("span",{className:A},n.default.createElement("h1",{className:"ax-visually-hidden"},p.filename(t)),n.default.createElement("nav",{className:"page-header-text u-l-fl",id:"path-breadcrumbs","aria-label":S.intl.formatMessage({id:"SzftTr",defaultMessage:"Folder hierarchy"}),role:"navigation"},b.length>0&&n.default.createElement(F,{crumbs:b,currentPath:t,shouldHighlightDropTargets:l,setFileUploaderPath:d,setUrl:_,enableDragging:!!h,onTitleClick:this.handleTitleClick,getUrlForPath:u}),y.map((function(o,i){return n.default.createElement(I,r.__assign({},o,{key:encodeURI(o.path),isOnlyCrumb:0===i&&1===y.length&&0===b.length,index:i,isLastCrumb:i===y.length-1,maxWidth:O,currentPath:t,shouldHighlightDropTargets:l,setFileUploaderPath:d,getUrlForPath:u,setUrl:_,size:f,enableDragging:!!h,onTitleClick:e.handleTitleClick(o)}))}))));var P=f===v.SMALL?c.Text:c.Title,L=f===v.SMALL?"small":"standard";return n.default.createElement(m.UserEducationEffect,{containerName:"PathBreadcrumbs",name:"HomeTitle",useSpan:!0},n.default.createElement(P,{size:L,className:"page-header-text"},s))},t.defaultProps={path:"/",shouldHighlightDropTargets:!1,setFileUploaderPath:function(){},size:v.LARGE,enableDragging:!1},t})(n.default.PureComponent);t.PathBreadcrumbs=b;var I=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleDragEnter=function(e){e.preventDefault(),e.target!==r.lastEnteredElement&&r.props.enableDragging&&(r.lastEnteredElement=e.target,r.dragEnterCount+=1,r.setState({isDraggedOver:!0}),r.props.isLastCrumb||r.props.setFileUploaderPath({path:r.props.path,targetSurface:"breadcrumb"}))},r.handleDragLeave=function(e){e.preventDefault(),r.props.enableDragging&&(r.lastEnteredElement=null,r.dragEnterCount-=1,r.dragEnterCount<1&&(r.dragEnterCount=0,r.state.isDraggedOver&&(r.props.setFileUploaderPath({path:r.props.currentPath}),r.setState({isDraggedOver:!1}))))},r.handleDrop=function(){r.setState({isDraggedOver:!1})},r.handleDragOver=function(e){e.preventDefault(),e.stopPropagation()},r.handleMouseEnter=function(){r.props.enableDragging||r.setState({isDraggedOver:!0})},r.handleMouseLeave=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.handleMouseUp=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.eventHandlers={onDragEnter:r.handleDragEnter,onDragLeave:r.handleDragLeave,onDrop:r.handleDrop,onDragOver:r.handleDragOver,onMouseEnter:r.handleMouseEnter,onMouseLeave:r.handleMouseLeave,onMouseUp:r.handleMouseUp},r.state={isDraggedOver:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0,this.lastEnteredElement=null},t.prototype.render=function(){var e,t=this.props,i=t.getUrlForPath,l=t.path,d=t.index,p=t.isOnlyCrumb,_=t.maxWidth,h=t.isLastCrumb,g=t.shouldHighlightDropTargets,S=t.size,w=p?this.props.folderName:u.Emstring.em_snippet(this.props.folderName,_),T={"breadcrumb-segment":!0,"breadcrumb-text-dragged-over":!h&&g&&this.state.isDraggedOver},b=S===v.SMALL?c.Text:c.Title,I=S===v.SMALL?"small":"standard";return e=h?n.default.createElement(b,r.__assign({size:I,"aria-current":"page"},this.eventHandlers,{"data-testid":"breadcrumb-segment"}),w):n.default.createElement("span",r.__assign({className:"breadcrumb-segment__wrapper"},this.eventHandlers),n.default.createElement(m.UserEducationEffect,{containerName:"BreadcrumbSegment",name:"link-"+d,useSpan:!0},n.default.createElement(b,{size:I,color:"faint"},n.default.createElement("a",{href:i(l).toString(),onClick:this.props.onTitleClick,className:o.default(T),"data-testid":"breadcrumb-segment"},w),n.default.createElement(s.UIIcon,{src:a.ChevronRightLine,size:"small",className:"breadcrumb__spacer"})))),this.props.folderName!==w?n.default.createElement(f.TitleBubble,{content:this.props.folderName,position:E.StickyPosition.BOTTOM,className:"list-label__title-bubble"},e):e},t.defaultProps={isOnlyCrumb:!1,shouldHighlightDropTargets:!1,disableDragging:!1},t})(n.default.Component);t.BreadcrumbSegment=I;var y=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleDragEnter=function(e){e.preventDefault(),e.target!==r.lastEnteredElement&&r.props.enableDragging&&(r.lastEnteredElement=e.target,r.dragEnterCount+=1,r.setState({isDraggedOver:!0}),r.props.setFileUploaderPath({path:r.props.path,targetSurface:"breadcrumb"}))},r.handleDragLeave=function(e){e.preventDefault(),r.props.enableDragging&&(r.lastEnteredElement=null,r.dragEnterCount-=1,r.dragEnterCount<1&&(r.dragEnterCount=0,r.state.isDraggedOver&&(r.props.setFileUploaderPath({path:r.props.currentPath}),r.setState({isDraggedOver:!1}))))},r.handleDrop=function(e){r.setState({isDraggedOver:!1}),r.dragEnterCount=0,r.props.onClose()},r.handleDragOver=function(e){e.preventDefault(),e.stopPropagation()},r.handleMouseEnter=function(){r.props.enableDragging&&r.setState({isDraggedOver:!0})},r.handleMouseLeave=function(){r.state.isDraggedOver&&(r.setState({isDraggedOver:!1}),r.props.onClose())},r.handleMouseUp=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1}),r.props.enableDragging&&!r.props.isLastCrumb&&r.props.onClose()},r.state={isDraggedOver:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0,this.lastEnteredElement=null},t.prototype.render=function(){var e=this.props,t=e.icon,r=e.alt,i=e.folderName,s={"breadcrumb-text-dragged-over":this.state.isDraggedOver};return n.default.createElement(l.Menu.LinkItem,{href:this.props.href,onClick:this.props.onCrumbClick,className:o.default(s),withLeftAccessory:n.default.createElement(d.IconContent,{name:t,"aria-label":r,role:"img",className:"breadcrumb-menu-item-icon"}),onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop,onDragOver:this.handleDragOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseUp:this.handleMouseUp},u.Emstring.em_snippet(i,20))},t.defaultProps={isHighlightedDropTarget:!1,onClose:function(){},alt:"",disableDragging:!1},t})(n.default.Component);t.BreadcrumbMenuItem=y;var F=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={menuVisible:!1},t.handleDragOver=function(e){return function(r){t.props.enableDragging&&(r.preventDefault(),e({autoFocus:!1}),t.setState({menuVisible:!0}))}},t.handleInnerDragEnter=function(e){e.preventDefault(),t.dragEnterCount++},t.handleDragLeave=function(e){return function(r){r.preventDefault(),t.dragEnterCount--,t.dragEnterCount<1&&(t.dragEnterCount=0,t.state.menuVisible&&(t.setState({menuVisible:!1}),e({autoFocus:!1})))}},t.handleMouseEnter=function(e){return function(r){t.props.enableDragging&&(r.preventDefault(),t.setState({menuVisible:!0}),e({autoFocus:!1}))}},t.handleCrumbSelected=function(e){t.props.setUrl({path:e})},t.handlePopoverToggle=function(e){var r=e.isOpen;t.setState({menuVisible:r})},t.handleClose=function(){t.dragEnterCount=0,t.handlePopoverToggle({isOpen:!1})},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0},t.prototype.render=function(){var e=this,t=r.__spreadArrays(this.props.crumbs).reverse(),o=this.props,u=o.currentPath,p=o.shouldHighlightDropTargets,_=o.setFileUploaderPath,f=o.enableDragging,m=o.onTitleClick,h=S.intl.formatMessage({id:"JY5LSc",defaultMessage:"Show parent folders (descending)"});return n.default.createElement(n.default.Fragment,null,n.default.createElement(l.Menu.Wrapper,{onSelection:this.handleCrumbSelected,shouldClickThroughOnClose:!0,className:"breadcrumb-menu-wrapper"},(function(o){var s=o.getContentProps,a=o.getTriggerProps,c=o.openMenu,g=o.closeMenu;return n.default.createElement(n.default.Fragment,null,n.default.createElement(i.IconButton,r.__assign({variant:"transparent",onDragOver:e.handleDragOver(c),onMouseEnter:e.handleMouseEnter(c)},a()),n.default.createElement(d.IconContent,{name:"folder_dropdown-small","aria-label":h,role:"img",className:"breadcrumb-menu-icon"})),n.default.createElement(l.Menu.Content,r.__assign({},s(),{onDragEnter:e.handleInnerDragEnter,onDragLeave:e.handleDragLeave(g)}),n.default.createElement(l.Menu.Segment,null,t.map((function(t){return n.default.createElement(y,{key:encodeURI(t.path),path:t.path,icon:t.icon,alt:t.alt,folderName:t.folderName,currentPath:u,isHighlightedDropTarget:p,setFileUploaderPath:_,onClose:e.handleClose,enableDragging:f,onCrumbClick:m(t),href:e.props.getUrlForPath(t.path).toString()})})))))})),n.default.createElement(c.Text,{color:"faint",className:"breadcrumb-menu-icon-parent"},n.default.createElement(s.UIIcon,{src:a.ChevronRightLine,className:"breadcrumb__spacer",size:"small"})))},t.defaultProps={shouldHighlightDropTargets:!1},t})(n.default.Component)})),define("modules/clean/react/share_download/api",["require","exports","tslib","modules/clean/ajax_as_promised"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var n=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})((function(e){this.message=e}));t.DownloadError=n;var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(n);t.TooLargeError=i,t.testDownload=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,o.SilentBackgroundRequest({url:e})];case 1:return t=r.sent(),[3,3];case 2:throw r.sent(),new n;case 3:if("OK"!==t)throw 0===t.indexOf("err:")?new i:new n;return[2]}}))}))},t.fetchDownloadUrl=function(e){return o.SilentBackgroundRequest({url:"/sharing/fetch_user_content_link",data:{url:e}})}})),define("modules/clean/redux/tests/store",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mockExtraArguments=function(){return{}}})),define("modules/clean/react/upload_kit/lib/processors",["require","exports","tslib","modules/clean/react/upload_kit/lib/types","modules/clean/react/upload_kit/utils/makers","modules/clean/react/upload_kit/utils/path","modules/clean/react/upload_kit/utils/file","modules/clean/filepath","modules/core/uri"],(function(e,t,r,o,n,i,s,a,l){"use strict";function c(e){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){return[2,e.map((function(e){var t=e[0],r=e[1];return n.makeFileUploadItem(t,o.isWebkitFile(t)&&""!==t.webkitRelativePath?t.webkitRelativePath:t.name,r)}))]}))}))}function d(e,t,r){return Promise.resolve([n.makeFileUploadItem(e,t,r)])}function u(e,t){return r.__awaiter(this,void 0,Promise,(function(){var o,a,l=this;return r.__generator(this,(function(c){switch(c.label){case 0:return[4,Promise.all(e.map((function(e){return r.__awaiter(l,void 0,void 0,(function(){var o;return r.__generator(this,(function(r){switch(r.label){case 0:return(null==e?void 0:e.isFile)?[4,s.getFile(e)]:[3,2];case 1:return o=r.sent(),[2,[n.makeFileUploadItem(o,i.getDestPath(e),t)]];case 2:return(null==e?void 0:e.isDirectory)?[4,p(e)]:[3,4];case 3:return[2,u(r.sent(),t)];case 4:return[2,null]}}))}))})))];case 1:return o=c.sent(),a=[],o.forEach((function(e){e&&a.push.apply(a,e)})),[2,a]}}))}))}function p(e){return r.__awaiter(this,void 0,Promise,(function(){function t(e){return r.__awaiter(this,void 0,Promise,(function(){var o=this;return r.__generator(this,(function(n){return[2,new Promise((function(n,i){return e.readEntries((function(i){return r.__awaiter(o,void 0,void 0,(function(){var o,s;return r.__generator(this,(function(a){switch(a.label){case 0:return i.length>0?(o=n,s=[i],[4,t(e)]):[3,2];case 1:return o.apply(void 0,[r.__spreadArrays.apply(void 0,s.concat([a.sent()]))]),[3,3];case 2:n(i),a.label=3;case 3:return[2]}}))}))}),(function(e){return i(e)}))}))]}))}))}return r.__generator(this,(function(r){return[2,t(e.createReader())]}))}))}function _(e){var t={};return e.map((function(e){return a.parent_dir(e.destPath)})).forEach((function(e){""!==e&&"/"!==e&&(t[e]=e)})),Object.keys(t).map((function(e){return n.makeDirectoryUploadItem(e)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.preprocessFiles=c,t.preprocessBlob=d,t.preprocessDropboxFiles=function(e){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){return[2,e.map((function(e){var t=e[0],r=e[1];return n.makeChooserUploadItem(t,r)}))]}))}))},t.preprocessDataTransfer=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){var o,n,i,a,p;return r.__generator(this,(function(r){return o=e.files,n=e.items,(i=e.types)&&i.length>0&&-1===i.indexOf("Files")?(a=s.getDataTransferUrl(e),p=l.URI.parse(a).getAuthority(),[2,d(s.makeLinkBlob(a),"#"+p+".url",t)]):n&&n.length>0&&n[0]&&n[0].webkitGetAsEntry?[2,u(Array.from(n).map((function(e){return e.webkitGetAsEntry()})),t)]:o&&o.length>0?[2,c(Array.from(o).map((function(e){return[e,t||{}]})))]:[2,Promise.resolve([])]}))}))},t.preprocessFileSystemEntries=u,t.readDirectory=p,t.collectDirectories=_,t.resolveDuplicates=function(e,t){void 0===t&&(t=[]);var r=new Set,o=new Set,n=[];return t&&t.forEach((function(e){o.add(e.id),r.add(i.getNameAtRoot(e.destPath).toLowerCase())})),e.forEach((function(e){if(!o.has(e.id)){var t,s=-1!==e.destPath.indexOf("/"),l=1,c=i.getNameAtRoot(e.destPath),d=a.split_filename(c);if(r.has(c.toLowerCase()))do{t=d.name+" ("+l+")",c=d.ext?t+"."+d.ext:t,l++}while(r.has(c.toLowerCase()));if(s){var u=e.destPath.split("/");u[0]=c,e.destPath=u.join("/")}else e.destPath=c;o.add(e.id),r.add(e.destPath.toLowerCase()),n.push(e)}})),n},t.processFilesWithRenaming=function(e,r,o){return Promise.resolve(t.resolveDuplicates(e,o)).then((function(e){return{errors:r,items:e.concat(_(e))}}))}})),define("modules/clean/react/upload_kit/lib/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWebkitFile=function(e){return"webkitRelativePath"in e},t.isChooserFile=function(e){return"bytes"in e},(function(e){e.Dropbox="dropbox",e.Computer="computer",e.Server="server"})(t.FileSource||(t.FileSource={})),(function(e){e.Staged="staged",e.Queued="queued",e.Uploading="uploading",e.Success="success",e.Error="error",e.Cancelling="cancelling"})(t.UploadStatus||(t.UploadStatus={})),(function(e){e.CloudDoc="cloud_doc",e.EmptyFile="empty_file",e.IgnoredFile="ignored_file",e.OverMaxFileSize="over_max_file_size",e.PointerFile="pointer_file",e.TemporaryFile="temporary_file",e.Unknown="unknown"})(t.UploadValidationError||(t.UploadValidationError={}))})),define("modules/clean/react/upload_kit/lib/upload_block",["require","exports","modules/clean/csrf","modules/core/uri"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uploadBlock=function(e,t,n,i){var s=new o.URI({scheme:"https",authority:"dl-web.dropbox.com",path:"/put_block_returning_token",query:{owner_id:e.toString(),_subject_uid:e.toString(),t:r.readCsrfToken()||"",reported_block_size:i.size.toString(),num_blocks:Math.ceil(n/i.size).toString(),ns_id_for_routing:t.toString()}});return new Promise((function(e,t){var r=new XMLHttpRequest;return r.withCredentials=!0,r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE)if(200===r.status){var o=JSON.parse(r.responseText);o.token?e(o.token):t("Server token empty or undefined error.")}else t("Server error "+r.status)},r.open("POST",s.toString(),!0),r.setRequestHeader("Content-Type","application/octet-stream"),r.send(i),r}))}})),define("modules/clean/react/upload_kit/uploader/async_controller",["require","exports","tslib"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function t(e){var t=e.onLoaded,o=r.__rest(e,["onLoaded"]);this.onLoaded=t,this.controllerProps=o}return t.prototype.get=function(){var t=this;return this.promise||(this.promise=new Promise((function(o){return r.__awaiter(t,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(i){switch(i.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/upload_kit/uploader/controller"],t,r)})).then(r.__importStar)];case 1:return t=i.sent().UploadController,n=new t(this.controllerProps),this.onLoaded(n),o(n),[2]}}))}))}))),this.promise},t})();t.AsyncUploadController=o})),define("modules/clean/react/upload_kit/uploader/context",["require","exports","tslib","react","modules/clean/react/helpers","modules/clean/react/upload_kit/uploader/async_controller","modules/clean/react/upload_kit/lib/processors"],(function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(o=r.__importDefault(o)).default.createContext({}),l=0;var c=(function(e){function t(t){var n,a,c,d=e.call(this,t)||this;return d.fileField=o.default.createRef(),d.folderField=o.default.createRef(),d.chooseHandled=new Set,d.state={uploadItems:[],isUploading:!1},d.setInitialUploadedItems=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).setInitialUploadedItems.apply(t,e)]}}))}))},d.cancelUploadItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).cancelUploadItem.apply(t,e)]}}))}))},d.chooseFiles=function(){return r.__awaiter(d,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){return e=this.fileField?this.fileField.current:null,[2,this.chooseLocalFiles(e)]}))}))},d.chooseFolder=function(){return r.__awaiter(d,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){return e=this.folderField?this.folderField.current:null,[2,this.chooseLocalFiles(e)]}))}))},d.chooseLocalFiles=(n=function(e){return void 0===e&&(e=null),d.asyncController.get(),new Promise((function(t,o){if(e){e.dataset.uploadKitId||(e.dataset.uploadKitId=String(l++));var n=e.dataset.uploadKitId,i=function(){return r.__awaiter(d,void 0,void 0,(function(){var s,a;return r.__generator(this,(function(r){switch(r.label){case 0:if(this.chooseHandled.delete(n),e.removeEventListener("change",i),!e.files)return[3,6];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,this.asyncController.get()];case 2:return[4,r.sent().addFiles(Array.from(e.files))];case 3:return s=r.sent(),t(s),[3,5];case 4:return a=r.sent(),o(a),[3,5];case 5:return[3,7];case 6:o(),r.label=7;case 7:return[2]}}))}))};d.chooseHandled.has(n)||(d.chooseHandled.add(n),e.addEventListener("change",i)),e.value="",e.click()}else o()}))},void 0===a&&(a=100),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c||(c=n.apply(void 0,e),setTimeout((function(){c=void 0}),a)),c}),d.chooseDropboxFiles=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).chooseDropboxFiles.apply(t,e)]}}))}))},d.handleDrop=function(e,t){return r.__awaiter(d,void 0,void 0,(function(){var o,n;return r.__generator(this,(function(r){switch(r.label){case 0:return e?[4,Promise.all([s.preprocessDataTransfer(e,{parentPath:t}),this.asyncController.get()])]:[2,Promise.reject()];case 1:return o=r.sent(),n=o[0],[2,o[1].addUploadItems(n)]}}))}))},d.makeDirectory=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).makeDirectory.apply(t,e)]}}))}))},d.moveUploadItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).moveUploadItem.apply(t,e)]}}))}))},d.removeUploadItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).removeUploadItem.apply(t,e)]}}))}))},d.renameUploadItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).renameUploadItem.apply(t,e)]}}))}))},d.startUploading=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).startUploading.apply(t,e)]}}))}))},d.stopUploading=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).stopUploading.apply(t,e)]}}))}))},d.asyncController=new i.AsyncUploadController(r.__assign(r.__assign({},t),{onLoaded:function(e){d.subscription=function(e){d.setState(e)},e.subscribe(d.subscription)}})),d}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.subscription?[4,this.asyncController.get()]:[3,2];case 1:e.sent().unsubscribe(this.subscription),e.label=2;case 2:return[2]}}))}))},t.prototype.render=function(){var e=this.props,t=e.children,n=e.fileExtensions,i=e.selectMultiple,s=r.__assign(r.__assign({},this.state),{setInitialUploadedItems:this.setInitialUploadedItems,cancelUploadItem:this.cancelUploadItem,chooseFiles:this.chooseFiles,chooseFolder:this.chooseFolder,chooseDropboxFiles:this.chooseDropboxFiles,handleDrop:this.handleDrop,makeDirectory:this.makeDirectory,moveUploadItem:this.moveUploadItem,removeUploadItem:this.removeUploadItem,renameUploadItem:this.renameUploadItem,startUploading:this.startUploading,stopUploading:this.stopUploading});return o.default.createElement(a.Provider,{value:s},t,o.default.createElement("input",{type:"file",ref:this.fileField,style:{display:"none"},multiple:!!i,accept:n?n.join(","):void 0}),o.default.createElement("input",r.__assign({type:"file",ref:this.folderField,style:{display:"none"}},{webkitdirectory:""})))},t})(o.default.PureComponent);t.UploadProvider=c,t.withCustomUploadProvider=function(e,t){var i=function(n){return o.default.createElement(t,r.__assign({},n),o.default.createElement(e,r.__assign({},n)))};return i.displayName="withCustomUploadProvider("+n.getDisplayName(e)+", "+n.getDisplayName(t)+")",i},t.UploadConsumer=a.Consumer,t.withUploadConsumer=function(e){var i=function(n){return o.default.createElement(t.UploadConsumer,null,(function(t){return o.default.createElement(e,r.__assign({},n,t))}))};return i.displayName="WithUploadConsumer("+n.getDisplayName(e)+")",i}})),define("modules/clean/react/upload_kit/utils/file",["require","exports","tslib","modules/clean/react/upload_kit/lib/types"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFile=function(e){return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(t){return[2,new Promise((function(t){return e.file((function(e){return t(e)}))}))]}))}))},t.getSize=function(e){return e?o.isChooserFile(e)?e.bytes:e.size:0},t.getDataTransferUrl=function(e){return(e.getData("Url")||e.getData("text/x-moz-url")||e.getData("text/uri-list")||"").split("\n")[0]},t.makeLinkBlob=function(e){return new Blob(["[InternetShortcut]\r\nURL="+e+"\r\n"],{type:"text/plain"})}})),define("modules/clean/react/upload_kit/utils/makers",["require","exports","tslib","modules/clean/react/upload_kit/lib/types","modules/clean/uuid"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeFileUploadItem=function(e,t,i){return r.__assign(r.__assign({},i),{bytes:e.size,bytesUploaded:0,destPath:t,file:e,id:n.UUID.v4(),isDir:!1,source:o.FileSource.Computer,status:o.UploadStatus.Staged})},t.makeDirectoryUploadItem=function(e){return{bytes:0,bytesUploaded:0,destPath:e,id:n.UUID.v4(),isDir:!0,source:o.FileSource.Computer,status:o.UploadStatus.Staged}},t.makeChooserUploadItem=function(e,t){return r.__assign(r.__assign({},t),{bytes:e.bytes,bytesUploaded:0,destPath:e.name,file:e,id:e.id,isDir:e.isDir,source:o.FileSource.Dropbox,status:o.UploadStatus.Staged})}})),define("modules/clean/react/upload_kit/utils/path",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renameFilename=function(e,t){var r=e.split("/");return r[r.length-1]=t,r.join("/")},t.reparentFilename=function(e,t){return t+"/"+e.split("/").pop()},t.getDestPath=function(e){return e.fullPath?e.fullPath.startsWith("/")?e.fullPath.substring(1):e.fullPath:e.name},t.getRootDir=function(e){return-1===e.indexOf("/")?"/":e.split("/")[0]},t.getNameAtRoot=function(e){return e.split("/")[0]}})),define("modules/clean/search/api",["require","exports","tslib","modules/clean/ajax","modules/clean/analytics","modules/clean/api_v2/user_client","modules/clean/react/browse/models","modules/clean/search/api_helpers","modules/clean/search/constants","modules/clean/search/models","modules/clean/search/search_helpers","modules/clean/api_v2/error"],(function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),l=r.__importStar(l),d=r.__importStar(d);var p=(function(){function e(){this._activeRequest=null}return e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype.loadResults=function(e){var t=e.user,r=e.path,o=e.query,n=e.start,i=e.maxResults,s=e.searchSessionId,c=e.nsId,u=e.fileNameOnly,p=e.loadDeleted,_=e.showPaperResults,f=e.isDropdown,m=e.isAdminConsole,h=e.webTimer,g=e.onSuccess,S=e.onError,E=e.overrideUrl,v=e.searchResultsExperiments,w=a.getCurrentTimezoneOffset(),T={query:o,search_token:d.getSearchCsrfToken(),fq_path:r,ns_id:c,filename_only:!!u,max_results:i,deleted:!!p,start:n,show_paper_results:!!_,is_dropdown:!!f,is_admin_console:!!m,show_unmounted_results:!0,timezone_offset:w,include_browse_context:!0,include_shared_docs:!0,include_snippets:!0},b=E||l.SEARCH_FRONTEND_SERVICE_ENDPOINT;this._fetchResults({requestData:T,nextOffset:n,user:t,searchSessionId:s,url:b,onSuccess:g,onError:S,webTimer:h,useApiV2:!!v.expSearchApiV2})},e.prototype._extractSpellCorrection=function(e,t){return{query:e.query,score:e.score,isCorrected:e.is_corrected,requestId:t}},e.prototype._getSearchType=function(e){return e.is_image_content_search?"image_search":e.is_dropdown?"dropdown":e.deleted?"full_page_deleted":"full_page"},e.prototype.loadPartialResults=function(e){var t=this,o=e.user,n=e.maxResults,i=e.start,s=e.cursor,a=e.path,c=e.query,u=e.fileCategories,p=e.isPaperEnabled,_=void 0===p||p,f=e.searchSessionId,m=e.includeBrowseContext,h=e.webTimer,g=e.sortOrder,S=e.searchType,E=e.onSuccess,v=e.onError,w=e.searchResultsExperiments,T=e.skipLogging,b=e.deleted,I=e.filteredAccountId;S===l.SearchType.IMAGE&&(u=void 0);var y=u&&!d.allCategoriesChecked(u,_)?d.fileCategoriesToString(u):"",F=g?d.sortFieldToOrderBy(g.sortField):"",C=g?d.sortDirectionToReverseOrder(g.sortDirection):"",O=r.__assign(r.__assign({query:c,search_token:d.getSearchCsrfToken(),fq_path:a,cursor:s,max_results:n,deleted:b,show_paper_results:S!==l.SearchType.IMAGE,include_browse_context:m,search_session_id:f},y&&{file_categories:y}),{is_image_content_search:S===l.SearchType.IMAGE,order_by:F,reverse_order:C,include_shared_docs:!0,include_snippets:S===l.SearchType.ALL,user_filter_account_id:I});t._fetchResults({requestData:O,nextOffset:i,user:o,searchSessionId:f,url:l.SEARCH_FRONTEND_SERVICE_ENDPOINT,onSuccess:E,onError:v,webTimer:h,skipLogging:T,useApiV2:!!w.expSearchApiV2})},e.prototype._fetchResults=function(e){var t=this,r=e.requestData,l=e.nextOffset,p=e.user,_=e.searchSessionId,f=e.url,m=e.onSuccess,h=e.onError,g=e.webTimer,S=e.skipLogging,E=e.useApiV2;if(null!=this._activeRequest&&this._activeRequest.abort(),this._activeRequestController&&(this._activeRequestController.abort(),this._activeRequestController=null),""!==r.query||r.user_filter_account_id){var v=d.fileCategoryStringToLogValue(r.file_categories),w={path_scoped:"/"!==r.fq_path,search_type:this._getSearchType(r),query_string:r.query,start:l,search_session_id:_,timezone_offset:r.timezone_offset,file_type_filters:v,user_filter_account_id:r.user_filter_account_id};S||n.SearchClientActivityLogger.log("query_started",p.id,w);var T=(new Date).getTime();if(E){var b=void 0;void 0!==window.AbortController&&(b=new AbortController,this._activeRequestController=b);var I=new i.UserApiV2Client,y=function(e){var o=e.result,n=e.headers;t._activeRequestController=null;var i,c=n["x-dropbox-request-id"];o.spell_correction&&(i={query:o.spell_correction.query,score:0,isCorrected:o.spell_correction.is_corrected,requestId:c});var d={results:a.extractSearchV2ResultsList(o.matches,l,c),hasMore:o.has_more,cursor:o.cursor,spellCorrection:i};m({context:new s.BrowseContext({blockHash:o.root_block_hash}),searchResults:d,deleted:!!r.deleted,requestId:c}),g&&g.end(c||void 0)},F=function(e){if(void 0===b||!b.signal.aborted){var t="",r="";(u.isApiError(e)||u.isBadRequestError(e)||u.isAuthError(e)||u.isAppError(e)||u.isServerError(e)||u.isRateLimitError(e))&&(t=e.toString(),e.headers&&(r=e.headers["x-dropbox-request-id"])),"function"==typeof h&&h(t,r)}g&&g.abort()};if(r.cursor)I.ns("files").rpcWithResponseHeaders("search/continue_v2",{cursor:r.cursor},{subjectUserId:p.id,signal:null==b?void 0:b.signal}).then(y).catch(F);else{var C=a.convertRequestDataToV2(r);I.ns("files").rpcWithResponseHeaders("search_v2",C,{subjectUserId:p.id,signal:null==b?void 0:b.signal}).then(y).catch(F)}}else this._activeRequest=o.WebRequest({url:f,data:r,dataType:"json",subject_user:p,success:function(e,o,i){var s;r.include_browse_context&&(s=c.extractBrowseContext(e));var d=e.search_results,u=i.getResponseHeader("x-dropbox-request-id");d.forEach((function(e){return e.request_id=u}));var f={results:a.extractSearchResultsList(d,l),hasMore:!!e.more,cursor:e.cursor,spellCorrection:e.spell_correction?t._extractSpellCorrection(e.spell_correction,u):void 0};if(m({context:s,searchResults:f,deleted:!!r.deleted,requestId:u}),!S){var h=n.SearchClientActivityLogger.create_search_log_dict(w,u,T,r.query,f.results.length,null,_);n.SearchClientActivityLogger.log("query_completed",p.id,h)}g&&g.end(u||void 0)},error:function(e,t,o){var i=e.getResponseHeader("x-dropbox-request-id");if("abort"!==t&&"function"==typeof h&&h(o,i),!S){var s=n.SearchClientActivityLogger.create_search_log_dict(w,i,T,r.query,null,t,_);n.SearchClientActivityLogger.log("query_failed",p.id,s)}g&&g.abort()},complete:function(){this._activeRequest=null}})}},e.prototype.fetchAdditionalFileMetadata=function(e){var t=e.searchResults,r=e.user,n=e.onSuccess,i=e.onError,s=t.filter(d.isSearchResultFile).map((function(e){return[e.ns_id,e.sjid,e.fq_path.substr(0,e.fq_path.length-e.ns_path.length)]}));s.length>0&&o.WebRequest({url:l.FILE_INFO_ENDPOINT,data:{nsid_sjid_fq_mount_point_tuples:JSON.stringify(s)},dataType:"json",subject_user:r,success:function(e,t,r){for(var o=[],i=0,s=e.file_results;i<s.length;i++){var a=s[i];o.push(a)}n(o)},error:function(e,t,r){"abort"!==t&&"function"==typeof i&&i(r,e.getResponseHeader("x-dropbox-request-id"))}})},e})();t.SearchApiClient=p,t.searchApiClient=new p})),define("modules/clean/search/single_page/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.SET_VARIANT="SEARCH/SET_VARIANT",e.SET_USER="SEARCH/SET_USER",e.SET_EXPERIMENTS="SEARCH/SET_EXPERIMENTS",e.SET_PATH="SEARCH/SET_PATH",e.SET_QUERY="SEARCH/SET_QUERY",e.SET_FILE_CATEGORIES="SEARCH/SET_FILE_CATEGORIES",e.SET_RESULTS="SEARCH/SET_RESULTS",e.CLEAR_RESULTS="SEARCH/CLEAR_RESULTS",e.APPEND_RESULTS="SEARCH/APPEND_RESULTS",e.SET_LOADING_STATE="SEARCH/SET_LOADING_STATE",e.SET_SESSION_ID="SEARCH/SET_SESSION_ID",e.SET_REQUEST_ID="SEARCH/SET_REQUEST_ID",e.SET_SELECTION="SEARCH/SET_SELECTION",e.SET_PREVIEW_FILE_ID="SEARCH/SET_PREVIEW_FILE",e.SET_SORT_ORDER="SEARCH/SET_SORT_ORDER",e.ADD_TTI_COMPONENT="SEARCH/ADD_TTI_COMPONENT",e.CLEAR_TTI_COMPONENTS="SEARCH/CLEAR_TTI_COMPONENTS",e.SET_LOADING_DELETED_RESULTS="SEARCH/SET_LOADING_DELETED_RESULTS",e.SET_SEARCH_TYPE="SEARCH/SET_SEARCH_TYPE",e.SET_IMAGE_SUGGESTION="SEARCH/SET_IMAGE_SUGGESTION",e.UPDATE_FILE_IN_RESULTS="SEARCH/UPDATE_FILE_IN_RESULTS",e.UPDATE_RESULTS="SEARCH/UPDATE_RESULTS",e.REMOVE_RESULTS="SEARCH/REMOVE_RESULTS",e.RENAME_FILE="SEARCH/RENAME_FILE",e.DELETE_FILES="SEARCH/DELETE_FILES",e.PURGE_FILES="SEARCH/PURGE_FILES",e.RESTORE_FILES="SEARCH/RESTORE_FILES",e.SET_QUERY_HISTORY="SEARCH/SET_QUERY_HISTORY",e.SET_HIGHLIGHTED_ROW="SEARCH/SET_HIGHLIGHTED_ROW",e.UPDATE_QUERY_SUGGESTIONS_CACHE="SEARCH/UPDATE_QUERY_SUGGESTIONS_CACHE",e.SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED="SEARCH/SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED",e.SET_FILTERED_ACCOUNT_ID="SEARCH/SET_FILTERED_ACCOUNT_ID",e.UPDATE_PEOPLE_SUGGESTIONS_CACHE="SEARCH/UPDATE_PEOPLE_SUGGESTIONS_CACHE",e.SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED="SEARCH/SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED",e.SET_DWELL_TIME="SEARCH/SET_DWELL_TIME",e.SET_QUERY_START_TIME="SEARCH/SET_QUERY_START_TIME",e.SET_IS_CREATING_SHARED_LINK="SEARCH/SET_IS_CREATING_SHARED_LINK"})(t.ActionTypes||(t.ActionTypes={}))}));__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/growth/invite_facepile_loader",["require","exports","modules/clean/react/async/loadable"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={loader:function(){return new Promise((function(t,r){e(["modules/clean/react/growth/invite_facepile"],t,r)})).then(__importStar).then((function(e){return e.InviteFacepile}))}};t.InviteFacepileLoadable=r.Loadable(o)})),define("modules/clean/react/growth/teams_web_actions_logger_events",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.ESSENTIAL_SETUP_STEPS="essential_setup_steps",e.INSTALL_PAGE_ESCAPE="install_page_escape",e.OPEN_DESKTOP_BANNER="open_desktop_banner",e.OPEN_DESKTOP_CLICK="open_desktop_click",e.RESEND_VERIFICATION_EMAIL="resend_verification_email",e.STEP_RENDER="setup_render",e.SUBMIT_TEAM_INFO="submit_team_info",e.TRANSITION_OPEN_GMAIL="transition_open_gmail",e.TRANSITION_OPEN_OUTLOOK="transition_open_outlook",e.TRIGGER_CLIENT_CHECK="trigger_client_check",e.TRIGGER_CLIENT_RESULT="trigger_client_result",e.TRIGGER_DOWNLOAD="trigger_download",e.TRIGGER_DOWNLOAD_AGAIN="trigger_download_again",e.TRIGGER_MAGIC_PAIRING="trigger_magic_pairing",e.UJ_CLINK_DOWNLOAD="uj_clink_download",e.ROLE_OPTION_SELECTED="role_option_selected",e.VIEW_SUGGESTIONS_LOADING_SCREEN="view_suggestions_loading_screen",e.COLLABORATION_TYPE_SELECTED="collaboration_type_selected",e.SETUP_SKIP_ADD_MEMBERS="setup_skip_add_members",e.SETUP_INVITE_MEMBERS_IMPORT="setup_invite_members_import",e.SETUP_INVITE_MEMBERS_COPY_LINK="setup_invite_members_copy_link",e.SETUP_INVITE_MEMBERS_ADD_EMAIL="setup_invite_members_add_email",e.SETUP_INVITE_MEMBERS_ADD_MORE_CLICKED="setup_invite_members_add_more_clicked",e.SETUP_ADD_MEMBERS="setup_add_members",e.SETUP_ADD_MEMBERS_SUBMITTED="setup_add_members_submitted",e.SETUP_ADD_MEMBERS_FAILED="setup_add_members_failed",e.SHARE_INVITE_CLICK="share_invite_click",e.SHARE_INVITE_SHEET_ACTION="share_invite_sheet_action",e.SHARE_INVITE_SHEET_DISMISS="share_invite_sheet_dismiss",e.SHARE_INVITE_COPIED="share_invite_copied",e.INVITE_PAGE_ESCAPE="invite_page_escape",e.MW_APP_STORE_REDIRECT="mw_app_store_redirect",e.MW_CLINK_FLOW_REDIRECT="mw_clink_flow_redirect",e.INSTALL_APP_PAGE_ESCAPE="install_app_page_escape",e.INSTALL_PAGE_REDIRECT="install_page_redirect",e.MOBILE_ICON_CLICK="mobile_icon_click",e.SEND_MOBILE_APP_LINK="send_mobile_app_link",e.MW_STEP_NOT_RENDER="mw_step_not_render",e.REC_FOLDER_LOADED="rec_folder_loaded",e.REC_FOLDER_LOAD_FAILED="rec_folder_load_failed",e.SETUP_ADD_MEMBERS_REC_LOADED="setup_add_members_rec_loaded",e.SETUP_ADD_MEMBERS_REC_LOAD_FAILED="setup_add_members_rec_load_failed",e.REC_FOLDER_CHECK="rec_folder_check",e.REC_FOLDER_UNCHECK="rec_folder_uncheck",e.REC_FOLDER_CLK_NEXT="rec_folder_clk_next",e.CONF_FOLDER_CLK_MOVE="conf_folder_clk_move",e.CONF_FOLDER_MOVE_SUCCEEDED="conf_folder_move_succeeded",e.CONF_FOLDER_MOVE_PARTIAL="conf_folder_move_partial_fail",e.CONF_FOLDER_MOVE_FAILED="conf_folder_move_failed",e.CONF_FOLDER_MOVE_INDIVIDUAL_ERROR="conf_folder_move_individual_error",e.CONF_FOLDER_MOVE_INTERRUPTED="conf_folder_move_interrupted",e.SETUP_CONFIRM_MOVE_FOLDERS_IMPRESSION="setup_confirm_move_folders_impression",e.SETUP_RESULTS_MOVE_FOLDERS_IMPRESSION="setup_results_move_folders_impression",e.SETUP_SELECT_FOLDERS_IMPRESSION="setup_select_folders_impression",e.SETUP_MOVE_FOLDERS_KEEP_PERSONAL="setup_move_folders_keep_personal",e.SETUP_ADD_MEMBERS_UNCHECK="setup_add_members_uncheck",e.SETUP_ADD_MEMBERS_CHECK="setup_add_members_check",e.SETUP_ADD_MEMBERS_MORE_RECOS="setup_add_members_more_recos",e.SCROLL_EVENT="scroll_event",e.ACCESS_FOLDER_CHECK="access_folder_check",e.ACCESS_FOLDER_UNCHECK="access_folder_uncheck",e.FLOW_STEPS_DOES_NOT_MATCH="flow_steps_does_not_match",e.FLOW_STEPS_DOES_NOT_MATCH_V2="flow_steps_does_not_match_v2",e.FLOW_STEPS_DOES_NOT_MATCH_V3="flow_steps_does_not_match_v3",e.FLOW_CONT_URL_DOES_NOT_MATCH="flow_cont_url_does_not_match"})(t.OnboardingLoggerEvents||(t.OnboardingLoggerEvents={})),(function(e){e.UJ_CLINK_DOWNLOAD_AGAIN="uj_clink_download_again",e.UJ_CLINK_SKIP_AFTER_DOWNLOAD="uj_clink_skip_after_download",e.SETUP_RENDER="setup_render",e.UJ_CLINK_DOWNLOAD_MOBILE_REROUTE="uj_clink_download_mobile_reroute",e.UJ_CLINK_DOWNLOAD="uj_clink_download",e.UJ_CLINK_SKIP="uj_clink_skip",e.OPEN_DESKTOP_CLICK="open_desktop_click"})(t.TeamInstallLoggerEvents||(t.TeamInstallLoggerEvents={})),(function(e){e.CLICK_MULTIPLE="rightsizing_clk_filter_screen_multiple",e.CLICK_YOU="rightsizing_clk_filter_screen_you",e.VIEW="rightsizing_view_filter_screen"})(t.RightsizingLoggerEvents||(t.RightsizingLoggerEvents={})),(function(e){e.CLK_YES_TO_CREATE="clk_yes_to_create",e.CLK_NO_TO_COMBINE="clk_no_to_combine",e.CLK_CREATE_JOINER="clk_create_joiner",e.CLK_CREATE_NEW="clk_create_new",e.CLK_COMBINE="clk_combine",e.SETUP_RENDER="setup_render",e.MERGE_ACCOUNTS="joiner_merge_accounts",e.CREATE_NEW_PERSONAL="joiner_create_new_personal",e.SIGNUP="joiner_signup",e.SIGNIN="joiner_signin"})(t.TeamJoinerLoggerEvents||(t.TeamJoinerLoggerEvents={})),(function(e){e.VIEW_CONTENT_EMPTY_STATE="view_content_empty_state",e.CLICK_BROWSE_UPLOAD_CTA="click_browse_upload_cta"})(t.EmptyStateDropTargetLoggerEvents||(t.EmptyStateDropTargetLoggerEvents={})),(function(e){e.VIEW_INVITE_EMPTY_STATE="view_invite_empty_state",e.INVITE_MEMBERS_PRIMARY_CTA_CLK="invite_members_primary_cta_clk"})(t.InviteFacepileLoggerEvents||(t.InviteFacepileLoggerEvents={})),(function(e){e.DESKTOP_ICON_TOOLTIP="desktop_icon_tooltip",e.DESKTOP_ICON_CLICK="desktop_icon_click",e.DESKTOP_ICON_CLICK_RESULT="desktop_icon_click_result",e.DESKTOP_ICON_TOOLTIP_DISMISS="desktop_icon_tooltip_dismiss"})(t.OpenInDesktopCtaLoggerEvents||(t.OpenInDesktopCtaLoggerEvents={})),(function(e){e.VIEW_MOBILE_EMPTY_STATE="view_mobile_empty_state",e.DISMISS_MOBILE_EMPTY_STATE="dismiss_mobile_empty_state",e.SEND_MOBILE_LINK_CLK="send_mobile_link_clk",e.SEND_MOBILE_LINK_SUCCESS="send_mobile_link_success",e.SEND_MOBILE_LINK_FAIL="send_mobile_link_fail"})(t.DownloadAppZoneLoggerEvents||(t.DownloadAppZoneLoggerEvents={})),(function(e){e.VIEW_SUGGESTED_FOLDERS="view_suggested_folders",e.SUGGESTED_FOLDER_ADD_CLICKED="suggested_folder_add_clicked",e.SUGGESTED_FOLDERS_HIDE_CLICKED="suggested_folders_hide_clicked",e.SUGGESTED_FOLDER_CREATED="suggested_folder_created",e.SUGGESTED_FOLDER_FAILED="suggested_folder_failed",e.SUGGESTED_FOLDER_ACCESS_VIEW="suggested_folder_access_view",e.SUGGESTED_FOLDER_ACCESS_CHANGE="suggested_folder_access_change",e.VIEW_SUGGESTED_FOLDERS_MINIMIZED="view_suggested_folders_minimized",e.VIEW_SUGGESTED_FOLDERS_OPEN="view_suggested_folders_open"})(t.SuggestedFoldersLoggerEvents||(t.SuggestedFoldersLoggerEvents={})),(function(e){e.VIEW_EXPLORE_CONTENT_STATE="view_explore_content_state",e.VIEW_EXPLORE_EMPTY_STATE="view_explore_empty_state"})(t.TeamSpaceEmptyZoneLoggerEvents||(t.TeamSpaceEmptyZoneLoggerEvents={})),(function(e){e.VIEW_ROLE_SUGGESTIONS="view_role_suggestions",e.VIEW_ROLE_SUGGESTIONS_MINIMIZED="view_role_suggestions_hidden",e.SHOW_SUGGESTIONS_CLICKED="role_suggestions_clk_view",e.HIDE_SUGGESTIONS_CLICKED="role_suggestions_clk_hide",e.CLICKED_SUGGESTION="role_suggestions_clk_cta",e.DISMISSED_SUGGESTION="role_suggestions_clk_dismiss",e.DISMISS_ALL_SUGGESTED_FOLDERS="suggested_folder_dismiss_all"})(t.CollectionsQuickActionsLoggerEvents||(t.CollectionsQuickActionsLoggerEvents={})),(function(e){e.SUGGESTIONS_PAGE_IMPRESSION="suggestions_page_impression",e.SUGGESTIONS_PAGE_CLICK_CTA="suggestions_page_clk_cta"})(t.CollectionsFolderActionsLoggerEvents||(t.CollectionsFolderActionsLoggerEvents={})),(function(e){e.UPLOAD_FILES_CLICKED="upload_files_clk",e.CREATE_FOLDER_CLICKED="create_folder_clk"})(t.TeamSpaceEmptyZoneCTALoggerEvents||(t.TeamSpaceEmptyZoneCTALoggerEvents={})),(function(e){e.NAVIGATION_SPLIT_TMF_TSD="navigation_split_tmf_tsd"})(t.SplitTmfTsdLoggerEvents||(t.SplitTmfTsdLoggerEvents={}))})),define("modules/clean/upsell/top_notification_listener",["require","exports","modules/clean/upsell/prompt_event_emitter"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTopNotificationListener=function(e){var t=function(t){return function(r){"TOP_NOTIFICATION"===r&&e(t)}},o=t(!0),n=t(!1);return r.promptBufferedEventEmitter.on(r.Events.ON_PROMPT_SHOWN,o),r.promptBufferedEventEmitter.on(r.Events.ON_PROMPT_DISMISSED,n),{unsubscribe:function(){r.promptBufferedEventEmitter.off(r.Events.ON_PROMPT_SHOWN,o),r.promptBufferedEventEmitter.off(r.Events.ON_PROMPT_DISMISSED,n)}}}})),define("modules/clean/web_upload_action_logger",["require","exports","tslib","modules/clean/ajax"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.MAX_ERRORS=3;var n=(function(){function e(){this.errorCount=0,this.lastError=Date.now(),this.shouldReport=!0}return e.prototype.log=function(e,n,i){var s=this;return i=r.__assign(r.__assign(r.__assign({},i),i.extra),{extra:void 0}),this.shouldReport&&(this.errorCount<t.MAX_ERRORS||Date.now()-this.lastError>6e5)?new Promise((function(r,a){o.SilentBackgroundRequest({url:"/log/web_upload_action",data:{_subject_uid:e,event_type:n,extra_params:JSON.stringify(i)},error:function(e){429===e.status?s.errorCount=t.MAX_ERRORS:s.errorCount++,s.lastError=Date.now(),a(e)},success:function(e){try{var t=JSON.parse(e);t&&!t.continue_sending&&(s.shouldReport=!1),s.errorCount=0,r(e)}catch(e){throw s.errorCount++,s.lastError=Date.now(),a(e),e}}})})):Promise.resolve({})},e})();t.WebUploadActionLog=new n,t.WebUploadActionLogClass=n})),define("modules/core/custom_protocol",["require","exports","tslib","modules/core/browser_detection"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o=r.__importStar(o)).chrome?1e3:2e3;function i(e){var t=document.createElement("iframe");t.src=e,t.setAttribute("style","display: none;"),document.body.appendChild(t)}function s(e,t,r){var o=window.navigator;o&&o.msLaunchUri?o.msLaunchUri(e,t,r):r()}t.launchUri=function(e){var t=0;return new Promise((function(r,a){function l(){window.removeEventListener("blur",l),clearTimeout(t),r()}window.addEventListener("blur",l),t=setTimeout((function(){window.removeEventListener("blur",l),a()}),n),o.chromium()?window.location.assign(e):o.mozilla||o.safari?i(e):(o.msie||o.edge)&&s(e,r,a)}))},t.launchUriByIframe=i,t.launchUriForMicrosoftBrowsers=s,t.canLaunchUri=function(){return o.msie?o.windowsInfo.win8OrHigher:!!(o.mozilla||o.safari||o.chrome)}})),define("modules/clean/react/growth/open_in_desktop",["require","exports","tslib","react","react-redux","dig-components/buttons","dig-components/icons","dig-components/typography","dig-components/tooltips","dig-components/icons/src","modules/clean/viewer","modules/clean/analytics","modules/clean/react/growth/teams_web_actions_logger_events","modules/clean/react/css","modules/core/i18n","modules/clean/growth/user_action/tracker","modules/clean/react/growth/first_task/first_task","modules/clean/react/growth/first_task/data/store","modules/clean/react/growth/first_task/data/selectors","modules/clean/react/growth/personalization/util","modules/clean/react/growth/open_in_util","modules/clean/react/growth/open_in_util"],(function(e,t,r,o,n,i,s,a,l,c,d,u,p,_,f,m,h,g,S,E,v,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.OPEN_IN_DESKTOP_TEXT=f.intl.formatMessage({id:"6mltsz",defaultMessage:"Open in desktop"});var T={CONTENT_FIRST:{title:f.intl.formatMessage({id:"c6i6ys",defaultMessage:"Work offline"}),body:f.intl.formatMessage({id:"lyDaYm",defaultMessage:"The desktop app keeps teamwork going—with or without an internet connection."})},INVITE_FIRST:{title:f.intl.formatMessage({id:"AIHxJP",defaultMessage:"Never miss an update"}),body:f.intl.formatMessage({id:"KxMBYG",defaultMessage:"The desktop app helps you stay in the loop with your team’s progress in real time."})}},b=(function(e){function n(t){var n=e.call(this,t)||this;return n.user=d.Viewer.get_viewer().work_user,n.addClickAnywhereHandler=function(){var e;u.TeamsWebActionsLogger.log(p.OpenInDesktopCtaLoggerEvents.DESKTOP_ICON_TOOLTIP,r.__assign({version:n.loggingVersion},w.loggingExtras)),document.addEventListener("mousedown",n.handleClickOutside,!0),null===(e=n.actionTracker)||void 0===e||e.track(v.ESSENTIAL_SETUP_SEEN_DESKTOP_TOOLTIP)},n.handleClick=function(){var e=n.props,t=e.textType,r=e.needsPairingToken,o=e.growthActSmbMpIteration;v.openInDesktopApp({user:n.user,needsPairingToken:r,textType:t,growthActSmbMpIteration:o})},n.handleClickOutside=function(){u.TeamsWebActionsLogger.log(p.OpenInDesktopCtaLoggerEvents.DESKTOP_ICON_TOOLTIP_DISMISS,r.__assign({version:n.loggingVersion},w.loggingExtras)),document.removeEventListener("mousedown",n.handleClickOutside,!0),h.markClinkTooltipSeenAndHide()},n.shouldShowButtonText=function(){var e=n.props.textType;return e===E.DesktopCtaType.ShowWithText||e===E.DesktopCtaType.ShowWithTextAsPrimary},n.getButtonVariant=function(){var e="transparent";switch(n.props.textType){case E.DesktopCtaType.ShowWithText:case E.DesktopCtaType.ShowWithoutText:e="outline";break;case E.DesktopCtaType.ShowWithTextAsPrimary:e="primary"}return e},n.tooltipRef=o.default.createRef(),n.user&&(n.actionTracker=new m.GrowthUserActionTracker(n.user.id,{project:v.ESSENTIAL_SETUP_ACTION_TRACKER}),t.clinkTooltipVisible!==h.TooltipType.None&&n.addClickAnywhereHandler(),t.totalNumItems>1&&h.showClinkTooltip(h.TooltipType.Files)),n}return r.__extends(n,e),n.prototype.componentDidUpdate=function(e){var t=this.props,r=t.totalNumItems,o=t.clinkTooltipVisible;r>1&&h.showClinkTooltip(h.TooltipType.Files),e.clinkTooltipVisible===h.TooltipType.None&&o!==h.TooltipType.None&&this.addClickAnywhereHandler()},Object.defineProperty(n.prototype,"loggingVersion",{get:function(){return this.props.clinkTooltipVisible===h.TooltipType.Members?"added_members":"added_content"},enumerable:!0,configurable:!0}),n.prototype.componentWillUnmount=function(){document.removeEventListener("mousedown",this.handleClickOutside,!0)},n.prototype.render=function(){var e,r=this.props,n=r.clinkTooltipVisible,d=r.hasSeenClinkTooltip,u=r.textType;if(!u&&(!this.user||!d&&n===h.TooltipType.None))return null;n===h.TooltipType.Files&&(e=T.CONTENT_FIRST),n===h.TooltipType.Members&&(e=T.INVITE_FIRST);var p=this.shouldShowButtonText(),_=this.getButtonVariant(),f=p?o.default.createElement(i.Button,{onClick:this.handleClick,variant:_,"aria-label":t.OPEN_IN_DESKTOP_TEXT},t.OPEN_IN_DESKTOP_TEXT,o.default.createElement(s.UIIcon,{src:c.OpenLine,style:{marginLeft:4}})):o.default.createElement(l.Tooltip,{placement:"bottom",title:t.OPEN_IN_DESKTOP_TEXT},o.default.createElement(i.IconButton,{variant:"outline","aria-label":t.OPEN_IN_DESKTOP_TEXT,onClick:this.handleClick},o.default.createElement(s.UIIcon,{src:c.OpenLine}))),m=e&&!u&&o.default.createElement(l.Tooltip.Control,{auto:!0,open:!0,placement:"bottom",variant:"rich",triggerRef:this.tooltipRef},o.default.createElement(o.default.Fragment,null,o.default.createElement(a.Title,{inverse:!0},e.title),o.default.createElement(a.Text,{tagName:"p",inverse:!0},e.body)));return o.default.createElement("div",{className:"open-in-desktop"},o.default.createElement("div",{ref:this.tooltipRef},f),m)},n})(o.default.PureComponent),I=n.connect((function(e){return{hasSeenClinkTooltip:S.getHasClinkTooltipDisplayed(e),clinkTooltipVisible:S.getClinkTooltipVisible(e)}}))(b),y=g.getStoreForFirstTask();t.ProvidedOpenInDesktop=function(e){return o.default.createElement(n.Provider,{store:y},o.default.createElement(I,r.__assign({},e)))},t.OpenInDesktop=_.requireCssWithComponent(t.ProvidedOpenInDesktop,["/static/css/dig-components/index.web-vflrectwC.css","/static/css/growth/experiments/open_in_desktop-vfln4XIZg.css"])})),define("modules/clean/react/vault/vault_browse_root_async",["require","exports","tslib","react"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o=r.__importStar(o)).lazy,i=o.Suspense,s=n((function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/vault/vault_browse_root"],t,r)})).then(r.__importStar)];case 1:return[2,{default:t.sent().VaultRoot}]}}))}))}));t.AsyncVaultRoot=function(e){return o.createElement(i,{fallback:o.createElement("div",null)},o.createElement(s,r.__assign({},e)))}})),define("modules/clean/react/vault/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VAULT_URL="/vault",t.VAULT_HASH_TAB_KEY="tab",t.VAULT_HASH_MODAL_KEY="modal",t.VAULT_NAME="Vault",t.VAULT_STYLESHEETS=["/static/css/spectrum/index.web-vfl6Z83yw.css","/static/css/dig-components/index.web-vflrectwC.css","/static/js/vault/index.web-vfliAnbo2.css","/static/css/vault/vault-vflE048Jv.css"],t.SECURITY_CHECKUP_RELATIVE_URL="/security_checkup",t.DEFAULT_APPS_PATH="/account/default_apps",t.VAULT_OWNER_FNAME_QUERY_PARAM_KEY="vo_fn",t.VAULT_OWNER_DISPLAY_NAME_QUERY_PARAM_KEY="vo_dn",t.ENCRYPTED_OWNER_QUERY_PARAM_KEY="vo"})),define("modules/clean/react/vault/lib/browse_utils",["require","exports","tslib","modules/clean/filepath","modules/clean/react/vault/constants"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.logShareFromInsideVault=function(t){return r.__awaiter(this,void 0,void 0,(function(){var o,n,i,s,a;return r.__generator(this,(function(l){switch(l.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/vault/lib/api"],t,r)})).then(r.__importStar)];case 1:return o=l.sent().logProductAnalyticsEvent,[4,new Promise((function(t,r){e(["vault/common/logging-types"],t,r)})).then(r.__importStar)];case 2:return n=l.sent(),i=n.AnalyticsEventAction,s=n.AnalyticsEventObject,a=n.AnalyticsEventActionSurface,o({eventAction:i.SELECT,eventObject:t?s.SHARE_FOLDER:s.SHARE_FILE,actionSurface:a.VAULT_HOME}),[2]}}))}))},t.isInsideVault=function(e){var t=e.split("/");return("/"===e[0]?t[1]:t[0])===n.VAULT_NAME},t.getVaultFqPath=function(){return o.normalize(n.VAULT_NAME)}})),define("comments2/components/folder_overview_utils",["require","exports","comments2/components/folder_overview_utils/description_utils"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyDescription=r.isEmptyDescription})),define("comments2/components/folder_overview_utils/description_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyDescription=function(e){return!e||(0===e.blocks.length||!(e.blocks.length>1)&&("unstyled"===e.blocks[0].type&&0===e.blocks.map((function(e){return e.text})).join("\n").replace(/%u200B/g,"").trim().length))}})),define("retrieval-components/collapsable-section",["require","exports","tslib","react","classnames","spectrum/button"],(function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),t.CollapsableSection=function(e){var t=e.title,r=e.isOpen,s=e.onHeaderClick,a=e.children,l=e.top,c=e.strings,d=e.containerClassName;return o.default.createElement("div",{className:n.default({"rc-collapsable-section":!0,"rc-collapsable-section--closed":!r}),style:{top:l}},o.default.createElement("div",{className:"rc-collapsable-section__header"},o.default.createElement("h2",{className:"rc-collapsable-section__header-tag"},o.default.createElement("span",null,t),o.default.createElement(i.Button,{onClick:s,className:"rc-collapsable-section__toggle",variant:"styleless"},r?c.buttonClose:c.buttonOpen))),o.default.createElement("div",{className:d,style:{display:r?void 0:"none"}},a))}})),define("retrieval-components/highlighted-truncated-string",["require","exports","tslib","classnames","react","spectrum/tooltip","retrieval-components/highlighted-truncated-string/em-string","retrieval-components/highlighted-truncated-string/text-highlights","retrieval-components/highlighted-truncated-string/em-string"],(function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),t.HighlightedTruncatedStringVariant=l.HighlightedTruncatedStringVariant;var c=(function(e){function t(t){var r=e.call(this,t)||this;return r.setRef=function(e){r.textContainerSpan=e},r.updateDisplayTextIfNecessary=function(e){if(r.textContainerSpan){var t=e.fontSize,o=e.text,n=e.availableWidth,i=e.cellBuffer,a=e.variant,l=r.textContainerSpan,c=n||l.getBoundingClientRect().width;if(r.props.text!==o||r.state.cellWidth!==c||r.props.fontSize!==t||r.props.variant!==a){r.setState({cellWidth:c});var d=c/t-i,u=s.Emstring.em_snippet(o,d,.5,a);u!==r.state.truncatedText&&r.setState({truncatedText:u}),r.updateTooltip(u,o)}}},r.updateTooltip=function(e,t){e&&t&&r.setState({showTooltip:e!==t})},r.state={truncatedText:t.text,showTooltip:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.updateDisplayTextIfNecessary(this.props)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.updateDisplayTextIfNecessary(e)},t.prototype.render=function(){var e=this.props,t=e.className,r=e.ariaLabel,s=e.highlightSpans,l=e.text,c=e.tooltipPosition,d=e.tooltipId,u=this.state,p=u.truncatedText,_=u.showTooltip;return n.createElement(i.Tooltip,{id:d,positioning:c,tooltipContent:s?a.generateHighlightedTooltipSpans(a.highlightSectionsFromHighlightSpans(l,s)):l,showOnMouseMove:_,wrapperClassName:"rc-truncated-string__tooltip"},n.createElement("span",{className:o.default(t,"rc-hl-truncated-string__container"),"aria-label":r,ref:this.setRef,style:{display:"block"}},s?this.getHighlightedSpan(p,l,s):p))},t.prototype.splitTruncatedParts=function(e,t){for(var r=0;r<e.length&&e.charAt(r)===t.charAt(r);)++r;return r===e.length||"…"!==e.charAt(r)?[e]:[e.substring(0,r),e.substring(r+1)]},t.prototype.getHighlightedSpan=function(e,t,r){var o=this.splitTruncatedParts(e,t);if(1===o.length)return a.highlightReactFromHighlightSpans(e,r);var i=a.highlightReactFromHighlightSpans(t,r,0,o[0].length),s=a.highlightReactFromHighlightSpans(t,r,t.lastIndexOf(o[1])),l=a.highlightEllipsisFromHighlightSpans(o[0].length+1,t.lastIndexOf(o[1])-1,r);return n.createElement("span",null,i,l,s)},t})(n.PureComponent);t.HighlightedTruncatedString=c,c.defaultProps={tooltipPosition:"above",cellBuffer:1,variant:s.HighlightedTruncatedStringVariant.HIGHLIGHTED_TRUNCATED_STRING_MIDDLE}})),define("retrieval-components/highlighted-truncated-string/em-string",["require","exports"],(function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.HighlightedTruncatedStringVariant||(t.HighlightedTruncatedStringVariant={})).HIGHLIGHTED_TRUNCATED_STRING_END="HIGHLIGHTED_TRUNCATED_STRING_END",r.HIGHLIGHTED_TRUNCATED_STRING_START="HIGHLIGHTED_TRUNCATED_STRING_START",r.HIGHLIGHTED_TRUNCATED_STRING_MIDDLE="HIGHLIGHTED_TRUNCATED_STRING_MIDDLE",r.HIGHLIGHTED_TRUNCATED_STRING_LAST_WORD="HIGHLIGHTED_TRUNCATED_STRING_LAST_WORD",r.HIGHLIGHTED_TRUNCATED_STRING_FILE_EXTENSION="HIGHLIGHTED_TRUNCATED_STRING_FILE_EXTENSION";var o=(function(){function e(e){this.s=e,this.info=this.widthInfo(),this.length=e.length?this.info[this.s.length-1]:0}return e.initClass=function(){this.ACCURACY=2,this.CODEPOINT_TO_WIDTH={32:38,33:25,34:42,35:67,36:58,37:92,38:75,39:25,40:33,41:33,42:58,43:58,44:25,45:33,46:25,47:42,48:58,49:58,50:58,51:58,52:58,53:58,54:58,55:58,56:58,57:58,58:25,59:25,60:58,61:58,62:58,63:50,64:100,65:67,66:67,67:67,68:75,69:58,70:58,71:75,72:83,73:33,74:25,75:67,76:58,77:100,78:83,79:83,80:67,81:83,82:67,83:58,84:58,85:75,86:67,87:100,88:67,89:58,90:58,91:33,92:42,93:33,94:58,95:50,96:67,97:58,98:67,99:50,100:67,101:58,102:33,103:58,104:67,105:25,106:25,107:58,108:25,109:100,110:67,111:67,112:67,113:67,114:42,115:50,116:42,117:67,118:58,119:83,120:58,121:58,122:50,123:42,124:58,125:42,126:58,161:25,162:58,163:58,164:58,165:58,166:58,167:58,168:67,169:92,170:42,171:50,172:58,174:92,175:58,176:50,177:58,178:42,179:42,180:67,181:67,182:75,183:25,184:25,185:42,186:42,187:50,188:83,189:83,190:83,191:50,192:67,193:67,194:67,195:67,196:67,197:67,198:92,199:67,200:58,201:58,202:58,203:58,204:33,205:33,206:33,207:33,208:75,209:83,210:83,211:83,212:83,213:83,214:83,215:58,216:83,217:75,218:75,219:75,220:75,221:58,222:67,223:67,224:58,225:58,226:58,227:58,228:58,229:58,230:92,231:50,232:58,233:58,234:58,235:58,236:25,237:25,238:25,239:25,240:67,241:67,242:67,243:67,244:67,245:67,246:67,247:58,248:67,249:67,250:67,251:67,252:67,253:58,254:67,255:58,256:75,257:67,258:75,259:67,260:75,261:67,262:75,263:58,264:75,265:58,266:75,267:58,268:75,269:58,270:83,271:83,272:83,273:75,274:67,275:67,276:67,277:67,278:67,279:67,280:67,281:67,282:67,283:67,284:83,285:75,286:83,287:75,288:83,289:75,290:83,291:75,292:83,293:75,294:92,295:75,296:33,297:33,298:33,299:33,300:33,301:33,302:33,303:33,304:33,305:25,306:67,307:67,308:42,309:33,310:75,311:67,312:67,313:58,314:33,315:58,316:33,317:58,318:42,319:58,320:50,321:67,322:42,323:83,324:75,325:83,326:75,327:83,328:75,329:83,330:83,331:75,332:92,333:67,334:92,335:67,336:92,337:67,338:100,339:100,340:75,341:50,342:75,343:50,344:75,345:50,346:67,347:58,348:67,349:58,350:67,351:58,352:67,353:58,354:75,355:42,356:75,357:42,358:75,359:42,360:83,361:75,362:83,363:75,364:83,365:75,366:83,367:75,368:83,369:75,370:83,371:75,372:100,373:92,374:75,375:58,376:75,377:67,378:67,379:67,380:67,381:67,382:67,383:42,384:75,385:83,386:67,387:75,388:75,389:67,390:75,391:83,392:58,393:83,394:100,395:67,396:75,397:67,398:67,399:75,400:58,401:58,402:75,403:83,404:75,405:100,406:50,407:50,408:75,409:67,410:50,411:67,412:117,413:83,414:75,415:92,416:92,417:75,418:117,419:100,420:75,421:75,422:75,423:67,424:58,425:67,426:58,427:42,428:75,429:42,430:75,431:83,432:75,433:92,434:83,435:75,436:75,437:67,438:67,439:67,440:67,441:58,442:58,443:75,444:75,445:58,446:50,447:67,448:33,449:50,450:50,451:33,452:142,453:142,454:133,455:100,456:92,457:67,458:117,459:117,460:100,461:75,462:67,463:33,464:33,465:92,466:67,467:83,468:75,469:83,470:75,471:83,472:75,473:83,474:75,475:83,476:75,477:67,478:75,479:67,480:75,481:67,482:100,483:100,484:92,485:75,486:83,487:75,488:75,489:67,490:92,491:67,492:92,493:67,494:67,495:58,496:33,497:142,498:142,499:133,500:83,501:75,502:117,503:67,504:83,505:75,506:75,507:67,508:100,509:100,510:92,511:67,512:75,513:67,514:75,515:67,516:67,517:67,518:67,519:67,520:33,521:33,522:33,523:33,524:92,525:67,526:92,527:67,528:75,529:50,530:75,531:50,532:83,533:75,534:83,535:75,536:67,537:58,538:75,539:42,540:58,541:58,542:83,543:75,544:83,545:100,546:92,547:67,548:67,549:67,550:75,551:67,552:67,553:67,554:92,555:67,556:92,557:67,558:92,559:67,560:92,561:67,562:75,563:58,564:67,565:100,566:67,567:33,568:100,569:100,570:75,571:75,572:58,573:58,574:67,575:58,576:58,577:67,578:50,579:75,580:75,581:75,582:75,583:58,584:58,585:25,586:83,587:58,588:75,589:33,590:75,591:58,880:67,881:50,882:67,883:50,884:33,885:33,886:75,887:67,888:108,889:108,890:67,891:58,892:58,893:58,894:42,895:108,896:108,897:108,898:108,899:108,900:67,901:67,902:75,903:42,904:83,905:100,906:58,907:108,908:100,909:108,910:100,911:100,912:42,913:75,914:67,915:58,916:83,917:67,918:67,919:83,920:92,921:33,922:75,923:75,924:100,925:83,926:75,927:92,928:83,929:67,930:108,931:67,932:75,933:75,934:83,935:75,936:83,937:92,938:33,939:75,940:83,941:58,942:75,943:42,944:67,945:83,946:67,947:67,948:67,949:58,950:75,951:75,952:67,953:42,954:67,955:67,956:75,957:67,958:67,959:67,960:92,961:67,962:67,963:75,964:67,965:67,966:92,967:67,968:92,969:100,970:42,971:67,972:67,973:67,974:100,975:108,976:58,977:75,978:75,979:100,980:75,981:92,982:100,983:67,984:92,985:67,986:75,987:58,988:58,989:58,990:67,991:58,992:75,993:92,994:100,995:92,996:75,997:58,998:75,999:58,1e3:75,1001:75,1002:67,1003:67,1004:83,1005:58,1006:50,1007:42,1008:67,1009:67,1010:58,1011:33,1012:92,1013:58,1014:58,1015:67,1016:67,1017:75,1018:100,1019:83,1020:58,1021:75,1022:75,1023:75,1024:67,1025:67,1026:92,1027:58,1028:75,1029:67,1030:33,1031:33,1032:42,1033:108,1034:108,1035:83,1036:75,1037:83,1038:75,1039:83,1040:75,1041:67,1042:67,1043:58,1044:83,1045:67,1046:92,1047:67,1048:83,1049:83,1050:75,1051:83,1052:100,1053:83,1054:92,1055:83,1056:67,1057:75,1058:75,1059:75,1060:83,1061:75,1062:83,1063:75,1064:108,1065:108,1066:75,1067:92,1068:67,1069:75,1070:108,1071:75,1072:67,1073:67,1074:58,1075:58,1076:75,1077:67,1078:83,1079:58,1080:75,1081:75,1082:67,1083:67,1084:83,1085:75,1086:67,1087:75,1088:75,1089:58,1090:58,1091:58,1092:92,1093:67,1094:75,1095:58,1096:92,1097:100,1098:67,1099:83,1100:58,1101:58,1102:92,1103:58,1104:67,1105:67,1106:75,1107:58,1108:58,1109:58,1110:33,1111:33,1112:42,1113:92,1114:92,1115:75,1116:67,1117:75,1118:58,1119:75,1120:100,1121:75,1122:75,1123:67,1124:83,1125:83,1126:75,1127:67,1128:100,1129:92,1130:92,1131:83,1132:117,1133:108,1134:67,1135:67,1136:83,1137:83,1138:92,1139:67,1140:83,1141:67,1142:83,1143:67,1144:133,1145:125,1146:92,1147:67,1148:100,1149:75,1150:100,1151:75,1152:75,1153:58,1154:75,1155:0,1156:0,1157:0,1158:0,1159:108,1160:0,1161:0,1162:83,1163:75,1164:67,1165:58,1166:67,1167:75,1168:58,1169:58,1170:67,1171:58,1172:75,1173:67,1174:100,1175:92,1176:67,1177:58,1178:75,1179:67,1180:83,1181:75,1182:75,1183:67,1184:83,1185:75,1186:83,1187:75,1188:100,1189:83,1190:117,1191:100,1192:92,1193:75,1194:75,1195:58,1196:75,1197:58,1198:75,1199:58,1200:75,1201:58,1202:75,1203:75,1204:100,1205:83,1206:75,1207:67,1208:75,1209:67,1210:75,1211:58,1212:92,1213:75,1214:92,1215:75,1216:33,1217:92,1218:83,1219:75,1220:67,1221:83,1222:67,1223:83,1224:75,1225:83,1226:75,1227:75,1228:58,1229:100,1230:83,1231:25,1232:75,1233:67,1234:75,1235:67,1236:100,1237:100,1238:67,1239:67,1240:75,1241:67,1242:75,1243:67,1244:92,1245:83,1246:67,1247:58,1248:67,1249:58,1250:83,1251:75,1252:83,1253:75,1254:92,1255:67,1256:92,1257:67,1258:92,1259:67,1260:75,1261:58,1262:75,1263:58,1264:75,1265:58,1266:75,1267:58,1268:75,1269:58,1270:58,1271:42,1272:92,1273:83,1274:58,1275:42,1276:75,1277:58,1278:75,1279:58,2026:67,19977:108,65403:58},this._ELLIPSIS_LENGTH=new e("…").length,this._DOT_LENGTH=new e(".").length},e.em_snippet=function(r,o,n,i){void 0===i&&(i=t.HighlightedTruncatedStringVariant.HIGHLIGHTED_TRUNCATED_STRING_MIDDLE),null==o&&(o=50),null==n&&(n=.75);var s=new e(r.toString());switch(i){case t.HighlightedTruncatedStringVariant.HIGHLIGHTED_TRUNCATED_STRING_END:return s.snippet_end(o).toString();case t.HighlightedTruncatedStringVariant.HIGHLIGHTED_TRUNCATED_STRING_START:return s.snippet_start(o).toString();case t.HighlightedTruncatedStringVariant.HIGHLIGHTED_TRUNCATED_STRING_LAST_WORD:return s.snippet_last_word(o).toString();case t.HighlightedTruncatedStringVariant.HIGHLIGHTED_TRUNCATED_STRING_FILE_EXTENSION:return s.snippet_file_extension(o).toString();case t.HighlightedTruncatedStringVariant.HIGHLIGHTED_TRUNCATED_STRING_MIDDLE:default:return s.snippet(o,n).toString()}},e.prototype.widthInfo=function(){for(var e={"-1":0},t=0,r=this.s.length,o=0<=r;o?t<r:t>r;o?t++:t--)e[t]=e[t-1]+this.ems(this.s.charAt(t));return e},e.prototype.findSpot=function(e){var t;if(!e)return 0;for(var r=0,o=this.s.length;r<=o;){t=Math.floor(r/2+o/2);var n=this.info[t-1];if(n>e)o=t-1;else{if(!(n<e))return t;r=t+1}}return r>t?r:t},e.prototype.ems=function(t){var r=t.charCodeAt(0),o=e.CODEPOINT_TO_WIDTH[r];return o?o/Math.pow(10,e.ACCURACY):768<=r&&r<=879?0:65377<=r&&r<=65500?.58:11904<=r&&r<=40911||44032<=r&&r<=55215||4352<=r&&r<=4607||63744<=r&&r<=64255||65280<=r&&r<=65535||131072<=r&&r<=196607?1.08:.65},e.prototype.substr=function(t,r){var o=this.findSpot(t);if(null!=r){var n=this.findSpot(t+r);if(n-o<this.s.length){var i=this.s.charCodeAt(n-o);65024<=i&&i<=65039&&n--}return new e(this.s.substr(o,n-o))}return new e(this.s.substr(o))},e.prototype.toString=function(){return this.s},e.prototype.snippet=function(t,r){if(void 0===t&&(t=50),void 0===r&&(r=.75),this.length<=t)return this;var o=(t-=e._ELLIPSIS_LENGTH)*r,n=t-o,i=this.length-n,s=this.substr(0,o),a=this.substr(i);return new e(s.toString()+"…"+a.toString())},e.prototype.snippet_end=function(t){return void 0===t&&(t=50),this.length<=t?this:(t-=e._ELLIPSIS_LENGTH,new e(this.substr(0,t).toString()+"…"))},e.prototype.snippet_start=function(t){return void 0===t&&(t=50),this.length<=t?this:(t-=e._ELLIPSIS_LENGTH,new e("…"+this.substr(this.length-t,t).toString()))},e.prototype.snippet_last_word=function(t){if(void 0===t&&(t=50),this.length<=t)return this;var r=this.toString().trim().split(" ").pop(),o=new e(r).length;if(o>=t)return this.snippet(t);var n=(t-=e._ELLIPSIS_LENGTH)-o;return new e(this.substr(0,n).toString()+"…"+r)},e.prototype.snippet_file_extension=function(t){if(void 0===t&&(t=50),this.length<=t)return this;var r=this.toString().trim().split(".").pop(),o=new e(r).length;if(o>=t)return this.snippet(t);var n=(t-=e._ELLIPSIS_LENGTH)-o-e._DOT_LENGTH;return new e(this.substr(0,n).toString()+"…."+r)},e})();t.Emstring=o,o.initClass()})),define("retrieval-components/highlighted-truncated-string/text-highlights",["require","exports","tslib","classnames","react"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n);function i(e,t,r,o){if(r||(r=0),void 0===o&&(o=e.length),!t||!(function(e,t){var r=t.map((function(e){return e.string})).join("");return e===r})(e,t))return[{isHighlighted:!1,text:e.substring(r,o)}];for(var n=[],i=0,s=0,a=t;s<a.length;s++){var l=a[s],c=e.indexOf(l.string,i),d=c+l.string.length;if(i=d,!(c<r&&d<=r||c>=o)){var u=l.string;c<r&&(u=u.slice(r-c)),o<d&&(u=u.slice(0,-(d-o))),n.push({text:u,isHighlighted:l.isHighlighted})}}return n}function s(e,t,r){if(!r)return!1;for(var o=0,n=0,i=r;n<i.length;n++){var s=i[n],a=o+s.string.length-1;if(s.isHighlighted&&a>=e&&o<=t)return!0;o=a+1}return!1}t.highlightSectionsFromHighlightSpans=i,t.highlightReactFromHighlightSpans=function(e,t,r,s){return a=i(e,t,r,s),n.createElement("span",null,a.map((function(e,t){return n.createElement("span",{className:o.default({"rc-hl-truncated-string__highlight":e.isHighlighted}),key:t},e.text)})));var a},t.highlightEllipsisFromHighlightSpans=function(e,t,r){return n.createElement("span",{className:o.default({"rc-hl-truncated-string__highlight":s(e,t,r)})},"…")},t.generateHighlightedTooltipSpans=function(e){return n.createElement("span",null,e.map((function(e,t){return n.createElement("span",{className:o.default({"rc-hl-truncated-string__tooltip-highlight":e.isHighlighted}),key:t},e.text)})))}})),define("dropbox/proto/hql_events/browse/web_browse",["require","exports","tslib","protobufjs/minimal","dropbox/proto/hql_events/extensions"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(o=r.__importStar(o)).Reader,s=o.Writer,a=(o.util,o.roots.default||(o.roots.default={}));t.default=a,t.hql_events=a.hql_events=((n=a.hql_events||{}).WebBrowseSelectRow=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.actionSource="",e.prototype.hqlMetadata=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.actionSource&&Object.hasOwnProperty.call(e,"actionSource")&&t.uint32(10).string(e.actionSource),null!=e.hqlMetadata&&Object.hasOwnProperty.call(e,"hqlMetadata")&&a.hql_events.HQLMetadata.encode(e.hqlMetadata,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,o=new a.hql_events.WebBrowseSelectRow;e.pos<r;){var n=e.uint32();switch(n>>>3){case 1:o.actionSource=e.string();break;case 2:o.hqlMetadata=a.hql_events.HQLMetadata.decode(e,e.uint32());break;default:e.skipType(7&n)}}return o},e.getTypeUrl=function(){return"type.googleapis.com/hql_events.WebBrowseSelectRow"},e})(n.WebBrowseSelectRow||{}),n)})),define("modules/clean/react/file_uploader/parallel_scheduler",["require","exports","tslib","modules/clean/react/upload_kit/scheduler/types"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CHUNK_SIZE=4194304;var n=(function(e){function o(t){var r=e.call(this,t)||this;return r.itemInfoByDestPath=new Map,r.sleepingWorkers=6,r.isDispenserEmpty=!0,r.isSchedulerUploading=!1,r.handleUploadBlocks=t.handleUploadBlocks,r.handleCommitBlocks=t.handleCommitBlocks,r.handleProgress=t.handleProgress,r.handleItemExit=t.handleItemExit,r}return r.__extends(o,e),o.prototype.itemExit=function(e,t){var r=this.itemInfoByDestPath.get(e);r&&(this.itemInfoByDestPath.delete(e),this.handleItemExit(r.info,t))},o.prototype.dispenseChunkData=function(){var e=this.currentFileChunkReader.getNextChunk();if(!e){if(this.currentDestPath=this.getNextDestPathInQueue(),!this.currentDestPath)return this.isDispenserEmpty=!0,null;var t=this.itemInfoByDestPath.get(this.currentDestPath);if(!t)return this.isDispenserEmpty=!0,null;if(this.currentFileChunkReader=new i(t.file),!(e=this.currentFileChunkReader.getNextChunk()))return this.isDispenserEmpty=!0,null}return{info:this.itemInfoByDestPath.get(this.currentDestPath).info,chunk:e,chunkDestPath:this.currentDestPath}},o.prototype.getNextDestPathInQueue=function(){var e=Array.from(this.itemInfoByDestPath.entries()).find((function(e){return"Queued"===e[1].status}));return e?e[0]:null},o.prototype.isFileReadyForCommit=function(e){var r=this.itemInfoByDestPath.get(e);if(!r)return!1;if(r.blockTokens.every((function(e){return""!==e}))){var o=r.file,n=Math.ceil(o.size/t.CHUNK_SIZE);return r.blockTokens.length===n}return!1},o.prototype.activateSleepingWorkers=function(e){for(var r=Math.ceil(e/t.CHUNK_SIZE),o=Math.min(this.sleepingWorkers,r),n=0;n<o;n++)this.uploadNextBlock()},o.prototype.uploadNextBlock=function(){var e=this;if(!(this.sleepingWorkers<=0)){var t=this.dispenseChunkData();if(t){var o=t.info,n=t.chunk,i=t.chunkDestPath,s=this.itemInfoByDestPath.get(i);if(s){"Queued"===s.status&&(s.status="Uploading");var a=0,l=function(t){var r=s.totalBytesUploaded,i=s.file,l=Math.min(r+n.size,i.size),c=Math.min(t,l),d=Math.max(c-a,0);a+=d;var u=Math.min(r+d,i.size);s.totalBytesUploaded=u,e.handleProgress(o,u)};s.blockTokens.push("");var c=s.tokenCount;s.tokenCount=c+1,this.sleepingWorkers--,this.handleUploadBlocks(o,n,l).then((function(t){return r.__awaiter(e,void 0,void 0,(function(){var e,o;return r.__generator(this,(function(r){switch(r.label){case 0:return l(n.size),s.blockTokens[c]=t,this.isFileReadyForCommit(i)?this.itemInfoByDestPath.get(i)?(e=s.info,o=s.blockTokens,[4,this.handleCommitBlocks([{info:e,tokens:o}])]):[3,2]:[3,3];case 1:r.sent(),this.itemExit(i,"Completed"),r.label=2;case 2:this.isQueueEmpty()&&(this.isSchedulerUploading=!1),r.label=3;case 3:return this.sleepingWorkers++,this.uploadNextBlock(),[2]}}))}))})).catch((function(t){e.itemExit(i,"Cancelled"===t?"Cancelled":"Error")}))}}}},o.prototype.addFile=function(e,t,o){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(r){return this.itemInfoByDestPath.set(t,{file:e,destPath:t,status:"Queued",bytesUploaded:0,info:o,blockTokens:[],tokenCount:0,totalBytesUploaded:0}),this.isSchedulerUploading&&this.activateSleepingWorkers(e.size),[2]}))}))},o.prototype.startUploading=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){return this.isSchedulerUploading=!0,this.isDispenserEmpty&&(this.currentDestPath=this.getNextDestPathInQueue(),this.currentDestPath&&(this.currentFileChunkReader=new i(this.itemInfoByDestPath.get(this.currentDestPath).file),this.isDispenserEmpty=!1)),this.currentDestPath&&(e=this.itemInfoByDestPath.get(this.currentDestPath))&&this.activateSleepingWorkers(e.file.size),[2]}))}))},o.prototype.cancelFile=function(e){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(e){return[2]}))}))},o.prototype.stopUploading=function(){},o.prototype.isQueueEmpty=function(){return 0===this.itemInfoByDestPath.size},o})(o.UploadScheduler);t.ParallelUploadScheduler=n;var i=(function(){function e(e){this.currentOffset=0,this.file=e}return e.prototype.getNextChunk=function(){if(this.file.size<=this.currentOffset)return null;var e=this.file.slice(this.currentOffset,t.CHUNK_SIZE+this.currentOffset);return this.currentOffset+=t.CHUNK_SIZE,e},e})()})),define("modules/clean/react/upload_kit/scheduler/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){};t.UploadScheduler=r}));__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/browse/fss_experiment_carousel_util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncShowFssExpr=function(t,r,o,n){new Promise((function(t,r){e(["modules/clean/react/browse/fss_experiment_carousel"],t,r)})).then(__importStar).then((function(e){e.showFssExpr(t,r,o,n)}))}})),define("modules/clean/react/file_task_list/async_file_task_list",["require","exports","tslib","modules/clean/react/async/loadable","modules/clean/web_timing_logger"],(function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncFileTaskList=o.Loadable({displayName:"AsyncFileTaskList",loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,n.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/react/file_task_list/file_task_list"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().FileTaskList]}}))}))}})}));
//# sourceMappingURL=pkg-browse.min.js-vflGKhe9m.map