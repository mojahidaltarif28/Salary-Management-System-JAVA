define(["require","exports","tslib","react","spectrum/button","spectrum/input","spectrum/modal","modules/clean/react/css","modules/clean/react/modal","modules/clean/static_urls","modules/clean/teams/admin/api/admin_console_api_client","modules/clean/teams/components/warning_box","modules/core/browser","modules/core/i18n","modules/core/notify"],(function(e,t,a,s,i,n,l,o,r,m,u,c,d,f,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),u=a.__importDefault(u),d=a.__importStar(d);var g=f.intl.formatMessage({id:"UFpE+s",defaultMessage:"GB"}),M=f.intl.formatMessage({id:"g/Ia4W",defaultMessage:"Reset custom space limit"}),h=f.intl.formatMessage({id:"GGfLFz",defaultMessage:"This member might be out of space if you set a limit lower than their current usage."}),C=s.default.createElement("div",null,s.default.createElement("div",{className:"off-warning-message"},f.intl.formatMessage({id:"MyGUjq",defaultMessage:"To apply a custom space limit, you’ll need to set a member space limit for your team first. <a>View settings</a>"},{a:function(e){return s.default.createElement("a",{href:"/team/admin/settings/space",target:"_blank",rel:"noopener noreferrer"},e)}})),h),y=(function(e){function t(t){var a=e.call(this,t)||this;return a.setCustomQuota=function(){return a._client.setCustomQuota(a.props.email,a.state.customQuota)},a.resetCustomQuota=function(){return a._client.removeCustomQuota(a.props.email)},a.onSet=function(){null==a.state.customQuota||a.state.customQuota<15?p.Notify.error(f.intl.formatMessage({id:"BpPk8Q",defaultMessage:"Custom quota must exceed 15 GB"})):a.onSubmit(a.setCustomQuota)},a.onMainCancelClicked=function(){a.setState({isModalOpen:!1,isResetConfirmationOpen:!1})},a.onResetCancel=function(){a.setState({isModalOpen:!0,isResetConfirmationOpen:!1})},a.onReset=function(){a.onSubmit(a.resetCustomQuota)},a.primaryAction=function(e,t,n){return s.default.createElement("span",null,a.state.submitting&&s.default.createElement("span",{className:"dbmodal-loading",key:"loading"},s.default.createElement("img",{src:m.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:f.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})})),s.default.createElement(i.Button,{disabled:a.state.submitting||n,variant:"primary",onClick:t},e))},a.setPrimaryAction=function(e){var t="Set custom space limit";return a.props.userCustomLimitGB&&(t=f.intl.formatMessage({id:"/oxGSo",defaultMessage:"Set {first_name}’s space limit"},{first_name:a.firstName})),a.primaryAction(t,e,!a.isValidInput())},a.resetPrimaryAction=function(e){return a.primaryAction(f.intl.formatMessage({id:"g/Ia4W",defaultMessage:"Reset custom space limit"}),e,!1)},a.secondaryAction=function(e){return s.default.createElement(i.Button,{disabled:a.state.submitting,variant:"secondary",onClick:e},f.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}))},a.saveCustomQuotaChange=function(e){a.setState({customQuota:Number(e.currentTarget.value)})},a.onResetClicked=function(){a.setState({isModalOpen:!1,isResetConfirmationOpen:!0})},a.state={submitting:!1,isModalOpen:!0,customQuota:a.props.userCustomLimitGB,isResetConfirmationOpen:!1},a._client=new u.default,a}return a.__extends(t,e),t.prototype.getErrorMessage=function(){return null==this.state.customQuota?null:this.state.customQuota%1!=0?f.intl.formatMessage({id:"V81LjE",defaultMessage:"This must be a whole number"}):this.state.customQuota<15?f.intl.formatMessage({id:"z3MfdB",defaultMessage:"This number can’t be lower than 15"}):null},t.prototype.isValidInput=function(){return null!=this.state.customQuota&&this.state.customQuota!==this.props.userCustomLimitGB&&15<=this.state.customQuota&&this.state.customQuota%1==0},t.prototype.onSubmit=function(e){var t=this;this.setState({submitting:!0}),e().then((function(){t.setState({submitting:!1,isModalOpen:!1}),t.props.redirectOnChangeUrl?d.redirect(t.props.redirectOnChangeUrl+"&msg=cq_set"):d.reload()})).catch((function(){t.setState({submitting:!1}),t.props.redirectOnChangeUrl?d.redirect(t.props.redirectOnChangeUrl+"&msg=cq_failed"):d.reload()}))},t.prototype.renderMainModal=function(){var e,t,a=f.intl.formatMessage({id:"D+135/",defaultMessage:"Edit {display_name}’s space limit"},{display_name:this.displayName}),i=f.intl.formatMessage({id:"kFNhCf",defaultMessage:"Set a custom space limit for this member. {first_name} is currently using {usage}."},{first_name:this.firstName,usage:this.props.userUsageString}),o=this.props.userCustomLimitGB?M:void 0,r=this.getErrorMessage(),m="off"===this.props.teamCapsType?C:h;return s.default.createElement(l.UtilityModal,{className:"edit-space-limit-modal",overlayClassName:"edit-space-limit-modal--overlay",title:a,primaryAction:this.setPrimaryAction,secondaryAction:this.secondaryAction,link:o,onPrimaryAction:this.onSet,onSecondaryAction:this.onMainCancelClicked,onLink:this.onResetClicked,onRequestClose:this.onMainCancelClicked,overlayClickClose:!0,ariaLabel:f.intl.formatMessage({id:"76Ae2R",defaultMessage:"Set custom space limit"}),open:this.state.isModalOpen&&!this.state.isResetConfirmationOpen},s.default.createElement("div",{className:"edit-space-limit-content"},i,s.default.createElement("br",null)),s.default.createElement("div",{className:"space-limit-row"},s.default.createElement("label",{className:"limit-label",htmlFor:"team-limit-input"},f.intl.formatMessage({id:"cAXMSv",defaultMessage:"Everyone’s default limit"}),s.default.createElement("br",null),(e=!!this.props.userCustomLimitGB,t=f.intl.formatMessage({id:"ia9qta",defaultMessage:"edit everyone’s default"}),e&&(t=f.intl.formatMessage({id:"nq1HqC",defaultMessage:"edit"})),s.default.createElement("a",{href:"/team/admin/settings/space",target:"_blank",rel:"noopener noreferrer"},t))),s.default.createElement("div",{className:"limit-input"},s.default.createElement(n.Input,{id:"team-limit-input",defaultValue:String(this.props.teamMemberDefaultLimitGB),disabled:!0}),s.default.createElement("div",{className:"limit-suffix"},g))),s.default.createElement("div",{className:"space-limit-row space-limit-input-row"},s.default.createElement("label",{className:"limit-label",htmlFor:"user-limit-input"},f.intl.formatMessage({id:"M5Btl1",defaultMessage:"This member’s limit"}),s.default.createElement("br",null),f.intl.formatMessage({id:"HB7g+f",defaultMessage:"(must exceed 15 GB)"})),s.default.createElement("div",{className:"limit-value"},s.default.createElement("div",{className:"limit-input"},s.default.createElement(n.Input,{id:"user-limit-input",type:"number",min:15,defaultValue:String(this.props.userCustomLimitGB),onChange:this.saveCustomQuotaChange}),s.default.createElement("div",{className:"limit-suffix"},g)),s.default.createElement("div",{className:"limit-error"},r))),s.default.createElement(c.WarningBox,{warningText:m}))},t.prototype.renderResetConfirmationModal=function(){var e=f.intl.formatMessage({id:"g/Ia4W",defaultMessage:"Reset custom space limit"}),t=f.intl.formatMessage({id:"Wl8Ylh",defaultMessage:"This member’s limit will return to the default space limit."});return s.default.createElement(l.UtilityModal,{className:"edit-space-limit-modal",overlayClassName:"edit-space-limit-modal--overlay",title:e,primaryAction:this.resetPrimaryAction,secondaryAction:this.secondaryAction,onPrimaryAction:this.onReset,onSecondaryAction:this.onResetCancel,onRequestClose:this.onMainCancelClicked,overlayClickClose:!0,ariaLabel:f.intl.formatMessage({id:"g/Ia4W",defaultMessage:"Reset custom space limit"}),open:this.state.isResetConfirmationOpen},s.default.createElement("div",{className:"edit-space-limit-content"},t))},t.prototype.render=function(){return this.state.isResetConfirmationOpen?this.renderResetConfirmationModal():this.renderMainModal()},Object.defineProperty(t.prototype,"displayName",{get:function(){return this.props.displayName||this.props.email},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstName",{get:function(){return this.props.firstName||this.props.email},enumerable:!0,configurable:!0}),t})(s.default.Component);t.EditSpaceLimitModal=o.requireCssWithComponent(y,["/static/css/spectrum/index.web-vfl6Z83yw.css","/static/css/teams/edit_space_limit_modal-vflsl_dkS.css"]),t.showEditSpaceLimitModal=function(e){r.Modal.showInstance(s.default.createElement(t.EditSpaceLimitModal,a.__assign({},e)))}}));
//# sourceMappingURL=edit_space_limit_modal.min.js-vflev8vSp.map