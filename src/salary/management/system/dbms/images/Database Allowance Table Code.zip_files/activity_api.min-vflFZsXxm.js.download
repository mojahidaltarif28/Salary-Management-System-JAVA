define(["require","exports","tslib","modules/clean/teams/admin/api/admin_console_api_client","modules/constants/time","modules/clean/contacts/contact","modules/clean/contacts/types","modules/core/notify","modules/core/i18n","modules/clean/teams/admin/pages/activity/behaviors/activity_logger","modules/clean/api_v2/types","modules/clean/viewer"],(function(e,t,i,r,n,o,a,s,c,u,_,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=i.__importStar(n),a=i.__importDefault(a),t.getClient=function(){return(new r.AdminConsoleApiClient).teamLogRoutes()};var m=c.intl.formatMessage({id:"9JWHIG",defaultMessage:"Unable to execute the required action"}),f=c.intl.formatMessage({id:"242oct",defaultMessage:"There was a problem with your request"});t.getEvents=function(e,i){var r;void 0===i&&(i=0),e.limit=e.limit||100;var n={};return i&&(n={headers:(r={},r[_.ApiV2HeaderNames.DropboxTeamId]=String(i),r[_.ApiV2HeaderNames.DropboxTeamAuthorization]=JSON.stringify({auth_role:String(l.Viewer.get_viewer().auth_role),auth_action_type:String(2)}),r)}),t.getClient().rpc("get_events_ex",e,n)},t.getNextEvents=function(e){return t.getClient().rpc("get_events_ex/continue",{cursor:e},{})},t.executeQuickActions=function(e){u.logActivityPageEventToHive({eventName:"activity_row_do_action",extra:{action_name:e.quick_action_type[".tag"]}});var i=t.getClient().rpc("execute_quick_action",e,{});return i.then((function(e){s.Notify.success(e.message)})),i.catch((function(e){e.message?s.Notify.error(e.message.toHTML()):s.Notify.error(m)})),i},t.fetchCategories=function(){return t.getClient().rpc("get_team_supported_activities",void 0,{})};var d=function(e){var t=p(e);return t&&["active","invited","suspended"].indexOf(t)>=0},p=function(e){if(e.member_info&&e.member_info.status)return e.member_info.status[".tag"]},g=function(e){var t=new o.Contact({dbx_account_id:e.account_id,name:e.display_name||e.email||"",email:e.email,photo_url:e.profile_photo_url,type:a.default.DBX_ID,on_team:d(e),join_state:p(e)});return t.role=(function(e){if(e.member_info&&e.member_info.role)return e.member_info.role[".tag"]})(e),t};t.partakers=function(e){var i=e.limit,r=e.accounts_ids,n=e.prefix;return[t.getClient().rpc("partakers/list",{prefix:n,limit:i,accounts_ids:r},{}).then((function(e){return{query:n||"",results:e.partakers.map(g)}})).catch((function(e){return e.message?s.Notify.error(e.message.toHTML()):s.Notify.error(f),{query:n||"",results:[].map(g)}}))]},t.partakerByAccountIdAndEmail=function(e,r){return i.__awaiter(void 0,void 0,void 0,(function(){return i.__generator(this,(function(i){switch(i.label){case 0:return[4,t.partakers({prefix:e,limit:500})[0]];case 1:return[2,i.sent().results.filter((function(e){return e.dbx_account_id===r}))]}}))}))},t.createReport=function(e,r,o){void 0===o&&(o=void 0);var a=o?{headers:o}:{};return t.getClient().rpc("create_team_events_report",i.__assign(i.__assign({},e),{exclude_high_volume_events:r,timezone_offset:60*n.TIMEZONE_OFFSET}),a)}}));
//# sourceMappingURL=activity_api.min.js-vflGwCifv.map