define("modules/clean/react/file_viewer/frame_interface",["require","exports","tslib","modules/clean/react/file_viewer/interface","modules/clean/react/previews/frame_messenger_host","file-viewer/libraries/frame_messenger"],(function(e,t,n,r,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["annotation-end-drag","annotation-enter","annotation-hidden","annotation-leave","annotation-placed","annotation-start-drag","annotation-ui-click","annotation-ui-enter","annotation-ui-leave","annotation-ui-over","mouse-up","on-keydown","page-change","page-rendered","scale-change","scroll","doc-metadata-load"],s=(function(e){function t(n){var r=e.call(this,n)||this;return r.handleMessageFromFrame=function(e){r.eventEmitter.emit(e.action,e.parameters)},t.frameMessengerFactory?r.frameMessenger=t.frameMessengerFactory():r.frameMessenger=new o.PreviewFrameMessengerHost,r.frameMessenger.configureChildMessaging('iframe[name="preview-content"]',r.handleMessageFromFrame,i),r.frameMessenger.startListening(),r}return n.__extends(t,e),t.prototype.dispatchEvent=function(e,t){a.logFrameMessage&&a.logFrameMessage("frame_interface",{eventName:e,data:t}),this.frameMessenger.postMessageToChildren(e,t)},t.prototype.destroy=function(){this.frameMessenger.stopListening()},t.setFrameMessengerFactory=function(e){t.frameMessengerFactory=e},t})(r.FileViewerInterface);t.FileViewerFrameInterface=s})),define("modules/clean/react/file_viewer/interface",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this.eventEmitter=e}return e.prototype.destroy=function(){},e})();t.FileViewerInterface=n})),define("modules/clean/react/file_viewer/sidebar_helpers",["require","exports","modules/clean/react/file_viewer/constants","modules/clean/react/size_class/utils"],(function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSidebarEnabled=function(e,t,o){return!(r.isSmallerThanLarge(t)||o||e!==n.DocType.ppt&&e!==n.DocType.pdf)}})),define("modules/clean/react/previews/pdf_viewer/event_emitter",["require","exports","tslib","eventemitter3"],(function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),t.eventEmitter=new r.default})),define("modules/clean/react/previews/pdf_viewer/font",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renderFont=function(e){var t=e.n.lastIndexOf(",");return{fontFamily:'"'+(t>-1?e.n.substr(0,t):e.n)+'", '+(1&e.f?"monospace":"serif"),isBold:(e.f&1<<18)>0,isItalic:(64&e.f)>0}}})),define("modules/clean/react/previews/pdf_viewer/frame_messenger",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FRAME_MESSAGES_FROM_PARENT=["open-file","page-up","page-down","set-current-page","file-feedback-ui-ready","update-annotations","focus-annotation","hover-annotation","enable-annotation-creation","disable-annotation-creation","enable-region-creation","disable-region-creation","zoom-in","zoom-out","print","remove-all-annotations","scroll-to-annotation","clear-annotation-selection","request-doc-metadata","place-default-annotation","hide-annotation"],t.WT_EVENT_PAGE_RENDERED="page-rendered"})),define("modules/clean/react/previews/pdf_viewer/frame_messenger_shims",["require","exports","tslib","eventemitter3","file-viewer/libraries/frame_messenger"],(function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r);t.makeChannel=function(){return{parentEmitter:new r.default,childEmitter:new r.default}};var a=(function(e){function t(t){var n=e.call(this,[])||this;return n.eventListener=function(e){n.shimValidActions.indexOf(e.action)>-1&&n.handler(e)},n.channel=t,n}return n.__extends(t,e),t.prototype.configureChildMessaging=function(e,t,n){this.handler=t,this.shimValidActions=n},t.prototype.startListening=function(){this.channel.childEmitter.on("message",this.eventListener)},t.prototype.stopListening=function(){this.channel.childEmitter.off("message",this.eventListener)},t.prototype.postMessageToChildren=function(e,t){void 0===t&&(t={}),this.channel.parentEmitter.emit("message",{action:e,parameters:t})},t})(o.FrameMessengerHost);t.FrameMessengerHostShim=a;var i=(function(e){function t(t){var n=e.call(this,[])||this;return n.eventListener=function(e){n.shimValidActions.indexOf(e.action)>-1&&n.handler(e)},n.channel=t,n}return n.__extends(t,e),t.prototype.configureParentMessaging=function(e,t,n){void 0===n&&(n=null),this.shimValidActions=t,this.handler=e},t.prototype.postMessageToParent=function(e,t){void 0===t&&(t={}),this.channel.childEmitter.emit("message",{action:e,parameters:t})},t.prototype.startListening=function(){this.channel.parentEmitter.on("message",this.eventListener)},t.prototype.stopListening=function(){this.channel.parentEmitter.off("message",this.eventListener)},t})(o.FrameMessengerClient);t.FrameMessengerClientShim=i})),define("modules/clean/react/previews/pdf_viewer/keyboard_bindings",["require","exports","tslib","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/keycode"],(function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLeftRightKeyboardBindings=function(e,t){return[r.hydrateKeyboardBinding({keyboardEventCriteria:{which:o.KeyCode.LEFT},callback:e}),r.hydrateKeyboardBinding({keyboardEventCriteria:{which:o.KeyCode.RIGHT},callback:t})]},t.getUpDownKeyboardBindings=function(e,t){return[r.hydrateKeyboardBinding({keyboardEventCriteria:{which:o.KeyCode.UP},callback:e}),r.hydrateKeyboardBinding({keyboardEventCriteria:{which:o.KeyCode.DOWN},callback:t})]},t.getPageUpPageDownKeyboardBindings=function(e,t){return[r.hydrateKeyboardBinding({keyboardEventCriteria:{which:o.KeyCode.PAGE_UP},callback:e}),r.hydrateKeyboardBinding({keyboardEventCriteria:{which:o.KeyCode.PAGE_DOWN},callback:t})]},t.getSinglePageKeyboardBindings=function(e){var a=e.pageUp,i=e.pageDown,s=e.zoomIn,l=e.zoomOut,d=e.print,c=r.hydrateKeyboardBinding({keyboardEventCriteria:{altKey:!1,which:o.KeyCode.SPACE},callback:i});return n.__spreadArrays([c],t.getPageUpPageDownKeyboardBindings(a,i),t.getUpDownKeyboardBindings(a,i),t.getLeftRightKeyboardBindings(a,i),r.getEqualsKeyBindings(s),r.getMinusKeyBindings(l),r.getPrintKeyBindings(d))},t.getContinuousPageKeyboardBindings=function(e){var a=e.isFullScreen,i=e.keyUp,s=e.keyDown,l=e.pageUp,d=e.pageDown,c=e.zoomIn,u=e.zoomOut,p=e.print,g=a?t.getUpDownKeyboardBindings(l,d):t.getUpDownKeyboardBindings(i,s),m=r.hydrateKeyboardBinding({keyboardEventCriteria:{altKey:!0,which:o.KeyCode.UP},callback:l}),f=r.hydrateKeyboardBinding({keyboardEventCriteria:{altKey:!0,which:o.KeyCode.DOWN},callback:d}),h=r.hydrateKeyboardBinding({keyboardEventCriteria:{altKey:!1,which:o.KeyCode.SPACE},callback:d}),v=a?n.__spreadArrays(t.getLeftRightKeyboardBindings(l,d)):[];return n.__spreadArrays(g,[m,f,h],t.getPageUpPageDownKeyboardBindings(l,d),v,r.getEqualsKeyBindings(c),r.getMinusKeyBindings(u),r.getPrintKeyBindings(p))}})),define("modules/clean/react/previews/pdf_viewer/layers",["require","exports","tslib","react","file-viewer/preview_doc","modules/clean/react/comments2/components/annotations/loadable","modules/clean/referrer_cleansing_redirect","file-viewer/preview_doc","modules/clean/react/watermarking/watermarking_layer","modules/clean/react/workflows/markup/markup_layer"],(function(e,t,n,r,o,a,i,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i),t._cleanseLinks=function(e){return void 0===e&&(e=[]),e.map((function(e){return e.a&&s.isLinkUrl(e.a)&&!e.a.ur.startsWith("mailto:")?n.__assign(n.__assign({},e),{a:n.__assign(n.__assign({},e.a),{ur:i.get_redirect_uri(o.normalizeUrl(e.a.ur)).toString()})}):e}))},t.createGenerateLayersFn=function(e,t,i){return function(s){return function(c){var u=s.config.load_image_only,p=s.filePreviewUiData.zoomScaleFactor,g=void 0===p?0:p,m=c.data,f=m.dimension,h=m.pageIndex,v={width:f[0]*g,height:f[1]*g},w=[r.default.createElement("div",{className:"c-loader",key:"loader"})],b=h+1;w.push(r.default.createElement(o.ImgLayer,n.__assign({},s,c,{key:"imgLayer"})));var _=null,P=null;return u||t||i||(_=r.default.createElement(o.TextLayer,n.__assign({},s,c,{key:"textLayer"})),P=r.default.createElement(o.LinksLayer,n.__assign({},s,c,{key:"linksLayer"}))),e?w.push(r.default.createElement(a.AnnotationViewLayer,{key:"annotationViewLayer",page:b}),r.default.createElement(a.AnnotationConductorLayer,{key:"annotationConductorLayer",page:b,layerSize:v},r.default.createElement(a.AnnotationInstructionalTooltipPane,{layerSize:v},t&&r.default.createElement(l.WatermarkingLayer,{layerSize:v,pageDimensions:{width:f[0],height:f[1]}}),i&&r.default.createElement(d.MarkupLayer,{page:h,layerSize:v,pageDimensions:{width:f[0],height:f[1]}}),_,P))):(t?w.push(r.default.createElement(l.WatermarkingLayer,{layerSize:v,pageDimensions:{width:f[0],height:f[1]}})):i&&w.push(r.default.createElement(d.MarkupLayer,{page:h,layerSize:v,pageDimensions:{width:f[0],height:f[1]}})),w.push(_,P)),w}}}})),define("modules/clean/react/previews/pdf_viewer/transform",["require","exports","tslib","modules/clean/react/previews/pdf_viewer/font","file-viewer/preview_doc","modules/clean/referrer_cleansing_redirect","modules/core/exception"],(function(e,t,n,r,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),i=n.__importStar(i),t.transformPdfCoordinates=function(e,t,n){return n.map((function(e){return e.coordinates.map((function(e){return{x:e.x,y:t-e.y}}))}))},t.transformViewportCoordinates=function(e,t,n,r,o,a,i){return i.map((function(i){return{coordinates:i.map((function(e){return{x:(e.x-t)/a,y:o-(e.y-n)/a}})),page:e,page_size:{width:r,height:o}}}))},t.transformPdfgenText=function(e){return e&&e.pages?Object.keys(e.pages).reduce((function(t,s){return t[s]=(e.pages[s]||[]).map((function(e){var t=(function(e){try{var t=o.transformText(e);return n.__assign(n.__assign({},t),{str:t.str.map((function(e){if(e.type===o.TextNodeType.link)try{return n.__assign(n.__assign({},e),{href:a.get_redirect_uri(e.text).toString()})}catch(e){}return e}))})}catch(e){i.reportException({err:new Error("PDF Text transformation failed"),tags:["pdfPreviews"],severity:i.SEVERITY.NONCRITICAL})}return{dir:o.TextDir.ltr,str:[]}})(e.t);return{d:e.d,t:e.t,r:e.r,h:e.h,rawText:e.t,transformedText:t.str,dir:t.dir,font:r.renderFont(e.font)}})),t}),{}):{}}})),define("modules/clean/react/previews/pdf_viewer/utils",["require","exports"],(function(e,t){"use strict";var n,r;function o(e){if(n===e)return r;var t=[];return e.forEach((function(e){for(var n=e[0],r=e[1],o=e[2],a=0;a<o;a++)t.push([n,r])})),n=e,r=t,t}Object.defineProperty(t,"__esModule",{value:!0}),t.expandDimensions=o,t.mapPages=function(e,t){for(var n=o(e),r=[],a=0;a<n.length;a++){var i=n[a],s=i[0],l=i[1];r.push(t(a,s,l))}return r},t.prefetchImage=function(e){(new Image).src=e},t.scaleDimension=function(e,t){void 0===t&&(t={});var n=e[0],r=e[1],o=t.maxWidth,a=t.maxHeight;if(void 0!==o&&void 0!==a){var i=Math.min(o/n,a/r);return[i*n,i*r]}return void 0!==o?[o,o/n*r]:void 0!==a?[a/r*n,a]:e}})),define("modules/clean/react/previews/pdf_viewer/zoom",["require","exports","modules/clean/previews/util","modules/core/browser_detection"],(function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a,i=[1,2,4],s=Math.max.apply(Math,i);(function(e){e[e.NONE=0]="NONE",e[e.FIT_TO_WIDTH=1]="FIT_TO_WIDTH",e[e.FIT_PAGE=2]="FIT_PAGE"})(o=t.FittingMode||(t.FittingMode={})),(function(e){e[e.CONTINUOUS=0]="CONTINUOUS",e[e.SINGLE_PAGE=1]="SINGLE_PAGE"})(a=t.ScrollMode||(t.ScrollMode={})),t.fullscreenFittingMode=function(){return o.FIT_PAGE},t.defaultScrollMode=function(e){return n.isPptExtension(e)&&!r.is_mobile_or_tablet()?a.SINGLE_PAGE:a.CONTINUOUS},t.computeClientScaleFactor=function(e,t,n,r){var a=1;if(e===o.FIT_PAGE){for(var i=0,l=0,d=0,c=t;d<c.length;d++){var u=c[d],p=u[0],g=u[1];l=Math.max(p,l),i=Math.max(g,i)}a=Math.min(n/i,r/l)}else e===o.FIT_TO_WIDTH&&(a=r/t[0][0]);return Math.min(a,s)},t.calculatedFetchedScaleFactor=function(e,t){if(t){var n=t.originalHeight;if((function(e,t){return 2048/Math.max(e,t)})(t.originalWidth,n)>e)return 0}for(var r=0,o=i;r<o.length;r++){var a=o[r];if(a>=e)return a}return s}})),define("modules/clean/react/previews/powerpoint/frame_messenger_provider",["require","exports","tslib","react","modules/clean/react/previews/pdf_viewer/frame_messenger_shims","modules/clean/react/file_viewer/frame_interface","modules/clean/react/previews/pdf_viewer/event_emitter"],(function(e,t,n,r,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(t){var n=e.call(this,t)||this;n.onMessage=function(e){i.eventEmitter.emit(e.action,e.parameters)};var r=n.props,s=r.invalidate,l=r.messages;return n.channel=o.makeChannel(),n.host=new o.FrameMessengerHostShim(n.channel),n.client=new o.FrameMessengerClientShim(n.channel),n.client.configureParentMessaging(n.onMessage,l),n.client.startListening(),a.FileViewerFrameInterface.setFrameMessengerFactory((function(){return new o.FrameMessengerHostShim(n.channel)})),"function"==typeof s&&s(),n}return n.__extends(t,e),t.prototype.componentWillUnmount=function(){this.client.stopListening()},t.prototype.render=function(){return this.props.children(this.client,this.host)},t})((r=n.__importDefault(r)).default.Component);t.FrameMessengerProvider=s})),define("modules/clean/react/previews/powerpoint/with_frame_messenger",["require","exports","tslib","react","hoist-non-react-statics","modules/clean/react/helpers","modules/clean/react/previews/powerpoint/frame_messenger_provider"],(function(e,t,n,r,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),o=n.__importDefault(o),t.withFrameMessenger=function(e){return function(t){var s=(function(o){function s(){var e=null!==o&&o.apply(this,arguments)||this;return e.displayName="WithFrameMessenger("+a.getDisplayName(t),e}return n.__extends(s,o),s.prototype.render=function(){var o=this;return r.default.createElement(i.FrameMessengerProvider,{messages:e,invalidate:this.props.invalidateFrameMessenger},(function(e,a){return r.default.createElement(t,n.__assign({},o.props,{frameMessengerClient:e,frameMessengerHost:a}))}))},s})(r.default.PureComponent);return o.default(s,t)}}})),define("modules/clean/react/previews/preview_pdf",["require","exports","tslib","react","modules/core/i18n","external/lodash","external/lodash","react-redux","classnames","modules/clean/react/previews/constants","file-viewer/core","modules/clean/react/file_viewer/location_utils","modules/clean/react/file_viewer/constants","modules/clean/react/previews/pdf_viewer/event_emitter","modules/clean/react/size_class/constants","modules/clean/react/file_viewer/data/selectors","modules/clean/previews/data/selectors","modules/clean/previews/data/actions","modules/clean/react/previews/preview_toolbar","modules/clean/web_timing_logger","modules/clean/react/previews/pdf_viewer/transform","modules/clean/react/previews/loading_indicator","modules/clean/react/previews/pdf_viewer/utils","modules/clean/react/file_viewer/sidebar_helpers","modules/clean/react/file_viewer/full_screen_helpers","modules/clean/react/previews/pdf_viewer/zoom","spectrum/dimensions","modules/clean/react/comments2/data/actions","modules/clean/react/comments2/data/selectors","modules/clean/react/keyboard_binding/keyboard_binding_connector","modules/core/browser","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/previews/pdf_viewer/keyboard_bindings","modules/clean/react/previews/pdf_viewer/urls","modules/clean/react/previews/pdf_viewer/frame_messenger","modules/clean/react/previews/powerpoint/with_frame_messenger","file-viewer/preview_doc","file-viewer/core","modules/clean/react/previews/pdf_viewer/layers","modules/core/browser_detection","modules/clean/react/file_viewer/data/actions","modules/clean/react/file_viewer/data/actions","modules/clean/react/previews/preview_toolbar_button","file-viewer/toolbar","modules/clean/react/file_viewer/logging","file-viewer/assets-metaserver","modules/clean/react/previews/print_helpers","modules/clean/previews/actions","modules/clean/loggers/workflows_logger","modules/clean/react/watermarking/selectors","modules/clean/react/watermarking/utils","file-viewer/polyfills"],(function(e,t,n,r,o,a,i,s,l,d,c,u,p,g,m,f,h,v,w,b,_,P,y,S,M,E,T,F,C,D,I,k,A,U,x,O,L,W,N,B,K,R,z,V,j,G,Z,H,q,Q,Y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),a=n.__importStar(a),l=n.__importDefault(l),b=n.__importStar(b),I=n.__importStar(I),B=n.__importStar(B);var X=F.Actions.setPendingNumberedAnnotationMayBeOffscreen,J=W.resolveAsset.bind(null,G.assets),$=["pdf"];function ee(){}function te(e){var t=e.imageUrlTmpl,n=e.useCanned,r=e.docMetadata,o=void 0===r?{}:r,i=o.metadata,s=void 0===i?void 0:i,l=o.text,d=void 0===l?{}:l;if(!s||!d||!s.page_count)return[];var c=y.expandDimensions(s.dimensions),u=_.transformPdfgenText(d);return a.range(0,s.page_count).map((function(e){return{pageIndex:e,dimension:c[e],textboxes:u&&u[e]||[],links:d.links&&d.links[e]||[],thumbnailUrl:U.imageUrl(t,e,0,n),imgUrls:{"1x":U.imageUrl(t,e,0,n),"4x":U.imageUrl(t,e,400,n)}}}))}var ne=(function(e){function t(t){var r=e.call(this,t)||this;r.downloadSucceedLogged=!1,r.renderSucceededLogged=!1,r.renderer=null,r.submitPassword=function(e){r._refreshBlob(e)},r.dismissPassword=function(){r.props.onError&&r.props.onError(d.ErrorType.PasswordProtectedError)},r._refreshBlob=function(e){var t=r.props,n=t.refreshBlobAction,o=t.revisionId,a=r.props,i=a.imageUrlTmpl,s=a.textUrlTmpl,l=a.refreshUrl;"function"==typeof n&&n(o,l||"",{image_url_tmpl:i,text_url_tmpl:s,refresh_url:l},e)},r._onScrollToPage=function(e){r.props.updateCurrentPageIndex(e),r.props.setPendingNumberedAnnotationMayBeOffscreen();var t=50*Math.floor(e/50);r.fetchDataForPage(t),t+50-e<15&&r.fetchDataForPage(t+50)},r.onMetadataLoad=function(e){r.props.frameMessengerClient.postMessageToParent("doc-metadata-load",{metadata:e})},r.logRenderSuccess=function(){r.downloadSucceedLogged||(r.downloadSucceedLogged=!0,r.logFilePreviewEvent(p.EventType.FilePreviewDownloadSucceeded)),r.renderSucceededLogged||(r.renderSucceededLogged=!0,r.logFilePreviewEvent(p.EventType.FilePreviewRenderSucceeded),"function"==typeof r.props.setRenderStatusSuccess&&r.props.setRenderStatusSuccess(),r.props.frameMessengerClient.postMessageToParent(x.WT_EVENT_PAGE_RENDERED)),r.setState({pageRendered:!0})},r.logTTI=function(){b.mark_time_to_view(),b.mark_time_to_interactive(),r.props.filePreviewSession&&r.props.filePreviewSession.markPrimaryEvent()},r.logWatermarkEvent=function(e,t){void 0===t&&(t={});var o=r.props,a=o.isWatermarkingMode,i=o.user,s=o.watermarkState;a&&q.logWorkflowsEvent(e,Y.getWatermarkMilestone(i),n.__assign({watermark_type:s.mode},t))},r.sendIdleMouse=i.debounce((function(){r.props.frameMessengerClient.postMessageToParent("idle-mouse")}),1500),r.onMouseMove=i.throttle((function(){r.props.frameMessengerClient.postMessageToParent("active-mouse"),r.sendIdleMouse()}),16),r.onToolbarShow=function(){r.setState({isToolbarVisible:!0})},r.onToolbarHide=function(){r.setState({isToolbarVisible:!1})},r.onError=function(e){r.setState({error:e})},r.onImageError=function(){r.setState({error:o.intl.formatMessage({id:"xYwBE4",defaultMessage:"Some pages failed to load"})})},r.onReload=function(){I.reload(!0)},r.onPageNavigation=function(e){r.handlePageChange(e),r._jumpToPage(e)},r.handlePageChange=function(e){var t=r.state.currentPageIndex,n=r.props.docMetadata;!n||!n.metadata||e<0||e>=n.metadata.page_count||(r.setState({currentPageIndex:e}),r._onScrollToPage(e),g.eventEmitter.emit("page-set-to",e,t))},r.logSidebarPageClicked=function(){r.logWatermarkEvent(q.WorkflowsEvent.WatermarkPagePreviewClicked)},r._jumpToPage=function(e){r.renderer&&r.renderer.jumpToPage(e)},r.pageDown=function(){r.renderer&&(r.renderer.pageDown(),r.logWatermarkEvent(q.WorkflowsEvent.WatermarkArrowClicked,{arrow_clicked_direction:"down"}))},r.pageUp=function(){r.renderer&&(r.renderer.pageUp(),r.logWatermarkEvent(q.WorkflowsEvent.WatermarkArrowClicked,{arrow_clicked_direction:"up"}))},r.scrollDown=function(){r.renderer&&r.renderer.scrollDown()},r.scrollUp=function(){r.renderer&&r.renderer.scrollUp()},r.zoomIn=function(){var e=Math.min(1.1*r.state.scaleFactor,10);r.setState({scaleFactor:e,fittingMode:E.FittingMode.NONE})},r.zoomOut=function(){var e=Math.max(r.state.scaleFactor/1.1,.1);r.setState({scaleFactor:e,fittingMode:E.FittingMode.NONE})},r.jumpToPageWithLogging=function(e){j.wrapToolbarActionWithLogging(r._jumpToPage,p.UserAction.PageChange)(e),r.logWatermarkEvent(q.WorkflowsEvent.WatermarkPageNumberClicked)},r.handlePageUpWithToolbarLogging=j.wrapToolbarActionWithLogging(r.pageUp,p.UserAction.PageUp),r.handlePageDownWithToolbarLogging=j.wrapToolbarActionWithLogging(r.pageDown,p.UserAction.PageDown),r.handleZoomInWithToolbarLogging=j.wrapToolbarActionWithLogging(r.zoomIn,p.UserAction.ZoomIn),r.handleZoomOutWithToolbarLogging=j.wrapToolbarActionWithLogging(r.zoomOut,p.UserAction.ZoomOut),r.isPrintable=function(){return Z.canPrint(r.props.sharePermission)&&!!r.props.autoprintUrl},r.print=function(e){r.isPrintable()&&r.props.autoprintUrl&&(H.docPrint(r.props.autoprintUrl),j.logUserAction(p.UserAction.Print,e))},r.onPageUp=j.wrapKeyboardActionWithLogging(k.withPreventDefault(r.pageUp),p.UserAction.PageUp),r.onPageDown=j.wrapKeyboardActionWithLogging(k.withPreventDefault(r.pageDown),p.UserAction.PageDown),r.onScrollUp=j.wrapKeyboardActionWithLogging(k.withPreventDefault(r.scrollUp),p.UserAction.ScrollUp),r.onScrollDown=j.wrapKeyboardActionWithLogging(k.withPreventDefault(r.scrollDown),p.UserAction.ScrollDown),r.onZoomIn=j.wrapKeyboardActionWithLogging(k.withPreventDefault(r.zoomIn),p.UserAction.ZoomIn),r.onZoomOut=j.wrapKeyboardActionWithLogging(k.withPreventDefault(r.zoomOut),p.UserAction.ZoomOut),r.onPrintKeyPressed=k.withPreventDefault((function(){return r.print(p.UserActionContext.Keyboard)})),r.docFullScreenKeyboardBindings=A.getContinuousPageKeyboardBindings({isFullScreen:!0,keyUp:r.onScrollUp,keyDown:r.onScrollDown,pageUp:r.onPageUp,pageDown:r.onPageDown,zoomIn:r.onZoomIn,zoomOut:r.onZoomOut,print:r.onPrintKeyPressed}),r.docSidebarFocusedKeyboardBindings=A.getContinuousPageKeyboardBindings({isFullScreen:!1,keyUp:r.pageUp,keyDown:r.onPageDown,pageUp:r.onPageUp,pageDown:r.onPageDown,zoomIn:r.onZoomIn,zoomOut:r.onZoomOut,print:r.onPrintKeyPressed}),r.docKeyboardBindings=A.getContinuousPageKeyboardBindings({isFullScreen:!1,keyUp:r.onScrollUp,keyDown:r.onScrollDown,pageUp:r.onPageUp,pageDown:r.onPageDown,zoomIn:r.onZoomIn,zoomOut:r.onZoomOut,print:r.onPrintKeyPressed}),r.getDocKeyboardBindings=function(e){return e?r.docFullScreenKeyboardBindings:r.renderer&&r.renderer.state&&r.renderer.state.isSidebarFocused?r.docSidebarFocusedKeyboardBindings:r.docKeyboardBindings},r.handlePageScroll=function(){r.props.setPendingNumberedAnnotationMayBeOffscreen()},r.renderLayers=function(){return N.createGenerateLayersFn(r.props.annotationAllowed,r.props.isWatermarkingMode,r.props.isMarkupMode)},r.onDismissError=function(){r.setState({error:void 0})},r.handleOnSidebarOpen=function(){(0,r.props.onSidebarOpen)(p.DocType.pdf,p.UserActionContext.Toolbar),r.logWatermarkEvent(q.WorkflowsEvent.WatermarkToolbarClicked,{sidebar_state:"enabled"})},r.handleOnSidebarClose=function(){(0,r.props.onSidebarClose)(p.DocType.pdf,p.UserActionContext.Toolbar),r.logWatermarkEvent(q.WorkflowsEvent.WatermarkToolbarClicked,{sidebar_state:"disabled"})};var a=t.isFullscreen?E.fullscreenFittingMode():E.FittingMode.FIT_TO_WIDTH,s={passwordRetryAttempt:0,showPasswordPrompt:!1,fittingMode:a,currentPageIndex:0,isSidebarFocused:!1,scaleFactor:1,pages:[],isToolbarVisible:!1,persistToolbar:!1};return r.logFilePreviewEvent(p.EventType.FilePreviewSupportConfirmed),r.logFilePreviewEvent(p.EventType.FilePreviewDownloadAttempted),t.docMetadata&&t.docMetadata.metadata&&Array.isArray(t.docMetadata.metadata.dimensions)&&t.docMetadata.metadata.dimensions.length&&(s.scaleFactor=t.height&&t.width?E.computeClientScaleFactor(a,t.docMetadata.metadata.dimensions,t.height,t.width-24-16):1,s.pages=te(t)),r.state=s,r}return n.__extends(t,e),Object.defineProperty(t.prototype,"startPage",{get:function(){if(this.props.location){var e=u.getPageQuery(this.props.location);if(e)return e-1}return 0},enumerable:!0,configurable:!0}),t.prototype.adjustWidth=function(e){return e-24-16-(this.isSidebarOpen()?L.SIDEBAR_WIDTH:0)},t.prototype.componentDidMount=function(){var e=this;"function"==typeof this.props.fetchDocMetadata&&this.props.fetchDocMetadata(this.props.revisionId,this.props.textUrlTmpl),this.refreshIntervalId=window.setInterval((function(){e._refreshBlob()}),108e5),g.eventEmitter.on("error",this.onError);var t=this.props.docMetadata,n=(void 0===t?{}:t).metadata,r=void 0===n?void 0:n;r&&this.startPage&&this.startPage>=0&&this.startPage<r.page_count&&this._jumpToPage(this.startPage)},t.prototype.componentWillUnmount=function(){g.eventEmitter.off("error",this.onError),window.clearInterval(this.refreshIntervalId),u.updatePageQuery(null),this.props.updateCurrentPageIndex(0)},t.prototype.componentDidUpdate=function(e){var t=e.documentRectangleToMakeVisible,n=e.docMetadata,r=(void 0===n?{}:n).metadata,o=void 0===r?void 0:r,a=this.props,i=a.documentRectangleToMakeVisible,s=a.docMetadata,l=(void 0===s?{}:s).metadata,d=void 0===l?void 0:l,c=a.height,u=a.width,p=a.sizeClass;if(i&&t!==i){var g=i.page;if(g!==this.state.currentPageIndex)return void this._jumpToPage(g)}if(p===m.SizeClass.Small&&!o&&d&&d.dimensions&&0!==d.dimensions.length&&c&&u){var f=E.computeClientScaleFactor(this.state.fittingMode,d.dimensions,c,this.adjustWidth(u));f!==this.state.scaleFactor&&this.setState({scaleFactor:f})}if(!o&&d&&this.startPage&&this.startPage>=0&&this.startPage<d.page_count&&this._jumpToPage(this.startPage),e.isFullscreen!==this.props.isFullscreen){var h=e.isFullscreen?E.FittingMode.FIT_TO_WIDTH:E.FittingMode.FIT_PAGE;this.setState({fittingMode:h})}var v=this.isSidebarOpen(),w=this.isSidebarOpen(e);this.state.fittingMode!==E.FittingMode.NONE&&(e.height!==this.props.height||e.width!==this.props.width||v!==w)&&d&&Array.isArray(d.dimensions)&&d.dimensions.length&&this.setState({scaleFactor:E.computeClientScaleFactor(this.state.fittingMode,d.dimensions,c,this.adjustWidth(u))}),this.props.isEditMode&&!e.isEditMode&&d&&this.setState({fittingMode:E.FittingMode.FIT_PAGE,scaleFactor:E.computeClientScaleFactor(E.FittingMode.FIT_PAGE,d.dimensions,c,this.adjustWidth(u))}),!this.props.isEditMode&&e.isEditMode&&d&&this.setState({fittingMode:E.FittingMode.FIT_TO_WIDTH,scaleFactor:E.computeClientScaleFactor(E.FittingMode.FIT_TO_WIDTH,d.dimensions,c,this.adjustWidth(u))})},t.prototype.componentWillReceiveProps=function(e){var t=e.docMetadata,n=e.revisionId,r=e.fileExtension,o=e.isVirtualPreview,a=e.onLoad,i=e.textUrlTmpl,s=e.fetchDocMetadata,l=this.props,d=l.isVirtualPreview,u=l.revisionId,g=l.docMetadata,m=l.textUrlTmpl,f=this.state.fittingMode;if(this.props.isFullscreen!==e.isFullscreen&&(f=e.isFullscreen?E.fullscreenFittingMode():E.FittingMode.FIT_TO_WIDTH,this.setState({fittingMode:f})),n!==u||i!==m||o!==d)this.logFilePreviewEvent(p.EventType.FilePreviewSupportConfirmed),this.logFilePreviewEvent(p.EventType.FilePreviewDownloadAttempted),this.setState({pageRendered:!1,passwordRetryAttempt:0,showPasswordPrompt:!1}),this.downloadSucceedLogged=!1,this.renderSucceededLogged=!1,"function"==typeof s&&s(n,i);else if(t&&t!==g){var h=t.error,v=t.metadata;!h||g&&h===g.error?v?(g&&v===g.metadata||(v.page_count?g&&g.metadata||this.handleMetadataLoad(t,a):this.handleError(c.RivieraStatus.Unknown)),this.setState({pages:te(e)})):this.handleError(c.RivieraStatus.Unknown,r):this.handleError(h.statusCode,r)}},t.prototype.logFilePreviewEvent=function(e,t){void 0===t&&(t={}),this.props.filePreviewSession&&this.props.filePreviewSession.recordEvent(e,t)},t.prototype.handleError=function(e,t){var n=this.props.onError;e===c.RivieraStatus.PasswordProtected?t&&$.includes(t)?this.setState({showPasswordPrompt:!0,passwordRetryAttempt:this.state.passwordRetryAttempt+1}):"function"==typeof n&&n(d.ErrorType.PasswordProtectedError,e):(this.logFilePreviewEvent(p.EventType.FilePreviewDownloadFailed,{rivieraStatusCode:e?e.toString():""}),"function"==typeof n&&n(d.ErrorType.LoadError,e))},t.prototype.handleMetadataLoad=function(e,t){e&&(this.onMetadataLoad(e.metadata),"function"==typeof t&&t(),this.setState({showPasswordPrompt:!1}))},t.prototype.fetchDataForPage=function(e){if(e%50!=0)throw new Error("invalid page lower bound "+e);var t=this.props,n=t.revisionId,r=t.textUrlTmpl,o=t.docMetadata,a=t.fetchDataForPageAction;if("function"==typeof a){if(o){var i=o.metadata,s=o.text;if(i&&i.page_count<=e)return;if(s&&s.pages&&s.pages[e])return}a(n,r,e,e+50)}},t.prototype.isSidebarOpen=function(e){void 0===e&&(e=this.props);var t=e.isSidebarOpen,n=e.sizeClass,r=e.isFullscreen;return!(!S.isSidebarEnabled(p.DocType.pdf,n,!!r)||!(t||{})[p.DocType.pdf])},t.prototype.renderCloseFullscreenButton=function(){return this.props.isFullscreen?r.default.createElement("div",{className:"close-x"},r.default.createElement("button",{onClick:function(){return M.exitFullScreen(p.UserActionContext.Browser)},className:"close-x-button","aria-label":o.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"})},"✕")):null},t.prototype.render=function(){var e=this,t=this.props,n=t.currentMode,a=t.docMetadata,i=t.height,s=t.isArchiveFile,d=t.isEditMode,u=t.isFullscreen,g=t.isSidebarOpen,f=t.isVirtualPreview,h=t.previewMetadata,v=t.revisionId,b=t.sharePermission,_=t.sizeClass,y=t.width,E=this.state,T=E.scaleFactor,F=E.pages,C=E.currentPageIndex,I=E.pageRendered,k=E.passwordRetryAttempt,A=E.showPasswordPrompt,U=E.isToolbarVisible,x=E.error,O=a&&a.metadata&&a.metadata.page_count||0,W=this.renderCloseFullscreenButton(),N={"viewer-container":!0,"sidebar-visible":this.isSidebarOpen()},K=I?null:r.default.createElement(P.LoadingIndicator,{className:"loading-indicator"});return r.default.createElement("div",{className:"preview-content preview-pdf preview-pdf-ssr",onMouseMove:this.onMouseMove,onTouchStart:this.onMouseMove,onTouchMove:this.onMouseMove},A?r.default.createElement(L.PasswordModal,{className:"file-viewer-modal-overlay",intl:o.intl,onSubmit:this.submitPassword,onDismiss:this.dismissPassword,enteredWrongPassword:k>1,onComponentDidMount:this.logTTI}):null,r.default.createElement("div",{className:l.default(N)},K,!d&&r.default.createElement(D.KeyboardBindingConnector,{keyboardBindings:this.getDocKeyboardBindings(!!this.props.isFullscreen)}),W,r.default.createElement(L.PreviewPDF,{fileMetadata:{file_id:v+(f?"-virtual":""),file_name:""},fileInfo:{file_id:v+(f?"-virtual":""),ns_id:0,sj_id:0,bootstrap:{state:"ready"}},filePreviewUiData:{currentPageIndex:C,zoomScaleFactor:T,fitScaleFactor:0,isSidebarOpen:!1,isFullScreen:!1,isFidelitySurveyVisible:!1},coreFileViewerUiData:{isDocSidebarOpen:this.isSidebarOpen()},fileViewerId:"",previewMetadata:h,className:l.default("pdf-viewer",{fullscreen:this.props.isFullscreen}),intl:o.intl,height:i,isEditMode:d,currentMode:n,logSidebarPageClicked:this.logSidebarPageClicked,onPageChange:this.handlePageChange,onPageNavigation:this.onPageNavigation,onInteractive:this.logTTI,onPageImageError:this.onImageError,onRenderFailed:ee,onRenderSucceeded:this.logRenderSuccess,onScroll:this.handlePageScroll,pageClassName:"page",data:F,config:c.DEFAULT_CONFIG,pagesClassName:l.default("viewer-container__sizer","page-container","pdf-viewer__pages",{"ios-enable-inertial-scroll":B.iOS}),ref:function(t){return e.renderer=t},width:y,dispatch:ee,layerRenderFn:this.renderLayers(),resolveAsset:J}),x?r.default.createElement(L.ErrorSnackbar,{intl:o.intl,className:U?"pdf-snackbar__toolbar-visible":"",error:x,onSubmit:this.onReload,onCancel:this.onDismissError}):null),a&&a.metadata&&a.metadata.page_count>0?r.default.createElement(w.PreviewToolbar,{isFullscreen:!!u,onToolbarShow:this.onToolbarShow,onToolbarHide:this.onToolbarHide,stayVisible:this.state.persistToolbar},S.isSidebarEnabled(p.DocType.pdf,_,!!u)?r.default.createElement(V.SidebarToggleButton,{className:"toolbar-button-entry",intl:o.intl,isSidebarOpen:g&&!!g[p.DocType.pdf],onSidebarOpen:this.handleOnSidebarOpen,onSidebarClose:this.handleOnSidebarClose}):null,_!==m.SizeClass.Small?r.default.createElement(V.PageUpButton,{className:"toolbar-button-entry",disabled:C<=0,intl:o.intl,onClick:this.handlePageUpWithToolbarLogging}):null,r.default.createElement(V.PageIndicator,{className:"toolbar-button-entry",currentPageIndex:C||0,intl:o.intl,id:"preview-toolbar-page-indicator",onBlur:function(){return e.setState({persistToolbar:!1})},onFocus:function(){return e.setState({persistToolbar:!0})},onPageNumberUpdated:this.jumpToPageWithLogging,pageCount:O||1,shouldShowPageCount:_!==m.SizeClass.Small}),_!==m.SizeClass.Small?r.default.createElement(V.PageDownButton,{className:"toolbar-button-entry",disabled:C>=O-1,intl:o.intl,onClick:this.handlePageDownWithToolbarLogging}):null,_===m.SizeClass.Small||d?null:[r.default.createElement(V.ZoomOutButton,{className:"toolbar-button-entry",disabled:T<=.1,intl:o.intl,key:"zoom-out",onClick:this.handleZoomOutWithToolbarLogging}),r.default.createElement(V.ZoomInButton,{className:"toolbar-button-entry",disabled:T>=10,intl:o.intl,key:"zoom-in",onClick:this.handleZoomInWithToolbarLogging}),r.default.createElement(V.FullScreenButton,{className:"toolbar-button-entry",intl:o.intl,key:"fullscreen",onClick:function(){return M.toggleFullScreen(!!u,p.UserActionContext.Toolbar)}}),s?null:r.default.createElement(z.PreviewToolbarButton,{className:"print","data-test":"print",disabled:!this.isPrintable(),key:"print",spriteGroup:"web",spriteName:"print",tooltip:Z.getPrintTooltip(b),onClick:function(){return e.print(p.UserActionContext.Toolbar)}})]):null)},t})(r.default.PureComponent);t._PreviewPDF=ne;var re={refreshBlobAction:v.refreshBlobAction,fetchDocMetadata:v.fetchDocMetadata,fetchDataForPageAction:v.fetchDataForPage,updateCurrentPageIndex:K.updateCurrentPageIndex,setPendingNumberedAnnotationMayBeOffscreen:X,onSidebarOpen:R.openSidebar,onSidebarClose:R.closeSidebar},oe=i.flow([O.withFrameMessenger(x.FRAME_MESSAGES_FROM_PARENT),s.connect((function(e,t){return{docMetadata:h.getDocMetadataByRevisionId(e,t.revisionId),isSidebarOpen:f.getIsSidebarOpen(e),documentRectangleToMakeVisible:C.getDocumentRectangleToMakeVisibleIfComments2Ready(e),previewMetadata:h.getApiDataForRevisionId(e,t.revisionId),isVirtualPreview:h.getIsVirtualRevisionId(e,t.revisionId),annotationAllowed:f.getAnnotationAllowed(e),isWatermarkingMode:f.getIsWatermarkingMode(e),isMarkupMode:f.getIsMarkupMode(e),isEditMode:f.getIsEditMode(e),watermarkState:Q.getWatermarkState(e)}}),re)])(ne);t.PreviewPDF=function(e){return r.default.createElement(T.Dimensions,{className:"flex-preview-container"},(function(t){var o=t.width,a=t.height;return r.default.createElement(oe,n.__assign({},e,{width:o,height:a}))}))}})),define("modules/clean/react/previews/preview_ppt",["require","exports","tslib","react","classnames","modules/core/i18n","external/lodash","react-redux","file-viewer/core","modules/clean/react/file_viewer/constants","modules/clean/react/size_class/constants","modules/clean/react/keyboard_binding/keyboard_binding_connector","modules/clean/react/previews/loading_indicator","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/file_viewer/data/selectors","modules/clean/react/previews/preview_toolbar","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/pdf_viewer/utils","modules/clean/react/previews/pdf_viewer/transform","modules/clean/react/previews/pdf_viewer/urls","modules/clean/react/previews/pdf_viewer/keyboard_bindings","file-viewer/preview_doc","modules/clean/react/previews/powerpoint/close_button","modules/clean/react/previews/pdf_viewer/event_emitter","modules/clean/react/file_viewer/full_screen_helpers","modules/clean/react/previews/powerpoint/with_frame_messenger","modules/clean/web_timing_logger","modules/clean/react/previews/powerpoint/with_document_metadata","modules/core/browser","modules/clean/react/previews/pdf_viewer/frame_messenger","modules/clean/react/comments2/data/actions","modules/clean/react/comments2/data/selectors","modules/clean/react/previews/pdf_viewer/layers","file-viewer/core","spectrum/dimensions","modules/clean/react/file_viewer/data/actions","modules/clean/previews/data/selectors","modules/clean/react/file_viewer/sidebar_helpers","modules/clean/react/file_viewer/data/actions","modules/clean/react/previews/preview_toolbar_button","file-viewer/toolbar","modules/clean/react/file_viewer/logging","file-viewer/assets-metaserver","modules/clean/react/previews/print_helpers","modules/clean/previews/actions","file-viewer/polyfills"],(function(e,t,n,r,o,a,i,s,l,d,c,u,p,g,m,f,h,v,w,b,_,P,y,S,M,E,T,F,C,D,I,k,A,U,x,O,L,W,N,B,K,R,z,V,j){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),o=n.__importDefault(o),T=n.__importStar(T),C=n.__importStar(C);var G=I.Actions.setPendingNumberedAnnotationMayBeOffscreen,Z=l.resolveAsset.bind(null,z.assets);function H(){}var q=(function(e){function t(t){var n=e.call(this,t)||this;return n.downloadSucceedLogged=!1,n.renderSucceededLogged=!1,n.state={isSidebarFocused:!1,clientScaleFactor:0,showSidebar:!0,persistToolbar:!1},n.sendIdleMouse=i.debounce((function(){n.props.frameMessengerClient.postMessageToParent("idle-mouse")}),1500),n.onMouseMove=i.throttle((function(){n.props.frameMessengerClient.postMessageToParent("active-mouse"),n.sendIdleMouse()}),16),n.reload=function(){C.reload(!0)},n.dismissError=function(){n.setState({error:void 0})},n.setPage=function(e,t,r){var o=(void 0===r?n.props:r).docMetadata;o&&o.metadata&&(e<0||e>=o.metadata.page_count||(n.onPageChange(e),n.props.updateCurrentPageIndex(e)))},n.logRenderSuccess=function(){n.downloadSucceedLogged||(n.downloadSucceedLogged=!0,n.logFilePreviewEvent(d.EventType.FilePreviewDownloadSucceeded)),n.setState({pageRendered:!0}),n.renderSucceededLogged||(n.renderSucceededLogged=!0,n.logFilePreviewEvent(d.EventType.FilePreviewRenderSucceeded),"function"==typeof n.props.setRenderStatusSuccess&&n.props.setRenderStatusSuccess(),n.props.frameMessengerClient.postMessageToParent(D.WT_EVENT_PAGE_RENDERED))},n.onPageChange=function(e){var t=n.props,r=t.onPageChange,o=t.setPendingNumberedAnnotationMayBeOffscreen;r&&r(e),o()},n.logTTI=function(){T.mark_time_to_view(),T.mark_time_to_interactive();var e=n.props.filePreviewSession;e&&e.markPrimaryEvent()},n.pageDown=function(){var e=n.props;e.currentPageIndex<e.docMetadata.metadata.page_count-1&&n.props.pageDown()},n.pageUp=function(){n.props.currentPageIndex>0&&n.props.pageUp()},n.updateCurrentPageIndexWithToolbarLogging=R.wrapToolbarActionWithLogging((function(e){n.props.updateCurrentPageIndex(e)}),d.UserAction.PageChange),n.handlePageUpWithToolbarLogging=R.wrapToolbarActionWithLogging(n.pageUp,d.UserAction.PageUp),n.handlePageDownWithToolbarLogging=R.wrapToolbarActionWithLogging(n.pageDown,d.UserAction.PageDown),n.onError=function(e){n.setState({error:e})},n.onToolbarShow=function(){n.setState({isToolbarVisible:!0})},n.onToolbarHide=function(){n.setState({isToolbarVisible:!1})},n.setupToolbar=function(){S.eventEmitter.on("error",n.onError)},n.teardownToolbar=function(){S.eventEmitter.off("error",n.onError)},n.zoomIn=function(){if(!n.props.isFullscreen){var e=Math.min(1.1*n.state.clientScaleFactor,10);n.setState({clientScaleFactor:e})}},n.zoomOut=function(){if(!n.props.isFullscreen){var e=Math.max(n.state.clientScaleFactor/1.1,.1);n.setState({clientScaleFactor:e})}},n.handleZoomInWithToolbarLogging=R.wrapToolbarActionWithLogging(n.zoomIn,d.UserAction.ZoomIn),n.handleZoomOutWithToolbarLogging=R.wrapToolbarActionWithLogging(n.zoomOut,d.UserAction.ZoomOut),n.isPrintable=function(){return V.canPrint(n.props.sharePermission)&&!!n.props.autoprintUrl},n.print=function(e){n.isPrintable()&&n.props.autoprintUrl&&(j.docPrint(n.props.autoprintUrl),R.logUserAction(d.UserAction.Print,e))},n.onPageUp=R.wrapKeyboardActionWithLogging(g.withPreventDefault(n.pageUp),d.UserAction.PageUp),n.onPageDown=R.wrapKeyboardActionWithLogging(g.withPreventDefault(n.pageDown),d.UserAction.PageDown),n.onZoomIn=R.wrapKeyboardActionWithLogging(g.withPreventDefault(n.zoomIn),d.UserAction.ZoomIn),n.onZoomOut=R.wrapKeyboardActionWithLogging(g.withPreventDefault(n.zoomOut),d.UserAction.ZoomOut),n.onPrintKeyPressed=g.withPreventDefault((function(){return n.print(d.UserActionContext.Keyboard)})),n.getPages=function(){var e=n.props,t=e.docMetadata,r=void 0===t?{}:t,o=r.metadata,a=void 0===o?void 0:o,s=r.text,l=void 0===s?{}:s,d=e.imageUrlTmpl,c=e.useCanned;if(!a||!l||!a.page_count)return[];var u=v.expandDimensions(a.dimensions),p=w.transformPdfgenText(l);return i.range(0,a.page_count).map((function(e){return{pageIndex:e,dimension:u[e]||[0,0],textboxes:p[e]||[],links:l.links&&l.links[e]||[],thumbnailUrl:b.imageUrl(d,e,0,c),imgUrls:{"1x":b.imageUrl(d,e,0,c),"4x":b.imageUrl(d,e,400,c)}}}))},n.renderLayers=function(){return A.createGenerateLayersFn(n.props.annotationAllowed,!1,!1)},n.logFilePreviewEvent(d.EventType.FilePreviewSupportConfirmed),t.docMetadata&&t.docMetadata.metadata&&n.logFilePreviewEvent(d.EventType.FilePreviewDownloadAttempted),n}return n.__extends(t,e),t.prototype.logFilePreviewEvent=function(e,t){void 0===t&&(t={});var n=this.props.filePreviewSession;n&&n.recordEvent(e,t)},t.prototype.componentDidMount=function(){this.logFilePreviewEvent(d.EventType.FilePreviewDownloadAttempted),this.setupToolbar();var e=this.props,t=e.docMetadata,n=e.startPage;t&&t.metadata&&n&&n>=0&&n<t.metadata.page_count&&this.setPage(n,l.UserActionContext.DocReset)},t.prototype.componentWillReceiveProps=function(e){var t=e.sizeClass,n=e.isFullscreen,r=e.isSidebarOpen,o=e.activatedAnnotationRectangle,a=e.docMetadata,i=W.isSidebarEnabled(d.DocType.ppt,t,!!n)&&!!(r||{})[d.DocType.ppt];if(this.setState({showSidebar:i}),o&&this.props.activatedAnnotationRectangle!==o&&this.setPage(o.page,l.UserActionContext.DocReset,e),a&&!a.error&&a.metadata){var s=a.metadata.dimensions;if(e.height!==this.props.height||e.width!==this.props.width||a!==this.props.docMetadata){var c=U.calculateFitBox(e.width-(r?P.SIDEBAR_WIDTH:0)-32,e.height,s[0][0]/s[0][1])[0];this.setState({clientScaleFactor:c/s[0][0]})}}},t.prototype.componentDidUpdate=function(e){e.currentPageIndex!==this.props.currentPageIndex&&this.onPageChange(this.props.currentPageIndex)},t.prototype.componentWillUnmount=function(){this.teardownToolbar(),h.updatePageQuery(null),this.props.updateCurrentPageIndex(0)},t.prototype.render=function(){var e=this,t=this.props,n=t.docMetadata,i=t.isArchiveFile,s=t.isFullscreen,g=t.isSidebarOpen,m=t.sharePermission,h=t.sizeClass,v=t.revisionId,w=t.width,b=t.height,S=t.currentMode,E=t.currentPageIndex,T=t.onSidebarClose,F=t.onSidebarOpen,C=t.previewMetadata,D=this.state,I=D.clientScaleFactor,k=D.showSidebar,A=D.error,U=D.isToolbarVisible,x=D.pageRendered;if(!n||!n.metadata)return null;var O=n.metadata,L=O&&O.page_count>0,N=_.getSinglePageKeyboardBindings({pageUp:this.onPageUp,pageDown:this.onPageDown,zoomIn:this.onZoomIn,zoomOut:this.onZoomOut,print:this.onPrintKeyPressed}),R=this.getPages(),z=null!=g&&!!g[d.DocType.ppt];return r.default.createElement("div",{className:"preview-content preview-pdf preview-pdf-ssr",onMouseMove:this.onMouseMove,onTouchStart:this.onMouseMove,onTouchMove:this.onMouseMove},r.default.createElement("div",{className:o.default({"viewer-container":!0,"sidebar-visible":k})},x?null:r.default.createElement(p.LoadingIndicator,{className:"loading-indicator"}),s?r.default.createElement(y.CloseButton,{onClick:function(){return M.exitFullScreen(d.UserActionContext.Browser)}}):null,r.default.createElement(u.KeyboardBindingConnector,{keyboardBindings:N}),r.default.createElement(P.PreviewPPT,{fileMetadata:{file_id:v,file_name:""},fileInfo:{file_id:v,ns_id:0,sj_id:0,bootstrap:{state:"ready"}},filePreviewUiData:{zoomScaleFactor:I,currentPageIndex:E,fitScaleFactor:0,isSidebarOpen:!1,isFullScreen:!1,isFidelitySurveyVisible:!1},coreFileViewerUiData:{isDocSidebarOpen:z},currentMode:S,previewMetadata:C,fileViewerId:"",className:"pdf-viewer",pageClassName:"page",data:R,intl:a.intl,onInteractive:this.logTTI,onRenderFailed:H,onRenderSucceeded:this.logRenderSuccess,onPageChange:this.setPage,width:w,height:b,dispatch:H,layerRenderFn:this.renderLayers(),config:l.DEFAULT_CONFIG,resolveAsset:Z}),L?r.default.createElement(f.PreviewToolbar,{isFullscreen:s,onToolbarShow:this.onToolbarShow,onToolbarHide:this.onToolbarHide,stayVisible:this.state.persistToolbar},W.isSidebarEnabled(d.DocType.ppt,h,!!s)?r.default.createElement(K.SidebarToggleButton,{className:"toolbar-button-entry",intl:a.intl,isSidebarOpen:z,onSidebarOpen:function(){return F(d.DocType.ppt,d.UserActionContext.Toolbar)},onSidebarClose:function(){return T(d.DocType.ppt,d.UserActionContext.Toolbar)}}):null,h!==c.SizeClass.Small?r.default.createElement(B.PreviewToolbarButton,{className:"ppt-up",disabled:E<=0,spriteGroup:"web",spriteName:"up",tooltip:a.intl.formatMessage({id:"jlNRKl",defaultMessage:"Previous slide"}),onClick:this.handlePageUpWithToolbarLogging}):null,r.default.createElement(K.PageIndicator,{className:"toolbar-button-entry",currentPageIndex:E||0,intl:a.intl,id:"preview-toolbar-page-indicator",onBlur:function(){return e.setState({persistToolbar:!1})},onFocus:function(){return e.setState({persistToolbar:!0})},onPageNumberUpdated:this.updateCurrentPageIndexWithToolbarLogging,pageCount:R.length||1,shouldShowPageCount:h!==c.SizeClass.Small}),h!==c.SizeClass.Small?[r.default.createElement(B.PreviewToolbarButton,{className:"ppt-down",disabled:E>=R.length-1,spriteGroup:"web",spriteName:"down",tooltip:a.intl.formatMessage({id:"pM+XGv",defaultMessage:"Next slide"}),onClick:this.handlePageDownWithToolbarLogging}),r.default.createElement(K.ZoomOutButton,{className:"toolbar-button-entry",disabled:I<=.1,intl:a.intl,onClick:this.handleZoomOutWithToolbarLogging}),r.default.createElement(K.ZoomInButton,{className:"toolbar-button-entry",disabled:I>=10,intl:a.intl,onClick:this.handleZoomInWithToolbarLogging}),r.default.createElement(K.FullScreenButton,{className:"toolbar-button-entry",intl:a.intl,onClick:function(){return M.toggleFullScreen(!!s,d.UserActionContext.Toolbar)}}),i?null:r.default.createElement(B.PreviewToolbarButton,{className:"print","data-test":"print",disabled:!this.isPrintable(),spriteGroup:"web",spriteName:"print",tooltip:V.getPrintTooltip(m),onClick:function(){return e.print(d.UserActionContext.Toolbar)}})]:null):null,A?r.default.createElement(P.ErrorSnackbar,{intl:a.intl,className:U?"pdf-snackbar__toolbar-visible":"",error:A,onSubmit:this.reload,onCancel:this.dismissError}):null))},t})(r.default.PureComponent);t._PreviewPPT=q;var Q={pageDown:O.pageDown,pageUp:O.pageUp,updateCurrentPageIndex:O.updateCurrentPageIndex,setPendingNumberedAnnotationMayBeOffscreen:G,onSidebarOpen:N.openSidebar,onSidebarClose:N.closeSidebar},Y=i.flow([F.withDocumentMetadata,E.withFrameMessenger(D.FRAME_MESSAGES_FROM_PARENT),s.connect((function(e,t){return{activatedAnnotationRectangle:k.getDocumentRectangleToMakeVisibleIfComments2Ready(e),currentPageIndex:m.getCurrentPageIndex(e)||0,isSidebarOpen:m.getIsSidebarOpen(e),previewMetadata:L.getApiDataForRevisionId(e,t.revisionId),annotationAllowed:m.getAnnotationAllowed(e)}}),Q)])(q);t.PreviewPPT=function(e){return r.default.createElement(x.Dimensions,{className:"flex-preview-container"},(function(t){var o=t.width,a=t.height;return r.default.createElement(Y,n.__assign({},e,{width:o,height:a}))}))}}));
//# sourceMappingURL=pkg-file_viewer_pdf.min.js-vflfOXxRI.map