define("modules/clean/edison/active_user_id",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveUserId=function(){var e=window;if(e.RUNNING_IN_EDISON)return e.EDISON_ACTIVE_USER_ID;if(e.ensemble){var t=e.ensemble.viewer.getActiveUser();if(t)return t.userId}}})),define("modules/clean/loggers/notification_tray_logger",["require","exports","tslib","modules/clean/ajax"],(function(e,t,n,i){"use strict";function o(e){i.SilentBackgroundRequest({url:"/log/notif_tray_events",data:{event_dict:JSON.stringify(e)}})}Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),t.logTrayOpen=function(e){o({event_name:"tray_popup_shown",badge_count:e})},t.logMarkAllAsRead=function(){o({event_name:"mark_all_as_read"})}})),define("modules/clean/photos/batch_thumb_loader",["require","exports","tslib","modules/clean/ajax","modules/clean/react/no-jquery","modules/constants/env","modules/core/uri"],(function(e,t,n,i,o,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),a=n.__importStar(a);var s=(function(){function e(e){var t=e.batch_size,n=e.max_parallel_requests,i=e.on_batch,o=e.batch_logger,a=e.on_batch_success;this.on_batch=i,this.batch_logger=o,this.on_batch_success=a,this.batch_size=t||16,this.max_parallel_requests=n||6,this.thumb_url_queue=[],this.batch_queue=[],this.callback_by_id={},this.request_ids_by_url={},this.num_requests_in_flight=0,this.flushing=!1,this.last_thumb_request_id=0,this.next_batch_id=0,this.cancelled_urls={},this.outstanding_batches={},this._request_callback_by_request_id={}}return e.prototype.vend_request_id=function(){return this.last_thumb_request_id++,this.last_thumb_request_id.toString()},e.prototype.queue_thumb=function(e,t,n){void 0===n&&(n={});var i=n.request_id,r=n.onrequest;if(o.corsSupport()&&a.BATCH_THUMB_ENDPOINTS.length){if(i||(i=this.vend_request_id()),this.request_ids_by_url[e]&&this.request_ids_by_url[e].length){var s=!1;for(var c in this.outstanding_batches)if(this.outstanding_batches[c]&&this.outstanding_batches[c].urls)for(var u=0,l=this.outstanding_batches[c].urls;u<l.length;u++){l[u]===e&&(s=!0)}s&&"function"==typeof r&&r()}else this.thumb_url_queue.push(e),this.request_ids_by_url[e]=[];return this.request_ids_by_url[e].push(i),t&&(this.callback_by_id[i]={url:e,callback:t}),this._request_callback_by_request_id[i]=r,this.thumb_url_queue.length>=this.batch_size&&(this.batch_queue.push(this.thumb_url_queue.splice(0,this.batch_size)),this._send_batch_requests()),i}"function"==typeof r&&r();return t&&"function"==typeof t&&t(e,!0),null},e.prototype.cancel_thumb=function(e){if(this.callback_by_id[e]){var t=this.callback_by_id[e].url;delete this.callback_by_id[e],delete this._request_callback_by_request_id[e];for(var n=0;n<this.request_ids_by_url[t].length;n++){if(this.request_ids_by_url[t][n]===e){this.request_ids_by_url[t].splice(n,1);break}}if(0===this.request_ids_by_url[t].length){delete this.request_ids_by_url[t];for(n=0;n<this.thumb_url_queue.length;n++)if(this.thumb_url_queue[n]===t)return void this.thumb_url_queue.splice(n,1);for(n=0;n<this.batch_queue.length;n++)for(var i=this.batch_queue[n],o=0;o<i.length;o++)if(i[o]===t)return i.splice(o,1),void(0===i.length&&this.batch_queue.splice(n,1));for(var a in this.cancelled_urls[t]=1,this.outstanding_batches)if(this.outstanding_batches[a]&&this.outstanding_batches[a].urls){for(var r=this.outstanding_batches[a],s=r.urls,c=r.request,u=!0,l=0,d=s;l<d.length;l++){var f=d[l];u=null!=this.cancelled_urls[f]&&u}if(u){c.abort();break}}}}},e.prototype.flush=function(){for(;this.thumb_url_queue.length;)this.batch_queue.push(this.thumb_url_queue.splice(0,this.batch_size));this._send_batch_requests()},e.prototype.reset=function(e){var t=e.batch_size,n=e.batch_logger;this.batch_logger=n,this.batch_size=t||16},e.prototype.clear=function(){this.thumb_url_queue=[]},e.prototype.pause=function(){this.flushing=!1},e.prototype._send_batch_requests=function(){if(!(0===this.batch_queue.length||this.num_requests_in_flight>=this.max_parallel_requests)&&this.batch_queue.length>0){this.flushing=!0;var e=this.batch_queue.shift(),t=this._generate_request_params(e),n=t.endpoint,o=t.method,a=t.data;this.on_batch&&"function"==typeof this.on_batch&&this.on_batch(e);for(var r=0,s=e;r<s.length;r++)for(var c=s[r],u=0,l=this.request_ids_by_url[c];u<l.length;u++){var d=l[u],f=this._request_callback_by_request_id[d];f&&"function"==typeof f&&f(),delete this._request_callback_by_request_id[d]}var p=this.next_batch_id;this.next_batch_id++,this.num_requests_in_flight++;var _=i.SilentBackgroundRequest({xhrFields:{withCredentials:!0},url:n,type:o,data:a,success:this._success.bind(this,e),error:this._error.bind(this,e),complete:this._complete.bind(this,p)});this.outstanding_batches[p]={urls:e,request:_},this._send_batch_requests()}},e.prototype._success=function(e,t){for(var n=t.split("\n"),i={},o=0,a=e;o<a.length;o++){var r=a[o];i[r]=!1}for(var s=0;s<n.length;s++){var c=n[s],u=c.indexOf(":");if(-1!==u){var l=c.substring(0,u).split("-"),d=parseInt(l[0],10),f=c.substring(u+1);r=e[d];i[r]=!0,this._call_callback(r,f),this.batch_logger&&"function"==typeof this.batch_logger&&this.batch_logger(s,e.length)}}this.on_batch_success&&"function"==typeof this.on_batch_success&&this.on_batch_success(e);for(var p=0,_=e.filter((function(e){return!i[e]}));p<_.length;p++){r=_[p];this.cancelled_urls[r]||this._call_callback(r,r)}},e.prototype._error=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];this._call_callback(i,i)}},e.prototype._complete=function(e){this.num_requests_in_flight--;for(var t=0,n=this.outstanding_batches[e].urls;t<n.length;t++){var i=n[t];delete this.cancelled_urls[i]}delete this.outstanding_batches[e],this.flushing&&this._send_batch_requests()},e.prototype._call_callback=function(e,t){var n;if(n=0===t.indexOf("data:image")?t:e,this.request_ids_by_url[e])for(var i=0,o=this.request_ids_by_url[e].slice();i<o.length;i++){var a=o[i];this.callback_by_id[a]&&(this.callback_by_id[a].callback(n,!1),delete this.callback_by_id[a])}delete this.request_ids_by_url[e]},e.prototype._generate_request_params=function(e){var t=e.map((function(e){return r.URI.parse(e).setScheme().setAuthority().toString()})),n=JSON.stringify(t),i=Math.abs(this._hash_string_to_int(n))%a.BATCH_THUMB_ENDPOINTS.length,o=a.BATCH_THUMB_ENDPOINTS[i],s={image_urls:n};return{endpoint:o,method:r.URI.parse(o).setQuery(s).toString().length>6e3?"POST":"GET",data:s}},e.prototype._hash_string_to_int=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n)}return t},e})();t.BatchThumbLoader=s})),define("modules/clean/react/maestro/layout/header_conditions",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showAccountMenu=function(e,t){return!e.is_team_assume_user_session&&!t.is_guest_admin}})),define("modules/clean/react/maestro/layout/non_pagelet_top_menu_container",["require","exports","tslib","react","modules/clean/react/account_menu/account_menu","modules/clean/react/css","modules/clean/react/maestro/layout/header_conditions","modules/clean/react/maestro/layout/top_menu_container","modules/clean/react/user_notifications/dropdown","modules/clean/viewer"],(function(e,t,n,i,o,a,r,s,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderTopMenus=function(e){var t;e&&(t=i.default.createElement(o.AccountMenu,{user:this.props.user,viewer:this.props.viewer}));var n=this.props.user.is_guest_admin?"":i.default.createElement(c.UserNotificationsDropdown,{isPagelet:!1});return[i.default.createElement("div",{className:"notifications-widget-container",key:"notifications-widget"},n),i.default.createElement("div",{className:"account-menu-widget-container",key:"account-menu-widget"},t)]},t.prototype.render=function(){var e=r.showAccountMenu(this.props.viewer,this.props.user),t=e?"":"top-menu-container--account-menu-hidden",o=n.__assign(n.__assign({},this.props),{rightContent:this.renderTopMenus(e),classNames:t});return i.default.createElement(s.TopMenuContainer,n.__assign({},o))},t.defaultProps={viewer:u.Viewer.get_viewer()},t})((i=n.__importDefault(i)).default.Component);t.NonPageletTopMenuContainer=a.requireCssWithComponent(l,["/static/css/pagelet-vflp36zom.css"],[s.TopMenuContainer,c.UserNotificationsDropdown])})),define("modules/clean/react/maestro/layout/nonpagelet_header",["require","exports","tslib","react","modules/clean/react/css","modules/clean/viewer","modules/clean/react/maestro/layout/header","modules/clean/react/maestro/layout/non_pagelet_top_menu_container"],(function(e,t,n,i,o,a,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getUser=function(){var e=a.Viewer.get_viewer().get_users();if(0===e.length)throw new Error("No logged in user detected. This header can only be used with a logged in user.");return e[0]},t.prototype.render=function(){var e=i.default.createElement(s.NonPageletTopMenuContainer,n.__assign({},this.props,{user:this.getUser()}));return i.default.createElement("div",{className:"maestro"},i.default.createElement("div",{className:"maestro-header--without-nav"},i.default.createElement("header",{className:"maestro-header page-header__shadow"},i.default.createElement("div",{className:"page-header"},i.default.createElement(r.MaestroHeaderLogo,null),i.default.createElement("div",{className:"maestro-header--right-content"},e)))))},t.defaultProps={searchVariant:null,isSearchBarExpanded:!1},t})((i=n.__importDefault(i)).default.Component),u=o.requireCssWithComponent(c,["/static/css/maestro_header_without_nav-vflzRZfOI.css"]);t.NonPageletMaestroHeader=u})),define("modules/clean/loggers/notification_logger",["require","exports","tslib","modules/clean/ajax","modules/clean/react/user_notifications/models"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),t.NotificationLocations={TRAY:"home",HOME_PAGE:"home_page"};var a=(function(){function e(){}return e.logReceive=function(t){for(var n=[],i=0,o=t;i<o.length;i++){var a=o[i];n.push(e.getCommonEventData("receive",a))}e.log(n)},e.logRender=function(t,n,i){var o=[];t.forEach((function(t,a){var r=e.getCommonEventData("render",t);r.location=i,r.location_index=n+a,o.push(r)})),e.log(o)},e.logAction=function(t,n,i){var o=e.getCommonEventData("action",t);o.action_taken=n,i&&(o.location=i),e.log([o])},e.logMarkAsRead=function(t,n){for(var i=[],o=0,a=t;o<a.length;o++){var r=a[o],s=e.getCommonEventData("mark_read",r);s.location=n,i.push(s)}e.log(i)},e.log=function(e){0!==e.length&&i.SilentBackgroundRequest({url:"/log/notif_events",data:{event_list:JSON.stringify(e)}})},e.getCommonEventData=function(e,t){return{event_name:e,type_id:t.typeId,campaign_id:o.getCampaignId(t),campaign_version:o.getCampaignVersion(t),instance_id:parseInt(t.id,10),status:o.NotificationStatusStrings[t.status],seen_state:t.seenState,target_object_key:t.targetObjectKey}},e})();t.NotificationLogger=a})),define("modules/clean/react/user_notifications/actions",["require","exports","tslib","modules/clean/bolt","modules/clean/loggers/notification_logger","modules/clean/loggers/notification_tray_logger","modules/clean/react/user_notifications/api","modules/clean/react/user_notifications/constants","modules/clean/react/user_notifications/dispatcher","modules/clean/react/user_notifications/models","modules/clean/react/user_notifications/store","modules/clean/referrer_cleansing_redirect"],(function(e,t,n,i,o,a,r,s,c,u,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),r=n.__importStar(r),d=n.__importStar(d);var f=new((function(){function t(){var e=this;this.onUserNotificationUpdate=function(){e.load().then((function(t){if(t){var n=e.getBoltChannelStates(t);e.boltClient.update_states(n)}}),(function(){}))},this.userNotificationRefreshCallback=function(){e.load().then((function(t){if(t){e.boltClient.unsubscribe();var n=e.getBoltChannelStates(t);n.length>0&&(e.boltClient=new i.BoltClient(n,e.onUserNotificationUpdate,e.userNotificationRefreshCallback),e.boltClient.start())}}),(function(){}))}}return t.prototype.asyncSharingAction=function(t){new Promise((function(t,n){e(["modules/clean/react/user_notifications/sharing_actions"],t,n)})).then(n.__importStar).then(t)},t.prototype.asyncGroupAction=function(t){new Promise((function(t,n){e(["modules/clean/react/user_notifications/group_actions"],t,n)})).then(n.__importStar).then(t)},t.prototype.load=function(){return c.userNotificationsDispatcher.dispatch({type:s.ActionTypes.LOAD_REQUEST}),r.getAll(l.userNotificationsStore.getCursor(),this.activeUserOnlyMode).then((function(e){var t=[];return t=t.concat(e.notifications),o.NotificationLogger.logReceive(t),c.userNotificationsDispatcher.dispatch({type:s.ActionTypes.LOAD_SUCCESS,data:e}),e}),(function(){c.userNotificationsDispatcher.dispatch({type:s.ActionTypes.LOAD_FAILURE})}))},t.prototype.loadOnceAndWatch=function(e){var t=this;this.hasLoadedOnce||(this.hasLoadedOnce=!0,this.activeUserOnlyMode=null!=e&&e,this.load().then((function(e){e&&t.watch(e)}),(function(){})))},t.prototype.acknowledge=function(e){c.userNotificationsDispatcher.dispatch({type:s.ActionTypes.ACKNOWLEDGEMENT_REQUEST_SINGLE,data:{notifications:[e]}}),r.ack(e)},t.prototype.markAllAsSeen=function(){var e=l.userNotificationsStore.getUnseen();0!==e.length&&(r.markAsSeen(e),c.userNotificationsDispatcher.dispatch({type:s.ActionTypes.MARK_AS_SEEN_REQUEST}))},t.prototype.watch=function(e){var t=this.getBoltChannelStates(e);t.length>0&&(this.boltClient=new i.BoltClient(t,this.onUserNotificationUpdate,this.userNotificationRefreshCallback),this.boltClient.start())},t.prototype.getBoltChannelStates=function(e){var t=[];for(var n in e.cursor)if(e.cursor.hasOwnProperty(n)){var o=null,a=window.ensemble;if(a&&a.viewer&&(o=a.viewer.getActiveUser()),!this.activeUserOnlyMode||(null!=o?o.userId:null)===parseInt(n,10)){var r=new i.SignedChannelState("user_notification",n,e.cursor[n],e.boltToken[n]);t.push(r)}}return t},t.prototype.acknowledgeAll=function(){0!==l.userNotificationsStore.getUnacknowledgedCount()&&(a.logMarkAllAsRead(),o.NotificationLogger.logMarkAsRead(l.userNotificationsStore.getUnacknowledged(),o.NotificationLocations.TRAY),c.userNotificationsDispatcher.dispatch({type:s.ActionTypes.ACKNOWLEDGEMENT_REQUEST}),r.ackAll(this.activeUserOnlyMode))},t.prototype.viewNotifications=function(){this.markAllAsSeen()},t.prototype.actionPerformed=function(e,t){o.NotificationLogger.logAction(e,t),u.isUnread(e)&&this.acknowledge(e)},t.prototype.triggerGenericLegacyNotificationAction=function(e){this.actionPerformed(e,"click")},t.prototype.dismissLegacySharingNotification=function(e,t){this.actionPerformed(e,"button_1"),this.asyncSharingAction((function(e){e.registerDismiss(t)}))},t.prototype.mountFromLegacySharingNotification=function(e,t){this.actionPerformed(e,"button_0"),this.asyncSharingAction((function(e){e.registerMount(t)}))},t.prototype.upgradeToMountFromLegacySharingNotification=function(e){this.actionPerformed(e,"button_0"),this.asyncSharingAction((function(e){e.upgradeToMount()}))},t.prototype.triggerBluenoteAction=function(e,t,n,i){this.actionPerformed(t,i),n.actionType===u.BluenoteActionTypes.OpenUrl?(e.preventDefault(),this.performBluenoteOpenUrlAction(e,n.params)):n.actionType===u.BluenoteActionTypes.MountSharedFolder?this.asyncSharingAction((function(e){e.performBluenoteMountSharedFolder(t,n.params)})):n.actionType===u.BluenoteActionTypes.ApproveGroupJoinRequest?this.asyncGroupAction((function(e){e.performBluenoteApproveGroupJoinRequestAction(t,n.params)})):n.actionType===u.BluenoteActionTypes.RemoveGroupJoinRequest&&this.asyncGroupAction((function(e){e.performBluenoteRemoveGroupJoinRequestAction(t,n.params)}))},t.prototype.performBluenoteOpenUrlAction=function(e,t){t.urlPath&&(e.ctrlKey||e.metaKey?d.safe_open_tab_and_redirect(t.urlPath):d.redirect(t.urlPath))},t})());t.default=f})),define("modules/clean/react/user_notifications/api",["require","exports","tslib","jquery","modules/clean/ajax","modules/clean/react/user_notifications/api_helper","modules/clean/edison/active_user_id"],(function(e,t,n,i,o,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),o=n.__importStar(o);t.getAll=function(e,t){void 0===e&&(e=null),void 0===t&&(t=!1);var n,s={count:100,template_version:5};if(null!=e&&(s.last_received_nid_by_user_id=JSON.stringify(e)),t){if(null===e){var c=window.__REGISTER_NOTIFICATIONS_PREFETCH_HANDLER;if(c)return c.prefetchDeferred||(c.prefetchDeferred=i.default.Deferred(),c((function(e){c.prefetchDeferred.resolve(a.parseGetAllResponse(e))}),(function(){return null}))),c.prefetchDeferred}n=o.SilentBackgroundRequest({url:"/web/notifications/retrieve_user",data:s,subject_user:r.getActiveUserId(),dataType:"json"})}else n=o.SilentBackgroundRequest({url:"/web/notifications/retrieve",data:s,dataType:"json"});return Promise.resolve(n.then(a.parseGetAllResponse))},t.ackAll=function(e){return void 0===e&&(e=!1),(e?o.SilentBackgroundRequest({url:"/web/notifications/ack_all_user",subject_user:r.getActiveUserId(),dataType:"json"}):o.SilentBackgroundRequest({url:"/web/notifications/ack_all",dataType:"json"})).then((function(e){return e.map(a.userNotificationDeserializer)}))},t.ack=function(e){o.SilentBackgroundBeaconRequest({url:"/web/notifications/ack",subject_user:e.userId,data:{nids:JSON.stringify([e.id])},dataType:"json"})},t.markAsSeen=function(e){for(var t={},n=0,i=e;n<i.length;n++){var a=i[n];a.userId&&a.id&&(t[a.userId]||(t[a.userId]=[])).push(a.id)}var r={nids_by_user_id:JSON.stringify(t)};o.SilentBackgroundRequest({url:"/web/notifications/mark_seen",data:r,dataType:"json"})}})),define("modules/clean/react/user_notifications/api_helper",["require","exports","modules/clean/react/user_notifications/constants","modules/clean/react/user_notifications/models"],(function(e,t,n,i){"use strict";function o(e){return{id:e.nid,userId:e.user_id,typeId:e.type_id,typeData:a(e),targetObjectKey:e.target_object_key,status:e.status,seenState:e.seen_state,feedTimeInSec:e.feed_time,rawDropdownRowHtml:e.notification_div,roleLabel:e.role_label,bluenoteActor:p(e),bluenoteObject:_(e),bluenoteNotificationTypeId:e.bluenote_notification_type_id,bluenoteTypedData:h(e)}}function a(e){switch(e.type_id){case i.NotificationTypes.SharedFolderInvite:return(function(e){return{overQuotaStatus:e.sf_invite_overquota}})(e);case i.NotificationTypes.Bluenote:return(function(e){var t=e.bluenote_payload;if(null!=t)return{templateType:t.template_type,templateVersion:t.template_version,campaignInfo:u(t.campaign_info),displayMessage:t.home_params.message,icon:l(t.image),surfaceAction:d(t.home_params.surface_action),buttonActions:(t.home_params.button_actions||[]).map(d),preview:r(t.preview)};return})(e)}}function r(e){if(null!=e)return{showThumbnail:e.show_thumbnail||!1,quote:e.quote,tasks:s(e.tasks)}}function s(e){if(null!=e)return{taskEndpoint:e.task_endpoint,tasks:(e.tasks||[]).map(c)}}function c(e){if(null!=e)return{name:e.name,id:e.id,isComplete:e.is_complete}}function u(e){if(null!=e)return{campaignId:e.campaignId,categoryId:e.categoryId,versionId:e.versionId?""+e.versionId:void 0,contentId:e.contentId}}function l(e){if(null!=e)return"avatar"===e.type?{avatarInitials:e.avatar_initials,avatarUrl:e.avatar_url}:{lowResIconUrl:e.system_url32,highResIconUrl:e.system_url64}}function d(e){if(null!=e){var t=void 0;if("open_url"===e.action_name?t=i.BluenoteActionTypes.OpenUrl:"mount_shared_folder"===e.action_name?t=i.BluenoteActionTypes.MountSharedFolder:"approve_group_join_request"===e.action_name?t=i.BluenoteActionTypes.ApproveGroupJoinRequest:"remove_group_join_request"===e.action_name&&(t=i.BluenoteActionTypes.RemoveGroupJoinRequest),t)return{buttonLabel:e.label,actionType:t,params:f(t,e.params)}}}function f(e,t){if(null!=t){if(e===i.BluenoteActionTypes.OpenUrl)return{urlPath:t.url_path};if(e===i.BluenoteActionTypes.MountSharedFolder)return{nsId:t.ns_id};if(e===i.BluenoteActionTypes.ApproveGroupJoinRequest||e===i.BluenoteActionTypes.RemoveGroupJoinRequest)return{requestingUserId:t.requesting_user_id,groupId:t.group_id}}}function p(e){var t=e.bluenote_actor;if(null!=t)return{accountId:t.actor_account_id,avatarUrl:t.actor_avatar_url,displayName:t.actor_display_name,initials:t.actor_initials}}function _(e){var t=e.bluenote_object;if(null!=t)return{id:t.id,ignore:t.ignore,name:t.name,thumbnailUrl:t.thumbnail_url,type:t.type,url:t.url}}function h(e){var t=e.bluenote_notification_type_id,i=e.bluenote_typed_data;if(null!=t&&null!=i)switch(t){case n.BNNotificationTypeIdentifier.NONE:return;case n.BNNotificationTypeIdentifier.DROPBOX_FILE_COMMENT:return(function(e){return{commentText:e.comment_text}})(i);case n.BNNotificationTypeIdentifier.DROPBOX_SHARED_CONTENT:case n.BNNotificationTypeIdentifier.PAPER_SHARE:return(function(e){return{shareText:e.share_text}})(i);case n.BNNotificationTypeIdentifier.PAPER_COMMENT:return(function(e){return{commentText:e.comment_text,numOtherCommenters:e.num_other_commenters,numOtherComments:e.num_other_comments}})(i);case n.BNNotificationTypeIdentifier.PAPER_MENTION:return(function(e){return{mentionText:e.mention_text}})(i);case n.BNNotificationTypeIdentifier.PAPER_TASK:return(function(e){return{isComplete:e.is_complete,isNew:e.is_new}})(i);case n.BNNotificationTypeIdentifier.COMMENTS2_COMMENT:return(function(e){return{previewQuote:e.preview_quote}})(i);default:return}}Object.defineProperty(t,"__esModule",{value:!0}),t.userNotificationDeserializer=o,t.parseGetAllResponse=function(e){var t=e.notifications.map(o);return{cursor:e.latest_nid,boltToken:e.bolt_token,notifications:t}},t.userNotificationComparator=function(e,t){var n=i.getFeedTime(e),o=i.getFeedTime(t);return void 0===n&&void 0===o?0:void 0===n?1:void 0===o?-1:o.getTime()-n.getTime()||i.getKey(e).localeCompare(i.getKey(t))}})),define("modules/clean/react/user_notifications/avatar_icon",["require","exports","tslib","react","modules/clean/avatar/initials_avatar","modules/clean/avatar/size"],(function(e,t,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(e){function t(t){var n=e.call(this,t)||this;n.thumbRequestId=null;var i=null,o=n.props.avatarIconRecord;return null!=o.avatarUrl&&(i=n.props.thumbStore.get_thumb(o.avatarUrl)),n.state={avatarImage:i},n}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.bindAvatarUrl(this.props)},t.prototype.componentWillUnmount=function(){this.unbindAvatarUrl()},t.prototype.componentDidUpdate=function(e){var t=e.avatarIconRecord,n=this.props.avatarIconRecord;t.avatarUrl!==n.avatarUrl&&(this.unbindAvatarUrl(),this.bindAvatarUrl(this.props))},t.prototype.bindAvatarUrl=function(e){var t=this,n=e.avatarIconRecord.avatarUrl;null!=n&&(this.thumbRequestId=e.thumbStore.bind_url(n,{onSuccess:function(){var i=e.thumbStore.get_thumb(n);t.setState({avatarImage:i})}}))},t.prototype.unbindAvatarUrl=function(){this.thumbRequestId&&(this.props.thumbStore.unbind_url(this.thumbRequestId),this.thumbRequestId=null)},t.prototype.render=function(){var e=this.props.avatarIconRecord;return null!=this.state.avatarImage?i.default.createElement("img",{className:this.props.className,src:this.state.avatarImage,alt:"",width:this.props.size,height:this.props.size}):i.default.createElement(o.InitialsAvatarWithColorDerivedFromName,{name:e.avatarInitials,dimension:this.props.size,initials:e.avatarInitials,shape:"CIRCLE",optionalClass:this.props.className})},t.displayName="AvatarIcon",t.defaultProps={size:a.AVATAR_DIMENSION_BY_SIZE.MEDIUM},t})((i=n.__importDefault(i)).default.Component);t.AvatarIcon=r})),define("modules/clean/react/user_notifications/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.LOAD_REQUEST="USER_NOTIFICATIONS_LOAD_REQUEST",e.LOAD_SUCCESS="USER_NOTIFICATIONS_LOAD_SUCCESS",e.LOAD_FAILURE="USER_NOTIFICATIONS_LOAD_FAILURE",e.ACKNOWLEDGEMENT_REQUEST="USER_NOTIFICATIONS_ACKNOWLEDGEMENT_REQUEST",e.ACKNOWLEDGEMENT_REQUEST_SINGLE="USER_NOTIFICATIONS_ACKNOWLEDGEMENT_REQUEST_SINGLE",e.MARK_AS_SEEN_REQUEST="USER_NOTIFICATIONS_MARK_AS_SEEN_REQUEST"})(t.ActionTypes||(t.ActionTypes={})),t.EventTypes={RENDERED_NOTIFICATIONS:"USER_NOTIFICATIONS_RENDERED_NOTIFICATIONS"},t.BNNotificationTypeIdentifier={NONE:"NONE",DROPBOX_FILE_COMMENT:"DROPBOX_FILE_COMMENT",DROPBOX_SHARED_CONTENT:"DROPBOX_SHARED_CONTENT",PAPER_SHARE:"PAPER_SHARE",PAPER_COMMENT:"PAPER_COMMENT",PAPER_MENTION:"PAPER_MENTION",PAPER_TASK:"PAPER_TASK",COMMENTS2_COMMENT:"COMMENTS2_COMMENT",GENERIC:"GENERIC"},t.BluenoteObjectTypes={DROPBOX_FILE:"dropbox-file",DROPBOX_FOLDER:"dropbox-folder",PAPER_PAD:"paper-pad",PAPER_FOLDER:"paper-folder"}})),define("modules/clean/react/user_notifications/dispatcher",["require","exports","modules/clean/flux/dispatcher"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userNotificationsDispatcher=n.Dispatcher})),define("modules/clean/react/user_notifications/dropdown",["require","exports","tslib","external/lodash","react","modules/clean/accessibility/tabbable","modules/clean/loggers/notification_logger","modules/clean/loggers/notification_tray_logger","modules/clean/react/css","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/dropdown_bell","modules/clean/react/user_notifications/shared/tray_chrome","modules/clean/react/user_notifications/renderer","modules/clean/react/user_notifications/store","spectrum/popover","modules/core/i18n"],(function(e,t,n,i,o,a,r,s,c,u,l,d,f,p,_,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),o=n.__importDefault(o),a=n.__importDefault(a),s=n.__importStar(s),u=n.__importDefault(u);var m=(function(t){function c(e){var n=t.call(this,e)||this;return n.onTrayMount=function(){s.logTrayOpen(n.state.actionableCount),u.default.viewNotifications()},n.logRenderWrapper=function(e,t){r.NotificationLogger.logRender(e,t,r.NotificationLocations.TRAY)},n.onMenuToggle=function(e){var t=e.isOpen;n.setState({isOpen:t}),c.requireAsyncModules()},n.state={actionableCount:p.userNotificationsStore.getActionableCount(),notifications:p.userNotificationsStore.getAllVisible(),isStoreLoading:p.userNotificationsStore.isLoading(),isDisabled:!0,isOpen:!1},n}return n.__extends(c,t),c.prototype.componentDidMount=function(){u.default.loadOnceAndWatch(this.props.isPagelet),this.removeStoreListener=p.userNotificationsStore.addListener(this.onUpdateFromStore.bind(this)),this.onUpdateFromStore();var e=new f.NotificationRenderer;this.notificationRenderFunc=e.renderNotification.bind(e),this.setState((function(e,t){return e.isDisabled=!1,e})),new a.default},c.prototype.componentWillUnmount=function(){this.removeStoreListener()},c.prototype.onUpdateFromStore=function(){this.setState((function(e,t){return e.actionableCount=p.userNotificationsStore.getActionableCount(),e.notifications=p.userNotificationsStore.getAllVisible(),e.isStoreLoading=p.userNotificationsStore.isLoading(),e}))},c.prototype.renderTrayContent=function(){return o.default.createElement("div",{id:"event-feed-container"},o.default.createElement("div",{id:"event-feed"},o.default.createElement(d.NotificationsTrayChrome,{unreadSectionTitle:h.intl.formatMessage({id:"B7AytW",defaultMessage:"Unread"}),readSectionTitle:h.intl.formatMessage({id:"du7HYM",defaultMessage:"Recent"}),notifications:this.state.notifications,markAllAsReadButtonTitle:h.intl.formatMessage({id:"G4MWO/",defaultMessage:"Mark all as read"}),markAllAsReadAction:u.default.acknowledgeAll,isLoading:this.state.isStoreLoading,loadingMessage:h.intl.formatMessage({id:"Uwr6W8",defaultMessage:"Loading ..."}),emptyMessage:h.intl.formatMessage({id:"NfgkYn",defaultMessage:"You donâ€™t have any notifications yet."}),notifRenderFunc:this.notificationRenderFunc,notifLogRenderFunc:this.logRenderWrapper,onTrayMount:this.onTrayMount})))},c.prototype.render=function(){var e=this.state.actionableCount;return o.default.createElement(_.Popover,{onSelection:i.noop,onMenuToggle:this.onMenuToggle},o.default.createElement(_.PopoverTrigger,{"aria-label":e>0?h.intl.formatMessage({id:"RaZY+d",defaultMessage:"Notifications menu, with new notifications"}):h.intl.formatMessage({id:"ewgyb+",defaultMessage:"Notifications menu"}),className:"notification-button"},o.default.createElement(l.UserNotificationsDropdownBell,{actionableCount:e,isSelected:this.state.isOpen})),o.default.createElement(_.PopoverContent,{attachment:"right",className:"notifications-popover-content"},o.default.createElement(_.PopoverContentTitle,null,h.intl.formatMessage({id:"dToisu",defaultMessage:"Notifications"})),o.default.createElement("div",{className:"notifications-dropdown"},this.renderTrayContent())))},c.displayName="UserNotificationsDropdown",c.requireAsyncModules=i.once((function(){return new Promise((function(t,n){e(["modules/clean/react/user_notifications/sharing_actions"],t,n)})).then(n.__importStar).then((function(){return null}))})),c.defaultProps={isPagelet:!1,accountMenuVisible:!0},c})(o.default.Component),g=c.requireCssWithComponent(m,["/static/css/scooter/scooter-scoped-vfl5wRSGl.css","/static/css/spectrum/index.web-vfl6Z83yw.css","/static/css/notifications-vflhjjdUx.css","/static/css/dig-components/index.web-vflrectwC.css"]);t.UserNotificationsDropdown=g})),define("modules/clean/react/user_notifications/dropdown_bell",["require","exports","tslib","spectrum/icon_global","react","modules/core/i18n"],(function(e,t,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderBell=function(){return o.default.createElement(i.IconGlobal,{name:"notifications",className:"mcl-notifications-icon",selected:this.props.isSelected})},t.prototype.renderBadge=function(){return this.props.actionableCount?o.default.createElement("div",{className:"badge-red-dot"}):null},t.prototype.render=function(){var e="";return this.props.actionableCount>0&&(e=a.intl.formatMessage({id:"Dj/752",defaultMessage:"{count, plural, one{{count} new} other{{count} new}}"},{count:this.props.actionableCount})),o.default.createElement("div",{className:"notification-button-bell-container"},o.default.createElement("span",{className:"ax-visually-hidden"},e),this.renderBell(),this.renderBadge())},t.defaultProps={actionableCount:0},t})((o=n.__importDefault(o)).default.Component);t.UserNotificationsDropdownBell=r})),define("modules/clean/react/user_notifications/dropdown_bluenote_row",["require","exports","tslib","classnames","purify","react","modules/clean/keycode","dig-components/buttons","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/avatar_icon","modules/clean/react/user_notifications/generic_icon","modules/clean/react/user_notifications/models","modules/clean/react/user_notifications/single_task_preview","modules/clean/react/user_notifications/thumbnail_preview","modules/clean/referrer_cleansing_redirect"],(function(e,t,n,i,o,a,r,s,c,u,l,d,f,p,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),o=n.__importStar(o),a=n.__importDefault(a),c=n.__importDefault(c);var h=function(e){var t=e.notification.typeData.displayMessage;return t?a.default.createElement("div",{className:"feed-text--button-wrapper"},a.default.createElement("button",{tabIndex:-1,className:"u-unbutton u-font-left feed-text__button"},a.default.createElement("div",{className:"feed-text__button-text",dangerouslySetInnerHTML:{__html:o.sanitize(t)}}))):null};h.displayName="UserNotificationText";var m=function(e){var t=e.notification,n=e.thumbStore,i=t.typeData.icon;return i&&(i.avatarInitials||i.avatarUrl)?a.default.createElement(u.AvatarIcon,{avatarIconRecord:i,thumbStore:n,className:"feed-image feed-image--bluenote"}):a.default.createElement(l.GenericIcon,{genericIconRecord:i,className:"feed-image feed-image--bluenote"})};m.displayName="UserNotificationImage";var g=function(e){var t=e.notification,n=d.getDisplayTime(t);return a.default.createElement("span",{className:"feed-time"},n)};g.displayName="UserNotificationTimestamp";var v=function(e){var t=e.notification,n=t.typeData.preview;if(!n)return null;var i=null;n.showThumbnail&&t.bluenoteObject&&(i=a.default.createElement(p.ThumbnailPreview,{object:t.bluenoteObject}));var o=null;n.tasks&&n.tasks.tasks&&n.tasks.tasks.length>0&&n.tasks.tasks[0]&&(o=a.default.createElement(f.SingleTaskPreview,{task:n.tasks.tasks[0]}));var r=null;return n.quote&&(r=a.default.createElement("div",{className:"preview-quote"},n.quote)),a.default.createElement("div",null,i,o,r)};v.displayName="UserNotificationPreview";var b=function(e){var t=e.notification,n=e.buttonLabel,i=e.buttonIndex;return a.default.createElement(s.Button,{className:"notification u-mar-right-xs u-mar-top-xs",variant:i>0?"outline":"primary",onClick:function(e){e.currentTarget.disabled=!0;var n=(t.typeData.buttonActions||[])[i];c.default.triggerBluenoteAction(e,t,n,"button_"+i),e.stopPropagation(),e.preventDefault()}},n)};b.displayName="UserNotificationButton";var y=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSurfaceAction=function(e){var n=t.props.notification,i=n.typeData.surfaceAction;null!=i&&c.default.triggerBluenoteAction(e,n,i,"surface")},t.handleKeyDown=function(e){e.keyCode!==r.KeyCode.ENTER&&e.keyCode!==r.KeyCode.SPACE||t.handleSurfaceAction(e)},t}return n.__extends(t,e),t.prototype.renderButtonActions=function(e){var t=[];return(e.typeData.buttonActions||[]).forEach((function(n,i){t.push(a.default.createElement(b,{key:d.getKey(e),notification:e,buttonLabel:n.buttonLabel,buttonIndex:i}))})),t.length>0?a.default.createElement("span",{className:"feed-action action-available"},t):null},t.prototype.render=function(){var e=this.props.notification,t=e.typeData;if(!t)return null;var n=t.surfaceAction,o=i.default({"feed-row":!0,clickable:null!=t.surfaceAction,read:this.props.isAcknowledged}),r=a.default.createElement("div",{onClick:this.handleSurfaceAction,onKeyDown:this.handleKeyDown,className:o,role:"button",tabIndex:0},a.default.createElement(m,{notification:e,thumbStore:this.props.thumbStore}),a.default.createElement(h,{notification:e}),a.default.createElement(v,{notification:e}),a.default.createElement(g,{notification:e}),this.renderButtonActions(e));if(null!=n&&n.actionType===d.BluenoteActionTypes.OpenUrl){var s=n.params;if(s.urlPath){var c=_.get_redirect_uri(s.urlPath);return a.default.createElement("a",{href:c.toString()},r)}}return r},t.displayName="UserNotificationsDropdownBluenoteRow",t})(a.default.Component);t.UserNotificationsDropdownBluenoteRow=y})),define("modules/clean/react/user_notifications/dropdown_row",["require","exports","tslib","react","react-dom-factories","external/lodash","jquery","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/models","modules/clean/sprite"],(function(e,t,n,i,o,a,r,s,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),o=n.__importDefault(o),a=n.__importStar(a),r=n.__importDefault(r),s=n.__importDefault(s),u=n.__importDefault(u);var l=o.default.div,d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._buildLegacyElement=function(e,n){var i,o=r.default(t.refs.dropdownLegacyRow);return o.html(null!==(i=e.rawDropdownRowHtml)&&void 0!==i?i:""),t._initImages(o),t._setTimeLabel(o,e),t._addClientStateClasses(o,e,n),t._initActionHandlers(e,o),o},t._initImages=function(e){return e.find("img").each((function(e,n){var i=r.default(n);return i.attr("alt",""),t._loadImage(i)}))},t._setTimeLabel=function(e,t){var n=e.find("#feed-time-label");if(null!=n)return n.text(c.getDisplayTime(t))},t._loadImage=function(e){var n=e.data("src");if(n)return t.props.legacyThumbLoader.load(n).progress((function(){return e.data("src",null),e.data("loading-src",n)})).then((function(t){e.data("loading-src",null);var n=function(){return e.addClass("thumbnail"),e.parent(".feed-thumbnail").addClass("has-frame")};return 0===t.indexOf("data:image")?n():(e.load(n),e.error(a.once((function(){var t=e.data("fail-src")||u.default.SPACER;return e.attr("src",t)})))),e.attr("src",t)}))},t._addClientStateClasses=function(e,t,n){var i=e.hasClass("feed-row")?e:e.find(".feed-row");if(c.isInvisible(t)&&i.addClass("invisible"),n)return i.addClass("read")},t._initActionHandlers=function(e,t){return t.on("click",(function(){return s.default.triggerGenericLegacyNotificationAction(e),!0})),t.on("click",".share-content-dismiss",(function(){return s.default.dismissLegacySharingNotification(e,this),!1})),t.on("click",".share-content-mount",(function(){return s.default.mountFromLegacySharingNotification(e,this),!1})),t.on("click",".share-content-upgrade-mount",(function(){return s.default.upgradeToMountFromLegacySharingNotification(e),!1}))},t}return n.__extends(t,e),t.prototype.componentDidMount=function(){return this._buildLegacyElement(this.props.notification,this.props.isAcknowledged)},t.prototype.render=function(){return l({ref:"dropdownLegacyRow"})},t.displayName="UserNotificationsDropdownRow",t})(i.default.Component);t.default=d})),define("modules/clean/react/user_notifications/generic_icon",["require","exports","tslib","react","modules/clean/react/image","modules/clean/static_urls"],(function(e,t,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),t.GenericIcon=function(e){var t=e.genericIconRecord,n=null!=t?t.lowResIconUrl:null,r=null!=t?t.highResIconUrl:null;return null!=n&&null!=r||(n=a.static_url("/static/images/icons32/system_notification_default_icon-vflSQSQdl.png"),r=a.static_url("/static/images/icons64/system_notification_default_icon-vfl0Gu6Pt.png")),i.default.createElement("div",{className:e.className},i.default.createElement(o.Image,{src:n,srcHiRes:r}))},t.GenericIcon.displayName="GenericIcon"})),define("modules/clean/react/user_notifications/legacy_thumb_loader",["require","exports","tslib","external/lodash","jquery","modules/clean/photos/batch_thumb_loader"],(function(e,t,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),o=n.__importDefault(o);var r=(function(){function e(){this._cache={};var e=new a.BatchThumbLoader({batch_size:16,max_parallel_requests:24});this._queueThumb=function(t,n,i){return e.queue_thumb(t,n,{onrequest:i})},this._flushQueue=i.debounce((function(){return e.flush()}),0)}return e.prototype.load=function(e){if(!this._cache[e]){var t=new o.default.Deferred;this._queueThumb(e,t.resolve,t.notify),this._flushQueue(),this._cache[e]=t.promise()}return this._cache[e]},e})();t.LegacyThumbLoader=r})),define("modules/clean/react/user_notifications/models",["require","exports","tslib","modules/clean/datetime"],(function(e,t,n,i){"use strict";var o,a,r;Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),(function(e){e[e.OpenUrl=1]="OpenUrl",e[e.MountSharedFolder=2]="MountSharedFolder",e[e.ApproveGroupJoinRequest=3]="ApproveGroupJoinRequest",e[e.RemoveGroupJoinRequest=4]="RemoveGroupJoinRequest"})(t.BluenoteActionTypes||(t.BluenoteActionTypes={})),(function(e){e[e.Unread=0]="Unread",e[e.Read=1]="Read",e[e.Invisible=2]="Invisible"})(o=t.NotificationStatuses||(t.NotificationStatuses={})),(function(e){e[e.Unseen=1]="Unseen",e[e.Seen=2]="Seen"})(a=t.NotificationSeenState||(t.NotificationSeenState={})),(function(e){e.STARRED="starred"})(t.FolderSuggestionReason||(t.FolderSuggestionReason={})),t.NotificationStatusStrings={0:"unread",1:"read",2:"invisible"},t.SharedFolderInviteOverQuotaStatuses={ALREADY_OVER:"overquota",WILL_BE_OVER:"will_be_overquota"},(function(e){e[e.SharedFolderInvite=100]="SharedFolderInvite",e[e.Bluenote=2200]="Bluenote"})(r=t.NotificationTypes||(t.NotificationTypes={})),t.getKey=function(e){return e.userId+" "+e.typeId+" "+e.targetObjectKey},t.isUnread=function(e){return e.status===o.Unread},t.isRead=function(e){return e.status===o.Read},t.isInvisible=function(e){return e.status===o.Invisible},t.isSeen=function(e){return!(e.seenState===a.Unseen&&e.status===o.Unread)},t.getFeedTime=function(e){return void 0===e.feedTimeInSec?void 0:new Date(1e3*e.feedTimeInSec)},t.getCampaignId=function(e){var t;if(e.typeId===r.Bluenote){var n=e.typeData;n.campaignInfo&&n.campaignInfo.campaignId&&(t=""+n.campaignInfo.campaignId)}return t},t.getCampaignVersion=function(e){if(e.typeId===r.Bluenote){var t=e.typeData;if(t.campaignInfo&&t.campaignInfo.versionId)return t.campaignInfo.versionId}},t.getDisplayTime=function(e){var n=t.getFeedTime(e);return void 0===n?"":i.ago(n,!0)}})),define("modules/clean/react/user_notifications/renderer",["require","exports","tslib","react","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react/user_notifications/dropdown_bluenote_row","modules/clean/react/user_notifications/dropdown_row","modules/clean/react/user_notifications/legacy_thumb_loader","modules/clean/react/user_notifications/models"],(function(e,t,n,i,o,a,r,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),r=n.__importDefault(r);var u=(function(){function e(){this.legacyThumbLoader=new s.LegacyThumbLoader,this.genericThumbStore=new o.GenericThumbStore}return e.prototype.renderNotification=function(e,t){return e.rawDropdownRowHtml?i.default.createElement(r.default,{notification:e,legacyThumbLoader:this.legacyThumbLoader,isAcknowledged:t}):e.typeId===c.NotificationTypes.Bluenote?i.default.createElement(a.UserNotificationsDropdownBluenoteRow,{notification:e,thumbStore:this.genericThumbStore,isAcknowledged:t}):null},e})();t.NotificationRenderer=u})),define("modules/clean/react/user_notifications/shared/icon_mark_as_read",["require","exports","tslib","react"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),t.IconMarkAsRead=function(e){return i.createElement("svg",n.__assign({width:"24",height:"24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),i.createElement("path",{d:"M5 12l4.147 4.608a.5.5 0 0 0 .726.02L19 7.5",stroke:"#1D2737",strokeWidth:"1.5"}))}})),define("modules/clean/react/user_notifications/shared/notification_row_wrapper",["require","exports","tslib","classnames","react","modules/clean/react/css","modules/clean/react/user_notifications/shared/icon_mark_as_read","modules/clean/react/title_bubble","modules/core/i18n","modules/clean/react/sticky_position"],(function(e,t,n,i,o,a,r,s,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i);var l=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={hover:!1},n.onMouseOver=n.onMouseOver.bind(n),n.onMouseOut=n.onMouseOut.bind(n),n}return n.__extends(t,e),t.prototype.onMouseOver=function(){this.setState({hover:!0})},t.prototype.onMouseOut=function(){this.setState({hover:!1})},t.prototype.renderInfoSheet=function(){var e=i.default({"notification-row-info-sheet":!0,"notification-row-info-sheet--visible":this.state.hover,"notification-row-info-sheet--unread":this.props.unread}),t=c.intl.formatMessage({id:"we6GC8",defaultMessage:"Mark as read"});return o.default.createElement("div",{className:e},o.default.createElement(s.TitleBubble,{position:u.StickyPosition.TOP,content:t},o.default.createElement("button",{className:"notification-row-info-sheet--markasread",onClick:this.props.onAcknowledge,"aria-label":t},o.default.createElement(r.IconMarkAsRead,null))))},t.prototype.render=function(){return o.default.createElement("div",{className:"notification-row-wrapper",onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut},this.props.unread&&this.renderInfoSheet(),this.props.row)},t})((o=n.__importDefault(o)).default.Component),d=a.requireCssWithComponent(l,["/static/css/user_notifications_shared-vflmbX9tA.css"]);t.NotificationRowWrapper=d})),define("modules/clean/react/user_notifications/shared/tray_chrome",["require","exports","tslib","react","react-dom","modules/clean/react/css","modules/clean/react/user_notifications/models","modules/clean/react/user_notifications/shared/tray_section"],(function(e,t,n,i,o,a,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),o=n.__importStar(o);var c=(function(e){function t(t){var n=e.call(this,t)||this;n.handleOnScroll=function(){n.scrollWithinOffsetToBottom(10)&&(n.logRendersForPage(n.state.visiblePages),n.setState({visiblePages:n.state.visiblePages+1}))},n.handleOnWheel=function(e){var t=-40*e.deltaY,i=o.findDOMNode(n);t<=0&&n.scrollWithinOffsetToBottom(0)?e.preventDefault():t>=0&&0===i.scrollTop&&e.preventDefault()};var i=n.processNotifications(n.props.notifications);return n.state={visiblePages:1,unreadNotifications:i.unreadNotifications,readNotifications:i.readNotifications},n}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onTrayMount(),this.logRendersForPage(0)},t.prototype.processNotifications=function(e){var t=this.state&&this.state.unreadNotifications||[],n={};t.forEach((function(e){return n[r.getKey(e)]=!0}));var i=[],o=[];return e.forEach((function(e){r.isUnread(e)||n[r.getKey(e)]?i.push(e):o.push(e)})),{unreadNotifications:i,readNotifications:o}},t.prototype.logRendersForPage=function(e){var t=this.state.unreadNotifications.concat(this.state.readNotifications).slice(10*e,10*(e+1));this.props.notifLogRenderFunc(t,10*e)},t.prototype.shouldComponentUpdate=function(e){return!(e.isLoading&&!this.props.isLoading)},t.prototype.componentWillReceiveProps=function(e){this.setState(this.processNotifications(e.notifications))},t.prototype.scrollWithinOffsetToBottom=function(e){var t=o.findDOMNode(this);return t.scrollHeight-t.scrollTop-t.offsetHeight<=e},t.prototype.render=function(){if(this.props.isLoading)return i.default.createElement("div",{className:"notifications-tray--loading"},this.props.loadingMessage);if(0===this.state.unreadNotifications.length&&0===this.state.readNotifications.length)return i.default.createElement("div",{className:"notifications-tray--empty"},this.props.emptyMessage);var e=this.state.unreadNotifications.slice(0,10*this.state.visiblePages),t=this.state.readNotifications.slice(0,10*this.state.visiblePages-e.length);return i.default.createElement("div",{className:"notifications-tray--loaded",onScroll:this.handleOnScroll,onWheel:this.handleOnWheel},i.default.createElement(s.NotificationsTraySection,{notifications:e,sectionTitle:this.props.unreadSectionTitle,actionButtonText:this.props.markAllAsReadButtonTitle,actionButtonAction:this.props.markAllAsReadAction,notifRenderFunc:this.props.notifRenderFunc,isUnreadSection:!0}),i.default.createElement(s.NotificationsTraySection,{notifications:t,sectionTitle:this.props.readSectionTitle,notifRenderFunc:this.props.notifRenderFunc,isUnreadSection:!1}))},t.displayName="NotificationsTrayChrome",t})(i.default.Component),u=a.requireCssWithComponent(c,["/static/css/user_notifications_shared-vflmbX9tA.css"]);t.NotificationsTrayChrome=u})),define("modules/clean/react/user_notifications/shared/tray_section",["require","exports","tslib","react","modules/clean/react/css","modules/clean/react/user_notifications/actions","modules/clean/react/user_notifications/models","modules/clean/react/user_notifications/shared/notification_row_wrapper"],(function(e,t,n,i,o,a,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),a=n.__importDefault(a);var c=(function(e){function t(t){var n=e.call(this,t)||this;return n.onClickActionButton=n.onClickActionButton.bind(n),n}return n.__extends(t,e),t.prototype.onClickActionButton=function(){this.props.actionButtonAction&&this.props.actionButtonAction()},t.prototype.renderReadSectionHeader=function(){var e=null;return this.props.actionButtonText&&(e=i.default.createElement("button",{className:"notifications-tray-section-header--button",onClick:this.onClickActionButton,tabIndex:0},this.props.actionButtonText)),i.default.createElement("div",{className:"notifications-tray-section-header"},i.default.createElement("span",{className:"notifications-tray-section-header--title"},this.props.sectionTitle),e)},t.prototype.onAckFactory=function(e){return function(t){t.stopPropagation(),a.default.acknowledge(e)}},t.prototype.render=function(){if(0===this.props.notifications.length)return null;for(var e=[],t=0,n=this.props.notifications;t<n.length;t++){var o=n[t],a=this.props.notifRenderFunc(o,!r.isUnread(o));null!=a&&e.push(i.default.createElement(s.NotificationRowWrapper,{onAcknowledge:this.onAckFactory(o),row:a,timestamp:r.getDisplayTime(o),unread:r.isUnread(o)}))}return i.default.createElement("div",null,this.renderReadSectionHeader(),e)},t})(i.default.Component),u=o.requireCssWithComponent(c,["/static/css/user_notifications_shared-vflmbX9tA.css"]);t.NotificationsTraySection=u})),define("modules/clean/react/user_notifications/single_task_preview",["require","exports","tslib","classnames","spectrum/checkbox","react"],(function(e,t,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i);var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.task,t=e.isComplete?"checked":"unchecked",n=i.default({"preview-single-task--text":!0,"preview-single-task--text--complete":e.isComplete});return a.default.createElement("div",{className:"preview-single-task"},a.default.createElement("div",null,a.default.createElement(o.Checkbox,{className:"preview-single-task--checkbox",checked:t,disabled:!0})),a.default.createElement("div",{className:n},e.name))},t})((a=n.__importDefault(a)).default.Component);t.SingleTaskPreview=r})),define("modules/clean/react/user_notifications/store",["require","exports","tslib","external/lodash","modules/clean/flux/flux_store","modules/clean/react/user_notifications/api_helper","modules/clean/react/user_notifications/constants","modules/clean/react/user_notifications/dispatcher","modules/clean/react/user_notifications/models"],(function(e,t,n,i,o,a,r,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i);var u=(function(e){function t(t){var i=e.call(this,t)||this;return i.markNotificationAsReadLocally=function(e){return c.isUnread(e)?n.__assign(n.__assign({},e),{status:c.NotificationStatuses.Read}):e},i.isLoadingFlag=!1,i.userNotifications=[],i}return n.__extends(t,e),t.prototype.isLoading=function(){return this.isLoadingFlag},t.prototype.getActionableCount=function(){return this.getUnseenInternal().length},t.prototype.getUnacknowledgedCount=function(){return this.getUnacknowledgedInternal().length},t.prototype.getCursor=function(){return this.cursor},t.prototype.getAll=function(){return this.userNotifications},t.prototype.getAllVisible=function(){return this.userNotifications.filter((function(e){return!c.isInvisible(e)}))},t.prototype.getUnacknowledged=function(){return this.getUnacknowledgedInternal()},t.prototype.getUnacknowledgedInternal=function(){return this.userNotifications.filter(c.isUnread)},t.prototype.getUnseen=function(){return this.getUnseenInternal()},t.prototype.getUnseenInternal=function(){return this.userNotifications.filter((function(e){return!c.isSeen(e)}))},t.prototype.onLoadRequest=function(){this.isLoadingFlag||(this.isLoadingFlag=!0,this.__emitChange())},t.prototype.onLoadSuccess=function(e){if(this.isLoadingFlag&&(this.isLoadingFlag=!1,this.__emitChange()),i.isEqual(e.cursor,this.cursor)||(this.cursor=e.cursor,this.__emitChange()),e.notifications.length>0){var t={};e.notifications.concat(this.userNotifications).forEach((function(e){t[c.getKey(e)]||(t[c.getKey(e)]=e)})),this.userNotifications=i.values(t).sort(a.userNotificationComparator),this.__emitChange()}},t.prototype.onLoadFailure=function(){this.isLoadingFlag&&(this.isLoadingFlag=!1,this.__emitChange())},t.prototype.onAcknowledgementRequest=function(){this.userNotifications=this.userNotifications.map(this.markNotificationAsReadLocally),this.__emitChange()},t.prototype.onAcknowledgementRequestSingle=function(e){var t=this;this.userNotifications=this.userNotifications.map((function(n){return n!==e?n:t.markNotificationAsReadLocally(e)})),this.__emitChange()},t.prototype.onMarkAsSeenRequest=function(){this.userNotifications=this.userNotifications.map((function(e){return c.isSeen(e)?e:n.__assign(n.__assign({},e),{seenState:c.NotificationSeenState.Seen})})),this.__emitChange()},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case r.ActionTypes.LOAD_REQUEST:this.onLoadRequest();break;case r.ActionTypes.LOAD_SUCCESS:this.onLoadSuccess(t.data);break;case r.ActionTypes.LOAD_FAILURE:this.onLoadFailure();break;case r.ActionTypes.ACKNOWLEDGEMENT_REQUEST:this.onAcknowledgementRequest();break;case r.ActionTypes.ACKNOWLEDGEMENT_REQUEST_SINGLE:this.onAcknowledgementRequestSingle(t.data.notifications[0]);break;case r.ActionTypes.MARK_AS_SEEN_REQUEST:this.onMarkAsSeenRequest()}},t})(o.FluxStore);t.UserNotificationsStore=u,t.userNotificationsStore=new u(s.userNotificationsDispatcher)})),define("modules/clean/react/user_notifications/thumbnail_preview",["require","exports","tslib","react","spectrum/file_icon","spectrum/icon_content"],(function(e,t,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i);var r={"paper-pad":"paper-small","paper-folder":"folder-small","dropbox-folder":"folder-small"},s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.object||{},t=e.type,n=e.name;return t&&n?i.default.createElement("div",{className:"preview-thumbnail--wrapper"},i.default.createElement("div",{className:"preview-thumbnail"},"dropbox-file"===t?i.default.createElement(o.FileIcon,{path:n,variant:"small",className:"preview-thumbnail--icon"}):i.default.createElement(a.IconContent,{name:r[t]||"unknown-small",className:"preview-thumbnail--icon"}),i.default.createElement("div",{className:"preview-thumbnail--text"},n))):null},t.displayName="ThumbnailPreview",t})(i.default.Component);t.ThumbnailPreview=s})),define("modules/clean/sprite",["require","exports","tslib","jquery","modules/clean/static_urls","modules/core/html"],(function(e,t,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i);var r={SPACER:o.static_url("/static/images/icons/icon_spacer-vflN3BYt2.gif"),CLASS_PREFIX:"s_",_make_class:function(e,t){return this.CLASS_PREFIX+e+"_"+t},src:function(e,t,n){return this.clear(e),i.default(e).addClass(this._make_class(t,n))},replace:function(e,t,n,o){return i.default(e).removeClass(this._make_class(t,n)).addClass(this._make_class(t,o))},clear:function(e){var t=this,n=e.className.split(" ");return n=i.default.grep(n,(function(e){return e&&0!==e.indexOf(t.CLASS_PREFIX)})),e.className=n.join(" ")},make:function(e,t,n){return n=this._prep_attrs(e,t,n),i.default("<img />",n)[0]},html:function(e,t,n){n=this._prep_attrs(e,t,n);var i=["<img "];for(var o in n)i.push(o,'="',a.HTML._raw_escape(n[o]),'" ');return i.push("/>"),new a.HTML(i.join(""))},_prep_attrs:function(e,t,n){void 0===n&&(n={}),n.src=n.src||this.SPACER;var i=["sprite","sprite_"+e,this._make_class(e,t)];return n.class&&i.push(n.class),n.class=i.join(" "),n},_get:function(e){return e.className},_set:function(e,t){return e.className=t,e.src=this.SPACER}};t.default=r}));
//# sourceMappingURL=pkg-notifications.min.js-vflHHRrJj.map