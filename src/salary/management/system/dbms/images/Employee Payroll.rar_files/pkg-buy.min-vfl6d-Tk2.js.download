define("modules/clean/auth/common/captcha",["require","exports","tslib","classnames","react","modules/clean/react/css","modules/clean/abuse/captcha_helper"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),t.get_captcha_responses=function(e){var t=e.getWrappedComponent();return{"g-recaptcha-response":t.recaptcha_response,"funcaptcha-response":t.funcaptcha_response}},t.handle_captcha_errors=function(e,t){return e.getWrappedComponent().handle_captcha_errors(t)},t.clear_captcha_response=function(e){return e.getWrappedComponent().clear_captcha_response()};var s=(function(t){function o(e){return t.call(this,e)||this}return r.__extends(o,t),o.prototype.handle_captcha_errors=function(t){var a=this;return!(!t||!t.funcaptcha_response)&&(new Promise((function(t,r){e(["modules/clean/abuse/funcaptcha_modal"],t,r)})).then(r.__importStar).then((function(e){(0,e.openFuncaptchaModal)(a.props.email||"",a.props.source,(function(e){a.funcaptcha_response=e,a.props.onSubmit()}))})),!0)},o.prototype.clear_captcha_response=function(){this.funcaptcha_response=void 0},o.prototype.componentDidMount=function(){i.LoadRecaptcha(void 0,!0)},o.prototype.render=function(){return n.default.createElement("div",{ref:"container_div",className:a.default({"recaptcha-v2-challenge-container":!0,"recaptcha-v2-challenge-container--invisible":!0})},n.default.createElement("div",{ref:"captcha_div",className:"recaptcha_v2_challenge"}))},o.prototype.submit=function(){this.clear_captcha_response(),this.props.onSubmit()},o})(n.default.Component);t.CaptchaComponent=s,t.Captcha=o.requireCssWithComponent(s,["/static/css/recaptcha-vflIN6j39.css"])})),define("modules/clean/auth/common/utils",["require","exports","modules/constants/page_load","modules/core/uri"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateId=function(e){return e+Math.random().toString().slice(2)};var n=["ja","ko","zh"];t.lastNameGoesFirst=function(){return n.includes(r.USER_LOCALE.slice(0,2))},t.isGoogleGrowthExperimentOn=function(e){return["GOOGLE2","GOOGLE3","MULTISTEP"].includes(e)},t.twoFactorRecoveryUrl=function(e,t){var r=new a.URI({path:"/twofactor_recovery"});return e&&r.updateQuery({remember_me:e.toString()}),t&&!["/",""].includes(t)&&r.updateQuery({cont:t}),r.toString()}})),define("modules/clean/components/password_strength_meter",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/react/css","modules/clean/react/bubble_dropdown_v2","modules/clean/web_timing_logger","modules/core/cancelable_promise","modules/clean/react/sticky_position"],(function(e,t,r,a,n,o,i,s,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n);var p=(function(t){function i(a){var n=t.call(this,a)||this;return n.setZxcvbn=function(e){var t=e.default;n.setState({zxcvbn:t})},n.getPasswordScore=function(e){return n.state.zxcvbn?n.state.zxcvbn(e).score:0},n.state={},a.zxcvbnPostTti?l.waitForTTI().then((function(){n.zxcvbnPromise=u.makeCancelable(new Promise((function(t,r){e(["zxcvbn"],t,r)})).then(r.__importStar)),n.zxcvbnPromise.then(n.setZxcvbn)})):(n.zxcvbnPromise=u.makeCancelable(new Promise((function(t,r){e(["zxcvbn"],t,r)})).then(r.__importStar)),n.zxcvbnPromise.then(n.setZxcvbn)),n}return r.__extends(i,t),i.prototype.componentWillUnmount=function(){this.zxcvbnPromise&&this.zxcvbnPromise.cancel()},i.prototype.render=function(){var e=this.props.password,t=e.length?Math.max(1,this.getPasswordScore(e)):0,r=["",o.intl.formatMessage({id:"i/ragh",defaultMessage:"Weak"}),o.intl.formatMessage({id:"GwYES8",defaultMessage:"So-so"}),o.intl.formatMessage({id:"Yd7c8F",defaultMessage:"Good"}),o.intl.formatMessage({id:"kbsmZh",defaultMessage:"Great!"})],i=this.props.bubbleDescription;return i||(i=o.intl.formatMessage({id:"6SDr7W",defaultMessage:"Passwords must be 6 characters or more. Good passwords are hard to guess and use uncommon words, numbers, symbols, and uppercase letters."})),a.default.createElement("div",{className:"password-input-meter "+this.props.className,tabIndex:-1,"aria-label":o.intl.formatMessage({id:"7h/xn+",defaultMessage:"Password strength"})},[4,3,2,1].map((function(e){var r=n.default({"password-input-dot":!0,"password-input-dot-selected--weak":t>=e&&t<=2,"password-input-dot-selected":t>=e});return a.default.createElement("div",{key:"password-input-dot-"+e,className:r})})),a.default.createElement(s.BubbleDropdown,{position:this.props.bubblePosition||c.StickyPosition.RIGHT,targetButton:a.default.createElement("button",{className:"password-bubble__button"}),className:this.props.bubbleClassName},a.default.createElement("div",{className:"password-bubble__content"},a.default.createElement("div",{className:"password-bubble__title"},r[t]||""),a.default.createElement("div",{className:"password-bubble__desc"},i))))},i})(a.default.Component);t.PasswordStrengthMeter=i.requireCssWithComponent(p,["/static/css/components/password_strength_meter-vflAqZDga.css"])})),define("modules/clean/react/payments/buy/components/buy_component",["require","exports","tslib","classnames","react","modules/core/i18n","modules/clean/web_timing_logger","modules/clean/react/payments/buy/components/headline","modules/clean/react/payments/buy/components/buy_navigation","react-intl","modules/clean/react/payments/buy/components/payments/async_sox_compliance_warning","modules/clean/react/rebrand/elements/rebrand_arbor_footer_components_lazy"],(function(e,t,r,a,n,o,i,s,l,u,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a);var d=(function(e){function t(t){return e.call(this,t)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){i.mark_time_to_interactive()},t.prototype.renderCheckOutForm=function(){var e=this.props,t=e.actions,r=e.checkoutFormProps,a=e.experiments,o=e.formData,i=e.pageState,s=e.pricingState,l=e.productPlanType,u=e.PurchaseFormComponent,c=e.showTrialVersion,p=e.useAUTaxInclusivePricing,d=e.userIsEligibleForProfessionalTrial;return n.default.createElement(u,{defaultPlan:r.defaultPlan,supportedProducts:r.supportedProducts,actions:t,braintreeClientToken:r.braintreeClientToken,ccIframeUrl:r.ccIframeUrl,continueURI:r.continueURI,countryList:r.countryList,currencyToFormatMap:r.currencyToFormatMap,experiments:a,formData:o,idealBanks:r.idealBanks,locale:r.locale,localeNumberFormat:r.localeNumberFormat,pageState:i,paymentMethodMapper:r.paymentMethodMapper,productPlanType:l,pricingState:s,taxNamesByCountry:r.taxNamesByCountry,userInfo:r.userInfo,showMarketingOptInIfNewAccount:r.showMarketingOptInIfNewAccount,showTrialVersion:c,useAUTaxInclusivePricing:!!p,userIsEligibleForProfessionalTrial:d,submitFormSuccess:i.submitFormSuccess})},t.prototype.render=function(){var e=this.props,t=e.checkoutFormProps.hideNavigationSteps,r=e.purchaseHeadline,i=e.SOXComplianceMessage,d=a.default({DropboxBuyPage__content:!0,grid__container:!0,"grid--x-left":!0});return n.default.createElement("main",{className:d},n.default.createElement(u.RawIntlProvider,{value:o.intl},i&&n.default.createElement(c.AsyncSOXComplianceBanner,{message:i}),n.default.createElement(s.DropboxBuyHeadlineWeb,{headlineText:r}),n.default.createElement(l.BuyNavigation,{hideSteps:t,currentStep:2}),n.default.createElement("section",{className:"DropboxBuyPage__form grid__container"},this.renderCheckOutForm()),n.default.createElement(p.LazyRebrandArborMinimalFooter,{localeSelectorWithoutCss:!0})))},t})((n=r.__importDefault(n)).default.Component);t.BuyComponent=d})),define("modules/clean/react/payments/buy/components/buy_page",["require","exports","tslib","classnames","react-intl","react","modules/clean/ajax","modules/clean/web_timing_logger","modules/core/i18n","modules/clean/react/payments/buy/components/buy_navigation","modules/clean/react/payments/buy/components/plan/plans","modules/clean/react/payments/buy/components/headline","modules/clean/react/rebrand/elements/rebrand_arbor_footer_components_lazy"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),o=r.__importDefault(o),i=r.__importStar(i),s=r.__importStar(s);var m=(function(e){function t(t){var a=e.call(this,t)||this,n=t.webTimingLoggerServerContext;return a.state={footerLinks:[]},n&&s.initialize_module(r.__assign({log_time_to_interactive:!0,log_time_to_view:!0,ttv_at_dom_interactive:!0,tti_at_dom_interactive:!0},n)),a}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;fetch("/buy/footer_links").then((function(e){return e.json()})).then((function(t){e.setState({footerLinks:t})})),i.SilentBackgroundRequest({url:"/growth/log_visit_ajax",type:"POST",data:r.__assign({endpoint:"buy",log_preauth:!0,additional_preauth_types:"preauth_pro_upgrade"},this.props.loggingProps)})},t.prototype.render=function(){var e=this.props,t=e.content,r=e.currentPlan,i=e.experiments,s=e.userIsEligibleForProfessionalTrial,m=this.state.footerLinks,f=a.default("DropboxBuyPage__content","grid__container","grid--x-left");return o.default.createElement(n.RawIntlProvider,{value:l.intl},o.default.createElement("div",{className:"DropboxBuyPage pro-buy-page-content"},o.default.createElement("main",{className:f},o.default.createElement(p.DropboxBuyHeadlineWeb,{headlineText:t.chooseHeadline}),o.default.createElement(u.BuyNavigation,{hideSteps:!1,currentStep:1}),o.default.createElement(c.Plans,{content:t,currentPlan:r,experiments:i,userIsEligibleForProfessionalTrial:s}),o.default.createElement(d.LazyRebrandArborFooter,{backgroundColor:"white",textColor:"black",content:m,localeSelectorWithoutCss:!0}))))},t})(o.default.Component);t.BuyPage=m,t.RootComponent=m})),define("modules/clean/react/payments/buy/components/checkout_page",["require","exports","tslib","react","modules/clean/ajax","modules/core/exception","modules/core/notify","modules/core/browser","modules/clean/payments/skus/pricing_data","modules/clean/payments/skus/subscription_change_plan","modules/clean/web_timing_logger","modules/clean/web_timing_logger","modules/clean/react/payments/common/adapters/setup_cash","modules/clean/react/payments/buy/state/checkout_store_creator","modules/clean/react/payments/buy/actions/buy_actions_creator","modules/clean/react/payments/buy/reducers/reducers","modules/clean/react/payments/buy/components/buy_component","modules/clean/react/payments/buy/components/buy_purchase_form","modules/clean/react/payments/buy/helpers/product_plan_helpers"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d,m,f,y,h,_,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importStar(n),o=r.__importStar(o),s=r.__importStar(s),c=r.__importStar(c);var v=(function(t){function v(a){var n,o=t.call(this,a)||this,i=a.checkoutFormProps,s=a.webTimingLoggerServerContext;d.setupCash(i.localeNumberFormat,i.currencyToFormatMap),s&&c.initialize_module(r.__assign({log_time_to_interactive:!0,log_time_to_view:!0,ttv_at_dom_interactive:!0,tti_at_dom_interactive:!0},s));var l=o.getStoreProps();return o.store=m.configureStore(l,y.proBuyReducer),o.state={checkoutStoreState:o.store.getState()},o.store.subscribe((function(){o.setState({checkoutStoreState:o.store.getState()})})),(null===(n=o.state.checkoutStoreState.pageState.marketingTracker)||void 0===n?void 0:n.initData)&&p.waitForTTI().then((function(){new Promise((function(t,r){e(["modules/clean/marketing_tracker"],t,r)})).then(r.__importStar).then((function(e){var t,r=e.MarketingTracker;(null===(t=o.state.checkoutStoreState.pageState.marketingTracker)||void 0===t?void 0:t.initData)&&r.push(o.state.checkoutStoreState.pageState.marketingTracker.initData)}))})),o}return r.__extends(v,t),v.prototype.getStoreProps=function(e){var t,r,a=this.props,n=a.checkoutFormProps,o=a.requestId,i=a.showTrialVersion,s=a.marketingTracker,l=n.defaultPlan,u=g.getProductPlanType(l),c={productPlanType:u,showTrialVersion:Boolean(i)},p=g.getSelectedUiProduct(n.supportedProducts,u);return{autocompleteForm:n.autocompleteForm,countryCode:n.countryCode,vat:n.vat,locale:n.locale,userInfo:n.userInfo,trialLength:p.trialInfo?p.trialInfo.trialDuration:0,serializedPaymentFormSpec:n.serializedPaymentFormSpec,serializedSubChangePlans:void 0,baseSubChangePlans:null===(r=null===(t=this.state)||void 0===t?void 0:t.checkoutStoreState)||void 0===r?void 0:r.pricingState.baseSubChangePlans,productPlanType:u,navState:c,showMarketingOptInIfNewAccount:n.showMarketingOptInIfNewAccount,showTrialVersion:c.showTrialVersion,requestId:o,marketingTracker:s}},Object.defineProperty(v.prototype,"actions",{get:function(){return f.bindProBuyActions(this.store)},enumerable:!0,configurable:!0}),v.prototype.componentDidMount=function(){var e="buy_"+this.props.checkoutFormProps.defaultPlan;n.SilentBackgroundRequest({url:"/growth/log_visit_ajax",type:"POST",data:r.__assign({endpoint:e,log_preauth:!0,additional_preauth_types:"preauth_pro_upgrade"},this.props.loggingProps)}),this.fetchInitialPlansData()},v.prototype.fetchInitialPlansData=function(){var e=this,t=Object.keys(this.props.checkoutFormProps.supportedProducts);n.WebRequest({url:"/pro/ajax_fetch_sub_change_plans",type:"POST",data:{product_plans:JSON.stringify(t)},success:function(t){var r=JSON.parse(t);if(0===r.length)i.Notify.error(l.PricingDataException.notifyErrorMessagePersonal,20),o.reportException({err:new Error("/pro/ajax_fetch_sub_change_plans returned 0 Subscription Change Plans"),severity:o.SEVERITY.NONCRITICAL});else{var a=r.map((function(e){return u.SubscriptionChangePlan.deserialize(e)}));e.actions.loadSubChangePlans(a)}},error:function(e,t,r){if("CurrencyMismatch"===r)s.redirect("/account/billing?modal=billing_info&reason=auto_convert");else if(0!==e.status){i.Notify.error(l.PricingDataException.notifyErrorMessagePersonal,20);var a="/pro/ajax_fetch_sub_change_plans failed to return Subscription Change Plans (status: "+e.status+")";o.reportException({err:new Error(a),severity:o.SEVERITY.CRITICAL})}}})},v.prototype.render=function(){var e=this.props,t=e.checkoutFormProps,n=e.experiments,o=e.purchaseHeadline,i=e.SOXComplianceMessage,s=e.useAUTaxInclusivePricing,l=e.userIsEligibleForProfessionalTrial,u=this.state.checkoutStoreState,c=u.navState,p=c.productPlanType,d=c.showTrialVersion,m=u.formData,f=u.pageState,y=u.pricingState,g={actions:this.actions,experiments:n,formData:m,pageState:f,productPlanType:p,showTrialVersion:d,SOXComplianceMessage:i,checkoutFormProps:t,PurchaseFormComponent:_.BuyPurchaseForm,purchaseHeadline:o,pricingState:y,useAUTaxInclusivePricing:s,userIsEligibleForProfessionalTrial:l};return a.default.createElement(h.BuyComponent,r.__assign({},g))},v})(a.default.Component);t.CheckoutPage=v,t.RootComponent=v})),define("modules/clean/react/payments/buy/components/headline",["require","exports","tslib","classnames","react"],(function(e,t,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),t.DropboxBuyHeadlineWeb=function(e){var t=e.headlineText,r=e.subheadlineText,o=a.default({DropboxBuyPage__headline:!0,grid__container:!0}),i=a.default({DropboxBuyPage__subheadline:!0,grid__container:!0}),s=r?n.default.createElement("h2",{className:i},r):null;return n.default.createElement(n.default.Fragment,null,n.default.createElement("h1",{className:o},t),s)}})),define("modules/clean/react/payments/buy/components/included_features",["require","exports","tslib","classnames","react"],(function(e,t,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),t.IncludedFeatures=function(e){var t=e.content,r=e.plusPlusCheckoutFeatures,o=a.default({"included-features":!0,grid__container:!0}),i=null!=r?r:t.items;return n.default.createElement("div",{className:o},n.default.createElement("p",{className:"included-features__title grid__item"},t.title),n.default.createElement("ul",{className:"included-features__list grid__container"},i.map((function(e,t){return n.default.createElement("li",{className:"included-features__feature grid__item--1-2",key:"included-"+t},e.text)}))))}})),define("modules/clean/react/payments/buy/components/buy_navigation",["require","exports","tslib","classnames","react","react-intl","spectrum-arbor/atoms/arbor_link"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n);var s=o.defineMessages({step:{id:"HfKKgw",defaultMessage:"Step {step}"},axLabel:{id:"cYlduc",defaultMessage:"Current step is {current_step} of {total_steps}"}});t.BuyNavigation=function(e){var t=e.currentStep,l=e.hideSteps,u=a.default("DropboxBuyPage__steps","grid__container"),c=a.default("DropboxBuyPage__step",{"DropboxBuyPage__step--currentStep":1===t,"DropboxBuyPage__step--clickable":2===t}),p=a.default("DropboxBuyPage__step",{"DropboxBuyPage__step--currentStep":2===t});return n.default.createElement("div",{className:u},l?null:n.default.createElement(n.default.Fragment,null,n.default.createElement("span",{className:"ax-visually-hidden"},n.default.createElement(o.FormattedMessage,r.__assign({},s.axLabel,{values:{current_step:t,total_steps:2}}))),n.default.createElement("span",{"aria-hidden":"true"},1===t?n.default.createElement("span",{className:c,"data-testid":"step",key:"step-1"},n.default.createElement(o.FormattedMessage,r.__assign({},s.step,{values:{step:1}}))):n.default.createElement(i.ArborLink,{className:c,"data-testid":"step",key:"step-1",href:"/buy"},n.default.createElement(o.FormattedMessage,r.__assign({},s.step,{values:{step:1}}))),n.default.createElement("span",{className:p,"data-testid":"step",key:"step-2"},n.default.createElement(o.FormattedMessage,r.__assign({},s.step,{values:{step:2}}))))))}})),define("modules/clean/react/payments/buy/components/plan/buy_plan",["require","exports","tslib","classnames","react-intl","react","modules/core/i18n","modules/clean/web_timing_logger","modules/clean/react/css","modules/clean/react/payments/buy/types/types","modules/clean/react/rebrand/elements/rebrand_buttons","modules/clean/react/payments/buy/components/plan/plan_card","spectrum-arbor/atoms/arbor_copy","spectrum-arbor/atoms/arbor_grid_element","spectrum-arbor/atoms/arbor_headline","spectrum-arbor/atoms/arbor_link","modules/clean/ts_utils"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d,m,f,y,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),o=r.__importDefault(o),s=r.__importStar(s);var _=n.defineMessages({whenBilledMonthly:{id:"l/iY2C",defaultMessage:"when billed monthly"},whenBilledYearly:{id:"z5Kari",defaultMessage:"when billed yearly"},priceText:{id:"/jhkvD",defaultMessage:"{price} / {duration}{line_break}({tax_string})"},orBuyNow:{id:"ccTmBg",defaultMessage:"or <a>buy {plan} now</a>"},gstIncludedMonthlyPriceText:{id:"E73zzX",defaultMessage:"{price} / month{line_break}({tax_string})"},gstIncludedMonthlyPriceTextAx:{id:"SK4S5K",defaultMessage:"{price} per month. {tax_string}"},primaryMonthlyPriceText:{id:"yCbN77",defaultMessage:"{price} / month"},primaryMonthlyPriceTextAx:{id:"DmMDME",defaultMessage:"{price} per month"},secondaryMonthlyPriceText:{id:"rLgZyR",defaultMessage:"{price} / month (save {savings})"},secondaryMonthlyPriceTextAx:{id:"ULSEEh",defaultMessage:"{price} per month. Save {savings}"},gstIncludedAnnualPriceText:{id:"J0oyWv",defaultMessage:"{price} / year{line_break}({tax_string})"},gstIncludedAnnualPriceTextAx:{id:"iLtYQ8",defaultMessage:"{price} per year. {tax_string}"},primaryAnnualPriceText:{id:"h3kG3E",defaultMessage:"{price} / year"},primaryAnnualPriceTextAx:{id:"5hvit0",defaultMessage:"{price} per year"},secondaryAnnualPriceText:{id:"fNvfPn",defaultMessage:"{price} / year (save {savings})"},secondaryAnnualPriceTextAx:{id:"xSnLZk",defaultMessage:"{price} per year. Save {savings}"}}),g=(function(e){function t(t){var r=e.call(this,t)||this;return r.state={namespace:"BuyPlan"},r}return r.__extends(t,e),t.prototype.isEligibleForTrialByTier=function(e){var t=this.props.userIsEligibleForProfessionalTrial;switch(e){case u.BuyPagePlanTiers.PROFESSIONAL:return t;case u.BuyPagePlanTiers.PLUS:case u.BuyPagePlanTiers.FAMILY:case u.BuyPagePlanTiers.TRANSFER:return!1;default:return h.enforceExhaustive(e),!1}},t.prototype.getPricingStrings=function(){var e,t,r,a=this.props.plan,n=a.priceMonthly,s=a.priceAnnual,l=a.gstIncluded;return l?(e=i.intl.formatMessage(_.priceText,{price:n.price,duration:n.duration,tax_string:l,line_break:"\n"}),r=i.intl.formatMessage(_.priceText,{price:n.price,duration:n.duration,tax_string:l,line_break:o.default.createElement("br",null)}),t=i.intl.formatMessage({id:"LciHZa",defaultMessage:"{price} per {duration}. {tax_string}"},{price:s.priceAsMonthly,duration:n.duration,tax_string:l})):(r=e=i.intl.formatMessage({id:"hc+1Ri",defaultMessage:"{price} / {duration}"},{price:s.priceAsMonthly,duration:n.duration}),t=i.intl.formatMessage({id:"paxTZY",defaultMessage:"{price} per {duration}"},{price:s.priceAsMonthly,duration:n.duration})),{primaryPrice:e,primaryPriceRichText:r,primaryPriceAx:t,secondaryPrice:i.intl.formatMessage({id:"YuTWxt",defaultMessage:"{price} / {duration} (save {savings})"},{price:s.price,duration:s.duration,savings:s.savings}),secondaryPriceAx:i.intl.formatMessage({id:"X8aFQg",defaultMessage:"{price} per {duration}. Save {savings}"},{price:s.price,duration:s.duration,savings:s.savings})}},t.prototype.renderCTA=function(){var e,t,n,s=this.props,l=s.plan,u=s.onClick,p=s.secondaryClick,f=s.disabled,h=s.href,g=s.secondaryHref,v=s.trackingId,b=s.secondaryTrackingId,P=s.experiments,S=this.state.namespace,C=f?i.intl.formatMessage({id:"fPUR43",defaultMessage:"Your current plan"}):l.cta.text,E={key:"primary",ariaLabel:f?i.intl.formatMessage({id:"cBVThZ",defaultMessage:"{plan_name} is your current plan"},{plan_name:l.name}):i.intl.formatMessage({id:"/LFPia",defaultMessage:"Select Dropbox {plan_name}"},{plan_name:l.name}),className:S+"__cta",importance:"primary",size:"medium",disabled:f,trackingId:v};if(u){var T=r.__assign({onClick:u,type:"button"},E);t=o.default.createElement(c.RebrandButton,r.__assign({},T),C)}else if(h){var w=r.__assign({href:h},E);t=o.default.createElement(c.RebrandButtonAnchor,r.__assign({},w),C)}if(this.isEligibleForTrialByTier(l.tier)&&(p||g)){var F=a.default(S+"__secondary-cta","button-as-link"),N=a.default(S+"__secondary-cta-text"),k=i.intl.formatMessage(_.orBuyNow,{a:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.default.createElement(y.ArborLink,{onClick:p,href:g,className:F,size:"micro",trackingId:b,clickEvent:"element_and_link_click"},e)},plan:l.namePrefixedWithDropbox});n=o.default.createElement(d.ArborCopy,{key:"secondary",tag:"p",size:"micro",className:N},k)}var M=P.familyPlanAcq||"OFF",I=a.default(S+"__cta-container",((e={})[S+"__cta-container__extra-padding"]=!n&&["CONTROL","OFF"].includes(M),e));return o.default.createElement(m.ArborGridElement,{key:"ctas",className:I,marginTopSize:"medium"},t,n)},t.prototype.componentDidMount=function(){s.mark_time_to_interactive()},t.prototype.render=function(){var e,t=this.state.namespace,r=this.props,a=r.hideDivider,n=r.plan,s=r.experiments,l=this.getPricingStrings(),c=n.name,m=["V1","V2"].includes(null!==(e=s.familyPlanAcq)&&void 0!==e?e:"OFF"),y=(function(e){switch(e){case u.BuyPagePlanTiers.PROFESSIONAL:return"dbx-blue";case u.BuyPagePlanTiers.PLUS:case u.BuyPagePlanTiers.FAMILY:case u.BuyPagePlanTiers.TRANSFER:return"panda-black";default:h.enforceExhaustive(e)}})(n.tier),_=o.default.createElement(o.default.Fragment,null,o.default.createElement(f.ArborHeadline,{"aria-hidden":"true",className:"plan-card__content_subheader--primary",tag:"h4"},l.primaryPriceRichText),o.default.createElement("span",{className:"ax-visually-hidden"},l.primaryPrice),o.default.createElement(d.ArborCopy,{tag:"p",size:"small",color:"shark",marginBottomSize:m?"small":"medium",marginTopSize:"none"},n.gstIncluded?null:i.intl.formatMessage({id:"evpR9Y",defaultMessage:"when billed yearly"})));return o.default.createElement(p.PlanCard,{classname:t+" "+t+"__"+c+" "+this.props.classname,title:c,eyebrowText:n.eyebrowText||"",planColor:y,hideDivider:a,primarySubheader:_,description:n.description,cardFeatures:n.cardFeatures||[],experiments:s},this.renderCTA())},t})(o.default.Component);t.BuyPlan=l.requireCssWithComponent(g,["/static/css/buy/components/buy_plan-vflKPQ2Wf.css","/static/js/spectrum-arbor/index.web-vflMipV2u.css"])})),define("modules/clean/react/payments/buy/components/plan/plan_card",["require","exports","tslib","react","classnames","spectrum-arbor/atoms/arbor_copy","spectrum-arbor/atoms/arbor_headline","spectrum-arbor/atoms/arbor_grid_element","spectrum-arbor/components/arbor_plan_card","spectrum-arbor/components/arbor_list","dig-components/icons/src","dig-components/icons","modules/constants/trademark","modules/clean/react/payments/buy/helpers/plans_util","modules/clean/react/css","modules/clean/web_timing_logger"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d,m,f,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),y=r.__importStar(y);var h=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){y.mark_time_to_interactive()},t.prototype.render=function(){var e,t=this.props,r=t.classname,f=t.cardFeatures,y=t.planColor,h=t.title,_=t.primarySubheader,g=t.description,v=t.hideDivider,b=t.eyebrowText,P=t.experiments,S=P.familyPlanAcq||"OFF",C=["V1","V2"].includes(S),E=n.default("plan-card__content",{"plan-card__content--extra-padding":C});if(C){var T=h===d.TRADEMARK_FAMILY?c.PersonMultipleLine:c.PersonLine,w=f.map((function(e){var t=m.getPlanCardFeatureIcon(e.icon);return{copy:e.text,size:"small",icon:a.default.createElement(p.UIIcon,{src:t}),marginTopSize:"small"}}));e=[a.default.createElement(s.ArborGridElement,{key:h},a.default.createElement(p.UIIcon,{src:T,className:"plan-card__icon"}),a.default.createElement(i.ArborHeadline,{tag:"h4",styleOverride:"title-3-5",marginBottomSize:"micro"},h),a.default.createElement(s.ArborGridElement,null,_),a.default.createElement(o.ArborCopy,{tag:"p",size:"small",marginBottomSize:"medium",className:"plan-card__content-description"},g),!v&&a.default.createElement("hr",{"aria-hidden":"true",className:"plan-card__content-divider"})),a.default.createElement(s.ArborGridElement,{className:"plan-card__highlights",key:"feature-highlights"},a.default.createElement(u.ArborList,{listItems:w,bulletStyle:"icon"})),a.default.createElement(a.default.Fragment,{key:"ctas"},this.props.children)]}else e=[a.default.createElement(s.ArborGridElement,{key:h},P.acqGrowthPlusPlusCopy&&a.default.createElement(o.ArborCopy,{marginBottomSize:"small","data-testid":"plan-card__eyebrow-text"},b),a.default.createElement(i.ArborHeadline,{tag:"h4",styleOverride:"title-3-5",marginBottomSize:"small"},h),a.default.createElement(s.ArborGridElement,null,_),!v&&a.default.createElement("hr",{"aria-hidden":"true",className:"plan-card__content-divider"}),a.default.createElement(o.ArborCopy,{tag:"p",size:"small",marginBottomSize:"medium",className:"plan-card__content-description"},g)),a.default.createElement(a.default.Fragment,{key:"ctas"},this.props.children)];return a.default.createElement(s.ArborGridElement,{className:r+" plan-card"},a.default.createElement(l.ArborPlanCard,{className:E,childSpacing:"flex-start",boxChildren:e,planColor:y,marginBottomSize:"large"}))},t})(a.default.PureComponent);t.PlanCard=f.requireCssWithComponent(h,["/static/css/growth_pages/plans/plan_card-vflqEvdFK.css"])})),define("modules/clean/react/payments/buy/components/plan/plan_card_and_reasons",["require","exports","tslib","react","classnames","dig-components/icons/src","dig-components/icons","spectrum-arbor/components/arbor_list","modules/clean/react/payments/buy/components/plan/buy_plan"],(function(e,t,r,a,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),t.PlanCardAndReasons=function(e){var t=e.plan,r=e.onClick,u=e.secondaryClick,c=e.disabled,p=e.href,d=e.secondaryHref,m=e.trackingId,f=e.secondaryTrackingId,y=e.userIsEligibleForProfessionalTrial,h=e.experiments,_=(h.acqGrowthPlusPlusCopy||h.familyPlanAcq)&&t.features||t.reasons,g=n.default({"DropboxBuyPage-plansAndReasons":!0,grid__item:!0,"grid__item--medium--5-12":!0,"grid__item--large--1-3":!0}),v=_.map((function(e,t){return{copy:e.text,size:"small",marginTopSize:"small",icon:a.default.createElement(i.UIIcon,{color:"#0061FF",src:o.CheckmarkLine}),key:"reason-"+t}}));return a.default.createElement("div",{className:g},a.default.createElement(l.BuyPlan,{trackingId:m,secondaryTrackingId:f,plan:t,onClick:r,secondaryClick:u,classname:"buy-plan",disabled:c,href:p,secondaryHref:d,experiments:h,userIsEligibleForProfessionalTrial:y}),a.default.createElement("span",{className:"ax-visually-hidden"},t.included.title),a.default.createElement(s.ArborList,{listItems:v,bulletStyle:"icon"}))}})),define("modules/clean/react/payments/buy/components/plan/plans",["require","exports","tslib","react","modules/clean/react/payments/buy/types/types","modules/clean/react/payments/buy/helpers/plans_util","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/components/plan/plan_card_and_reasons","modules/clean/react/growth_pages/components/pro_whispers_card","modules/clean/react/size_class/constants","spectrum/util/raf_throttle"],(function(e,t,r,a,n,o,i,s,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a);t.Plans=function(e){var t=e.content,r=e.currentPlan,p=e.experiments,d=e.userIsEligibleForProfessionalTrial,m={Professional:o.getBuyPlanContentFromMap(t,i.ProductPlanType.PROFESSIONAL),Plus:o.getBuyPlanContentFromMap(t,i.ProductPlanType.PLUS),Family:o.getBuyPlanContentFromMap(t,i.ProductPlanType.FAMILY_PAYER)},f=r===n.CheckoutPageProductPlan.PROFESSIONAL,y=r===n.CheckoutPageProductPlan.PLUS,h=r===n.CheckoutPageProductPlan.FAMILY,_="V1"===p.familyPlanAcq||"V2"===p.familyPlanAcq,g=a.useCallback((function(){var e=window.matchMedia(u.MEDIA_SIZE_CLASS_SMALL).matches,t=Array.from(document.querySelectorAll(".plan-card__content-description")),r=Array.from(document.querySelectorAll(".plan-card__highlights"));e?(t.forEach((function(e){return e.style.height="auto"})),r.forEach((function(e){return e.style.height="auto"}))):(o.findAndSetTallestHeight(t),o.findAndSetTallestHeight(r))}),[]);return a.useEffect((function(){g();var e=new c.RafThrottle(g).request;return window.addEventListener("resize",e),window.addEventListener("load",e),function(){window.removeEventListener("resize",e),window.removeEventListener("load",e)}}),[g]),a.default.createElement("section",{className:"DropboxBuyPage__plans grid__container"},a.default.createElement(s.PlanCardAndReasons,{plan:m.Plus,href:"/buy/plus",disabled:!f&&y,trackingId:"buy_page_select_plus",userIsEligibleForProfessionalTrial:d,experiments:p}),a.default.createElement("div",{className:"spacer grid__item--medium--1-24"}),_?a.default.createElement(s.PlanCardAndReasons,{plan:m.Family,href:"/buy/family",disabled:h,trackingId:"buy_page_select_family",userIsEligibleForProfessionalTrial:d,experiments:p}):y?a.default.createElement(s.PlanCardAndReasons,{plan:m.Professional,href:"/account/plan?modal=plan&option=pro",trackingId:"buy_page_select_pro",userIsEligibleForProfessionalTrial:d,experiments:p}):d?a.default.createElement(s.PlanCardAndReasons,{plan:m.Professional,href:"/pro/try",secondaryHref:"/buy/professional",disabled:f,trackingId:"buy_page_select_pro",secondaryTrackingId:"buy_page_select_pro_secondary",userIsEligibleForProfessionalTrial:!0,experiments:p}):a.default.createElement(s.PlanCardAndReasons,{plan:m.Professional,href:"/buy/professional",disabled:f,trackingId:"buy_page_select_pro",userIsEligibleForProfessionalTrial:!1,experiments:p}),_&&a.default.createElement(l.ProWhispersCard,{isPlus:y,userIsEligibleForProfessionalTrial:d}))}})),define("modules/clean/react/payments/common/middleware/pro_buy_logger",["require","exports","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/payment_form/payment_form_spec"],(function(e,t,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proBuyLogger=function(e){var t,o,i,s,l,u=["UpdateFirstName","UpdateLastName","UpdateEmail","UpdatePassword","UpdateZipCode","UpdateAccountHolderName","UpdateIBAN"];return function(c){return function(p){try{var d=c(p),m=p.type,f=e.getState(),y=f.pageState,h=f.pricingState,_=f.formData,g=f.navState,v=void 0;if(-1!==u.indexOf(m)&&o===m)return d;"UpdateTransitionsStart"===m?t=(new Date).getTime():"UpdateTransitionsSuccess"!==m&&"UpdateTransitionsError"!==m||(v=(((new Date).getTime()-t)/1e3).toFixed(1));var b={type:m,submitButtonState:y.submitting||h.loadingPrices?"disabled":"enabled"};if(void 0!==v&&(b.roundtrip=v),"UpdateSchedule"===m){var P="Unknown";_.scheduleId.rawValue===a.ScheduleId.MONTHLY?P="SelectMonthly":_.scheduleId.rawValue===a.ScheduleId.YEARLY&&(P="SelectYearly"),b.event=P}else if("UpdatePaymentMethod"===m){var S="Unknown";_.paymentMethod.rawValue===n.PaymentMethod.CreditCard?S="SelectCredit":_.paymentMethod.rawValue===n.PaymentMethod.PayPal?S="SelectPaypal":_.paymentMethod.rawValue===n.PaymentMethod.DirectDeposit?S="SelectDebit":_.paymentMethod.rawValue===n.PaymentMethod.Ideal&&(S="SelectIdeal"),b.event=S}else if("UpdateNonce"===m){var C=!1,E=_.nonce,T=E.isCCNValid,w=E.isCCodeValid,F=E.isCCExpValid;if(null!==i&&null!==l&&null!==s&&i===T&&l===w&&s===F&&(C=!0),i=T,l=w,s=F,C)return d;b.UpdateCC=T?"Valid":"Invalid",b.UpdateCVV=w?"Valid":"Invalid",b.UpdateExp=F?"Valid":"Invalid",o=m}return _.productPlanType.rawValue&&(b.productPlanType=_.productPlanType.rawValue,b.showTrialVersion=g&&g.showTrialVersion?"true":"false"),r.ProEventsLogger.log(r.ProEventNames.BUY_TRY_PAGE_CHECKOUT,b),-1!==u.indexOf(m)&&(o=m),d}catch(e){throw r.ProEventsLogger.log(r.ProEventNames.BUY_TRY_PAGE_CHECKOUT_CRASH,{action:p.type,error:e.stack||e.toString()}),e}}}}})),define("modules/clean/react/payments/buy/actions/buy_actions_creator",["require","exports","tslib","redux","modules/clean/react/payments/buy/actions/page_actions","modules/clean/react/payments/buy/actions/buy_form_actions","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/checkout/components/payment_method_form/apple_pay"],(function(e,t,r,a,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),n=r.__importStar(n),o=r.__importStar(o),i=r.__importStar(i),t.bindProBuyActions=function(e){return a.bindActionCreators(r.__assign(r.__assign({},t.SHARED_FORM_ACTIONS),{loadSubChangePlans:n.loadSubChangePlans,updateHistory:n.updateHistory,updateSelectedPlan:n.updateSelectedPlan}),e.dispatch)},t.SHARED_FORM_ACTIONS={updatePhone:i.updatePhone,blurPhone:i.blurPhone,updateCity:i.updateCity,blurCity:i.blurCity,updateName:i.updateName,blurName:i.blurName,updateAddress:i.updateAddress,blurAddress:i.blurAddress,showFormFieldErrors:i.showFormFieldErrors,submitCaptcha:i.submitCaptcha,submitProBuyForm:o.submitProBuyFormToServer,updateNonce:i.updateNonce,updatePayPalNonce:i.updatePayPalNonce,blurCCField:i.blurCCField,updateAdyenEncryptedCard:i.updateAdyenEncryptedCard,updateEncryptedCardForNetworkToken:i.updateEncryptedCardForNetworkToken,updateApplePayToken:i.updateApplePayToken,updateBrowserInfo:i.updateBrowserInfo,updateThreeDsData:i.updateThreeDsData,triggerThreeDsChallenge:i.triggerThreeDsChallenge,triggerThreeDsFingerprint:i.triggerThreeDsFingerprint,updateBIN:i.updateBIN,toggleExistingAccount:n.toggleSignInModal,updateCurrentPage:n.updateCurrentPage,updateFirstName:i.updateFirstName,updateLastName:i.updateLastName,updateEmail:i.updateEmail,updatePassword:i.updatePassword,updateSchedule:o.updateSchedule,updateProductPlantype:o.updateProductPlanType,updatePaymentMethod:i.updatePaymentMethod,updateCountryCode:o.updateCountryCode,updateZipCode:o.updateZipCode,blurZipCode:i.blurZipCode,updateVat:o.updateVat,blurVat:i.blurVat,updateCpf:i.updateCpf,blurCpf:i.blurCpf,updateCpfName:i.updateCpfName,updateAccountHolderName:i.updateAccountHolderName,blurAccountHolderName:i.blurAccountHolderName,updateIBAN:i.updateIBAN,blurIBAN:i.blurIBAN,updateMandateSigned:i.updateMandateSigned,updateMarketingOptIn:i.updateMarketingOptIn,updateIdealBank:o.updateIdealBank,updateTermsAndService:i.updateTermsAndService,updateEVH:o.updateEVH,paymentBannerError:i.paymentBannerError,applePayAction:s.applePayAction}})),define("modules/clean/react/payments/buy/actions/buy_form_actions",["require","exports","tslib","modules/clean/analytics","modules/clean/payments/payment_form/payment_form_spec","modules/clean/payments/skus/constants","modules/core/exception","modules/clean/react/payments/buy/actions/pricing_actions","modules/core/notify","modules/clean/web_register_logging_data","modules/clean/payments/skus/pricing_data","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/buy/helpers/product_plan_helpers","modules/clean/react/payments/buy/types/types"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d,m,f,y){"use strict";function h(e,t,r,a,o,i,s){void 0===o&&(o=!1),void 0===i&&(i=!0),void 0===s&&(s="OFF");var l=e.countryCode.formattedValue,u=["scheduleId","paymentMethod","countryCode"];return o||u.push("termsAndService"),r||(u.push("firstName","lastName","email","password"),a&&u.push("marketingOptIn")),t.allow_zip_code_for_country(l)&&u.push("zipCode"),t.should_show_vat_for_country(l)&&""!==e.vat.formattedValue&&u.push("vat"),t.should_require_cpf(l,e.paymentMethod.formattedValue)&&u.push("cpf"),e.paymentMethod.formattedValue===n.PaymentMethod.CreditCard?(u.push("nonce"),u.push("adyenEncryptedCard"),u.push("encryptedCardForNetworkToken"),u.push("browserInfo"),u.push("threeDsData"),i&&u.push("bin")):e.paymentMethod.formattedValue===n.PaymentMethod.PayPal?"ON"===s&&u.push("payPalNonce"):e.paymentMethod.formattedValue===n.PaymentMethod.DirectDeposit?u.push("accountHolderName","iban","mandateSigned"):e.paymentMethod.formattedValue===n.PaymentMethod.Ideal?u.push("idealBankId","idealBankName"):e.paymentMethod.formattedValue===n.PaymentMethod.ApplePay&&u.push("applePayToken"),u}var _;function g(e,t,a){return r.__awaiter(this,void 0,void 0,(function(){var n,i,s,l,c,p,d,m,y;return r.__generator(this,(function(r){return n=a.pageState,i=n.existingAccountShowing,s=n.requestId,l=n.submitSeq,c=e&&e.getScheduleId()===o.ScheduleId.MONTHLY?"monthly":"yearly",t.account_info_type=i?"existing":"new",t.billing_schedule=c,t.currency=e&&e.getCurrency(),t.expected_price=e&&e.getExpectedPriceToken(),t.plan_id=e&&e.transition.state.plan.id,t.tos_version="3",t.packrat=e&&e.hasPackrat(),t.addon_expected_price=e&&e.hasPackrat()&&e.getAddonExpectedPrice(),t.request_id=s,t.submit_seq=l,a.navState?(p=a.navState,d=p.showTrialVersion,m=p.productPlanType,y=f.getCheckoutPageProductPlan(m),t.expected_price_amount=e&&e.getTotalPrice().amount,t.product=v(y),t.signup_type=d?"trial":"purchase",t.signup_tag=b(y,d),[2,u.setWebRegisterLoggingData(t)]):[2,u.setWebRegisterLoggingData(t)]}))}))}function v(e){switch(e){case y.CheckoutPageProductPlan.PROFESSIONAL:return"pro";default:return e}}function b(e,t){switch(e){case y.CheckoutPageProductPlan.PLUS:return t?_.PLUS_TRY:_.PLUS_BUY;case y.CheckoutPageProductPlan.PROFESSIONAL:return t?_.PRO_TRY:_.PRO_BUY;default:return}}function P(e){return function(t){t(p.updateCountryCode(e)),t(s.updatePrice())}}function S(e){return function(t){t(p.updateZipCode(e)),t(s.updatePrice())}}function C(e){return function(t){t(p.updateVat(e)),t(s.updatePrice())}}function E(e){return function(t){t((function(e){return{type:d.FormActionEnum.UpdateEVH,value:e}})(e)),t(s.updateCurrentTransitionPrices())}}function T(e){return function(t){t((function(e){return{type:d.FormActionEnum.UpdateSchedule,value:e}})(e)),t(s.updateCurrentTransitionPrices())}}function w(e){return function(t){t(p.updateIdealBank(e))}}function F(e){return{type:d.FormActionEnum.UpdateProductPlanType,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),s=r.__importStar(s),p=r.__importStar(p),t.getFieldNamesToValidate=h,t.submitProBuyFormToServer=function(e){var t=e.additionalData,r=void 0===t?{}:t,n=e.allowSubmitWithoutTOS,o=e.captchaComponentRef,s=e.handle3DsMessage,u=e.enableBinRouting,p=e.prepareForSubmission,d=e.trigger,f=e.url,y=e.paymentPayPalV2Flow,_=void 0===y?"OFF":y;return function(e,t){var y,v=t(),b=v.formData,P=v.pageState.paymentFormSpec,S=v.pageState.existingAccountShowing,C=v.pageState.showMarketingOptInIfNewAccount,E=v.pricingState.subChangePlans;if(E){var T=b.scheduleId.formattedValue,w=b.evh.rawValue,F=E.filter((function(e){return!!e.finalSubState.plan&&(e.finalSubState.plan.billingSchedule.id===T&&!!e.finalSubState.addons.skus.length===w)})).pop();if(F){if(F.finalSubState.planSku.productType!==b.productPlanType.rawValue)return l.Notify.error(c.PricingDataException.notifyErrorMessagePersonal,20),void i.reportException({err:new Error("Intended product type to purchase does not match subscription change plan"),severity:i.SEVERITY.CRITICAL});y=F.tvm,r.sub_change_plan=JSON.stringify(F)}}var N=h(b,P,S,C,n,u,_);g(y,r,v).then((function(t){e(m.submitForm(f,N,p,t,o,s,d)),""!==v.formData.vat.formattedValue&&a.ProEventsLogger.log("vat_provided_on_initial_purchase",{})}))}},(function(e){e.PRO_BUY="pro_buy_register",e.PRO_TRY="pro_try_register",e.PLUS_BUY="plus_buy_register",e.PLUS_TRY="plus_try_register"})(_=t.SignupTags||(t.SignupTags={})),t.fillAdditionalData=g,t.getAdditionalDataProductTagField=v,t.getAdditionalDataSignupTagField=b,t.updateCountryCode=P,t.updateZipCode=S,t.updateVat=C,t.updateEVH=E,t.updateSchedule=T,t.updateIdealBank=w,t.updateProductPlanType=F,t.actionCreators={updateCountryCode:P,updateZipCode:S,updateVat:C,updateEVH:E,updateSchedule:T,updateIdealBank:w,updateProductPlanType:F}})),define("modules/clean/react/payments/buy/actions/page_actions",["require","exports","tslib","modules/clean/react/payments/buy/actions/pricing_actions","modules/clean/react/payments/buy/actions/buy_form_actions","modules/clean/dbmodal"],(function(e,t,r,a,n,o){"use strict";var i;function s(e,t){return{type:i.UpdateCurrentPage,productPlanType:e,showTrialVersion:Boolean(t)}}function l(e,t){return{type:i.UpdateTrialEndDate,trialDuration:e,locale:t}}function u(e){return function(t){t({type:i.LoadSubChangePlans,baseSubChangePlans:e}),t(a.updatePrice())}}Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),o=r.__importStar(o),(function(e){e.LoadSubChangePlans="LoadSubChangePlans",e.ToggleSignInModal="ToggleSignInModal",e.UpdateCurrentPage="UpdateCurrentPage",e.LoadCheckoutFormProps="LoadCheckoutFormProps",e.UpdateHistory="UpdateHistory",e.PaymentBannerError="PaymentBannerError",e.UpdateTrialEndDate="UpdateTrialEndDate"})(i=t.PageActionEnum||(t.PageActionEnum={})),t.toggleSignInModal=function(e){return function(t,r){r().pageState.userInfo.existingAccount?t({type:i.ToggleSignInModal,show:e}):new o.DBModal({element_id:"sign-in-modal",focus:"input[name='login_email']"}).show()}},t.updateCurrentPage=s,t.updateTrialEndDate=l,t.updateHistory=function(){return{type:i.UpdateHistory}},t.updateSelectedPlan=function(e,t,r,a){return function(o,i){o(s(e,a)),o(n.updateProductPlanType(e)),o(l(t,r));var c=i().pricingState;c.baseSubChangePlans&&o(u(c.baseSubChangePlans))}},t.loadSubChangePlans=u})),define("modules/clean/react/payments/buy/actions/pricing_actions",["require","exports","modules/clean/payments/skus/subscription_diff","modules/clean/payments/skus/subscription_service","modules/clean/react/growth_pages/promo/types"],(function(e,t,r,a,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.UpdateCurrentTransitionPrices="UpdateCurrentTransitionPrices",e.UpdateDisplayPrices="UpdateDisplayPrices",e.UpdateTransitionsStart="UpdateTransitionsStart",e.UpdateTransitionsSuccess="UpdateTransitionsSuccess",e.UpdateTransitionsError="UpdateTransitionsError"})(o=t.PricingActionEnum||(t.PricingActionEnum={}));var i=new a.SubscriptionService;function s(){return function(e,t){var a=t(),o=a.formData,s=a.pricingState,m=a.pageState,f={countryCode:o.countryCode.formattedValue,zipCode:o.zipCode.formattedValue,vat:o.vat.errorState?"":o.vat.formattedValue};if(e(l()),s.subChangePlans){var y=s.subChangePlans.map((function(e){return r.SubscriptionDiff.fromSubscriptionStatus(e)})),h=m.promoSpec&&m.promoSpec.cashCode&&m.promoSpec.id!==n.PromoSpecType.TRIAL?{cashCode:m.promoSpec.cashCode}:void 0;i.priceSet(y,f,h,!0).then((function(t){e(u(t)),e(p(t)),e(d(t))})).catch((function(t){e(c(t))}))}}}function l(){return{type:o.UpdateTransitionsStart}}function u(e){return{type:o.UpdateTransitionsSuccess,subChangePlans:e}}function c(e){return{type:o.UpdateTransitionsError,error:e}}function p(e){return{type:o.UpdateDisplayPrices,subChangePlans:e}}function d(e){return{type:o.UpdateCurrentTransitionPrices,subChangePlans:e}}t.updatePrice=s,t.updateTransitionsStart=l,t.updateTransitionsSuccess=u,t.updateTransitionsError=c,t.updateDisplayPrices=p,t.updateCurrentTransitionPrices=d,t.actionCreators={updatePrice:s,updateTransitionsStart:l,updateTransitionsSuccess:u,updateTransitionsError:c,updateDisplayPrices:p,updateCurrentTransitionPrices:d}})),define("modules/clean/react/payments/buy/state/checkout_store_creator",["require","exports","tslib","redux","redux-thunk","modules/clean/payments/payment_form/payment_form_spec","modules/clean/redux/unsupported","modules/clean/redux/devtools","modules/clean/react/payments/buy/actions/pricing_actions","modules/clean/react/payments/buy/actions/buy_form_actions","modules/clean/react/payments/buy/helpers/pricing_value_helper","modules/clean/payments/skus/subscription_change_plan","modules/clean/payments/skus/constants","modules/clean/react/payments/common/middleware/pro_buy_logger","modules/clean/react/payments/common/form_value_factory","modules/core/browser","modules/core/notify","modules/clean/react/payments/common/middleware/payments_ux_logger","modules/clean/react/payments/common/form/middleware/middleware","modules/clean/logging/hive/schemas/web-payments_ux_analytics"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d,m,f,y,h,_,g,v){"use strict";function b(e){return function(e){return function(t){if("SubmitFormError"!==t.type)return e(t);var r=e(t);return t.data&&t.data.error_message&&h.Notify.error(t.data.error_message),t.data.redirect&&y.redirect(t.data.redirect),r}}}function P(e){var t=S(e),r=C(e,t);return{pageState:t,pricingState:E(e,r),formData:r,navState:(function(e){var t=e.navState;return t||{productPlanType:0,showTrialVersion:!1}})(e)}}function S(e){var t=e.autocompleteForm,r=e.locale,a=e.userInfo,n=e.serializedPaymentFormSpec,i=e.showMarketingOptInIfNewAccount,s=e.requestId,l=e.promoSpec,u=e.marketingTracker;return{autocomplete:t,locale:r,userInfo:a,existingAccountShowing:a.existingAccount,paymentFormSpec:new o.PaymentFormSpec(n),submitFormSuccess:!1,showMarketingOptInIfNewAccount:i,requestId:s,submitSeq:0,submitting:!1,promoSpec:l,showBuyClickError:!1,marketingTracker:u,paypalEmail:""}}function C(e,t){var r=e.countryCode,a=e.userInfo,n=e.vat,o=e.trialLength,i=e.showTrialVersion,s=e.locale,l=a.fname||"",u=a.lname||"",c="";a.existingAccount||(c=a.email||"");var p,m=a.password||"",y=d.ScheduleId.YEARLY,h=e.productPlanType||d.ProductPlanType.STANDARD;p=i?t.paymentFormSpec.default_payment_method():t.paymentFormSpec.default_payment_method_for_country(r);var _=n||"";return{city:f.FormValueFactory.createCity(""),phone:f.FormValueFactory.createPhone(""),name:f.FormValueFactory.createName(""),address:f.FormValueFactory.createAddress(""),nonce:f.FormValueFactory.createNonce(""),payPalNonce:f.FormValueFactory.createPayPalNonce("",""),adyenEncryptedCard:f.FormValueFactory.createAdyenEncryptedCard(""),encryptedCardForNetworkToken:f.FormValueFactory.createEncryptedCardForNetworkToken("",""),applePayToken:f.FormValueFactory.createApplePayToken(""),bin:f.FormValueFactory.createBIN(""),browserInfo:f.FormValueFactory.createBrowserInfo(""),threeDsData:f.FormValueFactory.createThreeDsData(""),firstName:f.FormValueFactory.createInput(l),lastName:f.FormValueFactory.createInput(u),email:f.FormValueFactory.createEmail(c),password:f.FormValueFactory.createPassword(m),productPlanType:f.FormValueFactory.createProductPlanType(h),scheduleId:f.FormValueFactory.createSchedule(y),paymentMethod:f.FormValueFactory.createPaymentMethod(p,r,t.paymentFormSpec),countryCode:f.FormValueFactory.createCountryCode(r),zipCode:f.FormValueFactory.createZipCode("",r,t.paymentFormSpec),vat:f.FormValueFactory.createVat(_,r),cpf:f.FormValueFactory.createCpf("",void 0,!0),cpfName:f.FormValueFactory.createCpfNamePrefill("","",a.displayName,void 0,!0),accountHolderName:f.FormValueFactory.createInput(""),iban:f.FormValueFactory.createIBAN(""),mandateSigned:f.FormValueFactory.createCheckbox(!1),idealBankId:f.FormValueFactory.createIdealBankId(""),idealBankName:f.FormValueFactory.createIdealBankName(""),marketingOptIn:f.FormValueFactory.createCheckbox(!1,null,!0),termsAndService:f.FormValueFactory.createCheckbox(!1),evh:f.FormValueFactory.createCheckbox(!1),trialEndDate:f.FormValueFactory.createTrialEndDate(o,s)}}function E(e,t){var r,a=e.baseSubChangePlans,n=e.serializedSubChangePlans;return a?r=a.filter((function(t){return t.subState.planSku&&e.navState&&t.subState.planSku.productType===e.navState.productPlanType})):n&&(r=n.map((function(e){return p.SubscriptionChangePlan.deserialize(e)}))),{hasCurrencyChanged:!1,loadingPrices:void 0===r,requestToken:-1,subChangePlans:r,baseSubChangePlans:a,displayPrices:c.getDisplayPrices(r,t,e.promoSpec),currentTransitionPrices:c.getCurrentTransitionPrices(r,t)}}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),o=r.__importStar(o),t.submitFormErrorMiddleware=b,t.configureStore=function(e,t){var r=P(e),o=a.applyMiddleware(n.default,m.proBuyLogger,new _.PaymentsUXLogger(e.requestId,v.PaymentsUxPlatform.Legacy).reduxMiddleware,g.marketingEventMiddleware,b);return i.createStore(t,r,a.compose(o))},t.createState=P,t.createPageState=S,t.createFormState=C,t.createPricingState=E})),define("modules/clean/react/payments/buy/reducers/form_value_reducers",["require","exports","tslib","external/lodash","modules/clean/react/payments/common/form_values","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/form_value_factory","modules/clean/react/payments/common/payments/reducers/reducers","modules/clean/react/payments/buy/actions/page_actions","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/buy/actions/buy_form_actions"],(function(e,t,r,a,n,o,i,s,l,u,c){"use strict";function p(e,t){var r=a.assignIn({},e.formData,t),n=c.getFieldNamesToValidate(r,e.pageState.paymentFormSpec,e.pageState.existingAccountShowing,e.pageState.showMarketingOptInIfNewAccount),o=e.pageState.showBuyClickError&&!u.isValidSubmitState(r,n),i=a.assignIn({},e.pageState,{showBuyClickError:o});return a.assignIn({},e,{formData:r,pageState:i})}function d(e,t){return"UpdateFirstName"!==t.type?e:p(e,{firstName:i.FormValueFactory.createInput(t.value,e.formData.firstName)})}function m(e,t){return"UpdateLastName"!==t.type?e:p(e,{lastName:i.FormValueFactory.createInput(t.value,e.formData.lastName)})}function f(e,t){if("EmailTakenError"!==t.type)return e;var r=e.formData.email;return r.errorState=n.EmailErrorState.TakenError,r.showError=!0,p(e,{email:r})}function y(e,t){return"UpdateEmail"!==t.type?e:p(e,{email:i.FormValueFactory.createEmail(t.value,e.formData.email)})}function h(e,t){return"UpdatePassword"!==t.type?e:p(e,{password:i.FormValueFactory.createPassword(t.value,e.formData.password)})}function _(e,t){var r=e.formData.firstName.rawValue,a=e.formData.lastName.rawValue,n=e.pageState.userInfo.displayName;switch(t.type){case"UpdateCpfName":return p(e,{cpfName:i.FormValueFactory.createCpfName(t.value,e.formData.cpfName,!0)});case"UpdateFirstName":return e.formData.cpfName.manuallyEdited?e:p(e,{cpfName:i.FormValueFactory.createCpfNamePrefill(t.value,a,n,void 0,!0)});case"UpdateLastName":return e.formData.cpfName.manuallyEdited?e:p(e,{cpfName:i.FormValueFactory.createCpfNamePrefill(r,t.value,n,void 0,!0)});default:return e}}function g(e,t){if(t.type!==l.PageActionEnum.PaymentBannerError)return e;var r,n=a.assignIn({},e.pageState,{paymentBannerError:t.msg});e=a.assignIn({},e,{pageState:n});var o=document.getElementById("payment-info");if(!o)return e;var i=o.getBoundingClientRect().top;return void 0===r?r=i:i<r&&(r=i),void 0!==r&&scrollBy({top:r-150,behavior:"smooth"}),e}function v(e,t){return"UpdateProductPlanType"!==t.type?e:p(e,{productPlanType:i.FormValueFactory.createProductPlanType(t.value)})}function b(e,t){return"UpdateSchedule"!==t.type?e:p(e,{scheduleId:i.FormValueFactory.createSchedule(t.value)})}function P(e,t){return t.type!==u.FormActionEnum.UpdateEVH?e:p(e,{evh:i.FormValueFactory.createCheckbox(t.value,e.formData.evh)})}function S(e,t){return t.type!==u.FormActionEnum.UpdateAddress?e:p(e,{address:i.FormValueFactory.createAddress(t.value,e.formData.address)})}function C(e,t){return t.type!==u.FormActionEnum.UpdatePhone?e:p(e,{phone:i.FormValueFactory.createPhone(t.value,e.formData.phone)})}function E(e,t){return t.type!==u.FormActionEnum.UpdateName?e:p(e,{name:i.FormValueFactory.createName(t.value,e.formData.name)})}function T(e,t){return t.type!==u.FormActionEnum.UpdateCity?e:p(e,{city:i.FormValueFactory.createCity(t.value,e.formData.city)})}function w(e,t){if(t.type!==u.FormActionEnum.UpdatePaymentMethod&&t.type!==u.FormActionEnum.UpdateCountryCode)return e;var r=e.formData,a=e.pageState,n=t.type===u.FormActionEnum.UpdatePaymentMethod?t.value:r.paymentMethod.rawValue,o=r.countryCode.formattedValue;return p(e,{paymentMethod:i.FormValueFactory.createPaymentMethod(n,o,a.paymentFormSpec,r.paymentMethod)})}function F(e,t){return t.type!==u.FormActionEnum.UpdateCountryCode?e:p(e,{countryCode:i.FormValueFactory.createCountryCode(t.value,e.formData.countryCode)})}function N(e,t){if(t.type!==u.FormActionEnum.UpdateZipCode&&t.type!==u.FormActionEnum.UpdateCountryCode)return e;var r=t.type===u.FormActionEnum.UpdateZipCode?t.value:e.formData.zipCode.rawValue,a=e.formData.countryCode.formattedValue;return p(e,{zipCode:i.FormValueFactory.createZipCode(r,a,e.pageState.paymentFormSpec,e.formData.zipCode)})}function k(e,t){if(t.type!==u.FormActionEnum.UpdateVat&&t.type!==u.FormActionEnum.UpdateCountryCode)return e;var r=t.type===u.FormActionEnum.UpdateVat?t.value.toUpperCase():e.formData.vat.rawValue,a=e.formData.countryCode.formattedValue;return p(e,{vat:i.FormValueFactory.createVat(r,a,e.formData.vat)})}function M(e,t){if(t.type!==u.FormActionEnum.UpdateCpf)return e;return p(e,{cpf:i.FormValueFactory.createCpf(t.value,e.formData.cpf,!0)})}function I(e,t){if(t.type!==u.FormActionEnum.UpdateNonce)return e;return p(e,{nonce:i.FormValueFactory.createNonce(t.value,t.creditCardIframeFields,e.formData.nonce,!0)})}function x(e,t){return t.type!==u.FormActionEnum.UpdateBIN?e:p(e,{bin:i.FormValueFactory.createBIN(t.value,e.formData.bin)})}function V(e,t){return t.type!==u.FormActionEnum.UpdateAccountHolderName?e:p(e,{accountHolderName:i.FormValueFactory.createInput(t.value,e.formData.accountHolderName)})}function D(e,t){return t.type!==u.FormActionEnum.UpdateIBAN?e:p(e,{iban:i.FormValueFactory.createIBAN(t.value,e.formData.iban)})}function A(e,t){return t.type!==u.FormActionEnum.UpdateMandateSigned?e:p(e,{mandateSigned:i.FormValueFactory.createCheckbox(t.value,e.formData.mandateSigned)})}function B(e,t){return t.type!==u.FormActionEnum.UpdateMarketingOptIn?e:p(e,{marketingOptIn:i.FormValueFactory.createCheckbox(t.value,e.formData.marketingOptIn,!0)})}function U(e,t){return t.type!==u.FormActionEnum.UpdateTermsAndService?e:p(e,{termsAndService:i.FormValueFactory.createCheckbox(t.value,e.formData.termsAndService)})}function O(e,t){return t.type!==l.PageActionEnum.UpdateTrialEndDate?e:p(e,{trialEndDate:i.FormValueFactory.createTrialEndDate(t.trialDuration,t.locale)})}function L(e,t){if(t.type!==u.FormActionEnum.UpdateIdealBank)return e;var r=t.value,a=r.bankId,n=r.bankName;return p(e,{idealBankId:i.FormValueFactory.createIdealBankId(a,e.formData.idealBankId),idealBankName:i.FormValueFactory.createIdealBankName(n,e.formData.idealBankName)})}Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),n=r.__importStar(n),t.AccountReducers=[d,m,y,h,_,f],t.PlanReducers=[v,b,P],t.PaymentReducers=[F,w,N,k,M,_,I,s.updatePayPalNonce,s.updateAdyenEncryptedCard,s.updateEncryptedCardForNetworkToken,s.updateApplePayToken,x,s.updateBrowserInfo,s.updateThreeDsData,V,D,A,L,T,S,C,E,g],t.OrderSummaryReducers=[U,B,O],t.FormInputReducers=[q,H,z,Y],t.updateFirstName=d,t.updateLastName=m,t.emailAlreadyTakenError=f,t.updateEmail=y,t.updatePassword=h,t.updateCpfName=_,t.paymentBannerError=g,t.updateProductPlanType=v,t.updateSchedule=b,t.updateEVH=P,t.updateAddress=S,t.updatePhone=C,t.updateName=E,t.updateCity=T,t.updatePaymentMethod=w,t.updateCountryCode=F,t.updateZipCode=N,t.updateVat=k,t.updateCpf=M,t.updateNonce=I,t.updateBIN=x,t.updateAccountHolderName=V,t.updateIBAN=D,t.updateMandateSigned=A,t.updateMarketingOptIn=B,t.updateTOS=U,t.updateTrialEndDate=O,t.updateIdealBank=L;var R={firstName:"fname",lastName:"lname",email:"account-email",password:"password",name:"name",nonce:"iframe-holder",countryCode:"country_code",address:"address",zipCode:"zip",city:"city",accountHolderName:"owner_name",iban:"iban",mandateSigned:"mandate_signed",idealBankId:"ideal_bank",vat:"vat",cpf:"cpf"};function q(e,t){if(t.type!==u.FormActionEnum.ShowFormFieldErrors)return e;var n=r.__assign({},e.formData);e=a.assignIn({},e,{formData:n});for(var i,s=[],l=0,c=t.fieldNames;l<c.length;l++){var p=c[l],d=n[p];d&&!o.FormValueHelper.isValid(d)&&(n[p]=a.assignIn({},n[p],{showError:!0}),s.push(p))}var m=e.pageState.showBuyClickError;if("SubmitForm"===t.origin){m=!0;for(var f=0,y=s;f<y.length;f++){var h=y[f];if(R[h]){var _=document.getElementById(R[h]);if(_){var g=_.getBoundingClientRect().top;void 0===i?i=g:g<i&&(i=g)}}}void 0!==i&&scrollBy({top:i-150,behavior:"smooth"})}var v=a.assignIn({},e.pageState,{showBuyClickError:m});return e=a.assignIn({},e,{pageState:v})}function H(e,t){if(t.type!==u.FormActionEnum.SubmitFormStart)return e;var r=a.assignIn({},e.pageState,{submitting:!0,submitSeq:e.pageState.submitSeq+1});return a.assignIn({},e,{pageState:r})}function z(e,t){return t.type!==u.FormActionEnum.SubmitFormSuccess?e:r.__assign(r.__assign({},e),{pageState:r.__assign(r.__assign({},e.pageState),{submitFormSuccess:!0,submitting:!1})})}function Y(e,t){if(t.type!==u.FormActionEnum.SubmitFormError)return e;var r=a.assignIn({},e.pageState,{submitting:!1});return a.assignIn({},e,{pageState:r})}t.showFormFieldErrors=q,t.submitFormStart=H,t.submitFormSuccess=z,t.submitFormError=Y})),define("modules/clean/react/payments/buy/reducers/page_reducers",["require","exports","modules/clean/react/payments/buy/actions/page_actions"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.existingAccountShowing=function(e,t){switch(void 0===e&&(e=!1),t.type){case r.PageActionEnum.ToggleSignInModal:return(function(e,t){return void 0!==t.show?t.show:!e})(e,t);default:return e}}})),define("modules/clean/react/payments/buy/reducers/pricing_reducers",["require","exports","tslib","external/lodash","modules/clean/react/payments/buy/helpers/pricing_value_helper","modules/clean/react/payments/buy/actions/pricing_actions"],(function(e,t,r,a,n,o){"use strict";function i(e,t){if(t.type!==o.PricingActionEnum.UpdateTransitionsStart)return e;var r=a.assignIn({},e.pricingState,{loadingPrices:!0});return a.assignIn({},e,{pricingState:r})}function s(e,t){if(t.type!==o.PricingActionEnum.UpdateTransitionsSuccess)return e;var r=!1;if(t.subChangePlans&&e.pricingState.subChangePlans){var n=e.pricingState.subChangePlans[0].tvm,i=t.subChangePlans[0].tvm,s=n&&n.getCurrency(),l=i&&i.getCurrency();r=e.pricingState.hasCurrencyChanged||s!==l}var u=a.assignIn({},e.pricingState,{loadingPrices:!1,hasCurrencyChanged:r,subChangePlans:t.subChangePlans});return a.assignIn({},e,{pricingState:u})}function l(e,t){if(t.type!==o.PricingActionEnum.UpdateDisplayPrices)return e;var r=e.pageState.promoSpec,i=t.subChangePlans,s=n.getDisplayPrices(i,e.formData,r),l=a.assignIn({},e.pricingState,{displayPrices:s});return a.assignIn({},e,{pricingState:l})}function u(e,t){if(t.type!==o.PricingActionEnum.UpdateCurrentTransitionPrices)return e;var r=t.subChangePlans||e.pricingState.subChangePlans,i=n.getCurrentTransitionPrices(r,e.formData),s=a.assignIn({},e.pricingState,{currentTransitionPrices:i});return a.assignIn({},e,{pricingState:s})}Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),t.TransitionManagementReducers=[i,s],t.PricingManagementReducers=[l,u],t.updateTransitionsStart=i,t.updateTransitionsSuccess=s,t.updateDisplayPrices=l,t.updateCurrentTransitionPrices=u})),define("modules/clean/react/payments/buy/reducers/nav_reducer",["require","exports","modules/clean/react/payments/buy/actions/page_actions"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.navReducer=function(e,t){return t.type!==r.PageActionEnum.UpdateCurrentPage?e:{productPlanType:t.productPlanType,showTrialVersion:t.showTrialVersion}}})),define("modules/clean/react/payments/buy/reducers/reducers",["require","exports","tslib","redux","modules/clean/react/payments/buy/reducers/form_value_reducers","modules/clean/react/payments/buy/reducers/pricing_reducers","modules/clean/react/payments/buy/reducers/page_reducers","modules/clean/react/payments/buy/reducers/nav_reducer","modules/clean/react/payments/buy/actions/page_actions"],(function(e,t,r,a,n,o,i,s,l){"use strict";function u(e){return function(t,r){return Object.assign({},t,e(t,r))}}function c(e,t){if(t.type!==l.PageActionEnum.LoadSubChangePlans)return e;var a=r.__assign({},e.pricingState);return a.baseSubChangePlans=t.baseSubChangePlans,a.subChangePlans=t.baseSubChangePlans.filter((function(t){var r;return(null===(r=t.subState.planSku)||void 0===r?void 0:r.productType)===e.navState.productPlanType})),r.__assign(r.__assign({},e),{pricingState:r.__assign({},a)})}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),o=r.__importStar(o),t.loadSubChangePlans=c,t.proBuyReducer=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(r,a){return t(e(r,a),a)}}))}.apply(void 0,r.__spreadArrays([a.combineReducers({formData:function(e,t){return void 0===e&&(e={}),e},pageState:u(a.combineReducers({existingAccountShowing:i.existingAccountShowing})),pricingState:function(e,t){return void 0===e&&(e={}),e},navState:u(s.navReducer)}),c],n.AccountReducers,n.PlanReducers,n.PaymentReducers,n.OrderSummaryReducers,n.FormInputReducers,o.TransitionManagementReducers,o.PricingManagementReducers))})),define("modules/clean/react/payments/buy/types/types",["require","exports","modules/clean/payments/skus/constants"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.PROFESSIONAL="PROFESSIONAL",e.PLUS="PLUS",e.FAMILY="FAMILY",e.TRANSFER="TRANSFER"})(t.BuyPagePlanTiers||(t.BuyPagePlanTiers={})),(function(e){e.PLUS="plus",e.PROFESSIONAL="professional",e.FAMILY="family",e.TRANSFER="transfer",e.BACKUP="backup"})(t.CheckoutPageProductPlan||(t.CheckoutPageProductPlan={})),(function(e){e.ROW="row",e.COLUMN="column"})(t.FormVariant||(t.FormVariant={}))})),define("modules/clean/react/growth_pages/promo/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.NOT_APPLICABLE=0]="NOT_APPLICABLE",e[e.EXTRA_TIME_MONTHS=1]="EXTRA_TIME_MONTHS",e[e.EXPERIMENTAL_PLAN=2]="EXPERIMENTAL_PLAN",e[e.PERCENT_DISCOUNT_PRETAX=3]="PERCENT_DISCOUNT_PRETAX",e[e.TRIAL=4]="TRIAL"})(t.PromoSpecType||(t.PromoSpecType={}))})),define("modules/clean/react/payments/buy/components/buy_purchase_form",["require","exports","tslib","react","react-intl","classnames","ts-key-enum","modules/core/i18n","modules/clean/raf_throttle","modules/clean/auth/common/captcha","modules/clean/web_timing_logger","modules/clean/analytics","modules/clean/react/payments/buy/components/account/new_account_input","modules/clean/react/payments/buy/components/plan/schedule_selection","modules/clean/react/payments/buy/components/payments/buy_payment_info_section","modules/clean/react/payments/buy/components/payments/order_summary/order_summary","modules/clean/react/payments/buy/components/payments/worldpay_entity_info","modules/clean/react/payments/buy/components/plan/plan_selection","modules/clean/react/payments/buy/types/types","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form/actions/actions","modules/core/exception","modules/clean/react/payments/buy/components/included_features","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/helpers/product_plan_helpers","modules/clean/react/payments/buy/components/account/new_account_input_utils"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d,m,f,y,h,_,g,v,b,P,S,C,E,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),o=r.__importDefault(o),c=r.__importStar(c),P=r.__importStar(P);var w=(function(e){function t(t){var r=e.call(this,t)||this;r.paymentSection=a.default.createRef(),r.variant=g.FormVariant.ROW,r.setCaptchaComponent=function(e){r.captchaComponent=e},r.submitForm=function(e){var t,a=((t={})[v.PaymentMethod.CreditCard]="/pro/ajax_buy",t[v.PaymentMethod.PayPal]="/pro/ajax_paypal_buy",t[v.PaymentMethod.DirectDeposit]="/payments/ajax_sepa_buy",t[v.PaymentMethod.Ideal]="/payments/ajax_ideal_buy",t[v.PaymentMethod.ApplePay]="/pro/ajax_buy",t);r.onSubmitProBuyForm({trigger:e,url:a[r.props.formData.paymentMethod.formattedValue]})},r.handleSubmitTryForm=function(e){e.preventDefault(),r.onSubmitFormWithCaptchaScore()},r.submitTryForm=function(e){var t,a=r.state.selectedProduct;p.ProEventsLogger.log("clicked_start_free_trial_cta_"+a.name.toLowerCase());var n=((t={})[v.PaymentMethod.CreditCard]="/pro/ajax_try",t[v.PaymentMethod.PayPal]="/pro/ajax_paypal_try",t[v.PaymentMethod.TokenConnect]="/pro/ajax_try",t);r.onSubmitProBuyForm({trigger:e,url:n[r.props.formData.paymentMethod.formattedValue]})},r.onSubmitProBuyForm=function(e){var t=e.trigger,a=e.url,n=r.props.promoSpec,o={cont:r.props.continueURI,is_pro_buy_form:!0,send_conversion_data:!0};r.saveState(),n&&(o.is_pro_buy_form=!1,o.promo_ids=n.id,n.cashCode&&(o.code=n.cashCode)),r.props.actions.submitProBuyForm({additionalData:o,allowSubmitWithoutTOS:!1,captchaComponentRef:r.captchaComponent,handle3DsMessage:r.paymentInfoSection.getCreditCardFrame().handle3DsMessage,enableBinRouting:!0,prepareForSubmission:r.prepareForSubmission.bind(r),trigger:t,url:a,paymentPayPalV2Flow:r.props.experiments.paymentPayPalV2Flow})},r.onSubmitFormWithCaptchaScore=function(){r.captchaComponent&&r.captchaComponent.getWrappedComponent().submit()},r.resubmitForm=function(e){void 0===e&&(e=b.SubmitFormTriggerType.ButtonClick),r.props.showTrialVersion?r.submitTryForm(e):r.submitForm(e)},r.handleChange=function(){var e="none";if(window.innerWidth>=736){var t=r.state.elementPositions,a=window.pageYOffset||document.documentElement.scrollTop,n=t.columnTop-r.stickyColumnBuffer,o=t.paymentSectionTop-r.stickyColumnBuffer;e=a>=n&&a<=o?"fixed":a>o?"flex-end":"flex-start"}r.state.stickyElementState!==e&&r.setState({stickyElementState:e})},r.handleResize=function(){r.getElementPositions()},r.getElementPositions=function(){var e=r.paymentSection;if(e&&e.current){var t=r.summaryColumn.getBoundingClientRect(),a=r.stickyElement.getBoundingClientRect(),n=e.current.getBoundingClientRect(),o={columnTop:t.top+window.pageYOffset,columnLeft:t.left+window.pageXOffset,columnWidth:t.width,paymentSectionTop:n.top+window.pageYOffset,stickyElementHeight:a.height,windowWidth:document.documentElement.clientWidth};r.setState({elementPositions:o},r.handleChange)}},r.onLoginClick=function(){p.GrowthEventsLogger.log("buy_checkout_sign_in_modal",{action:"click",location:"in_product"}),r.props.actions.toggleExistingAccount()},r.toggleExistingAccount=function(){r.props.actions.toggleExistingAccount(!1)},r.handlePress=function(e){e.key===i.Key.Enter&&e.target instanceof Element&&("INPUT"===e.target.tagName||"SELECT"===e.target.tagName)&&(e.preventDefault(),r.onSubmitFormWithCaptchaScore())},r.scrollThrottle=new l.RafThrottle(r.handleChange),r.resizeThrottle=new l.RafThrottle(r.handleResize),r.stickyColumnBuffer=50;var n=E.getSelectedUiProduct(r.props.supportedProducts,r.props.productPlanType);if(r.state={stickyElementState:"flex-start",elementPositions:{columnTop:250,columnLeft:45,columnWidth:500,paymentSectionTop:900,stickyElementHeight:550,windowWidth:1e3},hasLoadedSubChangePlans:!1,selectedProduct:n},r.props.showTrialVersion){var o=r.props.pageState.paymentFormSpec;r.props.actions.updatePaymentMethod(o.default_payment_method())}return r.variant=r.props.variant?r.props.variant:g.FormVariant.ROW,r}return r.__extends(t,e),t.prototype.prepareForSubmission=function(){return this.paymentInfoSection.prepareForSubmission()},t.prototype.getValue=function(e,t){var r=this.props.pageState.paymentFormSpec.get_token_connect_data(e);if(null!=r)return r;if(void 0!==sessionStorage){var a=sessionStorage.getItem(e);if(null!=a)return a}return t},t.prototype.loadState=function(){try{if(void 0===sessionStorage&&void 0===this.props.pageState.paymentFormSpec.spec.token_connect_prefill_data)return;this.props.actions.updateFirstName(this.getValue("firstName",this.props.formData.firstName.rawValue)),this.props.actions.updateLastName(this.getValue("lastName",this.props.formData.lastName.rawValue)),this.props.actions.updateEmail(this.getValue("email",this.props.formData.email.rawValue)),this.props.actions.updateZipCode(this.getValue("zipCode",this.props.formData.zipCode.rawValue));var e=this.getValue("countryCode",this.props.formData.countryCode.rawValue);this.props.actions.updateCountryCode(e);var t=Number(this.getValue("paymentMethod",""+this.props.formData.paymentMethod.rawValue));this.props.pageState.paymentFormSpec.available_payment_methods_for_country(e).includes(t)&&this.props.actions.updatePaymentMethod(t)}catch(e){P.reportException({err:new Error("Error loading payment state"+e.message),severity:P.SEVERITY.NONCRITICAL})}},t.prototype.saveState=function(){try{if(void 0===sessionStorage)return;sessionStorage.setItem("firstName",this.props.formData.firstName.rawValue),sessionStorage.setItem("lastName",this.props.formData.lastName.rawValue),sessionStorage.setItem("email",this.props.formData.email.rawValue),sessionStorage.setItem("zipCode",this.props.formData.zipCode.rawValue),sessionStorage.setItem("countryCode",this.props.formData.countryCode.rawValue),sessionStorage.setItem("paymentMethod",""+this.props.formData.paymentMethod.rawValue)}catch(e){P.reportException({err:new Error("Error saving payment state"+e.message),severity:P.SEVERITY.NONCRITICAL})}},t.prototype.componentDidMount=function(){c.mark_time_to_interactive(),this.getElementPositions(),window.addEventListener("resize",this.resizeThrottle.request),this.variant===g.FormVariant.ROW&&window.addEventListener("scroll",this.scrollThrottle.request),"orientation"in window&&window.addEventListener("orientationchange",this.resizeThrottle.request),this.loadState()},t.prototype.componentDidUpdate=function(e,t){var r=this.props,a=r.pricingState,n=r.productPlanType,o=r.supportedProducts;!this.state.hasLoadedSubChangePlans&&a.currentTransitionPrices.totalPrice&&(this.handleResize(),this.setState({hasLoadedSubChangePlans:!0})),e.productPlanType!==n&&this.setState({selectedProduct:E.getSelectedUiProduct(o,n)})},t.prototype.componentWillUnmount=function(){window.removeEventListener("scroll",this.scrollThrottle.request),window.removeEventListener("resize",this.resizeThrottle.request)},t.prototype.renderPaymentForm=function(){var e=this,t=this.props,r=t.actions,o=t.ccIframeUrl,i=t.countryList,l=t.experiments,u=t.idealBanks,c=t.locale,p=t.formData,y=t.pageState,h=t.pricingState,v=t.showTrialVersion,b=t.useAUTaxInclusivePricing,P=t.userIsEligibleForProfessionalTrial,S=t.braintreeClientToken,C=t.defaultPlan,E=t.supportedProducts,w=t.promoSpec,F=this.state.selectedProduct,I=function(e){return void 0===e&&(e=!0),e?n.defineMessage({id:"uR6YMd",defaultMessage:"{index}. Choose your space"}):s.intl.formatMessage({id:"ix4+1x",defaultMessage:"Choose your space"})},x=function(e){return void 0===e&&(e=!0),e?n.defineMessage({id:"xs62vu",defaultMessage:"{index}. Choose your billing cycle"}):s.intl.formatMessage({id:"r4whCV",defaultMessage:"Choose your billing cycle"})},V=function(e){return void 0===e&&(e=!0),e?n.defineMessage({id:"DcuOhc",defaultMessage:"{index}. Create your account"}):s.intl.formatMessage({id:"QEa1gY",defaultMessage:"Create your account"})},D=function(e){return void 0===e&&(e=!0),e?n.defineMessage({id:"2/IxPb",defaultMessage:"{index}. Enter payment details"}):s.intl.formatMessage({id:"yxgpXI",defaultMessage:"Enter payment details"})},A=void 0,B=C===g.CheckoutPageProductPlan.PLUS,U=F.productPlan===g.CheckoutPageProductPlan.PLUS&&v;!B||U||w||(A=function(e,t){return a.default.createElement(N,{index:e,key:"choose-space-section-"+e,modifier:"plan-selection",title:I(t)},a.default.createElement(_.PlanSelection,{actions:r,locale:c,productPlanType:p.productPlanType.rawValue,showPlanNameUnderRadio:!1,defaultPlan:C,supportedProducts:E,userIsEligibleForProfessionalTrial:P}))});var O=h.subChangePlans?void 0:{monthlyPrice:F.priceMonthly.price,annualPriceAsMonthly:F.priceAnnual.priceAsMonthly,yearlyPrice:F.priceAnnual.price,yearlyWithoutSavings:F.priceAnnual.withoutSavings,yearlySavings:F.priceAnnual.savings},L=a.default.createElement(m.ScheduleSelection,{actions:r,displayPrices:h.displayPrices,formData:p,initialPricingStrings:O,locale:c,useAUTaxInclusivePricing:b,showTrialVersion:v,paymentSchedule:F.paymentSchedule,showYearlyPricePerMonth:Boolean(F.showYearlyPricePerMonth)}),R=void 0;if(!y.userInfo.email){var q=a.default.createElement(M,{onClick:this.onLoginClick,linkKey:"existing_account",linkText:n.defineMessage({id:"jofRGL",defaultMessage:"or <existing_account>use existing Dropbox account</existing_account>"})});R=function(t,n){return a.default.createElement(k,{index:t,key:"create-account-section-"+t,link:q,title:V(n)},a.default.createElement(d.NewAccountInput,{actions:r,autocomplete:y.autocomplete,formData:p,firstNameError:T.firstNameErrorMessage(p.firstName),lastNameError:T.lastNameErrorMessage(p.lastName),emailError:T.emailErrorMessage(p.email,e.toggleExistingAccount),passwordError:T.passwordErrorMessage(p.password)}))}}var H=a.default.createElement(f.PaymentInfoSection,{paymentSpec:y.paymentFormSpec,iframeUrl:o,idealBanks:u,countryList:i,formData:p,vatEnabled:Boolean(F.vatEnabled),actions:r,ref:function(t){e.paymentInfoSection=t},showTrialVersion:v,hidePaymentMethodSelector:!1,userInfo:y.userInfo,submitForm:this.resubmitForm,paymentPayPalV2Flow:l.paymentPayPalV2Flow,braintreeClientToken:S,paymentBannerError:y.paymentBannerError,planNamePrefixedWithDropbox:F.namePrefixedWithDropbox,price:this.props.pricingState.currentTransitionPrices}),z=[A,function(e,t){return a.default.createElement(N,{index:e,key:"billing-schedule-section-"+e,modifier:"schedule-selection",title:x(t)},L)},R,function(t,r){return a.default.createElement(N,{forwardRef:e.paymentSection,index:t,key:"payment-section-"+t,modifier:"billing",title:D(r)},H)}],Y=[],j=1;return z.forEach((function(e){e&&(Y.push(e(j,!0)),j+=1)})),a.default.createElement("form",{className:"payment-form grid__container",method:"post",onKeyPress:this.handlePress},Y)},t.prototype.renderWorldpayEntityText=function(){return-1===t.excludeWorldpayEntityTextForCountry.indexOf(this.props.formData.countryCode.formattedValue)?a.default.createElement(h.WorldPayEntityInfo,null):null},Object.defineProperty(t.prototype,"containerColumnStyle",{get:function(){if(this.variant===g.FormVariant.COLUMN)return{minWidth:"100%"};var e=this.state,t=e.elementPositions,a=e.stickyElementState,n="flex-start",o={msFlexAlign:"start"};if("flex-end"===a&&(n="flex-end",o={msFlexAlign:"end"}),"none"!==a){var i=t.paymentSectionTop-t.columnTop+t.stickyElementHeight;return r.__assign({height:i,alignItems:n},o)}return{alignItems:n,width:t.windowWidth,maxWidth:t.windowWidth}},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,r=t.actions,n=t.experiments,i=t.formData,s=t.pageState,l=t.pricingState,c=t.productPlanType,p=t.promoSpec,d=t.showMarketingOptInIfNewAccount,m=t.showTrialVersion,f=t.taxNamesByCountry,h=this.state,_=h.elementPositions,v=h.selectedProduct,b=h.stickyElementState,P=this.variant===g.FormVariant.COLUMN,E={};"fixed"===b&&(E={position:"fixed",top:this.stickyColumnBuffer,left:_.columnLeft,width:_.columnWidth});var T=v.included,w=m?this.handleSubmitTryForm:this.onSubmitFormWithCaptchaScore,F=n.acqGrowthPlusPlusCopy&&c===C.ProductPlanType.PLUS?v.checkoutFeatures:void 0;return a.default.createElement("div",{className:o.default("PurchaseForm","grid__container")},a.default.createElement("div",{className:o.default("grid__item",{"grid__item--medium--11-24":!P})},this.renderPaymentForm()),!P&&a.default.createElement("div",{className:"grid__item--medium--1-12"}),a.default.createElement("div",{className:o.default("grid__item","PurchaseForm__summary-col",{"grid__item--medium--11-24":!P,"PurchaseForm__summary-col--full":P}),style:this.containerColumnStyle,ref:function(t){e.summaryColumn=t}},a.default.createElement("div",{className:"grid__item",style:E,ref:function(t){e.stickyElement=t}},a.default.createElement("div",{className:"grid__item"},a.default.createElement(y.OrderSummary,{actions:r,buyLink:v.pageUrl.buyLink,formVariant:this.variant,formData:i,currentTransitionPrices:l.currentTransitionPrices,isLoadingPrices:l.loadingPrices,onClick:w,pageState:s,planColor:v.planColor,planName:v.name,planNamePrefixedWithDropbox:v.namePrefixedWithDropbox,taxNamesByCountry:f,showMarketingOptInIfNewAccount:d,showTrialVersion:m,promoSpec:p})),T&&a.default.createElement(S.IncludedFeatures,{content:T,plusPlusCheckoutFeatures:F}))),a.default.createElement("div",{className:"grid__item"},this.renderWorldpayEntityText()),a.default.createElement(u.Captcha,{ref:this.setCaptchaComponent,source:"BUY_PURCHASE_FORM",onSubmit:this.resubmitForm,email:this.props.pageState.userInfo.email||this.props.formData.email.formattedValue}))},t.excludeWorldpayEntityTextForCountry=["US","CA","MX"],t})(a.default.Component);t.BuyPurchaseForm=w;var F=function(){return a.default.createElement("hr",{"aria-hidden":"true",className:"payment-form__divider grid__item payment-form__divider"})},N=function(e){var t=e.children,n=e.forwardRef,o=e.index,i=e.modifier,l=e.title,u=r.__assign({className:"payment-form__section--"+i+" grid__item"},n?{ref:n}:{});return a.default.createElement("section",r.__assign({},u),a.default.createElement(F,null),a.default.createElement("div",{className:"payment-form__header grid__item"},"string"==typeof l?l:s.intl.formatMessage(l,{index:o})),t)},k=function(e){var t=e.index,r=e.link,n=e.title,o=e.children;return a.default.createElement("section",{className:"payment-form__section grid__item"},a.default.createElement(F,null),a.default.createElement("div",{className:"payment-form__header grid__container grid--x-bookend"},a.default.createElement("div",{className:"payment-form__header--account"},"string"==typeof n?n:s.intl.formatMessage(n,{index:t})),r),o)},M=function(e){var t,n=e.linkText,o=e.linkKey,i=e.onClick,l=e.otherFormatters,u=void 0===l?{}:l;return a.default.createElement("div",{className:"payment-form__login"},s.intl.formatMessage(n,r.__assign(((t={})[o]=function(e){return a.default.createElement("button",{"aria-label":"",key:"account-toggle",className:"account-toggle button--as-link",onClick:i,type:"button"},e)},t),u)))}})),define("modules/clean/react/payments/buy/components/account/new_account_input",["require","exports","tslib","react","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/components/password_strength_meter","modules/clean/react/payments/buy/components/account/new_account_input_utils","modules/clean/auth/common/utils","classnames"],(function(e,t,r,a,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),l=r.__importDefault(l);var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onFirstNameChanged=function(e){t.props.actions.updateFirstName(e.value)},t.onFirstNameBlur=function(e){t.props.actions.showFormFieldErrors(["firstName"],"FirstNameBlur")},t.onLastNameChanged=function(e){t.props.actions.updateLastName(e.value)},t.onLastNameBlur=function(e){t.props.actions.showFormFieldErrors(["lastName"],"LastNameBlur")},t.onEmailChanged=function(e){t.props.actions.updateEmail(e.value)},t.onEmailBlur=function(e){t.props.actions.showFormFieldErrors(["email"],"EmailBlur")},t.onPasswordChanged=function(e){t.props.actions.updatePassword(e.value)},t.onPasswordBlur=function(e){t.props.actions.showFormFieldErrors(["password"],"PasswordBlur")},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.autocomplete,r=e.emailError,u=e.firstNameError,c=e.formData,p=e.lastNameError,d=e.passwordError,m=s.lastNameGoesFirst(),f=a.default.createElement(n.LabeledTextInput,{name:"fname",autocomplete:t?"given-name":"off",labelText:i.accountLabels.firstName,containerClassName:l.default("grid__item--fluid",{"grid__item--margin-right--1-24":!m}),value:c.firstName.rawValue,onBlur:this.onFirstNameBlur,onChange:this.onFirstNameChanged,errorText:u}),y=a.default.createElement(n.LabeledTextInput,{name:"lname",autocomplete:t?"family-name":"off",labelText:i.accountLabels.lastName,containerClassName:l.default("grid__item--fluid",{"grid__item--margin-right--1-24":m}),value:c.lastName.rawValue,onBlur:this.onLastNameBlur,onChange:this.onLastNameChanged,errorText:p});return a.default.createElement("div",{className:"grid__item account-info grid__item--large--11-12"},a.default.createElement("div",{className:"account-info__name grid__container grid--x-bookend grid--y-top"},m?a.default.createElement(a.default.Fragment,null,y,f):a.default.createElement(a.default.Fragment,null,f,y)),a.default.createElement("div",{className:"account-info__cred grid__container grid--x-bookend grid--y-top"},a.default.createElement(n.LabeledTextInput,{name:"account-email",autocomplete:t?"email":"off",type:"email",labelText:i.accountLabels.email,containerClassName:"grid__item--fluid grid__item--margin-right--1-24",value:c.email.rawValue,onBlur:this.onEmailBlur,onChange:this.onEmailChanged,errorText:r}),a.default.createElement("div",{className:"account-info__password grid__item--fluid"},a.default.createElement(o.PasswordStrengthMeter,{password:c.password.rawValue}),a.default.createElement(n.LabeledTextInput,{name:"password",type:"password",autocomplete:"new-password",labelText:i.accountLabels.password,containerClassName:"grid__item",value:c.password.rawValue,onChange:this.onPasswordChanged,onBlur:this.onPasswordBlur,errorText:d}))))},t})(a.default.Component);t.NewAccountInput=u})),define("modules/clean/react/payments/buy/components/account/new_account_input_utils",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/form_values"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),i=r.__importStar(i),t.accountLabels={firstName:n.intl.formatMessage({id:"MF/EZ0",defaultMessage:"First name"}),lastName:n.intl.formatMessage({id:"o/EyS0",defaultMessage:"Last name"}),email:n.intl.formatMessage({id:"ycH5zr",defaultMessage:"Email"}),password:n.intl.formatMessage({id:"Dj00Xc",defaultMessage:"Password"})},t.firstNameErrorMessage=function(e){return e.showError&&!o.FormValueHelper.isValid(e)?n.intl.formatMessage({id:"first name",defaultMessage:"Please enter a valid first name."}):""},t.lastNameErrorMessage=function(e){return e.showError&&!o.FormValueHelper.isValid(e)?n.intl.formatMessage({id:"last name",defaultMessage:"Please enter a valid last name."}):""},t.passwordErrorMessage=function(e){return e.showError?n.intl.formatMessage({id:"y53jZ7",defaultMessage:"Passwords must be 6 characters or more."}):""},t.emailErrorMessage=function(e,t){if(!e.showError)return"";switch(e.errorState){case i.EmailErrorState.Empty:return n.intl.formatMessage({id:"uRA/73",defaultMessage:"Please enter an email address."});case i.EmailErrorState.NoAt:return n.intl.formatMessage({id:"JfCj3L",defaultMessage:"An email address must contain a single @"});case i.EmailErrorState.BadUsername:var r=e.formattedValue.split("@")[0];return n.intl.formatMessage({id:"YkS8kL",defaultMessage:"The username portion of the email address is invalid (the portion before the @: {username})."},{username:r});case i.EmailErrorState.BadDomain:var o=e.formattedValue.split("@")[1];return""===o?n.intl.formatMessage({id:"9wdsbq",defaultMessage:"The domain portion of the email address is invalid (the portion after the @)."}):n.intl.formatMessage({id:"HwUfO2",defaultMessage:"The domain portion of the email address is invalid (the portion after the @: {domain})."},{domain:o});case i.EmailErrorState.TakenWarning:return a.default.createElement("span",null,n.intl.formatMessage({id:"KP0Yzf",defaultMessage:"This e-mail is already taken."}));case i.EmailErrorState.TakenError:return a.default.createElement("span",null,n.intl.formatMessage({id:"KANDIa",defaultMessage:"This e-mail is already taken. <a_signin>Sign in</a_signin> or <a_forgot>reset your password</a_forgot>."},{a_signin:function(e){return a.default.createElement("a",{key:"a-signin",className:"login-register-switch-link",onClick:t},e)},a_forgot:function(e){return a.default.createElement("a",{key:"a-forgot",href:"/forgot"},e)}}));default:return""}}})),define("modules/clean/react/payments/buy/components/plan/schedule_selection",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/components/inputs/inputs"],(function(e,t,r,a,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n);var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onScheduleChange=function(e,r,a){var n=e.currentTarget;a=a||n.value;var o=parseInt(a,10);o!==t.props.formData.scheduleId.formattedValue&&t.props.actions.updateSchedule(o)},t.onPlanLabelClick=function(e){e!==t.props.formData.scheduleId.formattedValue&&t.props.actions.updateSchedule(e)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.actions,r=e.paymentSchedule;r&&"monthly"===r&&t.updateSchedule(i.ScheduleId.MONTHLY)},t.prototype.getPricingStrings=function(){var e,t,r,a,n,i,s,l=this.props.initialPricingStrings;if(l)e=o.intl.formatMessage({id:"6tPzCg",defaultMessage:"{price} / year"},{price:l.yearlyPrice}),a=o.intl.formatMessage({id:"KTUKSV",defaultMessage:"{price} per year. Save {savings}"},{price:l.yearlyPrice,savings:l.yearlySavings}),t=o.intl.formatMessage({id:"4IZRvO",defaultMessage:"{price} / month"},{price:l.monthlyPrice}),n=o.intl.formatMessage({id:"NCPpB8",defaultMessage:"{price} per month"},{price:l.monthlyPrice}),r=o.intl.formatMessage({id:"6tPzCg",defaultMessage:"{price} / year"},{price:l.yearlyWithoutSavings}),i=o.intl.formatMessage({id:"4IZRvO",defaultMessage:"{price} / month"},{price:l.annualPriceAsMonthly}),s=o.intl.formatMessage({id:"pmkY4K",defaultMessage:"{price} per month when billed yearly"},{price:l.annualPriceAsMonthly});else{var u=this.props.displayPrices,c=u.yearlyPrice,p=u.monthlyPrice,d=u.yearlySavings,m=u.taxInclusiveYearlyPrice,f=u.taxInclusiveMonthlyPrice,y=u.taxInclusiveYearlySavings;this.props.useAUTaxInclusivePricing?(e=o.intl.formatMessage({id:"6tPzCg",defaultMessage:"{price} / year"},{price:m?m.formatCurrency():""}),a=o.intl.formatMessage({id:"fTrTN2",defaultMessage:"{price} per year. Save {savings}. Prices include GST"},{price:m?m.formatCurrency():"",savings:y?y.formatCurrency():""}),t=o.intl.formatMessage({id:"4IZRvO",defaultMessage:"{price} / month"},{price:f?f.formatCurrency():""}),n=o.intl.formatMessage({id:"/Ww02p",defaultMessage:"{price} per month. Includes GST"},{price:f?f.formatCurrency():""}),r=o.intl.formatMessage({id:"6tPzCg",defaultMessage:"{price} / year"},{price:f?f.multiply(12).formatCurrency():""}),i=o.intl.formatMessage({id:"4IZRvO",defaultMessage:"{price} / month"},{price:m?m.divide(12).formatCurrency():""}),s=o.intl.formatMessage({id:"pmkY4K",defaultMessage:"{price} per month when billed yearly"},{price:m?m.divide(12).formatCurrency():""})):(e=o.intl.formatMessage({id:"6tPzCg",defaultMessage:"{price} / year"},{price:c?c.formatCurrency():""}),a=o.intl.formatMessage({id:"KTUKSV",defaultMessage:"{price} per year. Save {savings}"},{price:c?c.formatCurrency():"",savings:d?d.formatCurrency():""}),t=o.intl.formatMessage({id:"4IZRvO",defaultMessage:"{price} / month"},{price:p?p.formatCurrency():""}),n=o.intl.formatMessage({id:"NCPpB8",defaultMessage:"{price} per month"},{price:p?p.formatCurrency():""}),r=o.intl.formatMessage({id:"6tPzCg",defaultMessage:"{price} / year"},{price:p?p.multiply(12).formatCurrency():""}),i=o.intl.formatMessage({id:"4IZRvO",defaultMessage:"{price} / month"},{price:c?c.divide(12).formatCurrency():""}),s=o.intl.formatMessage({id:"pmkY4K",defaultMessage:"{price} per month when billed yearly"},{price:c?c.divide(12).formatCurrency():""}))}return{yearlyPrice:e,yearlyPriceAx:a,monthlyPrice:t,monthlyPriceAx:n,yearlyPriceNoSavings:r,yearlyGstIncluded:o.intl.formatMessage({id:"iBp3QN",defaultMessage:"(prices include GST)"}),monthlyGstIncluded:o.intl.formatMessage({id:"XfS7WN",defaultMessage:"(includes GST)"}),yearlyPricePerMonth:i,yearlyPricePerMonthAx:s}},t.prototype.renderYearlyPlanBlock=function(){var e=this,t=this.props,r=t.locale,l=t.showYearlyPricePerMonth,u=this.props.formData.scheduleId.formattedValue,c=this.getPricingStrings(),p=c.yearlyPrice,d=c.yearlyPriceAx,m=c.yearlyPriceNoSavings,f=c.yearlyGstIncluded,y=c.yearlyPricePerMonth,h=c.yearlyPricePerMonthAx,_=c.monthlyGstIncluded,g=n.default({"plan-info__savings":!0,"plan-info__savings--strike":"en"===r}),v="en"===r?m:o.intl.formatMessage({id:"rOFcNI",defaultMessage:"(includes 2 free months)"}),b=a.default.createElement("span",{id:"plan-info__label--yearly",className:"plan-info__label plan-info__label--yearly",onClick:function(){return e.onPlanLabelClick(i.ScheduleId.YEARLY)},"aria-hidden":"true"},o.intl.formatMessage({id:"VeKS9s",defaultMessage:"Billed Yearly"})),P=l?y:p;return a.default.createElement("div",{className:"plan-info__choice plan-info__yearly"},a.default.createElement(s.LabeledRadioInput,{name:"schedule_id",inputId:"plan-info__radio--yearly",ariaLabelId:"plan-info__label--yearly",className:"plan-info__radio",labelClassName:"plan-info__container",value:i.ScheduleId.YEARLY.toString(),checked:u===i.ScheduleId.YEARLY,labelSpan:b,onClickOrChange:this.onScheduleChange}),a.default.createElement("div",{className:"plan-info__subtitle","aria-hidden":"true"},P),a.default.createElement("span",{className:"ax-visually-hidden"},l?h:d),!l&&a.default.createElement("div",{"aria-hidden":"true",className:g},v),this.props.useAUTaxInclusivePricing&&a.default.createElement("div",{className:"plan-info__subtitle","aria-hidden":"true"},l?_:f))},t.prototype.renderMonthlyPlanBlock=function(){var e=this,t=this.props.formData.scheduleId.formattedValue,r=this.getPricingStrings(),n=r.monthlyPrice,l=r.monthlyPriceAx,u=r.monthlyGstIncluded,c=a.default.createElement("span",{id:"plan-info__label--monthly",className:"plan-info__label plan-info__label--monthly",onClick:function(){return e.onPlanLabelClick(i.ScheduleId.MONTHLY)},"aria-hidden":"true"},o.intl.formatMessage({id:"Fb6V6v",defaultMessage:"Billed Monthly"}));return a.default.createElement("div",{className:"plan-info__choice plan-info__monthly"},a.default.createElement(s.LabeledRadioInput,{name:"schedule_id",inputId:"plan-info__radio--monthly",ariaLabelId:"plan-info__label--monthly",className:"plan-info__radio",labelClassName:"plan-info__container",value:i.ScheduleId.MONTHLY.toString(),checked:t===i.ScheduleId.MONTHLY,labelSpan:c,onClickOrChange:this.onScheduleChange}),a.default.createElement("div",{className:"plan-info__subtitle","aria-hidden":"true"},n),a.default.createElement("span",{className:"ax-visually-hidden"},l),this.props.useAUTaxInclusivePricing&&a.default.createElement("div",{className:"plan-info__subtitle","aria-hidden":"true"},u))},t.prototype.render=function(){var e=this.props.paymentSchedule;return e&&"yearly"===e?a.default.createElement("div",{className:"grid__container plan-info"},this.renderYearlyPlanBlock()):e&&"monthly"===e?a.default.createElement("div",{className:"grid__container plan-info"},this.renderMonthlyPlanBlock()):a.default.createElement("div",{className:"grid__container plan-info"},this.renderYearlyPlanBlock(),a.default.createElement("div",{className:"plan-info__spacer"}),this.renderMonthlyPlanBlock())},t})(a.default.Component);t.ScheduleSelection=l}));var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/payments/buy/components/payments/async_sox_compliance_warning",["require","exports","modules/clean/react/async/loadable","modules/clean/web_timing_logger"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncSOXComplianceBanner=r.Loadable({loader:function(){return a.waitForTTI().then((function(){return new Promise((function(t,r){e(["modules/clean/react/payments/buy/components/payments/sox_compliance_warning"],t,r)})).then(__importStar).then((function(e){return e.SOXComplianceBanner}))}))}})})),define("modules/clean/react/payments/buy/components/payments/buy_payment_info_section",["require","exports","tslib","react","classnames","modules/clean/react/tooltip","modules/clean/react/image","modules/clean/static_urls","modules/clean/payments/payment_form/payment_form_spec","modules/clean/payments/validation","modules/core/i18n","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/buy/components/payments/ideal_form","modules/clean/react/payments/buy/components/payments/payment_method_selector","modules/clean/react/payments/buy/components/payments/cpf_tooltip","modules/clean/react/payments/checkout/components/payment_method_form/credit_card_frame","modules/clean/react/payments/checkout/components/payment_method_form/direct_debit_form","modules/clean/react/payments/checkout/components/payment_method_form/address_form","modules/core/exception","dig-components/icons/src","dig-components/icons"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d,m,f,y,h,_,g,v,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),v=r.__importStar(v);var S=(function(t){function S(){var a=null!==t&&t.apply(this,arguments)||this;return a.createPaypalBtn=function(){var t=a.props.braintreeClientToken?a.props.braintreeClientToken:"",n=a.props.actions.updatePayPalNonce;Promise.all([new Promise((function(t,r){e(["braintree-web"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["paypal-api-checkout"],t,r)})).then(r.__importStar)]).then((function(e){var r=e[0],a=e[1].default,o=r.client,i=r.paypalCheckout;o.create({authorization:t},(function(e,t){if(e)v.reportException({err:new Error("Error creating Braintree client: "+e),severity:v.SEVERITY.CRITICAL});else{var r=a;i.create({client:t},(function(e,t){e?v.reportException({err:new Error("Error creating PayPal Checkout: "+e),severity:v.SEVERITY.CRITICAL}):r.Button.render({env:"production",style:{color:"gold",height:35,label:"paypal",shape:"rect",size:"responsive",tagline:!1},funding:{allowed:[r.FUNDING.CARD],disallowed:[r.FUNDING.CREDIT]},payment:function(){return t.createPayment({flow:"vault",enableShippingAddress:!1})},onAuthorize:function(e,r){return t.tokenizePayment(e,(function(e,t){n(t.nonce,t.details.email)}))},onCancel:function(e){},onError:function(e){v.reportException({err:new Error("PayPal Checkout error: "+e),severity:v.SEVERITY.CRITICAL})}},"#paypal-button").then((function(){}))}))}}))}))},a.clearPayPalNonce=function(e){e.preventDefault(),a.props.actions.updatePayPalNonce("","")},a.onVatBlur=function(e){a.props.actions.showFormFieldErrors(["vat"],"VatBlur"),a.props.actions.blurVat(e.value)},a.onVatChange=function(e){a.props.actions.updateVat(e.value)},a.onCpfBlur=function(e){a.props.actions.showFormFieldErrors(["cpf"],"CpfBlur"),a.props.actions.blurCpf(e.value)},a.onCpfChange=function(e){a.props.actions.updateCpf(e.value)},a}return r.__extends(S,t),S.prototype.componentDidMount=function(){this.props.actions.updateHistory&&this.props.actions.updateHistory(),"ON"===this.props.paymentPayPalV2Flow&&this.props.braintreeClientToken&&this.createPaypalBtn(),this.props.price&&this.props.planNamePrefixedWithDropbox||this.props.paymentSpec.hide_apple_pay()},S.prototype.prepareForSubmission=function(){var e=this.props.formData.paymentMethod;if(e.formattedValue===l.PaymentMethod.CreditCard)return this.creditCardFrame.tokenize();if(e.formattedValue===l.PaymentMethod.ApplePay&&this.props.planNamePrefixedWithDropbox&&this.props.price){var t={planName:this.props.planNamePrefixedWithDropbox,price:this.props.price};return this.props.actions.applePayAction(t)}return Promise.resolve(!0)},S.prototype.getCreditCardFrame=function(){return this.creditCardFrame},S.prototype.vatErrorString=function(){var e=this.props.formData.vat;return!d.FormValueHelper.isValid(e)&&e.showError?c.intl.formatMessage({id:"iRjYtd",defaultMessage:"Please enter a valid VAT number (ex: {examples})."},{examples:u.getVatExamples(this.props.formData.countryCode.formattedValue).join(", ")}):""},S.prototype.cpfErrorString=function(){var e=this.props.formData.cpf;return!d.FormValueHelper.isValid(e)&&e.showError?c.intl.formatMessage({id:"MQDRWx",defaultMessage:"Please enter a valid CPF number."}):""},S.prototype.renderLocationFields=function(){return a.default.createElement("div",{className:"grid__item"},a.default.createElement(g.AddressForms,{paymentSpec:this.props.paymentSpec,formData:this.props.formData,actions:this.props.actions,countryList:this.props.countryList,showServerViewVersion:this.props.showServerViewVersion}),this.renderVatFields(),this.renderCpfInput())},S.prototype.renderVatFields=function(){var e=this.props,t=e.formData,r=e.paymentSpec,o=e.vatEnabled,i=null;if(r.should_show_vat_for_country(t.countryCode.formattedValue)&&o){var s=t.vat.errorState&&t.vat.showError,l=u.getVatPrefix(t.countryCode.formattedValue),m=n.default({"payment-info__vat-input":!0,"payment-info__vat-input--valid":""!==t.vat.formattedValue&&d.FormValueHelper.isValid(t.vat)});i=a.default.createElement(p.LabeledTextInput,{className:"payment-info__vat",inputClassName:m,containerClassName:"grid__item vat-container",name:"vat",labelText:c.intl.formatMessage({id:"eZAuK1",defaultMessage:"VAT number (optional)"}),placeholder:l,hasError:Boolean(s),value:t.vat.rawValue,onBlur:this.onVatBlur,onChange:this.onVatChange,errorText:this.vatErrorString()})}return i},S.prototype.renderCpfInput=function(){var e=null;if(this.props.paymentSpec.should_require_cpf(this.props.formData.countryCode.formattedValue,this.props.formData.paymentMethod.formattedValue)){var t=this.props.formData.cpf.errorState&&this.props.formData.cpf.showError,r=n.default({"payment-info__cpf-input":!0,"payment-info__cpf-input--valid":""!==this.props.formData.cpf.formattedValue&&d.FormValueHelper.isValid(this.props.formData.cpf)}),l=a.default.createElement("span",null,c.intl.formatMessage({id:"Z1BdZ2",defaultMessage:"CPF/CNPJ"}),a.default.createElement(o.Tooltip,{position:o.TooltipPosition.RIGHT,tooltip_contents:a.default.createElement(y.CPFTooltip,null),is_focusable:!0},a.default.createElement(i.Image,{className:"cpf-tooltip-icon",src:s.static_url("/static/images/payments/buy/rebrand-info-vflRPzJtZ.png"),srcHiRes:s.static_url("/static/images/payments/buy/rebrand-info@2x-vflc1SGxi.png"),alt:c.intl.formatMessage({id:"+SX5vq",defaultMessage:"More information"}),width:15,height:15}))),u=c.intl.formatMessage({id:"+9XYcz",defaultMessage:"e.g. 100.001.101-00"});e=a.default.createElement("div",{className:"grid__item"},a.default.createElement(p.LabeledTextInput,{className:"",inputClassName:r,containerClassName:"grid__item payment-info__cpf",name:"cpf",labelText:l,hasError:Boolean(t),value:this.props.formData.cpf.rawValue,onBlur:this.onCpfBlur,onChange:this.onCpfChange,placeholder:u,errorText:this.cpfErrorString()}))}return e},S.prototype.renderPaymentMethodSelector=function(){var e=this.props,t=e.paymentSpec,r=e.formData,n=e.showTrialVersion;return a.default.createElement(f.PaymentMethodSelector,{paymentSpec:t,paymentMethod:r.paymentMethod.rawValue,updatePaymentMethod:this.props.actions.updatePaymentMethod,countryCode:r.countryCode.rawValue,zipCode:r.zipCode.rawValue,showTrialVersion:n,fullWidth:!1})},S.prototype.paymentTokenConnectDetailsText=function(){return c.intl.formatMessage({id:"dIi5ZR",defaultMessage:"Your payment method has been pre-configured through your bank."})},S.prototype.renderPaymentTokenConnectDetailsText=function(){var e=null;return null!=this.props.paymentSpec.spec.token_connect_prefill_data&&(e=a.default.createElement("p",null,a.default.createElement("small",null,this.paymentTokenConnectDetailsText()))),e},S.prototype.render=function(){var e=this,t=this.props,r=t.actions,n=t.formData,o=t.idealBanks,i=t.hidePaymentMethodSelector,s=this.renderLocationFields(),u=s;n.paymentMethod.formattedValue===l.PaymentMethod.DirectDeposit?u=a.default.createElement(_.DirectDebitForm,{locationFields:s,formData:n,actions:r}):n.paymentMethod.formattedValue===l.PaymentMethod.Ideal&&(u=a.default.createElement(m.IdealForm,{locationFields:s,formData:n,actions:r,idealBanks:o}));var p,d;return"ON"===this.props.paymentPayPalV2Flow&&(p=a.default.createElement("span",{className:"paypal-button-container",hidden:n.paymentMethod.formattedValue!==l.PaymentMethod.PayPal},a.default.createElement("span",{className:"paypal-button-start",hidden:""!==n.payPalNonce.formattedValue},a.default.createElement("label",{className:"input__label"},c.intl.formatMessage({id:"Xkz5XK",defaultMessage:"Sign into PayPal to continue with this payment method:"})),a.default.createElement("div",{id:"paypal-button"})),a.default.createElement("span",{className:"paypal-button-end",hidden:""===n.payPalNonce.formattedValue},a.default.createElement("span",{id:"paypal-button-account-email"},n.payPalNonce.email),a.default.createElement("br",null),a.default.createElement("a",{href:"#",onClick:this.clearPayPalNonce},c.intl.formatMessage({id:"TFnOYM",defaultMessage:"Change PayPal account"}))),a.default.createElement("span",{hidden:!1===n.payPalNonce.showError},a.default.createElement("label",{className:"input__label--error"},c.intl.formatMessage({id:"3z459e",defaultMessage:"Please select your PayPal account."}))))),this.props.paymentBannerError&&(d=a.default.createElement("div",{className:"payment-error-div payment-info grid__container inline-errors"},a.default.createElement("div",{className:"grid__item--fluid",style:{maxWidth:"30px",marginRight:"5px",marginLeft:"5px"}},a.default.createElement(P.UIIcon,{src:b.WarningLine,size:"large"})),a.default.createElement("div",{className:"grid__item--fluid grid__item--margin-right--1-24 payment-error-text"},this.props.paymentBannerError))),a.default.createElement("div",{id:"payment-info",className:"payment-info grid__container inline-errors"},this.renderPaymentTokenConnectDetailsText(),d,!i&&this.renderPaymentMethodSelector(),a.default.createElement("div",{className:"grid__item grid__item--large--11-12"},a.default.createElement(h.CreditCardFrame,{iframeUrl:this.props.iframeUrl,hidden:n.paymentMethod.formattedValue!==l.PaymentMethod.CreditCard,actions:this.props.actions,ref:function(t){e.creditCardFrame=t},nonce:n.nonce,bin:n.bin,showServerViewVersion:this.props.showServerViewVersion,submitForm:this.props.submitForm,getHeightFromIframe:!0}),p,u))},S})(a.default.Component);t.PaymentInfoSection=S})),define("modules/clean/react/payments/buy/components/payments/cpf_tooltip",["require","exports","tslib","react","modules/core/i18n"],(function(e,t,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=n.intl.formatMessage({id:"1ONP6O",defaultMessage:"The Cadastro de Pessoas Físicas (CPF) is the the Brazilian individual taxpayer registry identification number. It has 11 digits and can be found on your CPF card. It consists of numbers, dots and a dash, as in the following example: 100.001.101-00."}),t=n.intl.formatMessage({id:"VsWgR6",defaultMessage:"The Cadastro Nacional da Pessoa Jurídica, or most commonly known as CNPJ, is a number that identifies legal entities and other legal arrangements at the Federal Revenue Service of Brazil. It has functions similar to those of the CPF, the only difference being that it is unique to the use of legal entities. It is a 14-digit number with a certain format, like in the following example: 00.000.000/0001-00"});return a.default.createElement("div",{className:"cpf-tooltip-contents"},a.default.createElement("p",{className:"cpf-tooltip-contents__header"},n.intl.formatMessage({id:"b1XaAp",defaultMessage:"What is CPF?"})),a.default.createElement("p",null,e),a.default.createElement("p",{className:"cpf-tooltip-contents__header"},n.intl.formatMessage({id:"grlpui",defaultMessage:"What is CNPJ?"})),a.default.createElement("p",null,t))},t})((a=r.__importDefault(a)).default.Component);t.CPFTooltip=o})),define("modules/clean/react/payments/buy/components/payments/marketing_opt_in",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/buy/components/inputs/inputs"],(function(e,t,r,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.toggleMarketingOptIn=function(e){var r=t.props.formData.marketingOptIn.rawValue;t.props.actions.updateMarketingOptIn(!r)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.formData,r=e.isCreatingNewAccount,i=e.showMarketingOptInIfNewAccount,s=n.intl.formatMessage({id:"vRE9NS",defaultMessage:"I’d like to receive direct marketing email updates from Dropbox"}),l=a.default.createElement("span",{className:"type--copy-small"},s);return i&&r?a.default.createElement(o.LabeledCheckboxInput,{checked:t.marketingOptIn.rawValue,containerClassName:"grid__item marketing_opt_in",className:"billing-marketing-opt-in",labelText:l,name:"marketing_opt_in",onClick:this.toggleMarketingOptIn}):null},t})((a=r.__importDefault(a)).default.Component);t.MarketingOptIn=i})),define("modules/clean/react/payments/buy/components/payments/order_summary/order_summary",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/react/payments/buy/components/payments/marketing_opt_in","modules/clean/react/payments/buy/components/payments/tos","modules/clean/react/rebrand/elements/rebrand_buttons","modules/core/browser","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/components/payments/order_summary/order_summary_utils","modules/clean/react/payments/buy/types/types","modules/clean/payments/payment_form/payment_form_spec"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),u=r.__importStar(u);var y=(function(e){function l(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickRedirectToBuy=function(){var e=t.props.buyLink;c.ProEventsLogger.log("clicked_buy_directly_cta",{}),u.redirect(e)},t}return r.__extends(l,e),l.prototype.getSubmitButtonText=function(){return this.props.showTrialVersion?o.intl.formatMessage({id:"ymP1f5",defaultMessage:"Start your free trial"}):o.intl.formatMessage({id:"4oMxy9",defaultMessage:"Buy now"})},l.prototype.render=function(){var e,r,o=this.props,l=o.actions,u=o.currentTransitionPrices,c=o.formData,p=o.formVariant,y=o.isLoadingPrices,h=o.onClick,_=o.pageState,g=o.planColor,v=o.planNamePrefixedWithDropbox,b=o.promoSpec,P=o.showMarketingOptInIfNewAccount,S=o.showTrialVersion,C=o.taxNamesByCountry,E=u.totalPrice,T=u.currency;E&&(e=a.default.createElement(t.OrderSummaryTotalPrice,{totalPrice:E,showTrialVersion:S}),T&&(r=a.default.createElement(s.TermsOfService,{actions:l,currency:T,formData:c,totalPrice:E.formatCurrency(),showTrialVersion:S})));var w,F=p===m.FormVariant.COLUMN;F||(w=a.default.createElement("div",{className:n.default("card-top","grid__item",d.getCardTopColorClassName(g))}));var N=a.default.createElement(t.OrderSummaryTrialGoToBuyLink,{isLoading:y,isSubmitting:_.submitting,planNamePrefixedWithDropbox:v,onClickRedirectToBuy:this.onClickRedirectToBuy});return a.default.createElement("div",{className:"order-summary grid__container"},w,a.default.createElement("div",{className:n.default("grid__item",{"order-summary__card":!F,"order-summary__card-no-border":F})},a.default.createElement("div",{className:"order-summary__plan-name grid__item"},v),a.default.createElement("div",{className:"order-summary__line-items grid__item"},a.default.createElement(t.OrderSummaryTaxes,{showTrialVersion:S,taxNamesByCountry:C,currentTransitionPrices:u}),a.default.createElement(t.OrderSummaryWithheldTaxes,{taxNamesByCountry:C,currentTransitionPrices:u}),e,a.default.createElement(t.OrderSummaryFreeMonths,{promoSpec:b,scheduleId:c.scheduleId.formattedValue})),r,a.default.createElement(i.MarketingOptIn,{formData:c,actions:l,showMarketingOptInIfNewAccount:P,isCreatingNewAccount:!_.existingAccountShowing}),a.default.createElement(t.OrderSummarySubmitButton,{isProcessing:y||_.submitting,buttonText:this.getSubmitButtonText(),onClick:h,isApplePay:c.paymentMethod.rawValue===f.PaymentMethod.ApplePay}),S?N:void 0,a.default.createElement(t.OrderSummaryErrors,{showBuyClickError:_.showBuyClickError})))},l})(a.default.Component);t.OrderSummary=y,t.OrderSummaryTaxes=function(e){var t=e.showTrialVersion,r=e.currentTransitionPrices,i=e.taxNamesByCountry,s=r.taxPercentage,l=r.taxAmount,u=r.taxCountryCode;if(!(l&&l.amount&&s&&s>0))return null;var c=d.getTaxNameForCountry(u,i);return a.default.createElement("div",{key:c,className:"order-summary__tax grid__item"},o.intl.formatMessage({id:"w5e+O+",defaultMessage:"{tax_name} ({tax_percent}): <span>{tax_amount}</span>"},{span:function(e){return a.default.createElement("span",{className:n.default("order-summary__tax_amount",{"order-summary__strike":t})},e)},tax_name:c,tax_percent:o.intl.formatNumber(s/100,{style:"percent",maximumFractionDigits:2}),tax_amount:l.toString()}))},t.OrderSummaryWithheldTaxes=function(e){var t=e.taxNamesByCountry,r=e.currentTransitionPrices,n=r.withheldTaxAmount,i=r.withheldTaxPercentage,s=r.taxCountryCode;return n&&n.amount&&i&&i>0?a.default.createElement("div",{className:"order-summary__withheld_tax grid__item"},o.intl.formatMessage({id:"E8kLRO",defaultMessage:"Withheld {tax_name} ({tax_percent, number, ::percent .##}): {tax_amount}"},{tax_name:d.getTaxNameForCountry(s,t),tax_percent:i/100,tax_amount:n.toString()})):null},t.OrderSummaryTotalPrice=function(e){var t=e.totalPrice,n=e.showTrialVersion,i=t.toString(),s=o.intl.formatMessage({id:"QgQyq4",defaultMessage:"Billed Now: {total_price}"},{total_price:i}),l={strike:function(e){return a.default.createElement("span",{className:"order-summary__strike order-summary__padding-left"},e)},free:function(e){return a.default.createElement("span",{className:"order-summary__free-price order-summary__padding-left"},e)}},u=o.intl.formatMessage({id:"/tcn5z",defaultMessage:"Charged Now: <strike>{total_price}</strike> <free>FREE</free>"},r.__assign(r.__assign({},l),{total_price:i}));return a.default.createElement("div",{className:"order-summary__price grid__item"},n?u:s)},t.OrderSummaryFreeMonths=function(e){var t=e.promoSpec,r=e.scheduleId;return t&&t.freeMonths&&r===p.ScheduleId.YEARLY?a.default.createElement("div",{className:"promo-highlight"},o.intl.formatMessage({id:"UVyMNH",defaultMessage:"<span>+ {free_months} months free</span> with your first year"},{free_months:t.freeMonths,span:function(e){return a.default.createElement("span",null,e)}})):null},t.OrderSummaryErrors=function(e){return e.showBuyClickError?a.default.createElement("p",{className:n.default("form-error","form-error--enabled"),"aria-live":"assertive"},o.intl.formatMessage({id:"Ftg4vm",defaultMessage:"Please correct the form errors and try again"})):null},t.OrderSummaryTrialGoToBuyLink=function(e){var t=e.isLoading,r=e.isSubmitting,i=e.planNamePrefixedWithDropbox,s=e.onClickRedirectToBuy,l=t||r;return a.default.createElement("button",{className:n.default("button-as-link","order-summary__button","order-summary__buy-button","grid__item",{"order-summary__buy-button-disabled":l}),onClick:s,"data-uxa-log":"order-summary-go-to-buy"},o.intl.formatMessage({id:"bg2sx0",defaultMessage:"Or buy {plan} now"},{plan:i}))},t.OrderSummarySubmitButton=function(e){var t=e.isProcessing,r=e.buttonText,o=e.onClick,i=e.isApplePay,s=n.default("button--submit","order-summary__button","grid__item",{"button--loading":t}),u=r;if(t)u=a.default.createElement("div",{className:"loader"},a.default.createElement("span",{className:"loader__dot"}),a.default.createElement("span",{className:"loader__dot"}),a.default.createElement("span",{className:"loader__dot"}));else if(i)return a.default.createElement("button",{className:"apple-pay-button-with-text apple-pay-button-black-with-text",onClick:o,"data-uxa-log":"order-summary-submit-button","aria-label":"Buy now",type:"submit"},a.default.createElement("span",{className:"text"},u),a.default.createElement("span",{className:"logo"}));return a.default.createElement(l.RebrandButton,{ariaLabel:r,importance:"primary",size:"medium",type:"submit",className:s,onClick:o,disabled:t,"data-uxa-log":"order-summary-submit-button"},u)}})),define("modules/clean/react/payments/buy/components/payments/order_summary/order_summary_utils",["require","exports","tslib","modules/core/i18n","modules/core/exception"],(function(e,t,r,a,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),t.getTaxNameForCountry=function(e,t){return t&&e&&t[e]?t[e]:a.intl.formatMessage({id:"dytYFt",defaultMessage:"Tax"})},(function(e){e.BLUE="card-top--blue",e.BLACK="card-top--black"})(o=t.CardTopClassName||(t.CardTopClassName={}));var i=new Map([["black",o.BLACK],["blue",o.BLUE]]);t.getCardTopColorClassName=function(e){return i.has(e)?i.get(e):(n.reportException({err:new Error("Unsupported checkout page plan color "+e),severity:n.SEVERITY.CRITICAL}),o.BLACK)}})),define("modules/clean/react/payments/buy/components/payments/worldpay_entity_info",["require","exports","tslib","react"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.default.createElement("div",{className:"grid__container payment-entity-info__text"},a.default.createElement("p",null,"Dropbox International Unlimited Company",a.default.createElement("br",null),"One Park Place / Hatch Street Upper / Dublin 2 / Ireland"))},t})((a=r.__importDefault(a)).default.Component);t.WorldPayEntityInfo=n})),define("modules/clean/react/payments/buy/components/plan/plan_selection",["require","exports","tslib","react","modules/clean/react/payments/buy/types/types","modules/clean/react/payments/buy/components/plan/plan_block"],(function(e,t,r,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePlanChange=function(e,r,a){var n=t.props,o=n.locale,i=n.productPlanType,s=n.actions.updateSelectedPlan;i!==e&&s(e,r,o,a)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.defaultPlan,r=e.supportedProducts,i=e.productPlanType,s=e.showPlanNameUnderRadio,l=e.userIsEligibleForProfessionalTrial;return t===n.CheckoutPageProductPlan.PLUS?a.default.createElement("div",{className:"grid__container plan-info"},a.default.createElement(o.PlusPlanBlock,{showTrialVersion:!1,showPlanNameUnderRadio:s,supportedProducts:r,handlePlanChange:this.handlePlanChange,selectedProductPlanType:i}),a.default.createElement("div",{className:"plan-info__spacer"}),a.default.createElement(o.ProfessionalPlanBlock,{showTrialVersion:l,showPlanNameUnderRadio:s,supportedProducts:r,handlePlanChange:this.handlePlanChange,selectedProductPlanType:i})):null},t})((a=r.__importDefault(a)).default.Component);t.PlanSelection=i})),define("modules/clean/react/payments/buy/components/plan/plan_block",["require","exports","tslib","react","modules/core/i18n","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/components/inputs/inputs","modules/constants/trademark","modules/clean/react/payments/buy/types/types"],(function(e,t,r,a,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a);t.PlanBlock=function(e){var r=e.planName,n=e.productPlanType,o=e.selectedProductPlanType,s=e.ariaLabelId,l=e.inputId,u=e.quotaString,c=e.showTrialVersion,p=e.showPlanNameUnderRadio,d=e.trialDuration,m=e.planInfoChoiceClass,f=e.planInfoLabelClass,y=e.planInfoSubtitleClass,h=e.handlePlanChange,_=a.default.createElement("span",{id:s,className:"plan-info__label plan-info__label--bold "+f,onClick:function(){h(n,d||0,c)},"aria-hidden":"true"},u),g=p&&r;return a.default.createElement("div",{className:"plan-info__choice "+m},a.default.createElement(i.LabeledRadioInput,{name:"plan_id",inputId:l,ariaLabelId:s+(g?" plan-info-subtitle-plan-name":"")+(c?" plan-info-subtitle-trial":""),className:"plan-info__radio",labelClassName:"plan-info__container",value:n.toString(),checked:n===o,labelSpan:_,onClickOrChange:function(e,t,r){var a=e.currentTarget;r=r||a.value;var n=parseInt(r,10);h(n,d||0,c)}}),g&&a.default.createElement("div",{id:"plan-info-subtitle-plan-name",className:"plan-info__subtitle "+y},r),c&&a.default.createElement("div",{id:"plan-info-subtitle-trial",className:"plan-info__subtitle plan-info__subtitle--green"},t.getTrialDurationString(d)))},t.getTrialDurationString=function(e){return void 0!==e?n.intl.formatMessage({id:"H8xyuK",defaultMessage:"Try free for {pro_trial_days} days"},{pro_trial_days:e}):""},t.ProfessionalPlanBlock=function(e){var r,n,i=e.supportedProducts,u=e.selectedProductPlanType,c=e.showTrialVersion,p=e.showPlanNameUnderRadio,d=e.handlePlanChange,m=null===(n=null===(r=i[l.CheckoutPageProductPlan.PROFESSIONAL])||void 0===r?void 0:r.trialInfo)||void 0===n?void 0:n.trialDuration;return a.default.createElement(t.PlanBlock,{planName:"Dropbox "+s.TRADEMARK_PROFESSIONAL,productPlanType:o.ProductPlanType.PROFESSIONAL,selectedProductPlanType:u,ariaLabelId:"plan-info__label--pro",inputId:"plan-info__radio--pro",quotaString:i[l.CheckoutPageProductPlan.PROFESSIONAL].quota,showTrialVersion:c,showPlanNameUnderRadio:p,trialDuration:m,planInfoChoiceClass:"plan-info__pro",planInfoLabelClass:"plan-info__label--pro",planInfoSubtitleClass:"plan-info__subtitle--pro",handlePlanChange:d})},t.PlusPlanBlock=function(e){var r,n,i=e.supportedProducts,u=e.selectedProductPlanType,c=e.showTrialVersion,p=e.showPlanNameUnderRadio,d=e.handlePlanChange,m=null===(n=null===(r=i[l.CheckoutPageProductPlan.PLUS])||void 0===r?void 0:r.trialInfo)||void 0===n?void 0:n.trialDuration;return a.default.createElement(t.PlanBlock,{planName:"Dropbox "+s.TRADEMARK_PLUS,productPlanType:o.ProductPlanType.PLUS,selectedProductPlanType:u,ariaLabelId:"plan-info__label--plus",inputId:"plan-info__radio--plus",quotaString:i[l.CheckoutPageProductPlan.PLUS].quota,showTrialVersion:c,showPlanNameUnderRadio:p,trialDuration:m,planInfoChoiceClass:"plan-info__plus",planInfoLabelClass:"plan-info__label--plus",planInfoSubtitleClass:"plan-info__subtitle--plus",handlePlanChange:d})}})),define("modules/clean/react/payments/buy/helpers/pricing_value_helper",["require","exports","modules/clean/payments/skus/constants"],(function(e,t,r){"use strict";function a(e,t,r,a){return e.filter((function(e){var n=e.finalSubState.plan,o=e.finalSubState.billingSchedule,i=!!e.finalSubState.addons.skus.length;return n&&n.productType===t&&o&&o.id===r&&i===a})).pop()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisplayPrices=function(e,t,n){var o,i,s,l,u,c;if(e){var p=a(e,t.productPlanType.formattedValue,r.ScheduleId.MONTHLY,!1),d=a(e,t.productPlanType.formattedValue,r.ScheduleId.YEARLY,!1),m=void 0,f=void 0;if(n?(d&&(o=(m=d.tvm).getTotalPrice(),l=m.getBilledPrice()),p&&(i=(f=p.tvm).getTotalPrice(),u=f.getBilledPrice())):(d&&(o=d.nextBillingSummary.base,l=d.nextBillingSummary.total),p&&(i=p.nextBillingSummary.base,u=p.nextBillingSummary.total)),o&&i){var y=i.multiply(12).subtract(o);s=y.amount>0?y:void 0}if(l&&u){var h=u.multiply(12).subtract(l);c=h.amount>0?h:void 0}}return{yearlyPrice:o,monthlyPrice:i,yearlySavings:s,taxInclusiveYearlyPrice:l,taxInclusiveMonthlyPrice:u,taxInclusiveYearlySavings:c}},t.getCurrentTransitionPrices=function(e,t){var r,n,o,i,s,l,u,c;if(e&&(r=a(e,t.productPlanType.formattedValue,t.scheduleId.formattedValue,!!t.evh.rawValue)),r&&r.tvm){var p=r.tvm;n=p.getTotalPrice(),o=p.getTaxCountryCode(),i=p.getTaxPercentage(),s=p.getTaxPrice(),l=p.getCurrency(),u=p.getTotalTaxWithheld(),c=p.getWithheldTaxPercentage()}return{totalPrice:n,taxCountryCode:o,taxPercentage:i,taxAmount:s,currency:l,withheldTaxAmount:u,withheldTaxPercentage:c}}})),define("modules/clean/react/payments/buy/helpers/plans_util",["require","exports","tslib","modules/clean/payments/skus/constants","dig-components/icons/src","modules/core/exception","modules/clean/ts_utils"],(function(e,t,r,a,n,o,i){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.findAndSetTallestHeight=function(e){var t=0;e.forEach((function(e){e.style.height="auto";var r=e.getBoundingClientRect().height;r>t&&(t=r)})),e.forEach((function(e){e.style.height=t+"px"}))},(function(e){e.FOLDER="folder",e.MULTIFOLDER="multiFolder",e.MULTIPERSON="multiPerson",e.PERSON="person"})(s=t.FeatureSVG||(t.FeatureSVG={})),t.getPlanCardFeatureIcon=function(e){switch(e){case s.FOLDER:return n.FolderLine;case s.MULTIFOLDER:return n.FileExplorerLine;case s.MULTIPERSON:return n.PersonMultipleLine;case s.PERSON:return n.PersonLine;default:i.enforceExhaustive(e)}},t.getBuyPlanContentFromMap=function(e,t){return t!==a.ProductPlanType.PLUS&&t!==a.ProductPlanType.PROFESSIONAL&&t!==a.ProductPlanType.FAMILY_PAYER&&(o.reportException({err:new Error("Unsupported plan type "+t),severity:o.SEVERITY.CRITICAL}),t=a.ProductPlanType.PLUS),e.plansByType[t]}})),define("modules/clean/react/payments/buy/components/payments/ideal_form",["require","exports","tslib","react","modules/clean/react/payments/buy/components/inputs/inputs","modules/core/i18n","modules/clean/react/payments/common/form_value_helpers"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onIdealBankChange=function(e){var r=e.value,a=t.props.idealBanks[r];t.props.actions.updateIdealBank({bankId:r,bankName:a})},t.onIdealBankBlur=function(e){t.props.actions.showFormFieldErrors(["idealBankId"],"IdealBankBlur")},t.idealErrorString=function(){var e=t.props.formData.idealBankId;return!i.FormValueHelper.isValid(e)&&e.showError?o.intl.formatMessage({id:"Lly4lc",defaultMessage:"Please select your bank."}):""},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.formData,r=e.idealBanks,i=o.intl.formatMessage({id:"4MQHjO",defaultMessage:"Note: We’ll use your bank information provided by iDEAL for all future billing cycles. If your bank is not listed, then please select a different payment method."}),s=t.idealBankId.errorState&&t.idealBankId.showError,l=this.idealErrorString();return a.default.createElement("div",{className:"ideal-container"},a.default.createElement("div",{className:"ideal-fields"},a.default.createElement(n.LabeledSelectInput,{name:"ideal_bank",labelText:o.intl.formatMessage({id:"nomYjM",defaultMessage:"Bank"}),value:t.idealBankId.rawValue,onChange:this.onIdealBankChange,onBlur:this.onIdealBankBlur,hasError:Boolean(s),errorText:l},a.default.createElement("option",{value:"",key:"default","aria-selected":""===t.idealBankId.rawValue},o.intl.formatMessage({id:"EYb0mR",defaultMessage:"Select your bank..."})),Object.keys(r).map((function(e){return a.default.createElement("option",{value:e,key:e,"aria-selected":t.idealBankId.rawValue===e},r[e])})))),this.props.locationFields,a.default.createElement("div",{className:"ideal-note"},i))},t})((a=r.__importDefault(a)).default.Component);t.IdealForm=s})),define("modules/clean/react/payments/buy/components/payments/payment_method_input",["require","exports","tslib","react","classnames","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/buy/components/inputs/inputs"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n);var s=(function(e){function t(t){var r=e.call(this,t)||this;return r.focus=function(){null!==r.labeledRadioInput.current&&r.labeledRadioInput.current.focus()},r.onChange=function(){r.props.onSelected(r.props.paymentMethod)},r.getPaymentMethodId=function(e){switch(e){case o.PaymentMethod.CreditCard:return"creditcard";case o.PaymentMethod.PayPal:return"paypal";case o.PaymentMethod.Ideal:return"ideal";case o.PaymentMethod.DirectDeposit:return"debit";case o.PaymentMethod.TokenConnect:return"token_connect";case o.PaymentMethod.ApplePay:return"applepay";default:return e}},r.labeledRadioInput=a.default.createRef(),r}return r.__extends(t,e),t.prototype.render=function(){var e=this.getPaymentMethodId(this.props.paymentMethod);return a.default.createElement("div",{className:n.default({"payment-info__option":!0,"full-width":this.props.fullWidth,"no-margin-bottom":this.props.noMarginBottom,"grid__item--expand":this.props.fullWidth,"grid__item--shrink":!this.props.fullWidth,"grid--y-middle":!0,"cc-payment-radio-selenium":this.props.paymentMethod===o.PaymentMethod.CreditCard})},a.default.createElement(i.LabeledRadioInput,{ref:this.labeledRadioInput,name:this.props.name,className:"payment-info__payment",inputId:"payment-method-radio#"+e,ariaLabelId:"payment-method-label#"+e,value:this.props.paymentMethod.toString(),checked:this.props.selected,onClickOrChange:this.onChange,labelSpan:a.default.createElement(l,{id:e,textTitle:this.props.textTitle,title:this.props.title,icons:this.props.icons,onClick:this.onChange,cc_last4:this.props.cc_last4})}))},t})(a.default.Component);t.PaymentMethodInput=s;var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.renderCCLast4=function(){var e=null;return null!=this.props.cc_last4&&(e=a.default.createElement("span",null,a.default.createElement("b",null,this.props.cc_last4))),e},t.prototype.render=function(){var e,t=this;return a.default.createElement("span",{className:"payment-info__method-label",onClick:this.props.onClick},a.default.createElement("span",{id:"payment-method-label#"+this.props.id,"aria-hidden":"true",className:n.default((e={"ax-visually-hidden":this.props.icons},e[this.props.id]=!this.props.icons,e)),title:this.props.textTitle},this.props.title),this.props.icons&&this.props.icons.map((function(e){return a.default.createElement("span",{key:"payment-method-icon#"+e,className:e,title:t.props.icons&&t.props.icons.length>1?e:t.props.title})})),this.renderCCLast4())},t})(a.default.Component)})),define("modules/clean/react/payments/buy/components/payments/payment_method_selector",["require","exports","tslib","react","modules/core/i18n","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/buy/components/payments/payment_method_input"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onPaymentMethodSelected=function(e){t.props.updatePaymentMethod(e)},t}return r.__extends(t,e),t.prototype.getLabelForMethodId=function(e){if(e===o.PaymentMethod.TokenConnect){var t=this.props.paymentSpec.supported_credit_cards_for_country(""),r=void 0;return this.props.paymentSpec.spec.token_connect_prefill_data&&"cc_last4"in this.props.paymentSpec.spec.token_connect_prefill_data&&(r="****-"+this.props.paymentSpec.spec.token_connect_prefill_data.cc_last4),a.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.TokenConnect,selected:this.props.paymentMethod===o.PaymentMethod.TokenConnect,onSelected:this.onPaymentMethodSelected,icons:t,fullWidth:this.props.fullWidth,title:n.intl.formatMessage({id:"7u/Z5D",defaultMessage:"Credit card"},{payment_methods:"mastercard"}),cc_last4:r})}if(e===o.PaymentMethod.CreditCard){t=this.props.paymentSpec.supported_credit_cards_for_country(this.props.countryCode);return a.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.CreditCard,selected:this.props.paymentMethod===o.PaymentMethod.CreditCard,onSelected:this.onPaymentMethodSelected,icons:t,fullWidth:this.props.fullWidth,title:n.intl.formatMessage({id:"2NPQhg",defaultMessage:"Credit card. We accept {payment_methods}."},{payment_methods:t.join(", ").replace("_","-")})})}return e===o.PaymentMethod.PayPal?a.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.PayPal,selected:this.props.paymentMethod===o.PaymentMethod.PayPal,onSelected:this.onPaymentMethodSelected,icons:["paypal"],fullWidth:this.props.fullWidth,title:n.intl.formatMessage({id:"RxvBVG",defaultMessage:"Paypal"})}):e===o.PaymentMethod.DirectDeposit?a.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.DirectDeposit,selected:this.props.paymentMethod===o.PaymentMethod.DirectDeposit,onSelected:this.onPaymentMethodSelected,title:n.intl.formatMessage({id:"H1vHwe",defaultMessage:"Direct Debit"}),fullWidth:this.props.fullWidth}):e===o.PaymentMethod.Ideal?a.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.Ideal,selected:this.props.paymentMethod===o.PaymentMethod.Ideal,onSelected:this.onPaymentMethodSelected,icons:["ideal"],fullWidth:this.props.fullWidth,title:n.intl.formatMessage({id:"DgNBM/",defaultMessage:"iDEAL"})}):e===o.PaymentMethod.ApplePay?a.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.ApplePay,selected:this.props.paymentMethod===o.PaymentMethod.ApplePay,onSelected:this.onPaymentMethodSelected,icons:["applepay"],fullWidth:this.props.fullWidth,title:n.intl.formatMessage({id:"ZoO+/M",defaultMessage:"ApplePay"})}):null},t.prototype.render=function(){var e=this,t=this.props,r=t.countryCode,o=t.paymentSpec,i=(t.showTrialVersion?o.only_default_payment_methods():o.available_payment_methods_for_country(r)).map((function(t){return e.getLabelForMethodId(t)}));return a.default.createElement("div",{className:"payment-info__selector grid__container"},a.default.createElement("span",{className:"ax-visually-hidden"},n.intl.formatMessage({id:"WrPpf6",defaultMessage:"Select a payment method"})),i)},t})((a=r.__importDefault(a)).default.Component);t.PaymentMethodSelector=s})),define("modules/clean/react/payments/buy/components/payments/tos",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/payments/skus/constants","modules/clean/react/payments/common/form_value_helpers"],(function(e,t,r,a,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onTermsAndServiceChange=function(e){t.props.actions.updateTermsAndService(Boolean(!e.checked))},t.onTermsAndServiceBlur=function(e){t.props.actions.showFormFieldErrors(["termsAndService"],"TermsAndServiceBlur")},t.onTOSLabelClick=function(e){var r=t.props.formData.termsAndService.formattedValue;t.props.actions.updateTermsAndService(Boolean(!r))},t}return r.__extends(t,e),t.prototype.termsAndServiceErrorString=function(){var e=this.props.formData.termsAndService;return!s.FormValueHelper.isValid(e)&&e.showError?n.intl.formatMessage({id:"a2NBnL",defaultMessage:"Please agree to the terms of service."}):""},t.prototype.renderLegalTermsBuy=function(){var e=this.props,t=e.currency,r=e.formData,o={total_price:e.totalPrice,schedule:r.scheduleId.rawValue===i.ScheduleId.MONTHLY?n.intl.formatMessage({id:"dF0ZGK",defaultMessage:"monthly"}):n.intl.formatMessage({id:"yvyyXC",defaultMessage:"yearly"}),currency:t,link_cancel:function(e){return a.default.createElement("a",{className:"terms-info__link","aria-label":"cancel-article",key:"tos-cancel",href:"/help/158",target:"_blank",rel:"noopener noreferrer"},e)},link_refund:function(e){return a.default.createElement("a",{className:"terms-info__link","aria-label":"refund-article",key:"tos-refund",href:"/terms",target:"_blank",rel:"noopener noreferrer"},e)},link_required:function(e){return a.default.createElement("a",{className:"terms-info__link","aria-label":"requirements-article",key:"tos-required",href:"/help/9069",target:"_blank",rel:"noopener noreferrer"},e)}};return n.intl.formatMessage({id:"iwdwdQ",defaultMessage:"You’ll be charged {total_price} {schedule} until you <link_cancel>cancel</link_cancel> your subscription. Previous charges <link_refund>won’t be refunded</link_refund> when you cancel <link_required>unless it’s legally required</link_required>. Your payment data is encrypted and secure. All amounts shown are in {currency}."},o)},t.prototype.renderLegalTermsTrial=function(){var e=this.props,t=e.currency,r=e.formData,o=e.totalPrice;return n.intl.formatMessage({id:"iPVwvJ",defaultMessage:"Your free trial ends on {trial_end_date}. If you don’t <link_cancel>cancel</link_cancel> your free trial by that date, we’ll charge you {total_price} {schedule} (taxes included) until you cancel your plan. Charges <link_refund>won’t be refunded</link_refund> when you cancel, <link_required>unless it’s legally required</link_required>. Your payment data is encrypted and secure. All amounts shown are in {currency}."},{trial_end_date:r.trialEndDate.rawValue,total_price:o,schedule:r.scheduleId.rawValue===i.ScheduleId.MONTHLY?n.intl.formatMessage({id:"dF0ZGK",defaultMessage:"monthly"}):n.intl.formatMessage({id:"yvyyXC",defaultMessage:"yearly"}),link_cancel:function(e){return a.default.createElement("a",{className:"terms-info__link","aria-label":"cancel-article",key:"tos-cancel",href:"/help/space/cancel-plus",target:"_blank",rel:"noopener noreferrer"},e)},link_refund:function(e){return a.default.createElement("a",{className:"terms-info__link","aria-label":"refund-article",key:"tos-refund",href:"/help/billing/plus-refund",target:"_blank",rel:"noopener noreferrer"},e)},link_required:function(e){return a.default.createElement("a",{className:"terms-info__link","aria-label":"requirements-article",key:"tos-required",href:"/terms",target:"_blank",rel:"noopener noreferrer"},e)},currency:t})},t.prototype.render=function(){var e=this.props.formData,t=this.props.showTrialVersion?this.renderLegalTermsTrial():this.renderLegalTermsBuy(),r=n.intl.formatMessage({id:"Q4Jjko",defaultMessage:"I agree to the <link>Dropbox Terms</link>{br}and the <strong>Automatic Renewal Terms</strong> above"},{link:function(e){return a.default.createElement("a",{className:"terms-info__tos--terms-link","aria-label":"terms",key:"link_dbx",href:"/terms",target:"_blank",rel:"noopener noreferrer"},e)},br:a.default.createElement("br",{key:"link_br"}),strong:function(e){return a.default.createElement("strong",{key:"link_strong"},e)}}),i=a.default.createElement("span",{className:"type--copy-small",onClick:this.onTOSLabelClick},r),s=a.default.createElement(o.LabeledCheckboxInput,{checked:e.termsAndService.rawValue,containerClassName:"grid__item terms-info__tos",className:"billing-terms-and-service",errorText:this.termsAndServiceErrorString(),labelText:i,name:"tos_agree",onClick:this.onTermsAndServiceChange,onBlur:this.onTermsAndServiceBlur});return a.default.createElement("div",{className:"terms-info"},a.default.createElement("p",{className:"terms-info__legal"},t),s)},t})((a=r.__importDefault(a)).default.Component);t.TermsOfService=l})),define("modules/clean/react/payments/buy/helpers/product_plan_helpers",["require","exports","tslib","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/types/types","modules/core/exception"],(function(e,t,r,a,n,o){"use strict";var i,s;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.supportedPlanTypeToCheckoutPagePlan=((i={})[a.ProductPlanType.PLUS]=n.CheckoutPageProductPlan.PLUS,i[a.ProductPlanType.PROFESSIONAL]=n.CheckoutPageProductPlan.PROFESSIONAL,i[a.ProductPlanType.TRANSFER]=n.CheckoutPageProductPlan.TRANSFER,i[a.ProductPlanType.FAMILY_PAYER]=n.CheckoutPageProductPlan.FAMILY,i[a.ProductPlanType.SYNC_EVERYTHING]=n.CheckoutPageProductPlan.BACKUP,i);var l=((s={})[n.CheckoutPageProductPlan.PLUS]=a.ProductPlanType.PLUS,s[n.CheckoutPageProductPlan.PROFESSIONAL]=a.ProductPlanType.PROFESSIONAL,s[n.CheckoutPageProductPlan.TRANSFER]=a.ProductPlanType.TRANSFER,s[n.CheckoutPageProductPlan.FAMILY]=a.ProductPlanType.FAMILY_PAYER,s[n.CheckoutPageProductPlan.BACKUP]=a.ProductPlanType.SYNC_EVERYTHING,s);function u(e){var r=t.supportedPlanTypeToCheckoutPagePlan[e];return r||o.reportException({err:new Error("Unsupported product plan type "+e),severity:o.SEVERITY.CRITICAL}),r}t.isProductPlanTypeSupportedByCheckoutPage=function(e){return void 0!==u(e)},t.getCheckoutPageProductPlan=u,t.getSelectedUiProduct=function(e,t){var r=u(t),a=e[r];return a||o.reportException({err:new Error("supportedProducts does not include selected checkout page product plan "+r),severity:o.SEVERITY.CRITICAL}),a},t.getProductPlanType=function(e){var t=l[e];return t||o.reportException({err:new Error("Unsupported checkout page product plan type "+e),severity:o.SEVERITY.CRITICAL}),t}})),define("modules/clean/react/payments/common/middleware/captcha_visibility_checker",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){var t=this;this.POLLING_FREQUENCY_MS=500,this.checkCaptchaVisibility=function(){t.isCheckingCaptchaVisibility&&(t.isCaptchaVisible=t.getCaptchaVisibility(),t.isCaptchaVisible?(t.isCheckingCaptchaVisibility=!1,t.onCaptchaVisibility(!0)):setTimeout(t.checkCaptchaVisibility,t.POLLING_FREQUENCY_MS))},this.isCaptchaVisible=!1,this.isCheckingCaptchaVisibility=!1,this.onCaptchaVisibility=e,this.wasLastCaptchaSubmitVisible=!1}return e.prototype.triggerCaptcha=function(){this.isCheckingCaptchaVisibility=!0,this.checkCaptchaVisibility()},e.prototype.submitCaptcha=function(){this.isCaptchaVisible||this.onCaptchaVisibility(!1),this.wasLastCaptchaSubmitVisible=this.isCaptchaVisible,this.isCaptchaVisible=!1,this.isCheckingCaptchaVisibility=!1},e.prototype.getCaptchaVisibility=function(){var e=document.querySelector('iframe[src^="https://www.google.com/recaptcha/api2/bframe"]');return null!==e&&null!==e.parentElement&&null!==e.parentElement.parentElement&&"visible"===e.parentElement.parentElement.style.visibility},e})();t.CaptchaVisibilityChecker=r})),define("modules/clean/react/payments/common/middleware/payments_ux_logger",["require","exports","tslib","modules/clean/payments/three_ds_helper","modules/clean/payments/payment_form/payment_form_spec","modules/clean/logging/telemetry","modules/core/exception","modules/clean/logging/hive/schemas/web-payments_ux_analytics","modules/clean/react/payments/common/form_values","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/common/middleware/captcha_visibility_checker","modules/clean/react/payments/buy/actions/page_actions"],(function(e,t,r,a,n,o,i,s,l,u,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),i=r.__importStar(i);var d=new Set(["BlurAccountHolderName","BlurAddress","BlurCity","BlurCpf","BlurIBAN","BlurName","BlurVat","BlurZipCode","UpdateCountryCode","UpdateIdealBank","UpdateMandateSigned","UpdatePaymentMethod"]),m=(function(){function e(e,t){var r=this;void 0===t&&(t=s.PaymentsUxPlatform.Legacy),this.reduxMiddleware=function(e){return function(t){return function(a){var n=e.getState(),o=t(a);try{var s=e.getState();r.handleAction(a,s,n)}catch(e){i.reportException({err:e,severity:i.SEVERITY.CRITICAL,tags:["payments_ux_logger","payment"]})}return o}}},this.onCaptchaVisibility=function(e){var t={challenge_type:e?s.ChallengeType.ShownCaptcha:s.ChallengeType.SuppressedCaptcha,origin_submit_seq:r.originSubmitSeq.toString()};r.actionSeq++,r.logChallengeStart(t)},this.requestSeq=-1,this.actionSeq=-1,this.originSubmitSeq=0,this.requestId=e,this.logger=new o.HiveLogger,this.captchaVisibilityChecker=new c.CaptchaVisibilityChecker(this.onCaptchaVisibility),this.platform=t}return e.prototype.handleAction=function(e,t,r){var o;if(this.isPageView(e)){var i=((o={})[s.FormFields.CountryCode]=t.formData.countryCode.rawValue,o[s.FormFields.PaymentMethod]=n.PaymentMethod[t.formData.paymentMethod.rawValue],o);this.requestSeq++,this.actionSeq=0,this.logPageView(i)}else if(this.isFormFieldChange(e)){null!==(i=this.getFormFieldChangeDetails(e.type,t.formData,r.formData))&&(this.actionSeq++,this.logFormFieldChange(i))}else if(this.isCCFormFieldChange(e)){null!==(i=this.getCCFormFieldChangeDetails(e.creditCardIframeFields))&&(this.actionSeq++,this.logFormFieldChange(i))}else if(this.isShowFormFieldErrors(e)){if(this.isErrorFromSubmitForm(e)){i=this.getFormValidationErrorDetails(t.formData);this.actionSeq++,this.logFormValidationError(i)}}else if(this.isSubmitFormSuccess(e)){i=this.getFormSubmitEventDetails(u.SubmitFormTriggerType.ButtonClick,t.formData,r.pageState.submitSeq);this.actionSeq++,this.logFormSubmitSuccess(i)}else if(this.isSubmitFormStart(e)){i=this.getFormSubmitEventDetails(e.trigger,t.formData,r.pageState.submitSeq);this.actionSeq++,this.logFormSubmit(i)}else if(this.isTriggerCaptcha(e))this.captchaVisibilityChecker.triggerCaptcha();else if(this.isSubmitCaptcha(e)){this.captchaVisibilityChecker.submitCaptcha();i={challenge_type:this.captchaVisibilityChecker.wasLastCaptchaSubmitVisible?s.ChallengeType.ShownCaptcha:s.ChallengeType.SuppressedCaptcha,origin_submit_seq:this.originSubmitSeq.toString()};this.actionSeq++,this.logChallengeSubmit(i)}else if(this.isTriggerThreeDsChallenge(e)){i={challenge_type:s.ChallengeType.ThreeDsChallenge,origin_submit_seq:this.originSubmitSeq.toString()};this.actionSeq++,this.logChallengeStart(i)}else if(this.isTriggerThreeDsFingerprint(e)){i={challenge_type:s.ChallengeType.ThreeDsFingerprint,origin_submit_seq:this.originSubmitSeq.toString()};this.actionSeq++,this.logChallengeStart(i)}else if(this.isUpdateThreeDsData(e)){if(""!==e.value){var l=JSON.parse(e.value),c=void 0;if(l.resultType===a.ThreeDsResultType.IdentifyShopper)c=s.ChallengeType.ThreeDsFingerprint;else{if(l.resultType!==a.ThreeDsResultType.ChallengeShopper)return;c=s.ChallengeType.ThreeDsChallenge}i={challenge_type:c,origin_submit_seq:this.originSubmitSeq.toString()};this.actionSeq++,this.logChallengeSubmit(i)}}else this.isApplePayClosedByError(e)?this.log(s.PaymentsUXEvent.ApplePayClosedByError,{}):this.isApplePayClosedBySuccess(e)?this.log(s.PaymentsUXEvent.ApplePayClosedBySuccess,{}):this.isApplePayClosedByUser(e)?this.log(s.PaymentsUXEvent.ApplePayClosedByUser,{}):this.isApplePayPopupShown(e)?this.log(s.PaymentsUXEvent.ApplePayPopupShown,{}):this.isApplePayStartup(e)&&this.log(s.PaymentsUXEvent.ApplePayStartup,{})},e.prototype.logPageView=function(e){this.log(s.PaymentsUXEvent.PageView,e)},e.prototype.logFormFieldChange=function(e){this.log(s.PaymentsUXEvent.FormFieldChange,e)},e.prototype.logFormValidationError=function(e){this.log(s.PaymentsUXEvent.FormValidationError,e)},e.prototype.logFormSubmitSuccess=function(e){this.log(s.PaymentsUXEvent.FormSubmitSuccess,e)},e.prototype.logFormSubmit=function(e){this.log(s.PaymentsUXEvent.FormSubmit,e)},e.prototype.logChallengeStart=function(e){this.log(s.PaymentsUXEvent.ChallengeStart,e)},e.prototype.logChallengeSubmit=function(e){this.log(s.PaymentsUXEvent.ChallengeSubmit,e)},e.prototype.log=function(e,t){this.logger.log(new s.PaymentsUXAnalyticsRow({event_name:e,event_details:t,request_id:this.requestId,request_seq:this.requestSeq,action_seq:this.actionSeq,platform:this.platform}))},e.prototype.isPageView=function(e){return e.type===p.PageActionEnum.UpdateHistory},e.prototype.isFormFieldChange=function(e){return d.has(e.type)},e.prototype.isShowFormFieldErrors=function(e){return"ShowFormFieldErrors"===e.type},e.prototype.isErrorFromSubmitForm=function(e){return"SubmitForm"===e.origin},e.prototype.isSubmitFormStart=function(e){return"SubmitFormStart"===e.type},e.prototype.isSubmitFormSuccess=function(e){return"SubmitFormSuccess"===e.type},e.prototype.isTriggerCaptcha=function(e){return"TriggerCaptcha"===e.type},e.prototype.isSubmitCaptcha=function(e){return"SubmitCaptcha"===e.type},e.prototype.isTriggerThreeDsChallenge=function(e){return"TriggerThreeDsChallenge"===e.type},e.prototype.isTriggerThreeDsFingerprint=function(e){return"TriggerThreeDsFingerprint"===e.type},e.prototype.isUpdateThreeDsData=function(e){return"UpdateThreeDsData"===e.type},e.prototype.isCCFormFieldChange=function(e){return"BlurCCField"===e.type},e.prototype.isApplePayStartup=function(e){return"ApplePayStartup"===e.type},e.prototype.isApplePayPopupShown=function(e){return"ApplePayPopupShown"===e.type},e.prototype.isApplePayClosedByError=function(e){return"ApplePayClosedByError"===e.type},e.prototype.isApplePayClosedBySuccess=function(e){return"ApplePayClosedBySuccess"===e.type},e.prototype.isApplePayClosedByUser=function(e){return"ApplePayPopupCloseByUser"===e.type},e.prototype.getFormFieldChangeDetails=function(e,t,r){switch(e){case"BlurAccountHolderName":return{field:s.FormFields.SepaAccountHolderName,value:t.accountHolderName.rawValue,error_state:l.InputErrorState[t.accountHolderName.errorState],show_error:t.accountHolderName.showError.toString()};case"BlurAddress":return{field:s.FormFields.Address,value:t.address.rawValue,error_state:l.InputErrorState[t.address.errorState],show_error:t.address.showError.toString()};case"BlurCity":return{field:s.FormFields.City,value:t.city.rawValue,error_state:l.InputErrorState[t.city.errorState],show_error:t.city.showError.toString()};case"BlurCpf":return{field:s.FormFields.Cpf,value:t.cpf.rawValue,error_state:l.InputErrorState[t.cpf.errorState],show_error:t.cpf.showError.toString()};case"BlurIBAN":return{field:s.FormFields.Iban,value:t.iban.rawValue,error_state:l.InputErrorState[t.iban.errorState],show_error:t.iban.showError.toString()};case"BlurName":return{field:s.FormFields.CardholderName,value:t.name.rawValue,error_state:l.InputErrorState[t.name.errorState],show_error:t.name.showError.toString()};case"BlurVat":return{field:s.FormFields.Vat,value:t.vat.rawValue,error_state:l.InputErrorState[t.vat.errorState],show_error:t.vat.showError.toString()};case"BlurZipCode":return{field:s.FormFields.ZipCode,value:t.zipCode.rawValue,error_state:l.InputErrorState[t.zipCode.errorState],show_error:t.zipCode.showError.toString()};case"UpdateCountryCode":return r.countryCode.rawValue!==t.countryCode.rawValue?{field:s.FormFields.CountryCode,value:t.countryCode.rawValue,error_state:l.InputErrorState[t.countryCode.errorState],show_error:t.countryCode.showError.toString()}:null;case"UpdateIdealBank":return r.idealBankId.rawValue!==t.idealBankId.rawValue?{field:s.FormFields.IdealBankId,value:t.idealBankId.rawValue,error_state:l.InputErrorState[t.idealBankId.errorState],show_error:t.idealBankId.showError.toString()}:null;case"UpdateMandateSigned":return r.mandateSigned.rawValue!==t.mandateSigned.rawValue?{field:s.FormFields.SepaMandateSigned,value:t.mandateSigned.rawValue.toString(),error_state:l.InputErrorState[t.mandateSigned.errorState],show_error:t.mandateSigned.showError.toString()}:null;case"UpdatePaymentMethod":return r.paymentMethod.rawValue!==t.paymentMethod.rawValue?{field:s.FormFields.PaymentMethod,value:n.PaymentMethod[t.paymentMethod.rawValue],error_state:l.InputErrorState[t.paymentMethod.errorState],show_error:t.paymentMethod.showError.toString()}:null;default:return null}},e.prototype.getCCFormFieldChangeDetails=function(e){return e.ccn?{field:s.FormFields.CreditCardNumber,error_state:l.InputErrorState[e.ccn.isValid?l.InputErrorState.Valid:l.InputErrorState.Invalid],show_error:e.ccn.showError.toString()}:e.ccode?{field:s.FormFields.CreditCardCode,error_state:l.InputErrorState[e.ccode.isValid?l.InputErrorState.Valid:l.InputErrorState.Invalid],show_error:e.ccode.showError.toString()}:e.ccexp?{field:s.FormFields.CreditCardExpDate,error_state:l.InputErrorState[e.ccexp.isValid?l.InputErrorState.Valid:l.InputErrorState.Invalid],show_error:e.ccexp.showError.toString()}:null},e.prototype.getFormValidationErrorDetails=function(e){var t={};return e.countryCode.showError&&(t[s.FormFields.CountryCode]=l.InputErrorState[e.countryCode.errorState]),e.paymentMethod.showError&&(t[s.FormFields.PaymentMethod]=l.InputErrorState[e.paymentMethod.errorState]),e.zipCode.showError&&(t[s.FormFields.ZipCode]=l.InputErrorState[e.zipCode.errorState]),e.vat.showError&&(t[s.FormFields.Vat]=l.InputErrorState[e.vat.errorState]),e.paymentMethod.formattedValue===n.PaymentMethod.CreditCard?(e.nonce.showError&&(e.nonce.isCCNValid||(t[s.FormFields.CreditCardNumber]=l.InputErrorState[l.InputErrorState.Invalid]),e.nonce.isCCodeValid||(t[s.FormFields.CreditCardCode]=l.InputErrorState[l.InputErrorState.Invalid]),e.nonce.isCCExpValid||(t[s.FormFields.CreditCardExpDate]=l.InputErrorState[l.InputErrorState.Invalid])),e.cpf.showError&&(t[s.FormFields.Cpf]=l.InputErrorState[e.cpf.errorState]),e.name.showError&&(t[s.FormFields.CardholderName]=l.InputErrorState[e.name.errorState]),e.address.showError&&(t[s.FormFields.Address]=l.InputErrorState[e.address.errorState]),e.city.showError&&(t[s.FormFields.City]=l.InputErrorState[e.city.errorState])):e.paymentMethod.formattedValue===n.PaymentMethod.DirectDeposit?(e.mandateSigned.showError&&(t[s.FormFields.SepaMandateSigned]=l.InputErrorState[e.mandateSigned.errorState]),e.accountHolderName.showError&&(t[s.FormFields.SepaAccountHolderName]=l.InputErrorState[e.accountHolderName.errorState]),e.iban.showError&&(t[s.FormFields.Iban]=l.InputErrorState[e.iban.errorState])):e.paymentMethod.formattedValue===n.PaymentMethod.Ideal&&e.idealBankId.showError&&(t[s.FormFields.IdealBankId]=l.InputErrorState[e.idealBankId.errorState]),t},e.prototype.getFormSubmitEventDetails=function(e,t,r){var a;switch(e){case u.SubmitFormTriggerType.ButtonClick:a=s.FormSubmitTrigger.ButtonClick,this.originSubmitSeq=r;break;case u.SubmitFormTriggerType.RecaptchaV2:a=this.captchaVisibilityChecker.wasLastCaptchaSubmitVisible?s.FormSubmitTrigger.ShownCaptcha:s.FormSubmitTrigger.SuppressedCaptcha;break;case u.SubmitFormTriggerType.ThreeDsFingerprint:a=s.FormSubmitTrigger.ThreeDsFingerprint;break;case u.SubmitFormTriggerType.ThreeDsChallenge:a=s.FormSubmitTrigger.ThreeDsChallenge;break;default:a=s.FormSubmitTrigger.Unknown}var o={origin_submit_seq:this.originSubmitSeq.toString(),submit_seq:r.toString(),trigger:a};return a===s.FormSubmitTrigger.ButtonClick&&(o[s.FormFields.CountryCode]=t.countryCode.rawValue,o[s.FormFields.PaymentMethod]=n.PaymentMethod[t.paymentMethod.rawValue],t.paymentMethod.rawValue===n.PaymentMethod.CreditCard&&(o.bin=t.bin.rawValue)),o},e})();t.PaymentsUXLogger=m})),define("modules/clean/logging/hive/schemas/web-payments_ux_analytics",["require","exports","tslib","modules/core/browser"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),(function(e){e.PageView="page_view",e.FormFieldChange="form_field_change",e.FormValidationError="form_validation_error",e.FormSubmit="form_submit",e.ChallengeStart="challenge_start",e.ChallengeSubmit="challenge_submit",e.FormSubmitSuccess="form_submit_success",e.ApplePayStartup="apple_pay_startup",e.ApplePayPopupShown="apple_pay_popup_shown",e.ApplePayClosedByUser="apple_pay_closed_by_user",e.ApplePayClosedByError="apple_pay_closed_by_error",e.ApplePayClosedBySuccess="apple_pay_closed_by_success"})(t.PaymentsUXEvent||(t.PaymentsUXEvent={})),(function(e){e.Address="address",e.CardholderName="name",e.City="city",e.CountryCode="country_code",e.Cpf="cpf",e.CreditCardCode="cc_code",e.CreditCardExpDate="cc_exp_date",e.CreditCardNumber="cc_number",e.Iban="iban",e.IdealBankId="bank_id",e.PaymentMethod="payment_method",e.SepaAccountHolderName="owner_name",e.SepaMandateSigned="mandate_signed",e.Vat="vat",e.ZipCode="zip_code"})(t.FormFields||(t.FormFields={})),(function(e){e.SuppressedCaptcha="suppressed_captcha",e.ShownCaptcha="shown_captcha",e.ThreeDsChallenge="three_ds_challenge",e.ThreeDsFingerprint="three_ds_fingerprint"})(t.ChallengeType||(t.ChallengeType={})),(function(e){e.ButtonClick="button_click",e.SuppressedCaptcha="suppressed_captcha",e.ShownCaptcha="shown_captcha",e.ThreeDsChallenge="three_ds_challenge",e.ThreeDsFingerprint="three_ds_fingerprint",e.Unknown="unknown"})(t.FormSubmitTrigger||(t.FormSubmitTrigger={})),(function(e){e.Legacy="legacy",e.RevenueAPI="revenue_api"})(t.PaymentsUxPlatform||(t.PaymentsUxPlatform={}));var n=function(e){this.category="web-payments_ux_analytics",this.session_id=null,this.user_id=null,this.team_id=null,this.anon_ip=null,this.country=null,this.locale_user_selected=null,this.locale_browser_header=null,this.user_agent=null,this.ua_browser_name=null,this.ua_browser_version=null,this.ua_os_name=null,this.ua_os_version=null,this.ua_dist_name=null,this.ua_dist_version=null,this.event_name=e.event_name,this.event_details=e.event_details,this.url=a.get_href(),this.request_id=e.request_id,this.request_seq=e.request_seq,this.action_seq=e.action_seq,this.platform=e.platform,Object.seal(this)};t.PaymentsUXAnalyticsRow=n})),define("modules/clean/payments/skus/subscription_change_plan_set",["require","exports","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_change_plan"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this._subChangePlans=e}return e.deserialize=function(t){return new e(t.map(a.SubscriptionChangePlan.deserialize))},Object.defineProperty(e.prototype,"plans",{get:function(){return this._subChangePlans.slice()},enumerable:!0,configurable:!0}),e.prototype.filter=function(t){return new e(this._subChangePlans.filter(t))},e.prototype.withProductPlanType=function(e){return this.filter((function(t){var r=t.finalSubState.plan;return!!r&&r.productType===e}))},e.prototype.withSchedule=function(e){return this.filter((function(t){var r=t.finalSubState.billingSchedule;return!!r&&r.id===e}))},e.prototype.withSku=function(e){return this.filter((function(t){return t.finalSubState.plan===e}))},e.prototype.monthly=function(){return this.withSchedule(r.ScheduleId.MONTHLY)},e.prototype.yearly=function(){return this.withSchedule(r.ScheduleId.YEARLY)},e})();t.SubscriptionChangePlanSet=n})),define("modules/clean/react/payments/common/form/middleware/middleware",["require","exports","tslib","external/lodash","modules/core/browser","modules/core/notify","modules/clean/marketing_tracker"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),t.submitFormErrorMiddleware=function(e){return function(e){return function(t){if("SubmitFormError"!==t.type)return e(t);var r=e(t);return t.data.error_message&&o.Notify.error(t.data.error_message),t.data.redirect&&n.redirect(t.data.redirect),r}}};var s={};t.marketingEventMiddleware=function(e){return function(t){return function(r){var n=r.additionalData;switch(r.type){case"SubmitFormStart":if(!n||!n.send_conversion_data)return t(r);var o={event:"conversionDataReady",tealium_event:"conversionDataReady",product:n.product,licenses:n.licenses||1,billing_cycle:n.billing_schedule,purchase_price:n.expected_price_amount,currency:n.currency,type:n.signup_type};if(a.isEqual(s,o))return t(r);i.MarketingTracker.pushWithDefaults(o),s=o;break;case"SubmitFormSuccess":var l=e.getState().pageState;if(l&&l.marketingTracker){var u=l.marketingTracker.onSubmitFormSuccess;u&&i.MarketingTracker.pushEvent(u)}}return t(r)}}}})),define("modules/clean/react/payments/common/form/reducers/reducers",["require","exports","tslib","redux","modules/clean/react/payments/common/form_values","modules/clean/payments/skus/constants","modules/clean/react/payments/business/state/business_state","modules/clean/react/payments/common/form_value_factory","modules/clean/react/payments/common/form_value_helpers"],(function(e,t,r,a,n,o,i,s,l){"use strict";function u(e,t){var a=i.fieldsToServerProps[e];return a?function(n,o){switch(o.type){case"ShowFormFieldErrors":var i=o;if(n&&!l.FormValueHelper.isValid(n))for(var s=0,u=i.fieldNames;s<u.length;s++){var c=u[s];if(e===c)return r.__assign(r.__assign({},n),{showError:!0})}return n;case"SubmitFormError":var p=o;return p.data instanceof Object&&p.data.error_fields instanceof Object&&p.data.error_fields.hasOwnProperty(a)?n?r.__assign(r.__assign({},n),{showError:!0,serverError:p.data.error_fields[a]}):{showError:!0,serverError:p.data.error_fields[a]}:n;default:return t(n,o)}}:t}function c(e){return function(t,a){return t?r.__assign(r.__assign({},t),e(t,a)):e(t,a)}}function p(e,t){var a=t;switch(a.type){case"SubmitFormError":var o=a;if(o.data instanceof Object&&o.data.hasOwnProperty("error_fields")&&o.data.error_fields.hasOwnProperty("email")){var i=o.data.error_fields.email,u=void 0;switch(i){case"empty":u=n.EmailErrorState.Empty;break;case"account":case"email-taken":u=n.EmailErrorState.TakenError;break;default:u=e?e.errorState:n.EmailErrorState.Valid}return r.__assign(r.__assign({},e),{showError:!0,serverError:i,errorState:u})}return o.data instanceof Object&&o.data.hasOwnProperty("error_type")&&"capturable_user"===o.data.error_type.toString()?r.__assign(r.__assign({},e),{showError:!1,isCapturable:!0}):e;case"ShowFormFieldErrors":var c=a;if(e&&!l.FormValueHelper.isValid(e))for(var p=0,d=c.fieldNames;p<d.length;p++){if("email"===d[p])return r.__assign(r.__assign({},e),{showError:!0})}return e;case"UpdateEmail":var m=a;return s.FormValueFactory.createEmail(m.value,e||void 0);default:return e||null}}function d(e,t){if(void 0===e&&(e=null),"SubmitFormSuccess"!==t.type)return null;var r=t;return r.data&&r.data.next_url?r.data.next_url:null}function m(e,t){switch(void 0===e&&(e=null),t.type){case"SubmitFormStart":return"submitting";case"SubmitFormSuccess":return"success";case"SubmitFormError":return"error";default:return e}}function f(e,t){return void 0===e&&(e=null),"SubmitFormStart"===t.type&&"number"==typeof e?e+1:e}function y(e,t){switch(void 0===e&&(e=!1),t.type){case"SubmitFormStart":return!0;case"SubmitFormSuccess":case"SubmitFormError":return!1;default:return e}}function h(e,t){e=e||{};var a=t;switch(a.type){case"UpdateCpfName":return r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{cpfName:s.FormValueFactory.createCpfName(a.value,e.formData.cpfName)})});case"UpdateFirstName":return e.formData.cpfName.manuallyEdited?e:r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{cpfName:s.FormValueFactory.createCpfNamePrefill(a.value,e.formData.lastName.rawValue,e.pageState.userInfo.displayName)})});case"UpdateLastName":return e.formData.cpfName.manuallyEdited?e:r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{cpfName:s.FormValueFactory.createCpfNamePrefill(e.formData.firstName.rawValue,a.value,e.pageState.userInfo.displayName)})});default:return e}}function _(e,t){e=e||{};var a=t;switch(a.type){case"SubmitFormError":var n=a,i="";return n.data&&n.data.error_fields&&(i=n.data.error_fields.product_plan_type),r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{productPlanType:r.__assign(r.__assign({},e.formData.productPlanType),{serverError:i,showError:!0})})});case"ShowFormFieldErrors":var u=a;if(e.formData.productPlanType&&!l.FormValueHelper.isValid(e.formData.productPlanType))for(var c=0,p=u.fieldNames;c<p.length;c++){if("productPlanType"===p[c])return r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{productPlanType:r.__assign(r.__assign({},e.formData.productPlanType),{showError:!0})})})}return e;case"UpdateProductPlanType":var d=a,m=d.value,f=m===o.ProductPlanType.ADVANCED?e.pageState.advancedMinNumUsers:e.pageState.standardMinNumUsers,y=m===o.ProductPlanType.ADVANCED?e.pageState.advancedMaxNumUsers:e.pageState.standardMaxNumUsers;return void 0!==e.pageState.teamNumUsers&&(f=Math.max(f,e.pageState.teamNumUsers)),r.__assign(r.__assign({},e),{pageState:r.__assign(r.__assign({},e.pageState),{minNumUsers:f,maxNumUsers:y}),formData:r.__assign(r.__assign({},e.formData),{productPlanType:s.FormValueFactory.createProductPlanType(d.value,e.pricingState.subChangePlans,e.formData.productPlanType)})});default:return e}}function g(e,t){e=e||{};var a=t;switch(a.type){case"SubmitFormError":var n=a,o="";return n.data&&n.data.error_fields&&(o=n.data.error_fields.team_num_users),r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{numberOfUsers:r.__assign(r.__assign({},e.formData.numberOfUsers),{serverError:o,showError:!0})})});case"ShowFormFieldErrors":var i=a;if(e.formData.numberOfUsers&&!l.FormValueHelper.isValid(e.formData.numberOfUsers))for(var u=0,c=i.fieldNames;u<c.length;u++){if("numberOfUsers"===c[u])return r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{numberOfUsers:r.__assign(r.__assign({},e.formData.numberOfUsers),{showError:!0})})})}return e;case"UpdateNumberOfUsers":var p=a;return r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{numberOfUsers:s.FormValueFactory.createNumberOfUsers(p.value,e.pageState,e.formData.numberOfUsers,e.formData.numberOfUsers.minLicenseLimit,e.formData.emailsToInvite?e.formData.emailsToInvite.rawValue.length:0)})});default:return e}}function v(e,t){e=e||{};var a=t;return"UpdateMarketingOptIn"!==a.type?e:r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{marketingOptIn:s.FormValueFactory.createCheckbox(a.value,e.formData.marketingOptIn,!0)})})}Object.defineProperty(t,"__esModule",{value:!0}),t.companySize=u("companySize",(function(e,t){return"UpdateCompanySize"===t.type?s.FormValueFactory.createInput(t.value,e||void 0):e||null})),t.email=p,t.emailsToInvite=u("emailsToInvite",(function(e,t){return"UpdateEmailsToInvite"===t.type?s.FormValueFactory.createEmailsToInvite(t.value,e||void 0):e||null})),t.firstName=u("firstName",(function(e,t){return"UpdateFirstName"===t.type?s.FormValueFactory.createInput(t.value,e||void 0):e||null})),t.lastName=u("lastName",(function(e,t){return"UpdateLastName"===t.type?s.FormValueFactory.createInput(t.value,e||void 0):e||null})),t.nextUrl=d,t.password=u("password",(function(e,t){return"UpdatePassword"===t.type?s.FormValueFactory.createPassword(t.value,e||void 0):e||null})),t.schedule=u("schedule",(function(e,t){return"UpdateSchedule"===t.type?s.FormValueFactory.createSchedule(t.value):e||null})),t.submitState=m,t.submitSeq=f,t.submitting=y,t.teamName=u("teamName",(function(e,t){return"UpdateTeamName"===t.type?s.FormValueFactory.createInput(t.value,e||void 0):e||null})),t.teamPhone=u("teamPhone",(function(e,t){return"UpdateTeamPhone"===t.type?s.FormValueFactory.createTeamPhone(t.value,e||void 0):e||null})),t.updateCpfName=h,t.updateProductPlanType=_,t.updateNumberOfUsers=g,t.updateMarketingOptIn=v;var b=c(a.combineReducers({nextUrl:d,submitState:m,submitting:y,submitSeq:f})),P=c(a.combineReducers({companySize:t.companySize,email:p,emailsToInvite:t.emailsToInvite,firstName:t.firstName,lastName:t.lastName,password:t.password,schedule:t.schedule,teamName:t.teamName,teamPhone:t.teamPhone}));t.FormReducer=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(r,a){return t(e(r,a),a)}}))})(h,_,g,v,a.combineReducers({pricingState:function(e){return e||{}},pageState:b,formData:P}))})),define("modules/clean/react/payments/common/payments/reducers/reducers",["require","exports","tslib","modules/clean/react/payments/business/state/business_state","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/form_value_factory"],(function(e,t,r,a,n,o){"use strict";function i(e,t){return r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),t)})}function s(e){var t=a.fieldsToServerProps[e];return t?function(a){return function(o,s){var l=o.formData[e];switch(s.type){case"ShowFormFieldErrors":for(var u=0,c=s.fieldNames;u<c.length;u++){if(c[u]===e&&void 0!==l&&!n.FormValueHelper.isValid(l)){var p={};return p[e]=r.__assign(r.__assign({},l),{showError:!0}),i(o,p)}}return o;case"SubmitFormError":var d=s;if(!d.data||!d.data.error_fields||!d.data.error_fields[t]||void 0===l)return o;var m={};return m[e]=r.__assign(r.__assign({},l),{showError:!0,serverError:d.data.error_fields[t]}),i(o,m);default:return a(o,s)}}}:function(e){return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.updatePaymentMethod=s("paymentMethod")((function(e,t){if("UpdatePaymentMethod"!==t.type&&"UpdateCountryCode"!==t.type)return e;var r=e.formData,a=e.pageState,n="UpdatePaymentMethod"===t.type?t.value:r.paymentMethod.rawValue,s=r.countryCode.formattedValue;return i(e,{paymentMethod:o.FormValueFactory.createPaymentMethod(n,s,a.paymentFormSpec,r.paymentMethod)})})),t.updateCountryCode=s("countryCode")((function(e,t){return"UpdateCountryCode"!==t.type?e:i(e,{countryCode:o.FormValueFactory.createCountryCode(t.value,e.formData.countryCode)})})),t.updateZipCode=s("zipCode")((function(e,t){return"UpdateZipCode"!==t.type&&"UpdateCountryCode"!==t.type?e:i(e,{zipCode:o.FormValueFactory.createZipCode("UpdateZipCode"===t.type?t.value:e.formData.zipCode.rawValue,e.formData.countryCode.formattedValue,e.pageState.paymentFormSpec,e.formData.zipCode)})})),t.updateVat=s("vat")((function(e,t){return"UpdateVat"!==t.type&&"UpdateCountryCode"!==t.type?e:i(e,{vat:o.FormValueFactory.createVat("UpdateVat"===t.type?t.value.toUpperCase():e.formData.vat.rawValue,e.formData.countryCode.formattedValue,e.formData.vat)})})),t.updateCpf=s("cpf")((function(e,t){return"UpdateCpf"!==t.type&&"UpdateCountryCode"!==t.type?e:i(e,{cpf:o.FormValueFactory.createCpf("UpdateCpf"===t.type?t.value.toUpperCase():e.formData.cpf.rawValue,e.formData.cpf)})})),t.updatePhone=s("phone")((function(e,t){return"UpdatePhone"!==t.type?e:i(e,{phone:o.FormValueFactory.createPhone(t.value,e.formData.phone)})})),t.updateAddress=s("address")((function(e,t){return"UpdateAddress"!==t.type?e:i(e,{address:o.FormValueFactory.createAddress(t.value,e.formData.address)})})),t.updateName=s("name")((function(e,t){return"UpdateName"!==t.type?e:i(e,{name:o.FormValueFactory.createName(t.value,e.formData.name)})})),t.updateCity=s("city")((function(e,t){return"UpdateCity"!==t.type?e:i(e,{city:o.FormValueFactory.createCity(t.value,e.formData.city)})})),t.updateCpfName=s("cpfName")((function(e,t){return"UpdateCpfName"!==t.type?e:i(e,{cpfName:o.FormValueFactory.createCpfName(t.value,e.formData.cpfName)})})),t.updateNonce=s("nonce")((function(e,t){return"UpdateNonce"!==t.type?e:i(e,{nonce:o.FormValueFactory.createNonce(t.value,t.creditCardIframeFields,e.formData.nonce)})})),t.updatePayPalNonce=s("nonce")((function(e,t){return"UpdatePayPalNonce"!==t.type?e:i(e,{payPalNonce:o.FormValueFactory.createPayPalNonce(t.value,t.email,e.formData.payPalNonce)})})),t.updateAdyenEncryptedCard=s("adyenEncryptedCard")((function(e,t){return"UpdateAdyenEncryptedCard"!==t.type?e:i(e,{adyenEncryptedCard:o.FormValueFactory.createAdyenEncryptedCard(t.value,e.formData.adyenEncryptedCard)})})),t.updateEncryptedCardForNetworkToken=s("encryptedCardForNetworkToken")((function(e,t){return"UpdateEncryptedCardForNetworkToken"!==t.type?e:i(e,{encryptedCardForNetworkToken:o.FormValueFactory.createEncryptedCardForNetworkToken(t.cardType,t.encryptedCard)})})),t.updateApplePayToken=s("applePayToken")((function(e,t){return"UpdateApplePayToken"!==t.type?e:i(e,{applePayToken:o.FormValueFactory.createApplePayToken(t.value,e.formData.applePayToken)})})),t.updateBIN=s("bin")((function(e,t){return"UpdateBIN"!==t.type?e:i(e,{bin:o.FormValueFactory.createBIN(t.value,e.formData.bin)})})),t.updateBrowserInfo=s("browserInfo")((function(e,t){return"UpdateBrowserInfo"!==t.type?e:i(e,{browserInfo:o.FormValueFactory.createBrowserInfo(t.value,e.formData.browserInfo)})})),t.updateThreeDsData=s("threeDsData")((function(e,t){return"UpdateThreeDsData"!==t.type?e:i(e,{threeDsData:o.FormValueFactory.createThreeDsData(t.value)})})),t.updateAccountHolderName=s("accountHolderName")((function(e,t){return"UpdateAccountHolderName"!==t.type?e:i(e,{accountHolderName:o.FormValueFactory.createInput(t.value,e.formData.accountHolderName)})})),t.updateIBAN=s("iban")((function(e,t){return"UpdateIBAN"!==t.type?e:i(e,{iban:o.FormValueFactory.createIBAN(t.value,e.formData.iban)})})),t.updateMandateSigned=s("mandateSigned")((function(e,t){return"UpdateMandateSigned"!==t.type?e:i(e,{mandateSigned:o.FormValueFactory.createCheckbox(t.value,e.formData.mandateSigned)})})),t.updateTermsAndService=s("termsAndService")((function(e,t){return"UpdateTermsAndService"!==t.type?e:i(e,{termsAndService:o.FormValueFactory.createCheckbox(t.value,e.formData.termsAndService)})})),t.updateIdealBank=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(r,a){return t(e(r,a),a)}}))})(s("idealBankId")((function(e,t){return"UpdateIdealBank"!==t.type?e:i(e,{idealBankId:o.FormValueFactory.createIdealBankId(t.value.bankId,e.formData.idealBankId)})})),s("idealBankName")((function(e,t){return"UpdateIdealBank"!==t.type?e:i(e,{idealBankName:o.FormValueFactory.createIdealBankName(t.value.bankName,e.formData.idealBankName)})}))),t.PaymentMethodReducers=[t.updateCountryCode,t.updatePaymentMethod,t.updateZipCode,t.updateVat,t.updateCpf,t.updateCpfName,t.updateNonce,t.updateAdyenEncryptedCard,t.updateEncryptedCardForNetworkToken,t.updateBIN,t.updateBrowserInfo,t.updateThreeDsData,t.updateAccountHolderName,t.updateIBAN,t.updateMandateSigned,t.updateIdealBank,t.updateCity,t.updateAddress,t.updatePhone,t.updateName,t.updatePayPalNonce,t.updateApplePayToken],t.TermsAndServiceReducers=[t.updateTermsAndService]})),define("modules/clean/react/payments/common/payments/state/store_creator",["require","exports","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form_value_factory"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPaymentPricingState=function(e){return{countryCode:a.FormValueFactory.createCountryCode(e.countryCode).formattedValue,countryCodeLoading:void 0,hasCurrencyChanged:!1,hasTaxChangedWithinCountry:!1,loadingPrices:!1,recentLoadEvent:!1,requestToken:-1}},t.createPaymentPageState=function(e){return{paymentFormSpec:new r.PaymentFormSpec(e.serializedPaymentFormSpec),requestId:e.requestId,submitSeq:0,paypalEmail:""}},t.createPaymentFormData=function(e,t,r){var n=e.countryCode,o=e.userInfo,i=e.vat,s=t.paymentFormSpec.default_payment_method_for_country(n);return{city:a.FormValueFactory.createCity(""),phone:a.FormValueFactory.createPhone(""),name:a.FormValueFactory.createName(""),address:a.FormValueFactory.createAddress(""),paymentMethod:a.FormValueFactory.createPaymentMethod(s,n,t.paymentFormSpec),countryCode:a.FormValueFactory.createCountryCode(n),zipCode:a.FormValueFactory.createZipCode("",n,t.paymentFormSpec),vat:a.FormValueFactory.createVat(i||"",n),cpf:a.FormValueFactory.createCpf(""),cpfName:a.FormValueFactory.createCpfNamePrefill("","",o.displayName),nonce:a.FormValueFactory.createNonce(""),payPalNonce:a.FormValueFactory.createPayPalNonce("",""),adyenEncryptedCard:a.FormValueFactory.createAdyenEncryptedCard(""),encryptedCardForNetworkToken:a.FormValueFactory.createEncryptedCardForNetworkToken("",""),applePayToken:a.FormValueFactory.createApplePayToken(""),bin:a.FormValueFactory.createBIN(""),browserInfo:a.FormValueFactory.createBrowserInfo(""),threeDsData:a.FormValueFactory.createThreeDsData(""),accountHolderName:a.FormValueFactory.createInput(""),iban:a.FormValueFactory.createIBAN(""),mandateSigned:a.FormValueFactory.createCheckbox(!1),termsAndService:a.FormValueFactory.createCheckbox(!1),idealBankId:a.FormValueFactory.createIdealBankId(""),idealBankName:a.FormValueFactory.createIdealBankName("")}}})),define("modules/clean/react/payments/common/pricing/reducers/reducers",["require","exports","tslib","modules/clean/payments/skus/subscription_change_plan_set"],(function(e,t,r,a){"use strict";function n(e,t){if("PrepareToUpdateTransitions"!==t.type)return e;var a=r.__assign(r.__assign({},e.pricingState),{loadingPrices:!0,recentLoadEvent:!0});return r.__assign(r.__assign({},e),{pricingState:a})}function o(e,t){if("UpdateRecentLoadEventStatus"!==t.type)return e;var a=r.__assign(r.__assign({},e.pricingState),{recentLoadEvent:t.recentLoadEventStatus});return r.__assign(r.__assign({},e),{pricingState:a})}function i(e,t){if("UpdateTransitionsStart"!==t.type)return e;var a=r.__assign(r.__assign({},e.pricingState),{countryCodeLoading:e.formData.countryCode.formattedValue,loadingPrices:!0,recentLoadEvent:!0});return r.__assign(r.__assign({},e),{pricingState:a})}function s(e,t){if("UpdateTransitionsSuccess"!==t.type)return e;var n,o="N/A",i=!1,s=!1;if(t.subChangePlans&&(n=t.subChangePlans,e.pricingState.subChangePlans.plans.length>0)){var l=e.pricingState.subChangePlans.plans[0],u=n[0],c=l.tvm,p=u.tvm,d=c&&c.getCurrency(),m=p&&p.getCurrency();i=(o="N/A"===e.pricingState.originalCurrency?d:e.pricingState.originalCurrency)!==m;var f=l.nextBillingSummary.taxRate,y=f===u.nextBillingSummary.taxRate&&(0===f||d===m);s=e.pricingState.hasTaxChangedWithinCountry||!y,e.pricingState.countryCode!==e.pricingState.countryCodeLoading&&(s=!1)}var h=r.__assign(r.__assign({},e.pricingState),{countryCode:e.pricingState.countryCodeLoading,countryCodeLoading:void 0,hasCurrencyChanged:i,hasTaxChangedWithinCountry:s,loadingPrices:!1,originalCurrency:o,recentLoadEvent:!0,subChangePlans:new a.SubscriptionChangePlanSet(t.subChangePlans),baseSubChangePlans:new a.SubscriptionChangePlanSet(t.subChangePlans)});return r.__assign(r.__assign({},e),{pricingState:h})}Object.defineProperty(t,"__esModule",{value:!0}),t.TransitionManagementReducers=[n,o,i,s],t.prepareToUpdateTransitions=n,t.updateRecentLoadEventStatus=o,t.updateTransitionsStart=i,t.updateTransitionsSuccess=s})),define("modules/clean/react/payments/pro/components/inputs/inputs",["require","exports","tslib","react","react-dom","classnames","ts-key-enum"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),o=r.__importDefault(o);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=o.default({input__label:!0,"input__label--before":Boolean(!this.props.labelAfterElement),"input__label--errormodal":Boolean(this.props.errorText)},this.props.className),t=this.props.containerClassName,r=a.default.createElement("label",{className:e,htmlFor:this.props.htmlFor},this.props.labelText),n=null;this.props.labelAfterElement&&(n=r,r=null);var i,s=null;this.props.secondaryLabel&&(s=a.default.createElement("label",{className:"input__label input__label--secondary",htmlFor:this.props.htmlFor},this.props.secondaryLabel)),this.props.errorText&&(i=this.props.errorText);var l=a.default.createElement("label",{className:"input__label--error",htmlFor:this.props.htmlFor},i);return a.default.createElement("div",{className:t},r,this.props.children,n,s,l)},t})(a.default.Component);t.LabeledInput=s;var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.props.onChange&&t.props.onChange(n.default.findDOMNode(t.input))},t.onBlur=function(e){t.props.onBlur&&t.props.onBlur(n.default.findDOMNode(t.input))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.default.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,n=t.autocomplete,i=t.className,l=t.disabled,u=t.labelText,c=t.secondaryLabel,p=t.errorText,d=t.hasError,m=t.value,f=t.maxLength,y=t.containerClassName,h=t.placeholder,_=this.props.type||"text",g=o.default({input__text:!0,"input__text--error":Boolean(p)||d},this.props.inputClassName);return a.default.createElement(s,{className:i,containerClassName:y,labelText:u,htmlFor:r,errorText:p,secondaryLabel:c},a.default.createElement("input",{className:g,type:_,autoComplete:n,placeholder:h,name:r,id:r,ref:function(t){e.input=t},value:m,disabled:l,onChange:this.onChange,onBlur:this.onBlur,maxLength:f}))},t})(a.default.Component);t.LabeledTextInput=l;var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCheckboxChange=function(e){t.props.onClick&&("click"!==e.type&&e.key!==i.Key.Enter&&13!==e.charCode||(t.props.onClick(n.default.findDOMNode(t.input)),e.preventDefault()))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onClick){var e=n.default.findDOMNode(this.input),t=e.checked;t&&t!==this.props.checked&&this.props.onClick(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,n=t.className,i=t.containerClassName,l=t.disabled,u=t.labelText,c=t.labelClassName,p=t.errorText,d=t.checked,m=o.default({input__checkbox:!0,"input__checkbox--valid":d,"input__checkbox--disabled":Boolean(l)},n);return a.default.createElement(s,{containerClassName:i,className:c,errorText:p,htmlFor:r,labelAfterElement:!0,labelText:u},a.default.createElement("div",{"aria-labelledby":r,tabIndex:0,role:"checkbox",className:m,onClick:this.handleCheckboxChange,onKeyUp:this.handleCheckboxChange}),a.default.createElement("input",{tabIndex:-1,checked:d,disabled:l,id:r,name:r,ref:function(t){e.input=t},type:"checkbox"}))},t})(a.default.Component);t.LabeledCheckboxInput=u;var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleRadioChange=function(e){t.props.disabled?e.stopPropagation():t.props.onClick&&("click"!==e.type&&e.key!==i.Key.Enter&&13!==e.charCode||(t.props.onClick(e,t.props.name,t.props.value),e.preventDefault()))},t}return r.__extends(t,e),t.prototype.render=function(){var e,t=this.props,r=t.id,n=t.name,i=t.ariaLabel,l=t.disabled,u=t.value,c=t.checked,p=t.onChange,d=t.labelText,m=t.labelClassName,f=o.default({input__radio:!0,"input__radio--valid":Boolean(c),"input__radio--disabled":Boolean(l)},this.props.className),y=o.default(((e={})[this.props.containerClassName+"--valid"]=!!this.props.containerClassName&&Boolean(c),e),this.props.containerClassName);return a.default.createElement(s,{containerClassName:y,className:m,labelText:d,htmlFor:n,labelAfterElement:!0},a.default.createElement("div",{"aria-label":i||n,role:"radio",tabIndex:0,className:f,onClick:this.handleRadioChange,onKeyUp:this.handleRadioChange}),a.default.createElement("input",{id:r,tabIndex:-1,ref:"radio",type:"radio",name:n,value:u,checked:c,onChange:p,disabled:l}))},t})(a.default.Component);t.LabeledRadioInput=c;var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.props.onChange&&t.props.onChange(n.default.findDOMNode(t.input))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.default.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,n=t.className,i=t.containerClassName,l=t.labelClassName,u=t.labelText,c=t.errorText,p=o.default({input__select:!0},n);return a.default.createElement(s,{containerClassName:i,className:l,errorText:c,htmlFor:r,labelText:u},a.default.createElement("select",{className:p,id:r,name:r,onChange:this.onChange,value:this.props.value,ref:function(t){e.input=t}},this.props.children))},t})(a.default.Component);t.LabeledSelectInput=p;var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.default.createElement("div",{className:this.props.className},this.props.children,this.props.errors&&this.props.errors.map((function(e){return a.default.createElement("div",{className:e.className},a.default.createElement("label",{className:"input__label--error",htmlFor:e.name},e.text))})))},t})(a.default.Component);t.LabeledInputRow=d})),define("modules/clean/payments/cvv_hint",["require","exports","tslib","react","modules/core/i18n","modules/clean/static_urls"],(function(e,t,r,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return this.props.showServerViewVersion?a.createElement("div",{className:"cvv-hint-view-desktop","aria-live":"assertive"},a.createElement("div",null,a.createElement("h5",null,n.intl.formatMessage({id:"e9l+ET",defaultMessage:"Visa/Mastercard"})),a.createElement("p",null,n.intl.formatMessage({id:"DGHB8Q",defaultMessage:"The 3 digit number on the back of your card"})),a.createElement("h5",null,n.intl.formatMessage({id:"t6hm3E",defaultMessage:"American Express"})),a.createElement("p",null,n.intl.formatMessage({id:"+LfH2F",defaultMessage:"The 4 digit number on the front of your card"})),a.createElement("h5",null)),a.createElement("img",{src:o.static_url("/static/images/cvv2_side_by_side-vflKpqWew.png"),alt:""})):a.createElement("div",{className:"cvv-hint-view","aria-live":"assertive"},a.createElement("div",null,a.createElement("p",null,n.intl.formatMessage({id:"tx+fwq",defaultMessage:"Your card code is a 3 or 4 digit number that is found in these locations:"})),a.createElement("img",{src:o.static_url("/static/images/cvv2-vflQL_5Od.png"),alt:""}),a.createElement("h5",null,n.intl.formatMessage({id:"e9l+ET",defaultMessage:"Visa/Mastercard"})),a.createElement("p",null,n.intl.formatMessage({id:"arXhRE",defaultMessage:"The security code is a 3 digit number on the back of your credit card. It immediately follows your main card number."})),a.createElement("h5",null,n.intl.formatMessage({id:"t6hm3E",defaultMessage:"American Express"})),a.createElement("p",null,n.intl.formatMessage({id:"yxdGmm",defaultMessage:"The security code is a 4 digit number on the front of your card, just above and to the right of your main card number."}))))},t})((a=r.__importStar(a)).Component);t.CvvHint=i})),define("modules/clean/payments/cvv_hint_container",["require","exports","tslib","react","modules/clean/payments/cvv_hint","modules/clean/react/css","modules/clean/react/tooltip","spectrum/tooltip"],(function(e,t,r,a,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setSpectrumTooltipRef=function(e){t.spectrumTooltipRef=e},t.setTooltipRef=function(e){t.tooltipRef=e},t.showTooltip=function(){t.spectrumTooltipRef?t.spectrumTooltipRef.showTooltip():t.tooltipRef._show()},t.hideTooltip=function(){t.spectrumTooltipRef?t.spectrumTooltipRef.hideTooltip():t.tooltipRef._hide()},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.targetDimensions,t=a.createElement(i.Tooltip,{position:i.TooltipPosition.BOTTOM_RIGHT,tooltip_contents:a.createElement(n.CvvHint,{showServerViewVersion:this.props.showServerViewVersion}),ref:this.setTooltipRef,is_focusable:!1},a.createElement("div",{style:{width:e.width,height:e.height}}));return this.props.showServerViewVersion&&(t=a.createElement(s.Tooltip,{ref:this.setSpectrumTooltipRef,positioning:"above",tooltipContent:a.createElement(n.CvvHint,{showServerViewVersion:this.props.showServerViewVersion})},a.createElement("div",{style:{width:e.width,height:e.height}}))),a.createElement("div",{className:"cvv-hint-container"},a.createElement("div",{style:{left:e.left,top:e.top}},t))},t})((a=r.__importStar(a)).Component);t.CvvHintContainerView=l,t.CvvHintContainer=o.requireCssWithComponent(l,["/static/css/payments/cvv_hint_container-vflDN68mD.css"])})),define("modules/clean/payments/skus/pricing_data",["require","exports","tslib","modules/clean/payments/cash","modules/clean/payments/skus/constants","modules/clean/payments/skus/sku_content","modules/core/exception","modules/core/i18n"],(function(e,t,r,a,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(){function e(){}return e.createFromState=function(e,t){var r=e.formData,a=e.pricingState,o=n.ProductPlanType.NEW_STANDARD,i=r.productPlanType.formattedValue||t.productPlanType||o,s=a.discountInfo&&a.discountInfo.discountPercentage;if(0!==a.subChangePlans.plans.length){var l=a.subChangePlans.withProductPlanType(i),c=l.yearly().plans.pop(),m=l.monthly().plans.pop(),f=Math.min(c&&c.nextBillingSummary.totalLicenses,m&&m.nextBillingSummary.totalLicenses);return m&&c?isNaN(f)||f<=0?u.NO_LICENSES:new p(a.subChangePlans,i,s):u.NO_PRODUCT_TYPE}switch(i){case n.ProductPlanType.NEW_STANDARD:return new d(t.orionPlanInfo.standard,s);case n.ProductPlanType.ADVANCED:return new d(t.orionPlanInfo.advanced,s);default:return void u.reportException({cause:u.NO_PRODUCT_TYPE,message:"Unable to calculate pricing data for unsupported product type",extra:{productPlanType:i}})}},e})();t.PricingDataFactory=l;var u=(function(){function e(){}return e.reportException=function(e){var t=e.cause,r=e.message,a=e.extra;i.reportStack(t+": "+r,{tags:["BusinessPaymentPages","PricingData"],severity:i.SEVERITY.CRITICAL,exc_extra:a})},e.NO_DATA_SOURCE="No data source",e.NO_LICENSES="No licenses",e.NO_TRANSITION="No transition",e.NO_PRODUCT_TYPE="No product type",e.INCOMPLETE_DATA_SOURCE="Incomplete data source",e.notifyErrorMessage=s.intl.formatMessage({id:"ZirEVc",defaultMessage:"We’re having some trouble right now. Please try again later or contact sales."}),e.notifyErrorMessagePersonal=s.intl.formatMessage({id:"0dO9r0",defaultMessage:"We’re having some trouble right now. Please try again later."}),e})();t.PricingDataException=u;var c=(function(){function e(e){this.promoDiscountPercentage=e||0}return e.prototype.getTotalYearlyDiscountWithPromoInPercent=function(){var e=this.getMonthlyPerUserPrice(),t=this.getMonthlyPlanData();void 0!==t&&void 0!==t.nextBillingSummary&&t.nextBillingSummary.discountPercentage>0&&(e=e.divide(1-t.nextBillingSummary.discountPercentage/100));var r=this.getYearlyPerUserPrice(),a=e.amount-r.amount;return Math.round(a/e.amount*100)},e.prototype.getYearlyPerUserPrice=function(e){void 0===e&&(e=!1);var t=this.getYearlyPrice(e),r=this.getNumLicenses();return r>0?t.divide(12).divide(r):t},e.prototype.getYearlyPricePerUserPerYear=function(e){void 0===e&&(e=!1);var t=this.getYearlyPrice(e),r=this.getNumLicenses();return r>0?t.divide(r):t},e.prototype.getMonthlyPerUserPrice=function(e){void 0===e&&(e=!1);var t=this.getMonthlyPrice(e),r=this.getNumLicenses();return r>0?t.divide(r):t},e.prototype.getPromoDiscount=function(){return this.promoDiscountPercentage},e.prototype.getYearlySavings=function(){var e=this.getMonthlyPrice(),t=this.getYearlyPrice();return e.multiply(12).subtract(t)},e.prototype.getMonthlyPriceWithoutPromo=function(e){void 0===e&&(e=!1);var t=this.getMonthlyPrice(e),r=this.getMonthlyPlanData();return void 0!==r&&void 0!==r.nextBillingSummary&&r.nextBillingSummary.discountPercentage>0&&(t=t.divide(1-r.nextBillingSummary.discountPercentage/100)),t},e.prototype.getYearlyPriceWithoutPromo=function(e){return void 0===e&&(e=!1),this.getYearlyPrice(e).divide(1-this.promoDiscountPercentage/100)},e.prototype.getYearlySavingsPercentage=function(){var e=this.getMonthlyPerUserPrice(),t=this.getYearlyPerUserPrice(),r=e.amount-t.amount;return Math.round(r/e.amount*100)},e.prototype.getYearlySavingsWithoutPromo=function(){var e=this.getMonthlyPrice(!0),t=this.getMonthlyPlanData();void 0!==t&&void 0!==t.nextBillingSummary&&t.nextBillingSummary.discountPercentage>0&&(e=e.divide(1-t.nextBillingSummary.discountPercentage/100));var r=this.getYearlyPrice(!0).divide(1-this.promoDiscountPercentage/100);return e.multiply(12).subtract(r)},e.prototype.getYearlySavingsWithoutPromoPerUser=function(){var e=this.getYearlySavingsWithoutPromo(),t=this.getNumLicenses();return t>0?e.divide(t):e},e.prototype.getYearlySavingsWithoutPromoPercentage=function(){var e=this.getMonthlyPerUserPrice(),t=this.getMonthlyPlanData();void 0!==t&&void 0!==t.nextBillingSummary&&t.nextBillingSummary.discountPercentage>0&&(e=e.divide(1-t.nextBillingSummary.discountPercentage/100));var r=this.getYearlyPerUserPrice().divide(1-this.promoDiscountPercentage/100),a=e.amount-Math.abs(r.amount);return Math.abs(Math.round(a/e.amount*100))},e})(),p=(function(e){function t(t,r,a){var n=e.call(this,a)||this,o=t.withProductPlanType(r),i=o.yearly().plans.pop(),s=o.monthly().plans.pop();if(n.yearlySubChangePlan=i,n.monthlySubChangePlan=s,n.numLicenses=Math.min(i&&i.nextBillingSummary.totalLicenses,s&&s.nextBillingSummary.totalLicenses),!n.monthlySubChangePlan||!n.yearlySubChangePlan){var l=n.monthlySubChangePlan?"yearly":"monthly";u.reportException({cause:u.NO_TRANSITION,message:"Unable to find a "+l+" subChangePlan in PricingDataOrion",extra:{subChangePlans:t}})}return(isNaN(n.numLicenses)||n.numLicenses<=0)&&u.reportException({cause:u.NO_LICENSES,message:"Number of licenses is 0 in PricingDataOrion",extra:{yearlySubChangePlan:n.yearlySubChangePlan}}),n}return r.__extends(t,e),t.prototype.getPlanDisplayName=function(){var e=this.yearlySubChangePlan||this.monthlySubChangePlan;if(!e)return"";var t=e.finalSubState.plan;return t?t.displayName():""},t.prototype.getPlanDisplaySpace=function(){var e=this.yearlySubChangePlan||this.monthlySubChangePlan;if(!e)return"";var t=e.finalSubState.plan;return t?t.displaySpace():""},t.prototype.getMonthlyPlanData=function(){return this.monthlySubChangePlan},t.prototype.getYearlyPlanData=function(){return this.yearlySubChangePlan},t.prototype.getMinLicensesLimit=function(e){return void 0===e&&(e=3),this.yearlySubChangePlan?this.yearlySubChangePlan.finalSubState.minLicenseLimitForPlan||e:this.monthlySubChangePlan&&this.monthlySubChangePlan.finalSubState.minLicenseLimitForPlan||e},t.prototype.getNumLicenses=function(){return this.numLicenses},t.prototype.getYearlyPrice=function(e){var t;return void 0===e&&(e=!1),this.yearlySubChangePlan?(t=this.yearlySubChangePlan.nextBillingSummary.total,e&&(t=t.subtract(this.yearlySubChangePlan.nextBillingSummary.tax))):t=new a.Cash(0,"USD"),t},t.prototype.getMonthlyPrice=function(e){var t;return void 0===e&&(e=!1),this.monthlySubChangePlan?(t=this.monthlySubChangePlan.nextBillingSummary.total,e&&(t=t.subtract(this.monthlySubChangePlan.nextBillingSummary.tax))):t=new a.Cash(0,"USD"),t},t})(c);t.PricingDataOrion=p;var d=(function(e){function t(t,r){var a=e.call(this,r)||this;return a.planInfo=t,a}return r.__extends(t,e),t.prototype.getPlanDisplayName=function(){return this.planInfo.skuContent.name},t.prototype.getPlanDisplaySpace=function(){return o.SkuContentClient.deserialize(this.planInfo.skuContent).spaceShortFormTb()},t.prototype.getMonthlyPlanData=function(){},t.prototype.getYearlyPlanData=function(){},t.prototype.getMinLicensesLimit=function(e){return void 0===e&&(e=3),this.planInfo.minLicenseCount||e},t.prototype.getNumLicenses=function(){return this.getMinLicensesLimit()},t.disallowTaxCalculations=function(e){e||u.reportException({cause:u.INCOMPLETE_DATA_SOURCE,message:"Cannot calculate price with tax from plan info",extra:{}})},t.prototype.getYearlyPrice=function(e){return void 0===e&&(e=!1),t.disallowTaxCalculations(e),a.Cash.fromObject(this.planInfo.yearlyPrice)},t.prototype.getMonthlyPrice=function(e){return void 0===e&&(e=!1),t.disallowTaxCalculations(e),a.Cash.fromObject(this.planInfo.monthlyPrice)},t})(c);t.PricingDataFromPlan=d})),define("modules/clean/react/payments/business/state/business_state",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fieldsToServerProps={accountHolderName:"owner_name",adyenEncryptedCard:"adyen_encrypted_card",encryptedCardForNetworkToken:"encrypted_card_for_network_token",bin:"bin",browserInfo:"browser_info",threeDsData:"three_ds_data",captcha:"recaptcha_response",companySize:"company_size",countryCode:"country_code",cpf:"cpf",cpfName:"cpf_name",email:"email",emailsToInvite:"emails_to_invite",firstName:"fname",iban:"iban",idealBankId:"bank_id",idealBankName:"bank_name",lastName:"lname",mandateSigned:"mandate_signed",marketingOptIn:"marketing_opt_in",nonce:"nonce",numberOfUsers:"team_num_users",password:"password",paymentMethod:"payment_method",payPalNonce:"paypal_nonce",schedule:"schedule_id",scheduleId:"schedule_id",selectedUser:"selected_user",teamName:"team_name",teamPhone:"team_phone",termsAndService:"tos_agree",vat:"vat",zipCode:"zip",city:"city",phone:"phone",name:"name",address:"address",applePayToken:"apple_pay_token"},t.serverPropsToFields={};for(var r=0,a=Object.keys(t.fieldsToServerProps);r<a.length;r++){var n=a[r],o=t.fieldsToServerProps[n];o&&(t.serverPropsToFields[o]=n)}t.TEAM_RESTORE_STEP=-1,t.SKU_SELECTION_STEP=0,t.ACCOUNT_INFO_OR_CHECKOUT_STEP=1,t.PLAN_SELECTION_STEP=2,t.PAYMENT_INFO_STEP=3,t.TryFormSteps=function(){return{skuSelectionStep:t.SKU_SELECTION_STEP,accountInfoStep:t.ACCOUNT_INFO_OR_CHECKOUT_STEP,planSelectionStep:t.PLAN_SELECTION_STEP,paymentInfoStep:t.PAYMENT_INFO_STEP}},t.BuyFormSteps=function(){return{skuSelectionStep:t.SKU_SELECTION_STEP,checkoutStep:t.ACCOUNT_INFO_OR_CHECKOUT_STEP}},t.BillingFormSteps=function(){return{teamRestoreStep:t.TEAM_RESTORE_STEP,skuSelectionStep:t.SKU_SELECTION_STEP,checkoutStep:t.ACCOUNT_INFO_OR_CHECKOUT_STEP}}})),define("modules/clean/react/payments/buy/components/inputs/inputs",["require","exports","tslib","react","react-dom","classnames","ts-key-enum"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),o=r.__importDefault(o);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=o.default({input__label:!0,"input__label--before":Boolean(!this.props.labelAfterElement)},this.props.className),t=this.props.containerClassName,r=a.default.createElement("label",{className:e,htmlFor:this.props.htmlFor},this.props.labelText),n=null;this.props.labelAfterElement&&(n=r,r=null);var i,s=null;return this.props.secondaryLabel&&(s=a.default.createElement("label",{className:"input__label input__label--secondary",htmlFor:this.props.htmlFor},this.props.secondaryLabel)),this.props.errorText&&(i=a.default.createElement("label",{className:"input__label--error",htmlFor:this.props.htmlFor},this.props.errorText)),a.default.createElement("div",{className:t},r,this.props.children,n,s,i)},t})(a.default.Component);t.LabeledInput=s;var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.props.onChange&&t.props.onChange(n.default.findDOMNode(t.input))},t.onBlur=function(e){t.props.onBlur&&t.props.onBlur(n.default.findDOMNode(t.input))},t.onFocus=function(e){t.props.onFocus&&t.props.onFocus(t.input)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.default.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,n=t.autocomplete,i=t.className,l=t.disabled,u=t.labelText,c=t.secondaryLabel,p=t.errorText,d=t.hasError,m=t.value,f=t.maxLength,y=t.containerClassName,h=t.placeholder,_=this.props.type||"text",g=o.default({input__text:!0,"input__text--error":Boolean(p)||d},this.props.inputClassName);return a.default.createElement(s,{className:i,containerClassName:y,labelText:u,htmlFor:r,errorText:p,secondaryLabel:c},a.default.createElement("input",{autoComplete:n,className:g,type:_,placeholder:h,name:r,id:r,ref:function(t){e.input=t},value:m,disabled:l,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,maxLength:f}))},t})(a.default.Component);t.LabeledTextInput=l;var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCheckboxChange=function(e){t.props.onClick&&("click"!==e.type&&e.key!==i.Key.Enter&&13!==e.charCode&&" "!==e.key&&32!==e.charCode||(t.props.onClick(n.default.findDOMNode(t.input)),e.preventDefault()))},t.onBlur=function(){t.props.onBlur&&t.props.onBlur(n.default.findDOMNode(t.input))},t.preventSpacebarScrolling=function(e){" "!==e.key&&32!==e.charCode||e.preventDefault()},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onClick){var e=n.default.findDOMNode(this.input),t=e.checked;t&&t!==this.props.checked&&this.props.onClick(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,n=t.className,i=t.containerClassName,l=t.disabled,u=t.labelText,c=t.labelClassName,p=t.errorText,d=t.checked,m=o.default({input__checkbox:!0,"input__checkbox--valid":d,"input__checkbox--disabled":Boolean(l)},n);return a.default.createElement(s,{containerClassName:i,className:c,errorText:p,htmlFor:r,labelAfterElement:!0,labelText:u},a.default.createElement("div",{"aria-checked":d,"aria-labelledby":r,tabIndex:0,role:"checkbox",className:m,onClick:this.handleCheckboxChange,onKeyDown:this.preventSpacebarScrolling,onKeyUp:this.handleCheckboxChange,onBlur:this.onBlur}),a.default.createElement("input",{readOnly:!0,"aria-hidden":!0,tabIndex:-1,checked:d,disabled:l,id:r,name:r,ref:function(t){e.input=t},type:"checkbox"}))},t})(a.default.Component);t.LabeledCheckboxInput=u;var c=(function(e){function t(t){var r=e.call(this,t)||this;return r.focus=function(){null!==r.radio.current&&r.radio.current.focus()},r.handleClick=function(e){r.props.disabled?e.stopPropagation():r.focus()},r.handleRadioChange=function(e){r.props.disabled?e.stopPropagation():r.props.onClickOrChange&&(r.props.onClickOrChange(e,r.props.inputId,r.props.value),e.preventDefault())},r.handleRadioKeyUp=function(e){if(r.props.disabled)e.stopPropagation();else{(["Tab","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)||[9,37,38,39,40].includes(e.keyCode))&&r.props.onClickOrChange&&(e.preventDefault(),r.focus(),r.props.onClickOrChange(e,r.props.inputId,r.props.value))}},r.radio=a.default.createRef(),r}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.name,r=e.inputId,n=e.ariaLabelId,i=e.disabled,s=e.value,l=e.checked,u=e.labelSpan,c=e.labelClassName,p=o.default({input__radio:!0,"input__radio--valid":Boolean(l),"input__radio--disabled":Boolean(i)},this.props.className),d=l?0:-1;return a.default.createElement("label",{htmlFor:s,className:c},a.default.createElement("span",{className:p,onClick:this.handleClick},a.default.createElement("input",{"aria-labelledby":n,ref:this.radio,type:"radio",name:t,id:r,value:s,tabIndex:d,"aria-checked":Boolean(l),checked:Boolean(l),onChange:this.handleRadioChange,onKeyUp:this.handleRadioKeyUp,disabled:i}),u))},t})(a.default.Component);t.LabeledRadioInput=c;var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.props.onChange&&t.props.onChange(n.default.findDOMNode(t.input))},t.onBlur=function(){t.props.onBlur&&t.props.onBlur(n.default.findDOMNode(t.input))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.default.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,n=t.className,i=t.containerClassName,l=t.hasError,u=t.labelClassName,c=t.labelText,p=t.errorText,d=t.autoComplete,m=o.default({input__select:!0,"input__select--error":Boolean(p)||l},n);return a.default.createElement(s,{containerClassName:i,className:u,errorText:p,htmlFor:r,labelText:c},a.default.createElement("select",{className:m,id:r,name:r,onChange:this.onChange,onBlur:this.onBlur,value:this.props.value,autoComplete:d,ref:function(t){e.input=t}},this.props.children))},t})(a.default.Component);t.LabeledSelectInput=p;var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.default.createElement("div",{className:this.props.className},this.props.children,this.props.errors&&this.props.errors.map((function(e,t){return a.default.createElement("div",{className:e.className,key:e.name+"-"+t},a.default.createElement("label",{className:"input__label--error",htmlFor:e.name},e.text))})))},t})(a.default.Component);t.LabeledInputRow=d})),define("modules/clean/react/payments/checkout/components/inputs/labeled_checkbox_input",["require","exports","tslib","react","react-dom","modules/clean/react/payments/checkout/components/inputs/labeled_input"],(function(e,t,r,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importStar(n);var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onBlur=function(){t.props.onBlur&&t.props.onBlur(n.findDOMNode(t.input))},t}return r.__extends(t,e),t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(n.findDOMNode(this.input))},t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.findDOMNode(this.input),t=e.checked;t&&t!==this.props.checked&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,n=t.className,i=t.labelText,s=t.errorText,l=t.errorHTML,u=t.checked,c=t.disabled;return a.default.createElement(o.LabeledInput,{className:n,errorHTML:l,errorText:s,htmlFor:r,labelAfterElement:!0,labelText:i},a.default.createElement("input",{checked:u,disabled:c,id:r,name:r,onChange:this.onChange.bind(this),onBlur:this.onBlur,ref:function(t){e.input=t},type:"checkbox"}))},t})(a.default.Component);t.LabeledCheckboxInput=i})),define("modules/clean/react/payments/checkout/components/inputs/labeled_input",["require","exports","tslib","classnames","purify","react","modules/core/browser_detection","modules/clean/react/tooltip","modules/clean/react/sprite"],(function(e,t,r,a,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importStar(n),o=r.__importDefault(o),i=r.__importStar(i);var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=a.default({"input__label--errormodal":Boolean(this.props.errorText),"input-with-inline-tooltip":Boolean(this.props.inlineTooltipText)},this.props.className,"label-input","input__label"),t=o.default.createElement("label",{className:"label "+(this.props.labelClass?this.props.labelClass:""),htmlFor:this.props.htmlFor},this.props.labelText),r=null;this.props.labelAfterElement&&(r=t,t=null);var u=null;u=this.props.rightLabelElement?o.default.createElement("div",{className:"grid__item grid--x-bookend"},t,o.default.createElement("div",null,this.props.rightLabelElement)):t;var c=null;this.props.errorText?c=this.props.errorText:this.props.errorHTML&&(c=o.default.createElement("span",{dangerouslySetInnerHTML:{__html:n.sanitize(this.props.errorHTML)}}));var p=o.default.createElement("label",{className:"error-message",htmlFor:this.props.htmlFor},c),d=null;if(this.props.inlineTooltipText){var m=i.is_supported_mobile_browser()?s.TooltipPosition.BOTTOM:s.TooltipPosition.RIGHT,f=o.default.createElement(s.Tooltip,{tooltip_classname:"input__inline-tooltip-bubble",position:m,tooltip_contents:this.props.inlineTooltipText},o.default.createElement(l.Sprite,{group:"web",name:"info",alt:""}));d=o.default.createElement("span",{className:"grid__item grid--y-middle input__tooltip--inline"},f)}return o.default.createElement("div",{className:e},u,d,this.props.children,r,p)},t})(o.default.Component);t.LabeledInput=u})),define("modules/clean/react/payments/checkout/components/inputs/labeled_text_input",["require","exports","tslib","classnames","react","react-dom","modules/clean/react/payments/checkout/components/inputs/labeled_input"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),o=r.__importStar(o);var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onBlur=function(e){t.props.onBlur&&t.props.onBlur(o.findDOMNode(t.input))},t.onFocus=function(e){t.props.onFocus&&t.props.onFocus(o.findDOMNode(t.input))},t.onChange=function(e){t.props.onChange&&t.props.onChange(o.findDOMNode(t.input))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=o.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.autoComplete,o=t.className,s=t.disabled,l=t.errorHTML,u=t.errorText,c=t.inlineTooltipText,p=t.labelAfterElement,d=t.labelClass,m=t.labelText,f=t.maxLength,y=t.name,h=t.placeholder,_=t.value,g=this.props.type||"text",v=a.default({input__text:!0,"input__text--errormodal":Boolean(u)},this.props.inputClassName);return n.default.createElement(i.LabeledInput,{className:o,errorHTML:l,errorText:u,htmlFor:y,inlineTooltipText:c,labelAfterElement:p,labelClass:d,labelText:m},n.default.createElement("input",{autoComplete:r,className:v,type:g,name:y,id:y,ref:function(t){e.input=t},value:null===_?"":_,disabled:s,onBlur:this.onBlur,onChange:this.onChange,onFocus:this.onFocus,maxLength:f,placeholder:h}))},t})(n.default.Component);t.BizLabeledTextInput=s})),define("modules/clean/react/payments/checkout/components/inputs/labeled_select_input",["require","exports","tslib","react","react-dom","modules/clean/react/payments/checkout/components/inputs/labeled_input"],(function(e,t,r,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importStar(n);var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(n.findDOMNode(this.input))},t.prototype.onClick=function(e){this.props.onClick&&this.props.onClick(n.findDOMNode(this.input))},t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,n=t.className,i=t.labelClass,s=t.labelText,l=t.rightLabelElement,u=t.errorText,c=t.errorHTML,p=t.autoComplete;return a.default.createElement(o.LabeledInput,{className:n,errorHTML:c,errorText:u,labelClass:i,htmlFor:r,labelText:s,rightLabelElement:l},a.default.createElement("select",{autoComplete:p,className:"option-selector",id:r,name:r,onChange:this.onChange.bind(this),onClick:this.onClick.bind(this),value:this.props.value,ref:function(t){e.input=t}},this.props.children))},t})(a.default.Component);t.BizLabeledSelectInput=i})),define("modules/clean/react/payments/checkout/components/payment_method_form/address_form",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/react/payments/checkout/components/inputs/labeled_text_input","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/checkout/components/inputs/labeled_select_input","modules/clean/react/payments/common/constants"],(function(e,t,r,a,n,o,i,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCountryCodeChange=function(e){t.props.actions.updateCountryCode(e.value)},t.onZipCodeBlur=function(e){t.props.actions.showFormFieldErrors(["zipCode"],"ZipCodeBlur"),t.props.actions.blurZipCode(e.value)},t.onZipCodeChange=function(e){t.props.actions.updateZipCode(e.value)},t}return r.__extends(t,e),t.prototype.renderCountrySelector=function(e){var t=this,r="grid__item--2-3";e?r="grid__item":this.props.isInModal||(r="grid__item--fluid grid__item--margin-right--1-24"),this.props.showServerViewVersion&&(r="grid__item grid__item--3-4");var i=this.props.countryList.map((function(e){var r=e[0],n=e[1];return a.default.createElement("option",{key:"location-"+r,value:r,"aria-selected":r===t.props.formData.countryCode.formattedValue},n)}));return 1==this.props.businessStyling?a.default.createElement(l.BizLabeledSelectInput,{autoComplete:"country",className:r,labelText:n.intl.formatMessage({id:"1SPrvR",defaultMessage:"Country"}),name:"country_code",onChange:this.onCountryCodeChange.bind(this),value:this.props.formData.countryCode.rawValue},i):a.default.createElement(o.LabeledSelectInput,{autoComplete:"country",className:"payment-info__country",containerClassName:r,labelText:n.intl.formatMessage({id:"1SPrvR",defaultMessage:"Country"}),name:"country_code",onChange:this.onCountryCodeChange,value:this.props.formData.countryCode.rawValue},i)},t.prototype.zipCodeErrorString=function(){var e=this.props.formData.zipCode;return!s.FormValueHelper.isValid(e)&&e.showError?"US"===this.props.formData.countryCode.formattedValue?n.intl.formatMessage({id:"kWjJlf",defaultMessage:"Please enter a valid billing ZIP code."}):u.ZipCodeErrorMessage:""},t.prototype.renderBillingFields=function(){return!0===this.props.businessStyling?a.default.createElement(a.default.Fragment,null,this.renderCountrySelector(!1),this.renderZipCodeInput()):a.default.createElement(o.LabeledInputRow,{className:"payment-info__location grid__item grid--x-bookend grid--y-top"},this.renderCountrySelector(!1),this.renderZipCodeInput())},t.prototype.renderZipCodeInput=function(e){void 0===e&&(e=!1);var t=n.intl.formatMessage({id:"5kJrVX",defaultMessage:"Postal Code"}),r="US"===this.props.formData.countryCode.formattedValue?n.intl.formatMessage({id:"ciLB6A",defaultMessage:"Billing ZIP"}):t,s=!this.props.paymentSpec.allow_zip_code_for_country(this.props.formData.countryCode.formattedValue),l=this.props.formData.zipCode.errorState&&this.props.formData.zipCode.showError;if(!0===this.props.businessStyling)return a.default.createElement(i.BizLabeledTextInput,{autoComplete:"postal-code",className:"billing-zip payment-info__zip grid__item grid__item--7-24",disabled:s,errorText:this.zipCodeErrorString(),errorHTML:this.props.formData.zipCode.serverError,labelText:r,name:"zip",onChange:this.onZipCodeChange.bind(this),value:this.props.formData.zipCode.rawValue,onBlur:this.onZipCodeBlur.bind(this)});var u=e?"grid__item--fluid grid__item--margin-right--1-24":"grid__item--fluid",c=this.zipCodeErrorString();return a.default.createElement(o.LabeledTextInput,{className:"payment-info__zip",containerClassName:u,name:"zip",placeholder:this.props.showServerViewVersion?r:"",autocomplete:"postal-code",labelText:r,value:this.props.formData.zipCode.rawValue,hasError:Boolean(l),disabled:s,onBlur:this.onZipCodeBlur,onChange:this.onZipCodeChange,errorText:c})},t.prototype.render=function(){return this.renderBillingFields()},t})((a=r.__importDefault(a)).default.Component);t.AddressForms=c})),define("modules/clean/react/payments/checkout/components/payment_method_form/credit_card_frame",["require","exports","tslib","jquery","react","react-dom","modules/clean/ajax","classnames","modules/core/exception","modules/core/notify","modules/core/i18n","modules/clean/payments/cvv_hint_container","modules/clean/react/payments/common/form/actions/actions","modules/clean/payments/payment_form/iframe_rpc","modules/clean/payments/three_ds_helper"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d,m,f){"use strict";function y(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),o=r.__importStar(o),i=r.__importStar(i),s=r.__importDefault(s),l=r.__importStar(l);var h=(function(e){function t(t){var n=e.call(this,t)||this;return n.setCvvHintContainerRef=function(e){n.cvvHintContainerRef=e},n.setIframeRef=function(e){n.iframeRef=e},n.submitThreeDsChallenge=function(){n.props.submitForm(d.SubmitFormTriggerType.ThreeDsChallenge)},n.submitThreeDsFingerprint=function(){n.props.submitForm(d.SubmitFormTriggerType.ThreeDsFingerprint)},n.showTooltip=function(e,t){if("cvv"===e){var i=a.default(n.iframeRef).offset(),s=a.default(o.findDOMNode(n.cvvHintContainerRef)).offset(),l=i.left-s.left,u=i.top-s.top,c={left:t.left+l,top:t.top+u,width:t.width,height:t.height};n.setState((function(e){return r.__assign(r.__assign({},e),{cvvHintDimensions:c})})),n.cvvHintContainerRef&&n.cvvHintContainerRef.getWrappedComponent().showTooltip()}},n.hideTooltip=function(e){"cvv"===e&&n.cvvHintContainerRef&&n.cvvHintContainerRef.getWrappedComponent().hideTooltip()},n.handle3DsMessage=function(e){n.threeDsHandler&&n.threeDsHandler.handle3DsMessage(e)},n.iframeReady=!1,n.state={cvvHintDimensions:{left:0,top:0,width:0,height:0},iframeFormHeight:null},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.isSeleniumChangesTest())return this.props.actions.updateNonce("fake-valid-nonce",{ccn:{error:!1},ccode:{error:!1},ccexp:{error:!1}}),void this.props.actions.updateBIN("457173");this.braintreeTokenLoaded=y(),this.adyenKeyLoaded=y(),this.iFrameRpcListener=new m.IFrameRpcListener(this.getCCIframeOrigin(),this);var e=frames.cc_iframe.window;this.iframeMessageTransport=new m.IFrameRpcTransport(this.props.iframeUrl,e),this.pingIframe()},t.prototype.componentWillUnmount=function(){this.isSeleniumChangesTest()||this.iFrameRpcListener.removeMessageListener()},t.prototype.componentWillReceiveProps=function(e){e.nonce.showError&&this.showFormErrors()},t.prototype.render=function(){var e=this.props,t=e.hidden,r=e.iframeUrl,a=s.default({grid__item:!0,hidden:t}),o=s.default("iframe-holder iframe-holder--full-width",{"iframe-holder--responsive":this.props.isResponsive,"iframe-holder-desktop":this.props.showServerViewVersion}),i={};return this.props.getHeightFromIframe&&(i={height:this.state.iframeFormHeight}),n.default.createElement("div",{id:"iframe-holder",className:a},n.default.createElement(p.CvvHintContainer,{targetDimensions:this.state.cvvHintDimensions,ref:this.setCvvHintContainerRef,showServerViewVersion:this.props.showServerViewVersion}),n.default.createElement("div",{className:o,style:i,ref:this.setIframeRef},n.default.createElement("iframe",{src:r,name:"cc_iframe",frameBorder:"0",title:c.intl.formatMessage({id:"ljVFCM",defaultMessage:"Form for entering credit card information"})})))},t.prototype.isSeleniumChangesTest=function(){return""===this.props.iframeUrl&&!1},t.prototype.getCCIframeOrigin=function(){var e=this.props.iframeUrl.split("/");return e[0]+"//"+e[2]},t.prototype.startServerTimeUpdate=function(){var e=this,t=function(t,r,a){var n=JSON.parse(t);if(n&&n.hasOwnProperty("server_time")){var o={serverTime:n.server_time};e.iframeMessageTransport.sendMessage(m.IFrameRpc.SET_SERVER_TIME,o)}e.startServerTimeUpdate()},r=function(t,r,a){e.startServerTimeUpdate()};setTimeout((function(){i.BackgroundRequest({url:"/credit_card_secrets/server_time",type:"GET",success:t,error:r})}),216e5)},t.prototype.encryptWithAdyen=function(){var e=this;return this.adyenEncrypting?this.adyenEncryptionDeferred.promise:(this.adyenEncrypting=!0,this.adyenEncryptionDeferred=y(),this.isSeleniumChangesTest()?this.submitEncryptedAdyenCard("brisket"):this.adyenKeyLoaded.promise.then((function(t){e.iframeMessageTransport.sendMessage(m.IFrameRpc.ENCRYPT_WITH_ADYEN)})),this.adyenEncryptionDeferred.promise)},t.prototype.encryptForNetworkToken=function(){return this.networkTokenEncrypting?this.networkTokenEncryptionDeferred.promise:(this.networkTokenEncrypting=!0,this.networkTokenEncryptionDeferred=y(),this.isSeleniumChangesTest()?this.submitEncryptedCardForNetworkToken("mastercard","test_for_network_token"):this.iframeMessageTransport.sendMessage(m.IFrameRpc.ENCRYPT_FOR_NETWORK_TOKEN),this.networkTokenEncryptionDeferred.promise)},t.prototype.tokenizeWithBraintree=function(){var e=this;return this.braintreeTokenizing?this.braintreeTokenizingDeferred.promise:(this.braintreeTokenizing=!0,this.braintreeTokenizingDeferred=y(),this.isSeleniumChangesTest()?this.submitTokenized("fake-valid-nonce","457173"):this.braintreeTokenLoaded.promise.then((function(t){e.iframeMessageTransport.sendMessage(m.IFrameRpc.TOKENIZE)})),this.braintreeTokenizingDeferred.promise)},t.prototype.tokenize=function(){return this.encryptWithAdyen(),this.encryptForNetworkToken(),Promise.all([this.tokenizeWithBraintree()]).then((function(e){for(var t=!0,r=0,a=e;r<a.length;r++){var n=a[r];t=t&&n}return t}))},t.prototype.submitTokenized=function(e,t){this.props.actions.updateNonce(e),this.props.actions.updateBIN(t),this.braintreeTokenizing=!1,this.braintreeTokenizingDeferred.resolve(!0)},t.prototype.submitEncryptedAdyenCard=function(e){var t=f.collectBrowserInfo();t&&this.props.actions.updateBrowserInfo(t),this.props.actions.updateAdyenEncryptedCard(e),this.adyenEncrypting=!1,this.adyenEncryptionDeferred.resolve(!0)},t.prototype.submitEncryptedCardForNetworkToken=function(e,t){this.props.actions.updateEncryptedCardForNetworkToken(e,t),this.networkTokenEncrypting=!1,this.networkTokenEncryptionDeferred.resolve(!0)},t.prototype.originReady=function(e){var t=this;this.iframeReady||(this.iframeReady=!0,this.isSeleniumChangesTest()||(this.iframeMessageTransport.sendMessage(m.IFrameRpc.READY),this.iframeMessageTransport.sendMessage(m.IFrameRpc.INIT_NETWORK_TOKEN,{isProd:!0}),this.fetchBraintreeToken().then((function(e){t.iframeMessageTransport.sendMessage(m.IFrameRpc.INIT_BRAINTREE,{token:e}),t.braintreeTokenLoaded.resolve(!0)})).catch((function(){u.Notify.error(c.intl.formatMessage({id:"K2YdqW",defaultMessage:"Unable to connect to our servers - Refresh page"}))})),this.fetchAdyenKey().then((function(e){t.iframeMessageTransport.sendMessage(m.IFrameRpc.INIT_ADYEN,e),t.adyenKeyLoaded.resolve(!0)})).catch((function(){u.Notify.error(c.intl.formatMessage({id:"K2YdqW",defaultMessage:"Unable to connect to our servers - Refresh page"}))})),this.threeDsHandler=new f.ThreeDsHandler({updateThreeDsData:this.props.actions.updateThreeDsData,submitThreeDsChallenge:this.submitThreeDsChallenge,triggerThreeDsChallenge:this.props.actions.triggerThreeDsChallenge,submitThreeDsFingerprint:this.submitThreeDsFingerprint,triggerThreeDsFingerprint:this.props.actions.triggerThreeDsFingerprint,isDesktop:!!this.props.showServerViewVersion,isSeleniumChangesTest:this.isSeleniumChangesTest()})))},t.prototype.fetchAdyenKey=function(e,t){var r=this;void 0===e&&(e=2),void 0===t&&(t=y());return i.BackgroundRequest({url:"/credit_card_secrets/adyen_key",type:"GET",success:function(e,a,n){var o=JSON.parse(e);if(o&&o.hasOwnProperty("key")&&o.hasOwnProperty("server_time")){var i={key:o.key,serverTime:o.server_time};t.resolve(i)}else t.reject(c.intl.formatMessage({id:"K2YdqW",defaultMessage:"Unable to connect to our servers - Refresh page"}));r.startServerTimeUpdate()},error:function(a,n,o){r.tokenErrorHandler(e,r.fetchAdyenKey,t,a,"get adyen key failed:",["fetch_adyen_key_failed"],o)}}),t.promise},t.prototype.fetchBraintreeToken=function(e,t){var r=this;void 0===e&&(e=2),void 0===t&&(t=y());return i.BackgroundRequest({url:"/payments/braintree_token",success:function(e,r,a){try{var n=JSON.parse(e);if(!n||!n.hasOwnProperty("token"))throw new Error("Invalid response from server");t.resolve(n.token)}catch(e){t.reject(c.intl.formatMessage({id:"K2YdqW",defaultMessage:"Unable to connect to our servers - Refresh page"}))}},error:function(a,n,o){r.tokenErrorHandler(e,r.fetchBraintreeToken,t,a,"ajax /braintree_token failed:",["fetch_braintree_token_failed"],o)}}),t.promise},t.prototype.tokenErrorHandler=function(e,t,r,a,n,o,i){if(--e>0)setTimeout((function(){t(e,r)}),2e3);else{var s=n+" "+(JSON.stringify(a.status)+", "+a.statusText+", "+a.readyState);l.reportException({err:new Error(s),severity:l.SEVERITY.CRITICAL,tags:o}),r.reject(i)}},t.prototype.pingIframe=function(){var e=this;this.iframeReady||(this.pingTimeoutLogged||(this.firstPing?(new Date).getTime()-this.firstPing>12e4&&(l.reportException({err:new Error("PCI iFrame timeout"),severity:l.SEVERITY.NONCRITICAL,tags:["iframe_ping_timeout"]}),this.pingTimeoutLogged=!0):this.firstPing=(new Date).getTime()),this.iframeMessageTransport.sendMessage(m.IFrameRpc.READY),setTimeout((function(){e.pingIframe()}),250))},t.prototype.showCvvModal=function(){},t.prototype.showFormErrors=function(){this.isSeleniumChangesTest()||this.iframeMessageTransport.sendMessage(m.IFrameRpc.SHOW_FORM_ERRORS)},t.prototype.focusOutsideIframe=function(){},t.prototype.handleValidationFailure=function(e){this.braintreeTokenizing=!1,this.braintreeTokenizingDeferred.resolve(!1),this.adyenEncrypting=!1,this.adyenEncryptionDeferred.resolve(!1),this.networkTokenEncrypting=!1,this.networkTokenEncryptionDeferred.resolve(!1)},t.prototype.handleDataStatusUpdate=function(e){},t.prototype.handleValidationUpdate=function(e){this.props.actions.updateNonce(this.props.nonce.rawValue,e),this.props.actions.updateBIN(this.props.bin.rawValue)},t.prototype.handleSizeUpdate=function(e){this.setState({iframeFormHeight:e})},t.prototype.handleBlurField=function(e){this.props.actions.blurCCField(e)},t.defaultProps={isResponsive:!1},t})(n.default.Component);t.CreditCardFrame=h})),define("modules/clean/react/payments/checkout/components/payment_method_form/direct_debit_form",["require","exports","tslib","react","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/checkout/components/inputs/labeled_text_input","modules/clean/react/payments/checkout/components/inputs/labeled_checkbox_input","modules/core/i18n","modules/clean/react/sprite_div","modules/clean/react/tooltip"],(function(e,t,r,a,n,o,i,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),l=r.__importDefault(l);var c=(u=r.__importStar(u)).Tooltip,p=u.TooltipPosition,d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onAccountHolderNameBlur=function(e){t.props.actions.showFormFieldErrors(["accountHolderName"],"AccountHolderNameBlur"),t.props.actions.blurAccountHolderName(e.value)},t.onIBANBlur=function(e){t.props.actions.showFormFieldErrors(["iban"],"IBANBlur"),t.props.actions.blurIBAN(e.value)},t}return r.__extends(t,e),t.prototype.onAccountHolderNameChange=function(e){this.props.actions.updateAccountHolderName(e.value)},t.prototype.onIBANChange=function(e){this.props.actions.updateIBAN(e.value)},t.prototype.onMandateSignedChange=function(e){this.props.actions.updateMandateSigned(e.checked)},t.prototype.onMandateSignedBlur=function(e){this.props.actions.showFormFieldErrors(["mandateSigned"],"MandateSignedBlur")},t.prototype.accountHolderNameErrorString=function(){var e=this.props.formData.accountHolderName;return!n.FormValueHelper.isValid(e)&&e.showError?s.intl.formatMessage({id:"lVEpBU",defaultMessage:"Please enter the account holder’s name."}):""},t.prototype.ibanErrorString=function(){var e=this.props.formData.iban;return!n.FormValueHelper.isValid(e)&&e.showError?s.intl.formatMessage({id:"jqBL8f",defaultMessage:"Please enter a valid bank account number."}):""},t.prototype.mandateSignedErrorString=function(){var e=this.props.formData.mandateSigned;return!n.FormValueHelper.isValid(e)&&e.showError?s.intl.formatMessage({id:"X6vQlG",defaultMessage:"Please agree to the SEPA mandate terms by clicking on this check box."}):""},t.prototype.renderIBANLabel=function(){var e=a.default.createElement(l.default,{group:"web",name:"info"}),t=s.intl.formatMessage({id:"yIGH7D",defaultMessage:"An International Bank Account Number (IBAN) is a unique identification code for a bank account. It’s made up of a two-letter country code and up to 30 alphanumeric characters. Check your bank statements or ask your bank for your IBAN."}),r=a.default.createElement(c,{tooltip_classname:"iban-label-tooltip-bubble",position:p.RIGHT,tooltip_contents:t},e);return a.default.createElement("span",{className:"grid__item grid--y-middle"},s.intl.formatMessage({id:"6BVmpd",defaultMessage:"IBAN"}),r)},t.prototype.render=function(){var e=this.props.formData,t=s.intl.formatMessage({id:"Pb48Th",defaultMessage:"I hereby authorize Dropbox International Unlimited Company, and its payment service provider, Adyen Client Management, to collect payments from my account via direct debit. At the same time, I instruct my bank to honor the direct debits drawn on my account. Notice: Within eight weeks, beginning with the debit date, I am entitled to claim a refund of the debited amount. In this case the terms and conditions agreed with my bank shall apply."});return a.default.createElement("div",{id:"sepa-direct-debit-form",className:"direct-debit-container"},a.default.createElement("div",{className:"direct-debit-fields"},a.default.createElement(o.BizLabeledTextInput,{name:"owner_name",labelText:s.intl.formatMessage({id:"vj7NTF",defaultMessage:"Account holder name"}),value:e.accountHolderName.rawValue,errorText:this.accountHolderNameErrorString(),errorHTML:e.accountHolderName.serverError,onBlur:this.onAccountHolderNameBlur,onChange:this.onAccountHolderNameChange.bind(this)}),a.default.createElement(o.BizLabeledTextInput,{name:"iban",labelText:this.renderIBANLabel(),value:e.iban.rawValue,errorText:this.ibanErrorString(),errorHTML:e.iban.serverError,onBlur:this.onIBANBlur,onChange:this.onIBANChange.bind(this)})),this.props.locationFields,a.default.createElement(i.LabeledCheckboxInput,{checked:e.mandateSigned.rawValue,className:"billing-mandate-signed",errorHTML:e.mandateSigned.serverError,errorText:this.mandateSignedErrorString(),labelText:t,name:"mandate_signed",onBlur:this.onMandateSignedBlur.bind(this),onChange:this.onMandateSignedChange.bind(this)}))},t})(a.default.Component);t.DirectDebitForm=d})),define("modules/clean/react/payments/checkout/components/payment_method_form/apple_pay",["require","exports","tslib","modules/clean/react/payments/common/form/actions/actions","modules/clean/ajax_as_promised","modules/core/notify","modules/core/i18n","modules/core/exception","modules/clean/react/payments/buy/components/payments/order_summary/order_summary_utils"],(function(e,t,r,a,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s);var u=i.intl.formatMessage({id:"OVUDyw",defaultMessage:"We weren't able to process your payment. Double check the payment info and try again. If that doesn't work, try another payment method or contact your bank"});function c(e,t){return n.BackgroundRequest({url:"/payments/apple_pay_session",type:"GET",data:{session_url:t}}).then((function(t){var r=JSON.parse(t);return r&&r.hasOwnProperty("session")?JSON.parse(r.session):(s.reportStack("Apple Pay Error (No Payment Session from Server Response)",{severity:s.SEVERITY.CRITICAL,tags:["applepay","payments"]}),o.Notify.error(u),e(a.applePayClosedByError("Step 1 - Blocked by No Payment Session")),e(a.paymentBannerError(u)),Promise.reject("No payment session from server response"))})).catch((function(t){return s.reportException({err:new Error("Apple Pay Error (No Payment Session from Server Response) "+t),severity:s.SEVERITY.CRITICAL,tags:["applepay","payments"]}),o.Notify.error(u),e(a.applePayClosedByError("Step 1 - Blocked by ERROR getting Payment Session")),e(a.paymentBannerError(u)),Promise.reject("error in getting payment session from server")}))}function p(e,t){var r=t.details,n=btoa(JSON.stringify(r.token.paymentData));e(a.updateApplePayToken(n))}function d(){return"merchant.dropbox.com"}t.applePayAction=function(e){var t=this,n=e.planName,i=e.price;return function(e){return r.__awaiter(t,void 0,void 0,(function(){var t,m,f,y,h,_,g,v,b;return r.__generator(this,(function(r){switch(r.label){case 0:if(!window.PaymentRequest)return[3,5];if(t={supportedMethods:"https://apple.com/apple-pay",data:{version:3,merchantIdentifier:d(),merchantCapabilities:["supports3DS","supportsCredit","supportsDebit"],supportedNetworks:["amex","discover","masterCard","visa"],countryCode:i.taxCountryCode}},e(a.applePayStartup("Step 0 - Trying to Initilize")),void 0===i.taxAmount||void 0===i.totalPrice||void 0===i.currency)return o.Notify.error(u),s.reportException({err:new Error("Apple Pay Error transition prices are undefined "),severity:s.SEVERITY.OPERATIONAL,tags:["applepay","payments"],exc_extra:{prices:i}}),e(a.paymentBannerError(u)),[2,Promise.resolve(!1)];m=i.taxAmount.amount,f=i.totalPrice.amount,y=i.currency,h=[t],_={total:{label:n,amount:{value:f.toString(),currency:y}},displayItems:[{label:n,amount:{value:(f-m).toString(),currency:y}}]},m>0&&_.displayItems.push({label:l.getTaxNameForCountry(i.taxCountryCode,void 0),amount:{value:m.toString(),currency:y}}),(g=new PaymentRequest(h,_,{})).onmerchantvalidation=function(t){var r=c(e,t.validationURL);t.complete(r)},r.label=1;case 1:return r.trys.push([1,3,,4]),e(a.applePayPopupShown("Step 2 - Payment Session OK - Showing")),[4,g.show()];case 2:return v=r.sent(),p(e,v),e(a.applePayClosedBySuccess("Step 3 - Payment response processed - closing")),v.complete("success"),[2,Promise.resolve(!0)];case 3:return(b=r.sent())&&"AbortError"===b.name?(s.reportException({err:new Error("Apple Pay User Aborted: "+b),severity:s.SEVERITY.NONCRITICAL,tags:["applepay","payments"]}),e(a.applePayClosedByUser("Step 2 - User Closed Most Likely")),[2,Promise.resolve(!1)]):(s.reportException({err:new Error("Apple Pay Error (Most Likely NOT User Abort) "+b),severity:s.SEVERITY.CRITICAL,tags:["applepay","payments"]}),o.Notify.error(u),e(a.applePayClosedByError("Step 2 - User Failed to Pay or Display")),e(a.paymentBannerError(u)),[2,Promise.resolve(!1)]);case 4:return[3,6];case 5:return[2,Promise.resolve(!1)];case 6:return[2]}}))}))}},t.fetchPaymentSession=c,t.processPaymentResponse=p,t.getMerchantIdentifier=d})),define("modules/clean/react/payments/common/constants",["require","exports","modules/core/i18n"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PricingToggleCookie="pricing-schedule",t.PricingToggleMonthly="monthly",t.PricingToggleAnnual="annual",t.ZipCodeErrorMessage=r.intl.formatMessage({id:"CAxLNf",defaultMessage:"Please enter a valid postal code."}),t.AddressErrorMessage=r.intl.formatMessage({id:"0Mt769",defaultMessage:"Please enter a valid address."}),t.CityErrorMessage=r.intl.formatMessage({id:"RF+x3N",defaultMessage:"Please enter a valid city/town."}),t.NameErrorMessage=r.intl.formatMessage({id:"OSqOkI",defaultMessage:"Please enter the card holder name."})})),define("modules/clean/react/payments/common/form_value_factory",["require","exports","tslib","modules/clean/react/payments/common/form_values","modules/clean/payments/validation","modules/clean/datetime"],(function(e,t,r,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a);var i=(function(){function e(){}return e.createInput=function(e,t){var r=e&&!!e.trim();return{rawValue:e,formattedValue:e,errorState:r?a.InputErrorState.Valid:a.InputErrorState.Invalid,showError:!(!r||!t)&&t.showError,serverError:""}},e.createCheckbox=function(e,t,r){var n=r||e?a.InputErrorState.Valid:a.InputErrorState.Invalid;return{rawValue:e,formattedValue:e,errorState:n,showError:!(n===a.InputErrorState.Valid||!t)&&t.showError,serverError:""}},e.createProductPlanType=function(e,t,r){var n=!1;return e&&t&&(n=0===t.plans.length||t.withProductPlanType(e).plans.length>0),{rawValue:e,formattedValue:e,errorState:n?a.InputErrorState.Valid:a.InputErrorState.Invalid,showError:!1,serverError:""}},e.createSchedule=function(e){return{rawValue:e,formattedValue:e,errorState:a.InputErrorState.Valid,showError:!1,serverError:""}},e.createTrialEndDate=function(e,t){var r="";if(t&&e){var n=t.replace("_","-");r=o.daysAfterToday(e).toLocaleDateString(n,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}return{rawValue:r,formattedValue:r,errorState:a.InputErrorState.Valid,showError:!1,serverError:""}},e.createNumberOfUsers=function(e,t,r,n,o){var i,s,l,u,c=t.minNumUsers,p=t.maxNumUsers,d=e,m=parseInt(d,10),f=!isNaN(m);f?(i=m<n,s=m<c,u=m>p,l=0!==o&&m<o+1,m=Math.min(Math.max(m,n),p)):(i=!1,s=!1,u=!1,l=!1,m=c);var y=f&&!s&&!l&&!u;return{rawValue:d,formattedValue:m,errorState:y?a.InputErrorState.Valid:a.InputErrorState.Invalid,showError:!(y||!r)&&r.showError,isUnderLicenseLimit:i,isUnderLimit:s,isOverLimit:u,minLicenseLimit:n,minNumUsers:c,maxNumUsers:p,serverError:""}},e.createEmail=function(e,t){var r=e.trim(),n=a.EmailErrorState.Valid;if(r){var o=r.split("@");if(2!==o.length)n=a.EmailErrorState.NoAt;else{var i=o[0],s=o[1],l=new RegExp("^([a-z0-9][a-z0-9\\-]*\\.)+([a-z]+|xn--[a-z0-9\\-]+)$","i");/^[\w!#$%&'*+\-\/=?^`{|}~.]+$/.test(i)?(!s||/^[\x00-\x7f]*$/.test(s)&&!l.test(s))&&(n=a.EmailErrorState.BadDomain):n=a.EmailErrorState.BadUsername}}else n=a.EmailErrorState.Empty;return{rawValue:e,formattedValue:r,errorState:n,showError:n!==a.EmailErrorState.Valid&&!!t&&t.showError,serverError:"",isCapturable:!1}},e.createTeamPhone=function(e,t){var r=a.TeamPhoneErrorState.Valid;return e||(r=a.TeamPhoneErrorState.Empty),{rawValue:e,formattedValue:e,errorState:r,showError:!(r===a.TeamPhoneErrorState.Valid||!t)&&t.showError,serverError:""}},e.createPassword=function(e,t){var r=a.PasswordErrorState.Valid;return e&&e.length<6?r=a.PasswordErrorState.TooShort:e||(r=a.PasswordErrorState.Empty),{rawValue:e,formattedValue:e,errorState:r,showError:!(r===a.PasswordErrorState.Valid||!t)&&t.showError,serverError:""}},e.createPaymentMethod=function(e,t,r,n){return r.available_payment_methods_for_country(t).indexOf(e)<0&&(e=r.default_payment_method_for_country(t)),{rawValue:e,formattedValue:e,errorState:a.InputErrorState.Valid,showError:!1,serverError:""}},e.createCountryCode=function(e,t){var r=e?a.InputErrorState.Valid:a.InputErrorState.Invalid;return{rawValue:e,formattedValue:e,errorState:r,showError:!(r===a.InputErrorState.Valid||!t)&&t.showError,serverError:""}},e.createAddress=function(e,t){var r=e&&!!e.trim()&&e.trim().length>=1;return{rawValue:e,formattedValue:e,errorState:r?a.InputErrorState.Valid:a.InputErrorState.Invalid,showError:!(r||!t)&&t.showError,serverError:""}},e.createPhone=function(e,t){var r=e&&!!e.trim()&&e.trim().length>=1;return{rawValue:e,formattedValue:e,errorState:r?a.InputErrorState.Valid:a.InputErrorState.Invalid,showError:!(r||!t)&&t.showError,serverError:""}},e.createCity=function(e,t){var r=e&&!!e.trim()&&e.trim().length>=1;return{rawValue:e,formattedValue:e,errorState:r?a.InputErrorState.Valid:a.InputErrorState.Invalid,showError:!(r||!t)&&t.showError,serverError:""}},e.createName=function(e,t){var r=e&&e.trim().length>=1;return{rawValue:e,formattedValue:e,errorState:r?a.InputErrorState.Valid:a.InputErrorState.Invalid,showError:!(r||!t)&&t.showError,serverError:""}},e.createZipCode=function(e,t,r,n){var o=!0,i=/\s+$/gi;if(r.allow_zip_code_for_country(t))if("US"===t){/(^\d{5}$)|(^\d{5}-\d{4}$)/.test(e.replace(i,""))||(o=!1)}else(!e||e.length>15||""===e.trim())&&(o=!1);else e="";var s=o?a.InputErrorState.Valid:a.InputErrorState.Invalid,l=!(o||!n)&&n.showError,u=o?e.replace(i,"").replace(".",""):"";return{rawValue:e,formattedValue:u,errorState:s,showError:l,serverError:""}},e.createVat=function(e,t,r){var o=a.InputErrorState,i=o.Valid,s=o.Invalid,l=e.replace(/\s+/gi,""),u=n.validateVat(t,l)?i:s;return{rawValue:e,formattedValue:l,errorState:u,showError:!(u===i||!r)&&r.showError,serverError:""}},e.createCpf=function(e,t,r){var o,i=a.InputErrorState,s=i.Valid,l=i.Invalid,u=e.replace(/[^\d]+/g,"");return{rawValue:e,formattedValue:u,errorState:o=""===e&&r?s:n.validateCpf(u)?s:l,showError:!(o===s||!t)&&t.showError,serverError:""}},e.createCpfName=function(e,t,r){var n=e&&!!e.trim()||""===e&&r;return{rawValue:e,formattedValue:e,errorState:n?a.InputErrorState.Valid:a.InputErrorState.Invalid,showError:!(!n||!t)&&t.showError,serverError:"",manuallyEdited:!0}},e.createCpfNamePrefill=function(e,t,r,n,o){var i="",s=(i=r||(e&&t?e+" "+t:e||t))&&!!i.trim()||""===i&&o;return{rawValue:i,formattedValue:i,errorState:s?a.InputErrorState.Valid:a.InputErrorState.Invalid,showError:!(!s||!n)&&n.showError,serverError:"",manuallyEdited:!1}},e.createNonce=function(e,t,r,n){var o=a.InputErrorState,i=o.Valid,s=o.Invalid,l=!!r&&r.isCCNValid,u=!!r&&r.isCCodeValid,c=!!r&&r.isCCExpValid;t&&(l=t.ccn?!t.ccn.error:l,u=t.ccode?!t.ccode.error:u,c=t?t.ccexp?!t.ccexp.error:t.ccexpyr&&t.ccexpmo?!t.ccexpyr.error&&!t.ccexpmo.error:c:c);var p=e||(r?r.rawValue:""),d=l&&u&&c?i:s;return{rawValue:p,formattedValue:p,errorState:d,showError:!(d===i||!r)&&r.showError&&!n,serverError:"",isCCNValid:l,isCCodeValid:u,isCCExpValid:c}},e.createPayPalNonce=function(e,t,r){var n=e,o=""!==e?a.InputErrorState.Valid:a.InputErrorState.Invalid;return{rawValue:n,email:t,formattedValue:n,errorState:o,showError:!(o===a.InputErrorState.Valid||!r)&&r.showError,serverError:""}},e.createAdyenEncryptedCard=function(e,t){var r=e||(t?t.rawValue:"");return{rawValue:r,formattedValue:r,errorState:a.InputErrorState.Valid,showError:!1,serverError:""}},e.createEncryptedCardForNetworkToken=function(e,t,r){var n=t||(r?r.encryptedCard:""),o=e||(r?r.cardType:"");return{rawValue:{cardType:o,encryptedCard:n},formattedValue:JSON.stringify({cardType:o,encryptedCard:n}),cardType:o,encryptedCard:n,errorState:a.InputErrorState.Valid,showError:!1,serverError:""}},e.createBIN=function(e,t){var r=e||(t?t.rawValue:"");return{rawValue:r,formattedValue:r,errorState:a.InputErrorState.Valid,showError:!1,serverError:""}},e.createBrowserInfo=function(e,t){var r=e||(t?t.rawValue:"");return{rawValue:r,formattedValue:r,errorState:a.InputErrorState.Valid,showError:!1,serverError:""}},e.createThreeDsData=function(e){return{rawValue:e,formattedValue:e,errorState:a.InputErrorState.Valid,showError:!1,serverError:""}},e.createApplePayToken=function(e,t){var r=e||(t?t.value:"");return{value:r,rawValue:r,formattedValue:r,errorState:a.InputErrorState.Valid,showError:!1,serverError:""}},e.createIBAN=function(e,t){var r=a.InputErrorState,o=r.Valid,i=r.Invalid,s=e.replace(/\s+/gi,""),l=n.validIBANForCountry(s)?o:i;return{rawValue:e,formattedValue:s,errorState:l,showError:!(l===o||!t)&&t.showError,serverError:""}},e.createIdealBankId=function(e,t){var r=e?a.InputErrorState.Valid:a.InputErrorState.Invalid;return{rawValue:e,formattedValue:e,errorState:r,showError:!(r===a.InputErrorState.Valid||!t)&&t.showError,serverError:""}},e.createIdealBankName=function(e,t){return{rawValue:e,formattedValue:e,errorState:e?a.InputErrorState.Valid:a.InputErrorState.Invalid,showError:!1,serverError:""}},e.createEmailsToInvite=function(e,t){return{rawValue:e=e||[],formattedValue:JSON.stringify(e),errorState:a.InputErrorState.Valid,showError:!1,serverError:""}},e})();t.FormValueFactory=i})),define("modules/clean/react/payments/common/form_value_helpers",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.isValid=function(e){return 0===e.errorState},e.hasServerError=function(e){return!!e.serverError}})(t.FormValueHelper||(t.FormValueHelper={}))})),define("modules/clean/react/payments/common/form_values",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.Valid=0]="Valid",e[e.Invalid=1]="Invalid"})(t.InputErrorState||(t.InputErrorState={})),(function(e){e[e.Valid=0]="Valid",e[e.Empty=1]="Empty",e[e.NoAt=2]="NoAt",e[e.BadUsername=3]="BadUsername",e[e.BadDomain=4]="BadDomain",e[e.TakenError=5]="TakenError",e[e.TakenWarning=6]="TakenWarning"})(t.EmailErrorState||(t.EmailErrorState={})),(function(e){e[e.Valid=0]="Valid",e[e.Empty=1]="Empty",e[e.TooShort=2]="TooShort"})(t.PasswordErrorState||(t.PasswordErrorState={})),(function(e){e[e.Valid=0]="Valid",e[e.Empty=1]="Empty"})(t.TeamPhoneErrorState||(t.TeamPhoneErrorState={}))})),define("modules/clean/react/payments/common/form/actions/actions",["require","exports","tslib","modules/clean/react/payments/common/constants","modules/clean/react/payments/common/pricing/actions/actions","external/lodash","modules/clean/react/payments/common/form_value_helpers","modules/clean/auth/common/captcha","modules/clean/payments/skus/constants","modules/clean/react/payments/business/state/business_state","modules/core/cookies"],(function(e,t,r,a,n,o,i,s,l,u,c){"use strict";var p,d;function m(t,a,n,i,l,c,p,m){for(var v={},P=0,S=i;P<S.length;P++){var C=S[P],E=n[C];v[u.fieldsToServerProps[C]]=E.formattedValue}o.assignIn(v,l);var T=function(e,r,a){if(t(y(e,l)),e&&e.actions)for(var n=e.actions,o=0,i=Array.from(n);o<i.length;o++){var s=i[o];if(s.length>=3){var u=s[0],c=s[2];switch(u){case"notifyError":"emailTaken"===c&&t(b())}}}},N=function(e,r,a){var n=null;try{n=JSON.parse(a)}catch(e){}finally{if(t(h(n||a)),p&&n&&p(n),n&&n.error_type&&n.msg&&"Payment"===n.error_type&&t(w(n.msg)),c)s.handle_captcha_errors(c,n)&&t(_())}};if(c){var k=s.get_captcha_responses(c);k["g-recaptcha-response"]&&(v["g-recaptcha-response"]=k["g-recaptcha-response"],m=d.RecaptchaV2,t(g()))}t(f(m,l)),new Promise((function(t,r){e(["modules/clean/payments/payments_web_request"],t,r)})).then(r.__importStar).then((function(e){new(0,e.PaymentsWebRequest)({url:a,data:v,success:T,error:N}).request()})),c&&s.clear_captcha_response(c),m!==d.ThreeDsChallenge&&m!==d.ThreeDsFingerprint||t(F(""))}function f(e,t){return void 0===e&&(e=d.ButtonClick),{type:p.SubmitFormStart,trigger:e,additionalData:t}}function y(e,t){return{type:p.SubmitFormSuccess,data:e,additionalData:t}}function h(e){return{type:p.SubmitFormError,data:e}}function _(){return{type:p.TriggerCaptcha}}function g(){return{type:p.SubmitCaptcha}}function v(e,t){return{type:p.ShowFormFieldErrors,fieldNames:e,origin:t}}function b(){return{type:p.EmailTakenError}}function P(e,t){return function(r){r(n.prepareToUpdatePrice()),r(S(e)),r(n.updatePrice(t))}}function S(e){return{type:p.UpdateNumberOfUsers,value:e}}function C(e){return{type:p.UpdateCountryCode,value:e}}function E(e){return{type:p.UpdateZipCode,value:e}}function T(e){return{type:p.UpdateVat,value:e}}function w(e){return{type:p.PaymentBannerError,msg:e}}function F(e){return{type:p.UpdateThreeDsData,value:e}}function N(e,t){for(var r=0,a=t;r<a.length;r++){var n=e[a[r]];if(!i.FormValueHelper.isValid(n))return!1}return!0}Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),n=r.__importStar(n),o=r.__importStar(o),(function(e){e.BlurEmail="BlurEmail",e.ClickGoogleSignup="ClickGoogleSignup",e.SubmitFormStart="SubmitFormStart",e.SubmitFormSuccess="SubmitFormSuccess",e.SubmitFormError="SubmitFormError",e.ShowFormFieldErrors="ShowFormFieldErrors",e.SubmitCaptcha="SubmitCaptcha",e.TriggerCaptcha="TriggerCaptcha",e.UpdateTransitions="UpdateTransitions",e.UpdateSchedule="UpdateSchedule",e.UpdateProductPlanType="UpdateProductPlanType",e.UpdateNumberOfUsers="UpdateNumberOfUsers",e.UpdateFirstName="UpdateFirstName",e.UpdateLastName="UpdateLastName",e.UpdateEmail="UpdateEmail",e.UpdatePassword="UpdatePassword",e.UpdateSelectedUser="UpdateSelectedUser",e.UpdateTeamName="UpdateTeamName",e.UpdateTeamPhone="UpdateTeamPhone",e.UpdateCompanySize="UpdateCompanySize",e.UpdatePaymentMethod="UpdatePaymentMethod",e.UpdateCountryCode="UpdateCountryCode",e.UpdateZipCode="UpdateZipCode",e.BlurZipCode="BlurZipCode",e.UpdateVat="UpdateVat",e.BlurVat="BlurVat",e.UpdateCpf="UpdateCpf",e.BlurCpf="BlurCpf",e.UpdateCpfName="UpdateCpfName",e.UpdateNonce="UpdateNonce",e.UpdatePayPalNonce="UpdatePayPalNonce",e.BlurCCField="BlurCCField",e.UpdateAdyenEncryptedCard="UpdateAdyenEncryptedCard",e.UpdateEncryptedCardForNetworkToken="UpdateEncryptedCardForNetworkToken",e.UpdateBrowserInfo="UpdateBrowserInfo",e.UpdateThreeDsData="UpdateThreeDsData",e.TriggerThreeDsChallenge="TriggerThreeDsChallenge",e.TriggerThreeDsFingerprint="TriggerThreeDsFingerprint",e.UpdateBIN="UpdateBIN",e.UpdateAccountHolderName="UpdateAccountHolderName",e.BlurAccountHolderName="BlurAccountHolderName",e.UpdateIBAN="UpdateIBAN",e.BlurIBAN="BlurIBAN",e.UpdateMandateSigned="UpdateMandateSigned",e.UpdateIdealBank="UpdateIdealBank",e.UpdateMarketingOptIn="UpdateMarketingOptIn",e.UpdateTermsAndService="UpdateTermsAndService",e.UpdateEVH="UpdateEVH",e.UpdateEmailsToInvite="UpdateEmailsToInvite",e.UpdateCity="UpdateCity",e.BlurCity="BlurCity",e.UpdateAddress="UpdateAddress",e.BlurAddress="BlurAddress",e.UpdatePhone="UpdatePhone",e.BlurPhone="BlurPhone",e.UpdateName="UpdateName",e.BlurName="BlurName",e.EmailTakenError="EmailTakenError",e.EmailTakenWarning="EmailTakenWarning",e.PaymentBannerError="PaymentBannerError",e.UpdateApplePayToken="UpdateApplePayToken",e.ApplePayStartup="ApplePayStartup",e.ApplePayPopupShown="ApplePayPopupShown",e.ApplePayClosedByUser="ApplePayPopupCloseByUser",e.ApplePayClosedByError="ApplePayClosedByError",e.ApplePayClosedBySuccess="ApplePayClosedBySuccess"})(p=t.FormActionEnum||(t.FormActionEnum={})),(function(e){e.ButtonClick="button_click",e.RecaptchaV2="recaptcha_v2",e.ThreeDsChallenge="three_ds_challenge",e.ThreeDsFingerprint="three_ds_fingerprint"})(d=t.SubmitFormTriggerType||(t.SubmitFormTriggerType={})),t.submitForm=function(e,t,r,a,n,o,i){return void 0===a&&(a={}),a.time_on_page_ms=window.performance.now(),function(s,l){N(l().formData,t)?r().then((function(r){r&&m(s,e,l().formData,t,a,n,o,i)})):s(v(t,"SubmitForm"))}},t.submitFormData=m,t.submitFormStart=f,t.submitFormSuccess=y,t.submitFormError=h,t.triggerCaptcha=_,t.submitCaptcha=g,t.showFormFieldErrors=v,t.showEmailTakenError=b,t.showEmailTakenWarning=function(){return{type:p.EmailTakenWarning}},t.updateSchedule=function(e){return c.Cookies.create(a.PricingToggleCookie,e===l.ScheduleId.MONTHLY?a.PricingToggleMonthly:a.PricingToggleAnnual,30),{type:p.UpdateSchedule,value:e}},t.updateProductPlanType=function(e){var t={type:p.UpdateProductPlanType,value:e};return function(e,r){var a=r();e(t),e(S(a.formData.numberOfUsers.rawValue))}},t.updateNumberOfUsers=P,t.updateFirstName=function(e){return{type:p.UpdateFirstName,value:e}},t.updateLastName=function(e){return{type:p.UpdateLastName,value:e}},t.blurEmail=function(e){return{type:p.BlurEmail,value:e}},t.clickGoogleSignup=function(){return{type:p.ClickGoogleSignup}},t.updateEmail=function(e){return{type:p.UpdateEmail,value:e}},t.updatePassword=function(e){return{type:p.UpdatePassword,value:e}},t.updateTeamName=function(e){return{type:p.UpdateTeamName,value:e}},t.updateTeamPhone=function(e){return{type:p.UpdateTeamPhone,value:e}},t.updateCompanySize=function(e){return{type:p.UpdateCompanySize,value:e}},t.updatePaymentMethod=function(e){return{type:p.UpdatePaymentMethod,value:e}},t.updateCountryCodeAndPrice=function(e){return function(t){t(n.prepareToUpdatePrice()),t(C(e)),t(n.updatePrice())}},t.updateCountryCode=C,t.updateZipCodeAndPrice=function(e,t){return function(r){r(n.prepareToUpdatePrice()),r(E(e)),r(n.updatePrice(t))}},t.updateZipCode=E,t.blurZipCode=function(e){return{type:p.BlurZipCode,value:e}},t.updateVatAndPrice=function(e,t){return function(r){r(n.prepareToUpdatePrice()),r(T(e)),r(n.updatePrice(t))}},t.updateVat=T,t.blurVat=function(e){return{type:p.BlurVat,value:e}},t.updateAddress=function(e){return{type:p.UpdateAddress,value:e}},t.blurAddress=function(e){return{type:p.BlurAddress,value:e}},t.updateCity=function(e){return{type:p.UpdateCity,value:e}},t.blurCity=function(e){return{type:p.BlurCity,value:e}},t.updatePhone=function(e){return{type:p.UpdatePhone,value:e}},t.blurPhone=function(e){return{type:p.BlurPhone,value:e}},t.updateName=function(e){return{type:p.UpdateName,value:e}},t.blurName=function(e){return{type:p.BlurName,value:e}},t.updateCpf=function(e){return{type:p.UpdateCpf,value:e}},t.blurCpf=function(e){return{type:p.BlurCpf,value:e}},t.paymentBannerError=w,t.applePayStartup=function(e){return{type:p.ApplePayStartup,msg:e}},t.applePayPopupShown=function(e){return{type:p.ApplePayPopupShown,msg:e}},t.applePayClosedByError=function(e){return{type:p.ApplePayClosedByError,msg:e}},t.applePayClosedBySuccess=function(e){return{type:p.ApplePayClosedBySuccess,msg:e}},t.applePayClosedByUser=function(e){return{type:p.ApplePayClosedByUser,msg:e}},t.updateCpfName=function(e){return{type:p.UpdateCpfName,value:e}},t.updateNonce=function(e,t){return{type:p.UpdateNonce,value:e,creditCardIframeFields:t}},t.updatePayPalNonce=function(e,t){return{type:p.UpdatePayPalNonce,value:e,email:t}},t.blurCCField=function(e){return{type:p.BlurCCField,creditCardIframeFields:e}},t.updateAdyenEncryptedCard=function(e){return{type:p.UpdateAdyenEncryptedCard,value:e}},t.updateEncryptedCardForNetworkToken=function(e,t){return{type:p.UpdateEncryptedCardForNetworkToken,cardType:e,encryptedCard:t}},t.updateApplePayToken=function(e){return{type:p.UpdateApplePayToken,value:e}},t.updateBrowserInfo=function(e){return{type:p.UpdateBrowserInfo,value:e}},t.updateThreeDsData=F,t.triggerThreeDsChallenge=function(){return{type:p.TriggerThreeDsChallenge}},t.triggerThreeDsFingerprint=function(){return{type:p.TriggerThreeDsFingerprint}},t.updateBIN=function(e){return{type:p.UpdateBIN,value:e}},t.updateAccountHolderName=function(e){return{type:p.UpdateAccountHolderName,value:e}},t.blurAccountHolderName=function(e){return{type:p.BlurAccountHolderName,value:e}},t.updateIBAN=function(e){return{type:p.UpdateIBAN,value:e}},t.blurIBAN=function(e){return{type:p.BlurIBAN,value:e}},t.updateMandateSigned=function(e){return{type:p.UpdateMandateSigned,value:e}},t.updateMarketingOptIn=function(e){return{type:p.UpdateMarketingOptIn,value:e}},t.updateTermsAndService=function(e){return{type:p.UpdateTermsAndService,value:e}},t.updateIdealBank=function(e){return{type:p.UpdateIdealBank,value:e}},t.updateEmailsToInvite=function(e,t){return function(r){r((function(e){return{type:p.UpdateEmailsToInvite,value:e}})(e)),r(P(Math.max(e.length+1,t)+""))}},t.isValidSubmitState=N})),define("modules/clean/react/payments/common/pricing/actions/actions",["require","exports","tslib","external/lodash","modules/core/i18n","modules/clean/payments/skus/subscription_diff","modules/clean/payments/skus/subscription_service","modules/clean/payments/dfb_util","modules/core/notify"],(function(e,t,r,a,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(a=r.__importStar(a)).debounce((function(e,t){e((function(e){return{type:"UpdateRecentLoadEventStatus",recentLoadEventStatus:e}})(t))}),400),c=new i.SubscriptionService,p=a.debounce((function(e,t,r,a,n,i){var s,l={discountPercentage:100*n,discountAllowMonthly:i};if(t.currentPlanSku){var u=new o.SubscriptionDiff;u.setPlan(t.currentPlanSku),u.setTotalLicenses(r),s=[u]}else s=t.subChangePlans.plans.map((function(e){var t=o.SubscriptionDiff.fromSubscriptionStatus(e);return t.setTotalLicenses(r),t}));c.priceSet(s,a,l).then((function(t){f(e,t)})).catch((function(t){e(y(t))}))}),400),d=a.debounce((function(e,t,r,a,o){var i=t().pageState.transition,u=new s.DfBTransitionInfoFetcher([i]),c={total_users:a,country_code:o.countryCode,zip_code:o.zipCode,vat_id:o.vat,renew:!0};u.get((function(t){var r=t[0].transition_view_model;e(_(r))}),c,(function(t){l.Notify.error(n.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),e(g(t))}))}),400);function m(){return{type:"UpdateTransitionsStart"}}function f(e,t){e({type:"UpdateTransitionsSuccess",subChangePlans:t}),u(e,!1)}function y(e){return{type:"UpdateTransitionsError",error:e}}function h(){return{type:"UpdateRenewTransitionsStart"}}function _(e){return{type:"UpdateRenewTransitionsSuccess",transition:e}}function g(e){return{type:"UpdateRenewTransitionsError",error:e}}t.prepareToUpdatePrice=function(){return{type:"PrepareToUpdateTransitions"}},t.updatePrice=function(e){return void 0===e&&(e=!1),function(t,r){var a,n=r(),o=n.formData,i=n.pricingState,s=i.discountInfo,l=o.numberOfUsers.formattedValue,u=!0;s&&(a=s.discountRatio,u=s.allowMonthly);var c={countryCode:o.countryCode.formattedValue,zipCode:o.zipCode.formattedValue,vat:o.vat.errorState?"":o.vat.formattedValue};e?(t({type:"UpdateRenewTransitionsStart"}),d(t,r,i,l,c)):(t({type:"UpdateTransitionsStart"}),p(t,i,l,c,a,u))}},t.updateTransitionsStart=m,t.updateTransitionsSuccess=f,t.updateTransitionsError=y,t.updateRenewTransitionsStart=h,t.updateRenewTransitionsSuccess=_,t.updateRenewTransitionsError=g})),define("modules/clean/payments/dfb_util",["require","exports","tslib","external/lodash","modules/clean/ajax","modules/clean/payments/validation","modules/clean/payments/cash","modules/core/exception"],(function(e,t,r,a,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),n=r.__importStar(n),o=r.__importStar(o);var l=(function(){function e(e,t,r,a,n,o,i){this.plan_ids=e,this.schedule_ids=t,this.license_ids_and_counts=r,this.currencies=a,this.country_code=n,this.zip_code=o,this.vat_id=i,this.renew=!1,this.discount_ratio=0,this.discount_allow_monthly=!1}return e.prototype.set_only_license_count=function(e){var t=Object.keys(this.license_ids_and_counts)[0];this.license_ids_and_counts[t]=e},e.prototype.get_only_license_count=function(){var e=Object.keys(this.license_ids_and_counts)[0];return this.license_ids_and_counts[e]},e.prototype.set_country_code=function(e){this.country_code=e},e.prototype.set_zip_code=function(e){this.zip_code=e},e.prototype.set_currencies=function(e){this.currencies=e},e.prototype.set_renew=function(e){this.renew=e},e.prototype.set_discount_ratio=function(e){this.discount_ratio=e},e.prototype.set_discount_allow_monthly=function(e){this.discount_allow_monthly=e},e.prototype.set_vat_id=function(e){""!==e&&o.validateVat(this.country_code||"",e)?this.vat_id=e:this.vat_id=""},e.prototype.cache_key=function(e){var t;return void 0===e&&(e=!1),this.currencies&&!e&&(t=this.currencies.join(",")),[this.plan_ids.join(","),this.schedule_ids.join(","),this.get_only_license_count(),t,this.country_code,this.zip_code,this.vat_id,this.renew,this.discount_ratio].join(":")},e.prototype.to_json=function(){var e=this.renew?{renew:1}:{};return r.__assign(r.__assign({},e),{plan_ids:JSON.stringify(this.plan_ids),schedule_ids:JSON.stringify(this.schedule_ids),license_ids_and_counts:JSON.stringify(this.license_ids_and_counts),currencies:this.currencies?JSON.stringify(this.currencies):"",country_code:this.country_code,zip_code:this.zip_code,vat_id:this.vat_id,discount_percentage:JSON.stringify(100*this.discount_ratio),discount_allow_monthly:this.discount_allow_monthly})},e.from_transition_view_models=function(t){for(var r,n=[],o=[],i=[],l=null,u=null,c=null,p=0,d=t;p<d.length;p++){var m=d[p],f=void 0;if(n.push(m.state.plan.id),o.push(m.state.schedule.id),i.push(m.state.currency),void 0===r){r={};for(var y=0,h=m.state.allocated_licenses;y<h.length;y++)r[(f=h[y]).license_id]=f.license_count;a.isObject(m.read_only_invoice)&&(l=m.read_only_invoice.tax_country_code||null,u=m.read_only_invoice.tax_exclusion_id||null,c=m.read_only_invoice.tax_zip_code||null)}else{s.assert(m.state.allocated_licenses.length===Object.keys(r).length,"License sets differ");for(var _=0,g=m.state.allocated_licenses;_<g.length;_++)f=g[_],s.assert(r.hasOwnProperty(""+f.license_id),"License sets differ"),s.assert(r[f.license_id]===f.license_count,"License count must match");s.assert(l===(m.read_only_invoice&&m.read_only_invoice.tax_country_code||null),"country code must match"),s.assert(c===(m.read_only_invoice&&m.read_only_invoice.tax_zip_code||null),"zip code must match"),s.assert(u===(m.read_only_invoice&&m.read_only_invoice.tax_exclusion_id||null),"VAT ID must match")}}return new e(a.uniq(n),a.uniq(o),r||{},a.uniq(i),l,c,u)},e})();t.DfbTransitionSpaceParams=l;var u=function(e){if(this.transition_view_model=e,this.transition_view_model.read_only_invoice?this.current_total=i.Cash.fromObject(this.transition_view_model.read_only_invoice.total):this.current_total=new i.Cash(0,this.transition_view_model.state.currency),this.price_token=this.transition_view_model.expected_price,this.transition_view_model.state.per_license_prices.length?this.per_license_price=i.Cash.fromObject(this.transition_view_model.state.per_license_prices[0].price):this.per_license_price=new i.Cash(0,this.transition_view_model.state.currency),this.recurring_total=i.Cash.fromObject(this.transition_view_model.state.total_recurring_price),this.transition_view_model.prices?this.tax=i.Cash.fromObject(this.transition_view_model.prices.tax):this.tax=new i.Cash(0,this.recurring_total.currency),this.transition_view_model.total_recurring_taxes?this.recurring_tax=i.Cash.fromObject(this.transition_view_model.total_recurring_taxes):this.recurring_tax=new i.Cash(0,this.recurring_total.currency),this.recurring_total_tax=this.recurring_total.add(this.recurring_tax),this.tax_percentage=0,this.transition_view_model.read_only_invoice){var t=this.transition_view_model.read_only_invoice.line_items,r=t.length>0?t[0]:void 0;r&&!a.isEmpty(r.country_tax_percentage)?this.tax_percentage=parseFloat(r.country_tax_percentage):r&&!a.isEmpty(r.state_tax_percentage)&&(this.tax_percentage=parseFloat(r.state_tax_percentage))}};t.DfBTransitionInfo=u;var c=(function(){function e(e){var t=this;this.has_inflight_request=function(){return Object.keys(t.transition_view_model_requests).length>0},this.add_to_cache=function(e,r){void 0===r&&(r=!1);var a=l.from_transition_view_models(e).cache_key(r),n=e.map((function(e){return new u(e)}));return t.transition_info_cache[a]=n,n},this.get_transition_info_for=function(e){return t.transition_info_cache.hasOwnProperty(e)?t.transition_info_cache[e]:null},this.default_transition_view_models=e,this.transition_view_model_requests={},this.transition_info_cache={},this.add_to_cache(this.default_transition_view_models)}return e.prototype.get=function(e,t,r){var o=this,i=l.from_transition_view_models(this.default_transition_view_models);t.total_users&&i.set_only_license_count(t.total_users),t.country_code&&i.set_country_code(t.country_code),t.currency&&i.set_currencies([t.currency]),!0===t.remove_currency&&i.set_currencies([]),t.zip_code&&i.set_zip_code(t.zip_code),a.isBoolean(t.renew)&&i.set_renew(t.renew),(t.vat_id||""===t.vat_id)&&i.set_vat_id(t.vat_id),t.discount_ratio&&i.set_discount_ratio(t.discount_ratio),a.isBoolean(t.discount_allow_monthly)&&i.set_discount_allow_monthly(t.discount_allow_monthly);var s=i.cache_key(),u=this.get_transition_info_for(s);if(u)e(u);else if(!this.transition_view_model_requests[s])return this.transition_view_model_requests[s]=!0,n.SilentBackgroundRequest({url:"/business/transition-model",type:"GET",dataType:"json",data:i.to_json(),success:function(r){delete o.transition_view_model_requests[s];var a=o.add_to_cache(r,t.remove_currency);e(a)},error:function(e){a.isFunction(r)&&r(e),delete o.transition_view_model_requests[s]}})},e})();t.DfBTransitionInfoFetcher=c}));
//# sourceMappingURL=pkg-buy.min.js-vflW9rEVO.map