define(["require","exports","tslib","modules/clean/ajax_as_promised","modules/clean/api_v2/default_user_client","modules/clean/auth/login/types","modules/clean/viewer","modules/core/exception","modules/core/i18n"],(function(e,r,n,t,a,s,i,o,c){"use strict";function u(){var e=i.Viewer.get_viewer().get_users()[0];return o.assert(null!=e,"Expect user is logged in when pairing"),new a.DefaultUserApiV2Client(e)}function l(e){var r;return(null===(r=null==e?void 0:e.error)||void 0===r?void 0:r[".tag"])?{status:s.LoginResponseStatus.ERROR,html_response:!1,message:e.message}:{status:s.LoginResponseStatus.ERROR,html_response:!1,message:c.intl.formatMessage({id:"vuVMnM",defaultMessage:"Something went wrong."})}}function _(e){return n.__awaiter(this,void 0,Promise,(function(){var r,t,a,s,i;return n.__generator(this,(function(n){switch(n.label){case 0:r=e.login_email,t=e.encrypted_password,o.assert(null!=r&&null!=t,"Expect login email and password not null"),a=u(),s={login_email:r,encrypted_password:t,remember_me:e.remember_me},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,a.ns("team").rpc("account_pair_login",s,{})];case 2:return(i=n.sent()).two_factor_request?[2,i.two_factor_request]:[2,i];case 3:return[2,l(n.sent())];case 4:return[2]}}))}))}function m(e){return n.__awaiter(this,void 0,Promise,(function(){var r,t,a,s;return n.__generator(this,(function(n){switch(n.label){case 0:r=e.checkpoint_token,t=e.code,o.assert(null!=r&&null!=t,"Expect checkpoint token and code not null"),a=u(),s={checkpoint_token:r,code:t,remember_me:e.remember_me},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,a.ns("team").rpc("account_pair_two_factor_login",s,{})];case 2:return[2,n.sent()];case 3:return[2,l(n.sent())];case 4:return[2]}}))}))}Object.defineProperty(r,"__esModule",{value:!0}),t=n.__importStar(t),r.checkSsoState=function(e){return new Promise((function(r){return t.WebRequest({url:"/sso_state",data:{email:e},success:function(e){return r(JSON.parse(e))}})}))},r.accountPairLogin=_,r.accountPairTwoFactorLogin=m,r.submitCredentialsForm=function(e,r){var n;switch(e){case"multi":n="/ajax_multi_login";break;case"pairing":n="/team/join/new_pair_login_ajax";break;case"cli_link":n="/cli_link";break;case"cli_link_nonce":n="/cli_link_nonce";break;case"bidirectional_pair":return _(r);default:n="/ajax_login"}return new Promise((function(e,a){return t.WebRequest({url:n,type:"POST",data:r,success:function(r){e(JSON.parse(r))},error:function(r,n,t){"{"!==t[0]&&-1===t.indexOf(":")?e({status:s.LoginResponseStatus.ERROR,html_response:!1,message:t}):a(JSON.parse(t))}})}))},r.resendTwoFactorCode=function(e,r){return new Promise((function(n,a){return t.WebRequest({url:"/twofactor_resend",data:{backup:e,mobile_push:r},success:n,error:a})}))},r.retryU2fAuthentication=function(){return new Promise((function(e,r){return t.WebRequest({url:"/account/twofactor/u2f_start_authentication",success:e,error:r})}))},r.submitTwoFactorForm=function(e,r){var n;switch(e){case"multi":n="/ajax_multi_verify_code";break;case"pairing":n="/team/join/new_pair_login_ajax";break;case"cli_link":case"cli_link_nonce":n="/cli_link_twofactor";break;case"admin":n="/admin/login/twofactor";break;case"bidirectional_pair":return m(r);default:n="/ajax_verify_code"}return new Promise((function(e,a){return t.WebRequest({url:n,type:"POST",data:r,success:function(r){return e(JSON.parse(r))},error:function(e,r,n){return a(JSON.parse(n))}})}))},r.logProfileServicesSuccess=function(){return t.SilentBackgroundRequest({url:"/profile_services/log",data:{event_name:"login_callback_success"}})},r.logProfileServicesFailure=function(){return t.SilentBackgroundRequest({url:"/profile_services/log",data:{event_name:"login_callback_error"}})}}));
//# sourceMappingURL=api.min.js-vflWmokRb.map